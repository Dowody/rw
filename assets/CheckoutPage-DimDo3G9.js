const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/secp256k1-CXafz8lr.js","assets/index-D0qe6qwo.js","assets/index-BN5gd7GH.css","assets/invoiceUtils-CjMltxFc.js","assets/shield-check-JdpX1u60.js","assets/credit-card-BRaAU-pn.js","assets/file-text-B2VPAxWD.js","assets/embedded-wallet-BDXHrTBS.js","assets/if-defined-B_SNVxgh.js","assets/index-DP2_pQaY.js","assets/index-DS3Ge-QJ.js","assets/ref-DN4H2pLC.js","assets/index-C7ibr0fR.js","assets/index-BFFGuqPA.js","assets/index-DyCoHsDf.js","assets/index-DEQCmmAW.js","assets/index-DxCzHFIR.js","assets/index-Df-bKHLL.js","assets/index-Di5Edqh0.js","assets/email-Bf9vZ0VD.js","assets/index-DbPmFujR.js","assets/socials-BFOkH0gS.js","assets/index-CiyZwFPe.js","assets/ConstantsUtil-Dmg8YACJ.js","assets/index-Co3ZsCXL.js","assets/index-CvM13Oy4.js","assets/index-BpB9Nl0S.js","assets/index-Bvzyj-RF.js","assets/swaps-CXzbbxfm.js","assets/index-CZ0eT8Bl.js","assets/index-BcHdtF05.js","assets/index-CDDO8FFk.js","assets/send-DW1KYLkk.js","assets/index-Cy92dYCJ.js","assets/index-JutSJ65J.js","assets/receive-NxioL1Mo.js","assets/index-BCQh4m2N.js","assets/onramp-ncVVSYkj.js","assets/index-oxEJCQ_T.js","assets/index-CkA0YCG5.js","assets/index-BQJZVeL4.js","assets/transactions-EHsmFSxl.js","assets/index-Dt3panm7.js","assets/index-DFplMpj9.js","assets/index-DLBlYXcn.js","assets/index-CfC33MLK.js","assets/index-DJbmAwR-.js","assets/w3m-modal-aPO4RrzA.js","assets/index-ByyAH7FS.js"])))=>i.map(i=>d[i]);
var Yx=Object.defineProperty;var D0=r=>{throw TypeError(r)};var Qx=(r,e,t)=>e in r?Yx(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var L=(r,e,t)=>Qx(r,typeof e!="symbol"?e+"":e,t),fm=(r,e,t)=>e.has(r)||D0("Cannot "+t);var y=(r,e,t)=>(fm(r,e,"read from private field"),t?t.call(r):e.get(r)),F=(r,e,t)=>e.has(r)?D0("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),_=(r,e,t,n)=>(fm(r,e,"write to private field"),n?n.call(r,t):e.set(r,t),t),W=(r,e,t)=>(fm(r,e,"access private method"),t);var Qu=(r,e,t,n)=>({set _(s){_(r,e,s,t)},get _(){return y(r,e,n)}});import{c as SC,n as _g,o as xC,_ as cn,p as Bs,r as Ce,R as Zx,b as Xx,u as eT,j as I,q as tT,t as pm,v as k0,C as U0,m as Vo,w as rT,G as B0,T as nT,h as sT,x as Of,W as gm,e as mm,f as L0,L as Rf,S as iT,A as oT,s as qn,y as aT,I as cT,X as lT}from"./index-D0qe6qwo.js";import{g as uT}from"./invoiceUtils-CjMltxFc.js";import{S as $0}from"./shield-check-JdpX1u60.js";import{C as M0}from"./credit-card-BRaAU-pn.js";import{F as hT}from"./file-text-B2VPAxWD.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dT=SC("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fT=SC("Link2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]),pT=Symbol(),wb=Symbol(),Zu="a",xh="w";let gT=(r,e)=>new Proxy(r,e);const Uy=Object.getPrototypeOf,By=new WeakMap,TC=r=>r&&(By.has(r)?By.get(r):Uy(r)===Object.prototype||Uy(r)===Array.prototype),Up=r=>typeof r=="object"&&r!==null,mT=r=>{if(Array.isArray(r))return Array.from(r);const e=Object.getOwnPropertyDescriptors(r);return Object.values(e).forEach(t=>{t.configurable=!0}),Object.create(Uy(r),e)},bb=r=>r[wb]||r,PC=(r,e,t,n)=>{if(!TC(r))return r;let s=n&&n.get(r);if(!s){const c=bb(r);s=(l=>Object.values(Object.getOwnPropertyDescriptors(l)).some(u=>!u.configurable&&!u.writable))(c)?[c,mT(c)]:[c],n==null||n.set(r,s)}const[i,o]=s;let a=t&&t.get(i);return a&&a[1].f===!!o||(a=((c,l)=>{const u={f:l};let h=!1;const d=(g,p)=>{if(!h){let m=u[Zu].get(c);if(m||(m={},u[Zu].set(c,m)),g===xh)m[xh]=!0;else{let w=m[g];w||(w=new Set,m[g]=w),w.add(p)}}},f={get:(g,p)=>p===wb?c:(d("k",p),PC(Reflect.get(g,p),u[Zu],u.c,u.t)),has:(g,p)=>p===pT?(h=!0,u[Zu].delete(c),!0):(d("h",p),Reflect.has(g,p)),getOwnPropertyDescriptor:(g,p)=>(d("o",p),Reflect.getOwnPropertyDescriptor(g,p)),ownKeys:g=>(d(xh),Reflect.ownKeys(g))};return l&&(f.set=f.deleteProperty=()=>!1),[f,u]})(i,!!o),a[1].p=gT(o||i,a[0]),t&&t.set(i,a)),a[1][Zu]=e,a[1].c=t,a[1].t=n,a[1].p},OC=(r,e,t,n,s=Object.is)=>{if(s(r,e))return!1;if(!Up(r)||!Up(e))return!0;const i=t.get(bb(r));if(!i)return!0;if(n){const a=n.get(r);if(a&&a.n===e)return a.g;n.set(r,{n:e,g:!1})}let o=null;try{for(const a of i.h||[])if(o=Reflect.has(r,a)!==Reflect.has(e,a),o)return o;if(i[xh]===!0){if(o=((a,c)=>{const l=Reflect.ownKeys(a),u=Reflect.ownKeys(c);return l.length!==u.length||l.some((h,d)=>h!==u[d])})(r,e),o)return o}else for(const a of i.o||[])if(o=!!Reflect.getOwnPropertyDescriptor(r,a)!=!!Reflect.getOwnPropertyDescriptor(e,a),o)return o;for(const a of i.k||[])if(o=OC(r[a],e[a],t,n,s),o)return o;return o===null&&(o=!0),o}finally{n&&n.set(r,{n:e,g:o})}},yT=r=>TC(r)&&r[wb]||null,F0=(r,e=!0)=>{By.set(r,e)},wT=(r,e,t)=>{const n=[],s=new WeakSet,i=(o,a)=>{if(s.has(o))return;Up(o)&&s.add(o);const c=Up(o)&&e.get(bb(o));if(c){var l,u;if((l=c.h)==null||l.forEach(d=>{const f=`:has(${String(d)})`;n.push(a?[...a,f]:[f])}),c[xh]===!0){const d=":ownKeys";n.push(a?[...a,d]:[d])}else{var h;(h=c.o)==null||h.forEach(d=>{const f=`:hasOwn(${String(d)})`;n.push(a?[...a,f]:[f])})}(u=c.k)==null||u.forEach(d=>{!("value"in(Object.getOwnPropertyDescriptor(o,d)||{}))||i(o[d],a?[...a,d]:[d])})}else a&&n.push(a)};return i(r),n},Bp={},ym=r=>typeof r=="object"&&r!==null,ro=new WeakMap,wh=new WeakSet,bT=(r=Object.is,e=(l,u)=>new Proxy(l,u),t=l=>ym(l)&&!wh.has(l)&&(Array.isArray(l)||!(Symbol.iterator in l))&&!(l instanceof WeakMap)&&!(l instanceof WeakSet)&&!(l instanceof Error)&&!(l instanceof Number)&&!(l instanceof Date)&&!(l instanceof String)&&!(l instanceof RegExp)&&!(l instanceof ArrayBuffer),n=l=>{switch(l.status){case"fulfilled":return l.value;case"rejected":throw l.reason;default:throw l}},s=new WeakMap,i=(l,u,h=n)=>{const d=s.get(l);if((d==null?void 0:d[0])===u)return d[1];const f=Array.isArray(l)?[]:Object.create(Object.getPrototypeOf(l));return F0(f,!0),s.set(l,[u,f]),Reflect.ownKeys(l).forEach(g=>{if(Object.getOwnPropertyDescriptor(f,g))return;const p=Reflect.get(l,g),{enumerable:m}=Reflect.getOwnPropertyDescriptor(l,g),w={value:p,enumerable:m,configurable:!0};if(wh.has(p))F0(p,!1);else if(p instanceof Promise)delete w.value,w.get=()=>h(p);else if(ro.has(p)){const[A,v]=ro.get(p);w.value=i(A,v(),h)}Object.defineProperty(f,g,w)}),Object.preventExtensions(f)},o=new WeakMap,a=[1,1],c=l=>{if(!ym(l))throw new Error("object required");const u=o.get(l);if(u)return u;let h=a[0];const d=new Set,f=(x,j=++a[0])=>{h!==j&&(h=j,d.forEach($=>$(x,j)))};let g=a[1];const p=(x=++a[1])=>(g!==x&&!d.size&&(g=x,w.forEach(([j])=>{const $=j[1](x);$>h&&(h=$)})),h),m=x=>(j,$)=>{const H=[...j];H[1]=[x,...H[1]],f(H,$)},w=new Map,A=(x,j)=>{if((Bp?"production":void 0)!=="production"&&w.has(x))throw new Error("prop listener already exists");if(d.size){const $=j[3](m(x));w.set(x,[j,$])}else w.set(x,[j])},v=x=>{var j;const $=w.get(x);$&&(w.delete(x),(j=$[1])==null||j.call($))},N=x=>(d.add(x),d.size===1&&w.forEach(([$,H],Z)=>{if((Bp?"production":void 0)!=="production"&&H)throw new Error("remove already exists");const z=$[3](m(Z));w.set(Z,[$,z])}),()=>{d.delete(x),d.size===0&&w.forEach(([$,H],Z)=>{H&&(H(),w.set(Z,[$]))})}),T=Array.isArray(l)?[]:Object.create(Object.getPrototypeOf(l)),D=e(T,{deleteProperty(x,j){const $=Reflect.get(x,j);v(j);const H=Reflect.deleteProperty(x,j);return H&&f(["delete",[j],$]),H},set(x,j,$,H){const Z=Reflect.has(x,j),z=Reflect.get(x,j,H);if(Z&&(r(z,$)||o.has($)&&r(z,o.get($))))return!0;v(j),ym($)&&($=yT($)||$);let b=$;if($ instanceof Promise)$.then(E=>{$.status="fulfilled",$.value=E,f(["resolve",[j],E])}).catch(E=>{$.status="rejected",$.reason=E,f(["reject",[j],E])});else{!ro.has($)&&t($)&&(b=c($));const E=!wh.has(b)&&ro.get(b);E&&A(j,E)}return Reflect.set(x,j,b,H),f(["set",[j],$,z]),!0}});o.set(l,D);const U=[T,p,i,N];return ro.set(D,U),Reflect.ownKeys(l).forEach(x=>{const j=Object.getOwnPropertyDescriptor(l,x);"value"in j&&(D[x]=l[x],delete j.value,delete j.writable),Object.defineProperty(T,x,j)}),D})=>[c,ro,wh,r,e,t,n,s,i,o,a],[ET]=bT();function St(r={}){return ET(r)}function _r(r,e,t){const n=ro.get(r);(Bp?"production":void 0)!=="production"&&!n&&console.warn("Please use proxy object");let s;const i=[],o=n[3];let a=!1;const l=o(u=>{i.push(u),s||(s=Promise.resolve().then(()=>{s=void 0,a&&e(i.splice(0))}))});return a=!0,()=>{a=!1,l()}}function Za(r,e){const t=ro.get(r);(Bp?"production":void 0)!=="production"&&!t&&console.warn("Please use proxy object");const[n,s,i]=t;return i(n,s(),e)}function Xa(r){return wh.add(r),r}function Zr(r,e,t,n){let s=r[e];return _r(r,()=>{const i=r[e];Object.is(s,i)||t(s=i)})}function vT(r){const e=St({data:Array.from([]),has(t){return this.data.some(n=>n[0]===t)},set(t,n){const s=this.data.find(i=>i[0]===t);return s?s[1]=n:this.data.push([t,n]),this},get(t){var n;return(n=this.data.find(s=>s[0]===t))==null?void 0:n[1]},delete(t){const n=this.data.findIndex(s=>s[0]===t);return n===-1?!1:(this.data.splice(n,1),!0)},clear(){this.data.splice(0)},get size(){return this.data.length},toJSON(){return new Map(this.data)},forEach(t){this.data.forEach(n=>{t(n[1],n[0],this)})},keys(){return this.data.map(t=>t[0]).values()},values(){return this.data.map(t=>t[1]).values()},entries(){return new Map(this.data).entries()},get[Symbol.toStringTag](){return"Map"},[Symbol.iterator](){return this.entries()}});return Object.defineProperties(e,{data:{enumerable:!1},size:{enumerable:!1},toJSON:{enumerable:!1}}),Object.seal(e),e}const RC={caipNetworkIdToNumber(r){return r?Number(r.split(":")[1]):void 0},parseEvmChainId(r){return typeof r=="string"?this.caipNetworkIdToNumber(r):r},getNetworksByNamespace(r,e){return(r==null?void 0:r.filter(t=>t.chainNamespace===e))||[]},getFirstNetworkByNamespace(r,e){return this.getNetworksByNamespace(r,e)[0]}};var AT=20,CT=1,ku=1e6,_T=1e6,NT=-7,IT=21,ST=!1,nf="[big.js] ",fc=nf+"Invalid ",Ng=fc+"decimal places",xT=fc+"rounding mode",DC=nf+"Division by zero",it={},zs=void 0,TT=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;function kC(){function r(e){var t=this;if(!(t instanceof r))return e===zs?kC():new r(e);if(e instanceof r)t.s=e.s,t.e=e.e,t.c=e.c.slice();else{if(typeof e!="string"){if(r.strict===!0&&typeof e!="bigint")throw TypeError(fc+"value");e=e===0&&1/e<0?"-0":String(e)}PT(t,e)}t.constructor=r}return r.prototype=it,r.DP=AT,r.RM=CT,r.NE=NT,r.PE=IT,r.strict=ST,r.roundDown=0,r.roundHalfUp=1,r.roundHalfEven=2,r.roundUp=3,r}function PT(r,e){var t,n,s;if(!TT.test(e))throw Error(fc+"number");for(r.s=e.charAt(0)=="-"?(e=e.slice(1),-1):1,(t=e.indexOf("."))>-1&&(e=e.replace(".","")),(n=e.search(/e/i))>0?(t<0&&(t=n),t+=+e.slice(n+1),e=e.substring(0,n)):t<0&&(t=e.length),s=e.length,n=0;n<s&&e.charAt(n)=="0";)++n;if(n==s)r.c=[r.e=0];else{for(;s>0&&e.charAt(--s)=="0";);for(r.e=t-n-1,r.c=[],t=0;n<=s;)r.c[t++]=+e.charAt(n++)}return r}function pc(r,e,t,n){var s=r.c;if(t===zs&&(t=r.constructor.RM),t!==0&&t!==1&&t!==2&&t!==3)throw Error(xT);if(e<1)n=t===3&&(n||!!s[0])||e===0&&(t===1&&s[0]>=5||t===2&&(s[0]>5||s[0]===5&&(n||s[1]!==zs))),s.length=1,n?(r.e=r.e-e+1,s[0]=1):s[0]=r.e=0;else if(e<s.length){if(n=t===1&&s[e]>=5||t===2&&(s[e]>5||s[e]===5&&(n||s[e+1]!==zs||s[e-1]&1))||t===3&&(n||!!s[0]),s.length=e,n){for(;++s[--e]>9;)if(s[e]=0,e===0){++r.e,s.unshift(1);break}}for(e=s.length;!s[--e];)s.pop()}return r}function gc(r,e,t){var n=r.e,s=r.c.join(""),i=s.length;if(e)s=s.charAt(0)+(i>1?"."+s.slice(1):"")+(n<0?"e":"e+")+n;else if(n<0){for(;++n;)s="0"+s;s="0."+s}else if(n>0)if(++n>i)for(n-=i;n--;)s+="0";else n<i&&(s=s.slice(0,n)+"."+s.slice(n));else i>1&&(s=s.charAt(0)+"."+s.slice(1));return r.s<0&&t?"-"+s:s}it.abs=function(){var r=new this.constructor(this);return r.s=1,r};it.cmp=function(r){var e,t=this,n=t.c,s=(r=new t.constructor(r)).c,i=t.s,o=r.s,a=t.e,c=r.e;if(!n[0]||!s[0])return n[0]?i:s[0]?-o:0;if(i!=o)return i;if(e=i<0,a!=c)return a>c^e?1:-1;for(o=(a=n.length)<(c=s.length)?a:c,i=-1;++i<o;)if(n[i]!=s[i])return n[i]>s[i]^e?1:-1;return a==c?0:a>c^e?1:-1};it.div=function(r){var e=this,t=e.constructor,n=e.c,s=(r=new t(r)).c,i=e.s==r.s?1:-1,o=t.DP;if(o!==~~o||o<0||o>ku)throw Error(Ng);if(!s[0])throw Error(DC);if(!n[0])return r.s=i,r.c=[r.e=0],r;var a,c,l,u,h,d=s.slice(),f=a=s.length,g=n.length,p=n.slice(0,a),m=p.length,w=r,A=w.c=[],v=0,N=o+(w.e=e.e-r.e)+1;for(w.s=i,i=N<0?0:N,d.unshift(0);m++<a;)p.push(0);do{for(l=0;l<10;l++){if(a!=(m=p.length))u=a>m?1:-1;else for(h=-1,u=0;++h<a;)if(s[h]!=p[h]){u=s[h]>p[h]?1:-1;break}if(u<0){for(c=m==a?s:d;m;){if(p[--m]<c[m]){for(h=m;h&&!p[--h];)p[h]=9;--p[h],p[m]+=10}p[m]-=c[m]}for(;!p[0];)p.shift()}else break}A[v++]=u?l:++l,p[0]&&u?p[m]=n[f]||0:p=[n[f]]}while((f++<g||p[0]!==zs)&&i--);return!A[0]&&v!=1&&(A.shift(),w.e--,N--),v>N&&pc(w,N,t.RM,p[0]!==zs),w};it.eq=function(r){return this.cmp(r)===0};it.gt=function(r){return this.cmp(r)>0};it.gte=function(r){return this.cmp(r)>-1};it.lt=function(r){return this.cmp(r)<0};it.lte=function(r){return this.cmp(r)<1};it.minus=it.sub=function(r){var e,t,n,s,i=this,o=i.constructor,a=i.s,c=(r=new o(r)).s;if(a!=c)return r.s=-c,i.plus(r);var l=i.c.slice(),u=i.e,h=r.c,d=r.e;if(!l[0]||!h[0])return h[0]?r.s=-c:l[0]?r=new o(i):r.s=1,r;if(a=u-d){for((s=a<0)?(a=-a,n=l):(d=u,n=h),n.reverse(),c=a;c--;)n.push(0);n.reverse()}else for(t=((s=l.length<h.length)?l:h).length,a=c=0;c<t;c++)if(l[c]!=h[c]){s=l[c]<h[c];break}if(s&&(n=l,l=h,h=n,r.s=-r.s),(c=(t=h.length)-(e=l.length))>0)for(;c--;)l[e++]=0;for(c=e;t>a;){if(l[--t]<h[t]){for(e=t;e&&!l[--e];)l[e]=9;--l[e],l[t]+=10}l[t]-=h[t]}for(;l[--c]===0;)l.pop();for(;l[0]===0;)l.shift(),--d;return l[0]||(r.s=1,l=[d=0]),r.c=l,r.e=d,r};it.mod=function(r){var e,t=this,n=t.constructor,s=t.s,i=(r=new n(r)).s;if(!r.c[0])throw Error(DC);return t.s=r.s=1,e=r.cmp(t)==1,t.s=s,r.s=i,e?new n(t):(s=n.DP,i=n.RM,n.DP=n.RM=0,t=t.div(r),n.DP=s,n.RM=i,this.minus(t.times(r)))};it.neg=function(){var r=new this.constructor(this);return r.s=-r.s,r};it.plus=it.add=function(r){var e,t,n,s=this,i=s.constructor;if(r=new i(r),s.s!=r.s)return r.s=-r.s,s.minus(r);var o=s.e,a=s.c,c=r.e,l=r.c;if(!a[0]||!l[0])return l[0]||(a[0]?r=new i(s):r.s=s.s),r;if(a=a.slice(),e=o-c){for(e>0?(c=o,n=l):(e=-e,n=a),n.reverse();e--;)n.push(0);n.reverse()}for(a.length-l.length<0&&(n=l,l=a,a=n),e=l.length,t=0;e;a[e]%=10)t=(a[--e]=a[e]+l[e]+t)/10|0;for(t&&(a.unshift(t),++c),e=a.length;a[--e]===0;)a.pop();return r.c=a,r.e=c,r};it.pow=function(r){var e=this,t=new e.constructor("1"),n=t,s=r<0;if(r!==~~r||r<-1e6||r>_T)throw Error(fc+"exponent");for(s&&(r=-r);r&1&&(n=n.times(e)),r>>=1,!!r;)e=e.times(e);return s?t.div(n):n};it.prec=function(r,e){if(r!==~~r||r<1||r>ku)throw Error(fc+"precision");return pc(new this.constructor(this),r,e)};it.round=function(r,e){if(r===zs)r=0;else if(r!==~~r||r<-1e6||r>ku)throw Error(Ng);return pc(new this.constructor(this),r+this.e+1,e)};it.sqrt=function(){var r,e,t,n=this,s=n.constructor,i=n.s,o=n.e,a=new s("0.5");if(!n.c[0])return new s(n);if(i<0)throw Error(nf+"No square root");i=Math.sqrt(+gc(n,!0,!0)),i===0||i===1/0?(e=n.c.join(""),e.length+o&1||(e+="0"),i=Math.sqrt(e),o=((o+1)/2|0)-(o<0||o&1),r=new s((i==1/0?"5e":(i=i.toExponential()).slice(0,i.indexOf("e")+1))+o)):r=new s(i+""),o=r.e+(s.DP+=4);do t=r,r=a.times(t.plus(n.div(t)));while(t.c.slice(0,o).join("")!==r.c.slice(0,o).join(""));return pc(r,(s.DP-=4)+r.e+1,s.RM)};it.times=it.mul=function(r){var e,t=this,n=t.constructor,s=t.c,i=(r=new n(r)).c,o=s.length,a=i.length,c=t.e,l=r.e;if(r.s=t.s==r.s?1:-1,!s[0]||!i[0])return r.c=[r.e=0],r;for(r.e=c+l,o<a&&(e=s,s=i,i=e,l=o,o=a,a=l),e=new Array(l=o+a);l--;)e[l]=0;for(c=a;c--;){for(a=0,l=o+c;l>c;)a=e[l]+i[c]*s[l-c-1]+a,e[l--]=a%10,a=a/10|0;e[l]=a}for(a?++r.e:e.shift(),c=e.length;!e[--c];)e.pop();return r.c=e,r};it.toExponential=function(r,e){var t=this,n=t.c[0];if(r!==zs){if(r!==~~r||r<0||r>ku)throw Error(Ng);for(t=pc(new t.constructor(t),++r,e);t.c.length<r;)t.c.push(0)}return gc(t,!0,!!n)};it.toFixed=function(r,e){var t=this,n=t.c[0];if(r!==zs){if(r!==~~r||r<0||r>ku)throw Error(Ng);for(t=pc(new t.constructor(t),r+t.e+1,e),r=r+t.e+1;t.c.length<r;)t.c.push(0)}return gc(t,!1,!!n)};it[Symbol.for("nodejs.util.inspect.custom")]=it.toJSON=it.toString=function(){var r=this,e=r.constructor;return gc(r,r.e<=e.NE||r.e>=e.PE,!!r.c[0])};it.toNumber=function(){var r=+gc(this,!0,!0);if(this.constructor.strict===!0&&!this.eq(r.toString()))throw Error(nf+"Imprecise conversion");return r};it.toPrecision=function(r,e){var t=this,n=t.constructor,s=t.c[0];if(r!==zs){if(r!==~~r||r<1||r>ku)throw Error(fc+"precision");for(t=pc(new n(t),r,e);t.c.length<r;)t.c.push(0)}return gc(t,r<=t.e||t.e<=n.NE||t.e>=n.PE,!!s)};it.valueOf=function(){var r=this,e=r.constructor;if(e.strict===!0)throw Error(nf+"valueOf disallowed");return gc(r,r.e<=e.NE||r.e>=e.PE,!0)};var Xu=kC();const OT={bigNumber(r){return r?new Xu(r):new Xu(0)},multiply(r,e){if(r===void 0||e===void 0)return new Xu(0);const t=new Xu(r),n=new Xu(e);return t.times(n)},formatNumberToLocalString(r,e=2){return r===void 0?"0.00":typeof r=="number"?r.toLocaleString("en-US",{maximumFractionDigits:e,minimumFractionDigits:e}):parseFloat(r).toLocaleString("en-US",{maximumFractionDigits:e,minimumFractionDigits:e})},parseLocalStringToNumber(r){return r===void 0?0:parseFloat(r.replace(/,/gu,""))}},RT=[{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"_to",type:"address"},{name:"_value",type:"uint256"}],outputs:[{name:"",type:"bool"}]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_value",type:"uint256"}],outputs:[{name:"",type:"bool"}]}],DT=[{type:"function",name:"approve",stateMutability:"nonpayable",inputs:[{name:"spender",type:"address"},{name:"amount",type:"uint256"}],outputs:[{type:"bool"}]}],kT=[{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"sender",type:"address"},{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[{name:"",type:"bool"}]}];var j0={};const ee={WC_NAME_SUFFIX:".reown.id",WC_NAME_SUFFIX_LEGACY:".wcn.id",BLOCKCHAIN_API_RPC_URL:"https://rpc.walletconnect.org",PULSE_API_URL:"https://pulse.walletconnect.org",W3M_API_URL:"https://api.web3modal.org",CONNECTOR_ID:{WALLET_CONNECT:"walletConnect",INJECTED:"injected",WALLET_STANDARD:"announced",COINBASE:"coinbaseWallet",COINBASE_SDK:"coinbaseWalletSDK",SAFE:"safe",LEDGER:"ledger",OKX:"okx",EIP6963:"eip6963",AUTH:"ID_AUTH"},CONNECTOR_NAMES:{AUTH:"Auth"},AUTH_CONNECTOR_SUPPORTED_CHAINS:["eip155","solana"],LIMITS:{PENDING_TRANSACTIONS:99},CHAIN:{EVM:"eip155",SOLANA:"solana",POLKADOT:"polkadot",BITCOIN:"bip122"},CHAIN_NAME_MAP:{eip155:"EVM Networks",solana:"Solana",polkadot:"Polkadot",bip122:"Bitcoin",cosmos:"Cosmos"},ADAPTER_TYPES:{BITCOIN:"bitcoin",SOLANA:"solana",WAGMI:"wagmi",ETHERS:"ethers",ETHERS5:"ethers5"},USDT_CONTRACT_ADDRESSES:["0xdac17f958d2ee523a2206206994597c13d831ec7","0xc2132d05d31c914a87c6611c10748aeb04b58e8f","0x9702230a8ea53601f5cd2dc00fdbc13d4df4a8c7","0x919C1c267BC06a7039e03fcc2eF738525769109c","0x48065fbBE25f71C9282ddf5e1cD6D6A887483D5e","0x55d398326f99059fF775485246999027B3197955","0xfd086bc7cd5c481dcc9c85ebe478a1c0b69fcbb9"],HTTP_STATUS_CODES:{SERVICE_UNAVAILABLE:503,FORBIDDEN:403},UNSUPPORTED_NETWORK_NAME:"Unknown Network",SECURE_SITE_SDK_ORIGIN:(typeof process<"u"&&typeof j0<"u"?j0.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org"},UT={getERC20Abi:r=>ee.USDT_CONTRACT_ADDRESSES.includes(r)?kT:RT,getSwapAbi:()=>DT},ai={validateCaipAddress(r){var e;if(((e=r.split(":"))==null?void 0:e.length)!==3)throw new Error("Invalid CAIP Address");return r},parseCaipAddress(r){const e=r.split(":");if(e.length!==3)throw new Error(`Invalid CAIP-10 address: ${r}`);const[t,n,s]=e;if(!t||!n||!s)throw new Error(`Invalid CAIP-10 address: ${r}`);return{chainNamespace:t,chainId:n,address:s}},parseCaipNetworkId(r){const e=r.split(":");if(e.length!==2)throw new Error(`Invalid CAIP-2 network id: ${r}`);const[t,n]=e;if(!t||!n)throw new Error(`Invalid CAIP-2 network id: ${r}`);return{chainNamespace:t,chainId:n}}},Re={WALLET_ID:"@appkit/wallet_id",WALLET_NAME:"@appkit/wallet_name",SOLANA_WALLET:"@appkit/solana_wallet",SOLANA_CAIP_CHAIN:"@appkit/solana_caip_chain",ACTIVE_CAIP_NETWORK_ID:"@appkit/active_caip_network_id",CONNECTED_SOCIAL:"@appkit/connected_social",CONNECTED_SOCIAL_USERNAME:"@appkit-wallet/SOCIAL_USERNAME",RECENT_WALLETS:"@appkit/recent_wallets",DEEPLINK_CHOICE:"WALLETCONNECT_DEEPLINK_CHOICE",ACTIVE_NAMESPACE:"@appkit/active_namespace",CONNECTED_NAMESPACES:"@appkit/connected_namespaces",CONNECTION_STATUS:"@appkit/connection_status",SIWX_AUTH_TOKEN:"@appkit/siwx-auth-token",SIWX_NONCE_TOKEN:"@appkit/siwx-nonce-token",TELEGRAM_SOCIAL_PROVIDER:"@appkit/social_provider",NATIVE_BALANCE_CACHE:"@appkit/native_balance_cache",PORTFOLIO_CACHE:"@appkit/portfolio_cache",ENS_CACHE:"@appkit/ens_cache",IDENTITY_CACHE:"@appkit/identity_cache",PREFERRED_ACCOUNT_TYPES:"@appkit/preferred_account_types"};function wm(r){if(!r)throw new Error("Namespace is required for CONNECTED_CONNECTOR_ID");return`@appkit/${r}:connected_connector_id`}const Se={setItem(r,e){bh()&&e!==void 0&&localStorage.setItem(r,e)},getItem(r){if(bh())return localStorage.getItem(r)||void 0},removeItem(r){bh()&&localStorage.removeItem(r)},clear(){bh()&&localStorage.clear()}};function bh(){return typeof window<"u"&&typeof localStorage<"u"}function xi(r,e){return e==="light"?{"--w3m-accent":(r==null?void 0:r["--w3m-accent"])||"hsla(231, 100%, 70%, 1)","--w3m-background":"#fff"}:{"--w3m-accent":(r==null?void 0:r["--w3m-accent"])||"hsla(230, 100%, 67%, 1)","--w3m-background":"#121313"}}var H0={};const bm=(typeof process<"u"&&typeof H0<"u"?H0.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org",hK=[{label:"Coinbase",name:"coinbase",feeRange:"1-2%",url:"",supportedChains:["eip155"]},{label:"Meld.io",name:"meld",feeRange:"1-2%",url:"https://meldcrypto.com",supportedChains:["eip155","solana"]}],dK="WXETMuFUQmqqybHuRkSgxv:25B8LJHSfpG6LVjR2ytU5Cwh7Z4Sch2ocoU",ur={FOUR_MINUTES_MS:24e4,TEN_SEC_MS:1e4,FIVE_SEC_MS:5e3,THREE_SEC_MS:3e3,ONE_SEC_MS:1e3,SECURE_SITE:bm,SECURE_SITE_DASHBOARD:`${bm}/dashboard`,SECURE_SITE_FAVICON:`${bm}/images/favicon.png`,RESTRICTED_TIMEZONES:["ASIA/SHANGHAI","ASIA/URUMQI","ASIA/CHONGQING","ASIA/HARBIN","ASIA/KASHGAR","ASIA/MACAU","ASIA/HONG_KONG","ASIA/MACAO","ASIA/BEIJING","ASIA/HARBIN"],WC_COINBASE_PAY_SDK_CHAINS:["ethereum","arbitrum","polygon","berachain","avalanche-c-chain","optimism","celo","base"],WC_COINBASE_PAY_SDK_FALLBACK_CHAIN:"ethereum",WC_COINBASE_PAY_SDK_CHAIN_NAME_MAP:{Ethereum:"ethereum","Arbitrum One":"arbitrum",Polygon:"polygon",Berachain:"berachain",Avalanche:"avalanche-c-chain","OP Mainnet":"optimism",Celo:"celo",Base:"base"},WC_COINBASE_ONRAMP_APP_ID:"bf18c88d-495a-463b-b249-0b9d3656cf5e",SWAP_SUGGESTED_TOKENS:["ETH","UNI","1INCH","AAVE","SOL","ADA","AVAX","DOT","LINK","NITRO","GAIA","MILK","TRX","NEAR","GNO","WBTC","DAI","WETH","USDC","USDT","ARB","BAL","BICO","CRV","ENS","MATIC","OP"],SWAP_POPULAR_TOKENS:["ETH","UNI","1INCH","AAVE","SOL","ADA","AVAX","DOT","LINK","NITRO","GAIA","MILK","TRX","NEAR","GNO","WBTC","DAI","WETH","USDC","USDT","ARB","BAL","BICO","CRV","ENS","MATIC","OP","METAL","DAI","CHAMP","WOLF","SALE","BAL","BUSD","MUST","BTCpx","ROUTE","HEX","WELT","amDAI","VSQ","VISION","AURUM","pSP","SNX","VC","LINK","CHP","amUSDT","SPHERE","FOX","GIDDY","GFC","OMEN","OX_OLD","DE","WNT"],BALANCE_SUPPORTED_CHAINS:["eip155","solana"],SWAP_SUPPORTED_NETWORKS:["eip155:1","eip155:42161","eip155:10","eip155:324","eip155:8453","eip155:56","eip155:137","eip155:100","eip155:43114","eip155:250","eip155:8217","eip155:1313161554"],NAMES_SUPPORTED_CHAIN_NAMESPACES:["eip155"],ONRAMP_SUPPORTED_CHAIN_NAMESPACES:["eip155","solana"],ACTIVITY_ENABLED_CHAIN_NAMESPACES:["eip155"],NATIVE_TOKEN_ADDRESS:{eip155:"0xeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee",solana:"So11111111111111111111111111111111111111111",polkadot:"0x",bip122:"0x",cosmos:"0x"},CONVERT_SLIPPAGE_TOLERANCE:1,CONNECT_LABELS:{MOBILE:"Open and continue in a new browser tab"},SEND_SUPPORTED_NAMESPACES:["eip155","solana"],DEFAULT_FEATURES:{swaps:!0,onramp:!0,receive:!0,send:!0,email:!0,emailShowWallets:!0,socials:["google","x","discord","farcaster","github","apple","facebook"],connectorTypeOrder:["walletConnect","recent","injected","featured","custom","external","recommended"],history:!0,analytics:!0,allWallets:!0,legalCheckbox:!1,smartSessions:!1,collapseWallets:!1,walletFeaturesOrder:["onramp","swaps","receive","send"],connectMethodsOrder:void 0,pay:!1},DEFAULT_ACCOUNT_TYPES:{bip122:"payment",eip155:"smartAccount",polkadot:"eoa",solana:"eoa"},ADAPTER_TYPES:{UNIVERSAL:"universal",SOLANA:"solana",WAGMI:"wagmi",ETHERS:"ethers",ETHERS5:"ethers5",BITCOIN:"bitcoin"}},se={cacheExpiry:{portfolio:3e4,nativeBalance:3e4,ens:3e5,identity:3e5},isCacheExpired(r,e){return Date.now()-r>e},getActiveNetworkProps(){const r=se.getActiveNamespace(),e=se.getActiveCaipNetworkId(),t=e?e.split(":")[1]:void 0,n=t?isNaN(Number(t))?t:Number(t):void 0;return{namespace:r,caipNetworkId:e,chainId:n}},setWalletConnectDeepLink({name:r,href:e}){try{Se.setItem(Re.DEEPLINK_CHOICE,JSON.stringify({href:e,name:r}))}catch{console.info("Unable to set WalletConnect deep link")}},getWalletConnectDeepLink(){try{const r=Se.getItem(Re.DEEPLINK_CHOICE);if(r)return JSON.parse(r)}catch{console.info("Unable to get WalletConnect deep link")}},deleteWalletConnectDeepLink(){try{Se.removeItem(Re.DEEPLINK_CHOICE)}catch{console.info("Unable to delete WalletConnect deep link")}},setActiveNamespace(r){try{Se.setItem(Re.ACTIVE_NAMESPACE,r)}catch{console.info("Unable to set active namespace")}},setActiveCaipNetworkId(r){try{Se.setItem(Re.ACTIVE_CAIP_NETWORK_ID,r),se.setActiveNamespace(r.split(":")[0])}catch{console.info("Unable to set active caip network id")}},getActiveCaipNetworkId(){try{return Se.getItem(Re.ACTIVE_CAIP_NETWORK_ID)}catch{console.info("Unable to get active caip network id");return}},deleteActiveCaipNetworkId(){try{Se.removeItem(Re.ACTIVE_CAIP_NETWORK_ID)}catch{console.info("Unable to delete active caip network id")}},deleteConnectedConnectorId(r){try{const e=wm(r);Se.removeItem(e)}catch{console.info("Unable to delete connected connector id")}},setAppKitRecent(r){try{const e=se.getRecentWallets();e.find(n=>n.id===r.id)||(e.unshift(r),e.length>2&&e.pop(),Se.setItem(Re.RECENT_WALLETS,JSON.stringify(e)))}catch{console.info("Unable to set AppKit recent")}},getRecentWallets(){try{const r=Se.getItem(Re.RECENT_WALLETS);return r?JSON.parse(r):[]}catch{console.info("Unable to get AppKit recent")}return[]},setConnectedConnectorId(r,e){try{const t=wm(r);Se.setItem(t,e)}catch{console.info("Unable to set Connected Connector Id")}},getActiveNamespace(){try{return Se.getItem(Re.ACTIVE_NAMESPACE)}catch{console.info("Unable to get active namespace")}},getConnectedConnectorId(r){if(r)try{const e=wm(r);return Se.getItem(e)}catch{console.info("Unable to get connected connector id in namespace ",r)}},setConnectedSocialProvider(r){try{Se.setItem(Re.CONNECTED_SOCIAL,r)}catch{console.info("Unable to set connected social provider")}},getConnectedSocialProvider(){try{return Se.getItem(Re.CONNECTED_SOCIAL)}catch{console.info("Unable to get connected social provider")}},deleteConnectedSocialProvider(){try{Se.removeItem(Re.CONNECTED_SOCIAL)}catch{console.info("Unable to delete connected social provider")}},getConnectedSocialUsername(){try{return Se.getItem(Re.CONNECTED_SOCIAL_USERNAME)}catch{console.info("Unable to get connected social username")}},getStoredActiveCaipNetworkId(){var t;const r=Se.getItem(Re.ACTIVE_CAIP_NETWORK_ID);return(t=r==null?void 0:r.split(":"))==null?void 0:t[1]},setConnectionStatus(r){try{Se.setItem(Re.CONNECTION_STATUS,r)}catch{console.info("Unable to set connection status")}},getConnectionStatus(){try{return Se.getItem(Re.CONNECTION_STATUS)}catch{return}},getConnectedNamespaces(){try{const r=Se.getItem(Re.CONNECTED_NAMESPACES);return r!=null&&r.length?r.split(","):[]}catch{return[]}},setConnectedNamespaces(r){try{const e=Array.from(new Set(r));Se.setItem(Re.CONNECTED_NAMESPACES,e.join(","))}catch{console.info("Unable to set namespaces in storage")}},addConnectedNamespace(r){try{const e=se.getConnectedNamespaces();e.includes(r)||(e.push(r),se.setConnectedNamespaces(e))}catch{console.info("Unable to add connected namespace")}},removeConnectedNamespace(r){try{const e=se.getConnectedNamespaces(),t=e.indexOf(r);t>-1&&(e.splice(t,1),se.setConnectedNamespaces(e))}catch{console.info("Unable to remove connected namespace")}},getTelegramSocialProvider(){try{return Se.getItem(Re.TELEGRAM_SOCIAL_PROVIDER)}catch{return console.info("Unable to get telegram social provider"),null}},setTelegramSocialProvider(r){try{Se.setItem(Re.TELEGRAM_SOCIAL_PROVIDER,r)}catch{console.info("Unable to set telegram social provider")}},removeTelegramSocialProvider(){try{Se.removeItem(Re.TELEGRAM_SOCIAL_PROVIDER)}catch{console.info("Unable to remove telegram social provider")}},getBalanceCache(){let r={};try{const e=Se.getItem(Re.PORTFOLIO_CACHE);r=e?JSON.parse(e):{}}catch{console.info("Unable to get balance cache")}return r},removeAddressFromBalanceCache(r){try{const e=se.getBalanceCache();Se.setItem(Re.PORTFOLIO_CACHE,JSON.stringify({...e,[r]:void 0}))}catch{console.info("Unable to remove address from balance cache",r)}},getBalanceCacheForCaipAddress(r){try{const t=se.getBalanceCache()[r];if(t&&!this.isCacheExpired(t.timestamp,this.cacheExpiry.portfolio))return t.balance;se.removeAddressFromBalanceCache(r)}catch{console.info("Unable to get balance cache for address",r)}},updateBalanceCache(r){try{const e=se.getBalanceCache();e[r.caipAddress]=r,Se.setItem(Re.PORTFOLIO_CACHE,JSON.stringify(e))}catch{console.info("Unable to update balance cache",r)}},getNativeBalanceCache(){let r={};try{const e=Se.getItem(Re.NATIVE_BALANCE_CACHE);r=e?JSON.parse(e):{}}catch{console.info("Unable to get balance cache")}return r},removeAddressFromNativeBalanceCache(r){try{const e=se.getBalanceCache();Se.setItem(Re.NATIVE_BALANCE_CACHE,JSON.stringify({...e,[r]:void 0}))}catch{console.info("Unable to remove address from balance cache",r)}},getNativeBalanceCacheForCaipAddress(r){try{const t=se.getNativeBalanceCache()[r];if(t&&!this.isCacheExpired(t.timestamp,this.cacheExpiry.nativeBalance))return t;console.info("Discarding cache for address",r),se.removeAddressFromBalanceCache(r)}catch{console.info("Unable to get balance cache for address",r)}},updateNativeBalanceCache(r){try{const e=se.getNativeBalanceCache();e[r.caipAddress]=r,Se.setItem(Re.NATIVE_BALANCE_CACHE,JSON.stringify(e))}catch{console.info("Unable to update balance cache",r)}},getEnsCache(){let r={};try{const e=Se.getItem(Re.ENS_CACHE);r=e?JSON.parse(e):{}}catch{console.info("Unable to get ens name cache")}return r},getEnsFromCacheForAddress(r){try{const t=se.getEnsCache()[r];if(t&&!this.isCacheExpired(t.timestamp,this.cacheExpiry.ens))return t.ens;se.removeEnsFromCache(r)}catch{console.info("Unable to get ens name from cache",r)}},updateEnsCache(r){try{const e=se.getEnsCache();e[r.address]=r,Se.setItem(Re.ENS_CACHE,JSON.stringify(e))}catch{console.info("Unable to update ens name cache",r)}},removeEnsFromCache(r){try{const e=se.getEnsCache();Se.setItem(Re.ENS_CACHE,JSON.stringify({...e,[r]:void 0}))}catch{console.info("Unable to remove ens name from cache",r)}},getIdentityCache(){let r={};try{const e=Se.getItem(Re.IDENTITY_CACHE);r=e?JSON.parse(e):{}}catch{console.info("Unable to get identity cache")}return r},getIdentityFromCacheForAddress(r){try{const t=se.getIdentityCache()[r];if(t&&!this.isCacheExpired(t.timestamp,this.cacheExpiry.identity))return t.identity;se.removeIdentityFromCache(r)}catch{console.info("Unable to get identity from cache",r)}},updateIdentityCache(r){try{const e=se.getIdentityCache();e[r.address]={identity:r.identity,timestamp:r.timestamp},Se.setItem(Re.IDENTITY_CACHE,JSON.stringify(e))}catch{console.info("Unable to update identity cache",r)}},removeIdentityFromCache(r){try{const e=se.getIdentityCache();Se.setItem(Re.IDENTITY_CACHE,JSON.stringify({...e,[r]:void 0}))}catch{console.info("Unable to remove identity from cache",r)}},clearAddressCache(){try{Se.removeItem(Re.PORTFOLIO_CACHE),Se.removeItem(Re.NATIVE_BALANCE_CACHE),Se.removeItem(Re.ENS_CACHE),Se.removeItem(Re.IDENTITY_CACHE)}catch{console.info("Unable to clear address cache")}},setPreferredAccountTypes(r){try{Se.setItem(Re.PREFERRED_ACCOUNT_TYPES,JSON.stringify(r))}catch{console.info("Unable to set preferred account types",r)}},getPreferredAccountTypes(){try{const r=Se.getItem(Re.PREFERRED_ACCOUNT_TYPES);return JSON.parse(r)}catch{console.info("Unable to get preferred account types")}}},Ee={isMobile(){var r;return this.isClient()?!!((r=window==null?void 0:window.matchMedia("(pointer:coarse)"))!=null&&r.matches||/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini/u.test(navigator.userAgent)):!1},checkCaipNetwork(r,e=""){return r==null?void 0:r.caipNetworkId.toLocaleLowerCase().includes(e.toLowerCase())},isAndroid(){if(!this.isMobile())return!1;const r=window==null?void 0:window.navigator.userAgent.toLowerCase();return Ee.isMobile()&&r.includes("android")},isIos(){if(!this.isMobile())return!1;const r=window==null?void 0:window.navigator.userAgent.toLowerCase();return r.includes("iphone")||r.includes("ipad")},isSafari(){return this.isClient()?(window==null?void 0:window.navigator.userAgent.toLowerCase()).includes("safari"):!1},isClient(){return typeof window<"u"},isPairingExpired(r){return r?r-Date.now()<=ur.TEN_SEC_MS:!0},isAllowedRetry(r,e=ur.ONE_SEC_MS){return Date.now()-r>=e},copyToClopboard(r){navigator.clipboard.writeText(r)},isIframe(){try{return(window==null?void 0:window.self)!==(window==null?void 0:window.top)}catch{return!1}},getPairingExpiry(){return Date.now()+ur.FOUR_MINUTES_MS},getNetworkId(r){return r==null?void 0:r.split(":")[1]},getPlainAddress(r){return r==null?void 0:r.split(":")[2]},async wait(r){return new Promise(e=>{setTimeout(e,r)})},debounce(r,e=500){let t;return(...n)=>{function s(){r(...n)}t&&clearTimeout(t),t=setTimeout(s,e)}},isHttpUrl(r){return r.startsWith("http://")||r.startsWith("https://")},formatNativeUrl(r,e){if(Ee.isHttpUrl(r))return this.formatUniversalUrl(r,e);let t=r;t.includes("://")||(t=r.replaceAll("/","").replaceAll(":",""),t=`${t}://`),t.endsWith("/")||(t=`${t}/`),this.isTelegram()&&this.isAndroid()&&(e=encodeURIComponent(e));const n=encodeURIComponent(e);return{redirect:`${t}wc?uri=${n}`,href:t}},formatUniversalUrl(r,e){if(!Ee.isHttpUrl(r))return this.formatNativeUrl(r,e);let t=r;t.endsWith("/")||(t=`${t}/`);const n=encodeURIComponent(e);return{redirect:`${t}wc?uri=${n}`,href:t}},getOpenTargetForPlatform(r){return r==="popupWindow"?r:this.isTelegram()?se.getTelegramSocialProvider()?"_top":"_blank":r},openHref(r,e,t){window==null||window.open(r,this.getOpenTargetForPlatform(e),t||"noreferrer noopener")},returnOpenHref(r,e,t){return window==null?void 0:window.open(r,this.getOpenTargetForPlatform(e),t||"noreferrer noopener")},isTelegram(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)},isPWA(){var t,n,s;if(typeof window>"u")return!1;const r=(n=(t=window.matchMedia)==null?void 0:t.call(window,"(display-mode: standalone)"))==null?void 0:n.matches,e=(s=window==null?void 0:window.navigator)==null?void 0:s.standalone;return!!(r||e)},async preloadImage(r){const e=new Promise((t,n)=>{const s=new Image;s.onload=t,s.onerror=n,s.crossOrigin="anonymous",s.src=r});return Promise.race([e,Ee.wait(2e3)])},formatBalance(r,e){let t="0.000";if(typeof r=="string"){const n=Number(r);if(n){const s=Math.floor(n*1e3)/1e3;s&&(t=s.toString())}}return`${t}${e?` ${e}`:""}`},formatBalance2(r,e){var n;let t;if(r==="0")t="0";else if(typeof r=="string"){const s=Number(r);s&&(t=(n=s.toString().match(/^-?\d+(?:\.\d{0,3})?/u))==null?void 0:n[0])}return{value:t??"0",rest:t==="0"?"000":"",symbol:e}},getApiUrl(){return ee.W3M_API_URL},getBlockchainApiUrl(){return ee.BLOCKCHAIN_API_RPC_URL},getAnalyticsUrl(){return ee.PULSE_API_URL},getUUID(){return crypto!=null&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,r=>{const e=Math.random()*16|0;return(r==="x"?e:e&3|8).toString(16)})},parseError(r){var e,t;return typeof r=="string"?r:typeof((t=(e=r==null?void 0:r.issues)==null?void 0:e[0])==null?void 0:t.message)=="string"?r.issues[0].message:r instanceof Error?r.message:"Unknown error"},sortRequestedNetworks(r,e=[]){const t={};return e&&r&&(r.forEach((n,s)=>{t[n]=s}),e.sort((n,s)=>{const i=t[n.id],o=t[s.id];return i!==void 0&&o!==void 0?i-o:i!==void 0?-1:o!==void 0?1:0})),e},calculateBalance(r){let e=0;for(const t of r)e+=t.value??0;return e},formatTokenBalance(r){const e=r.toFixed(2),[t,n]=e.split(".");return{dollars:t,pennies:n}},isAddress(r,e="eip155"){switch(e){case"eip155":if(/^(?:0x)?[0-9a-f]{40}$/iu.test(r)){if(/^(?:0x)?[0-9a-f]{40}$/iu.test(r)||/^(?:0x)?[0-9A-F]{40}$/iu.test(r))return!0}else return!1;return!1;case"solana":return/[1-9A-HJ-NP-Za-km-z]{32,44}$/iu.test(r);default:return!1}},uniqueBy(r,e){const t=new Set;return r.filter(n=>{const s=n[e];return t.has(s)?!1:(t.add(s),!0)})},generateSdkVersion(r,e,t){const s=r.length===0?ur.ADAPTER_TYPES.UNIVERSAL:r.map(i=>i.adapterType).join(",");return`${e}-${s}-${t}`},createAccount(r,e,t,n,s){return{namespace:r,address:e,type:t,publicKey:n,path:s}},isCaipAddress(r){if(typeof r!="string")return!1;const e=r.split(":"),t=e[0];return e.filter(Boolean).length===3&&t in ee.CHAIN_NAME_MAP},isMac(){const r=window==null?void 0:window.navigator.userAgent.toLowerCase();return r.includes("macintosh")&&!r.includes("safari")},formatTelegramSocialLoginUrl(r){const e=`--${encodeURIComponent(window==null?void 0:window.location.href)}`,t="state=";if(new URL(r).host==="auth.magic.link"){const s="provider_authorization_url=",i=r.substring(r.indexOf(s)+s.length),o=this.injectIntoUrl(decodeURIComponent(i),t,e);return r.replace(i,encodeURIComponent(o))}return this.injectIntoUrl(r,t,e)},injectIntoUrl(r,e,t){const n=r.indexOf(e);if(n===-1)throw new Error(`${e} parameter not found in the URL: ${r}`);const s=r.indexOf("&",n),i=e.length,o=s!==-1?s:r.length,a=r.substring(0,n+i),c=r.substring(n+i,o),l=r.substring(s),u=c+t;return a+u+l}};async function eh(...r){const e=await fetch(...r);if(!e.ok)throw new Error(`HTTP status code: ${e.status}`,{cause:e});return e}class Ig{constructor({baseUrl:e,clientId:t}){this.baseUrl=e,this.clientId=t}async get({headers:e,signal:t,cache:n,...s}){const i=this.createUrl(s);return(await eh(i,{method:"GET",headers:e,signal:t,cache:n})).json()}async getBlob({headers:e,signal:t,...n}){const s=this.createUrl(n);return(await eh(s,{method:"GET",headers:e,signal:t})).blob()}async post({body:e,headers:t,signal:n,...s}){const i=this.createUrl(s);return(await eh(i,{method:"POST",headers:t,body:e?JSON.stringify(e):void 0,signal:n})).json()}async put({body:e,headers:t,signal:n,...s}){const i=this.createUrl(s);return(await eh(i,{method:"PUT",headers:t,body:e?JSON.stringify(e):void 0,signal:n})).json()}async delete({body:e,headers:t,signal:n,...s}){const i=this.createUrl(s);return(await eh(i,{method:"DELETE",headers:t,body:e?JSON.stringify(e):void 0,signal:n})).json()}createUrl({path:e,params:t}){const n=new URL(e,this.baseUrl);return t&&Object.entries(t).forEach(([s,i])=>{i&&n.searchParams.append(s,i)}),this.clientId&&n.searchParams.append("clientId",this.clientId),n}}const BT={handleSolanaDeeplinkRedirect(r){if(S.state.activeChain===ee.CHAIN.SOLANA){const e=window.location.href,t=encodeURIComponent(e);if(r==="Phantom"&&!("phantom"in window)){const n=e.startsWith("https")?"https":"http",s=e.split("/")[2],i=encodeURIComponent(`${n}://${s}`);window.location.href=`https://phantom.app/ul/browse/${t}?ref=${i}`}r==="Coinbase Wallet"&&!("coinbaseSolana"in window)&&(window.location.href=`https://go.cb-w.com/dapp?cb_url=${t}`)}}},rn=St({walletImages:{},networkImages:{},chainImages:{},connectorImages:{},tokenImages:{},currencyImages:{}}),is={state:rn,subscribeNetworkImages(r){return _r(rn.networkImages,()=>r(rn.networkImages))},subscribeKey(r,e){return Zr(rn,r,e)},subscribe(r){return _r(rn,()=>r(rn))},setWalletImage(r,e){rn.walletImages[r]=e},setNetworkImage(r,e){rn.networkImages[r]=e},setChainImage(r,e){rn.chainImages[r]=e},setConnectorImage(r,e){rn.connectorImages={...rn.connectorImages,[r]:e}},setTokenImage(r,e){rn.tokenImages[r]=e},setCurrencyImage(r,e){rn.currencyImages[r]=e}},LT={eip155:"ba0ba0cd-17c6-4806-ad93-f9d174f17900",solana:"a1b58899-f671-4276-6a5e-56ca5bd59700",polkadot:"",bip122:"0b4838db-0161-4ffe-022d-532bf03dba00",cosmos:""},Em=St({networkImagePromises:{}}),UC={async fetchWalletImage(r){if(r)return await be._fetchWalletImage(r),this.getWalletImageById(r)},async fetchNetworkImage(r){if(!r)return;const e=this.getNetworkImageById(r);return e||(Em.networkImagePromises[r]||(Em.networkImagePromises[r]=be._fetchNetworkImage(r)),await Em.networkImagePromises[r],this.getNetworkImageById(r))},getWalletImageById(r){if(r)return is.state.walletImages[r]},getWalletImage(r){if(r!=null&&r.image_url)return r==null?void 0:r.image_url;if(r!=null&&r.image_id)return is.state.walletImages[r.image_id]},getNetworkImage(r){var e,t,n;if((e=r==null?void 0:r.assets)!=null&&e.imageUrl)return(t=r==null?void 0:r.assets)==null?void 0:t.imageUrl;if((n=r==null?void 0:r.assets)!=null&&n.imageId)return is.state.networkImages[r.assets.imageId]},getNetworkImageById(r){if(r)return is.state.networkImages[r]},getConnectorImage(r){if(r!=null&&r.imageUrl)return r.imageUrl;if(r!=null&&r.imageId)return is.state.connectorImages[r.imageId]},getChainImage(r){return is.state.networkImages[LT[r]]}},$T={getFeatureValue(r,e){const t=e==null?void 0:e[r];return t===void 0?ur.DEFAULT_FEATURES[r]:t},filterSocialsByPlatform(r){if(!r||!r.length)return r;if(Ee.isTelegram()){if(Ee.isIos())return r.filter(e=>e!=="google");if(Ee.isMac())return r.filter(e=>e!=="x");if(Ee.isAndroid())return r.filter(e=>!["facebook","x"].includes(e))}return r}},we=St({features:ur.DEFAULT_FEATURES,projectId:"",sdkType:"appkit",sdkVersion:"html-wagmi-undefined",defaultAccountTypes:{solana:"eoa",bip122:"payment",polkadot:"eoa",eip155:"smartAccount"},enableNetworkSwitch:!0}),K={state:we,subscribeKey(r,e){return Zr(we,r,e)},setOptions(r){Object.assign(we,r)},setFeatures(r){if(!r)return;we.features||(we.features=ur.DEFAULT_FEATURES);const e={...we.features,...r};we.features=e,we.features.socials&&(we.features.socials=$T.filterSocialsByPlatform(we.features.socials))},setProjectId(r){we.projectId=r},setCustomRpcUrls(r){we.customRpcUrls=r},setAllWallets(r){we.allWallets=r},setIncludeWalletIds(r){we.includeWalletIds=r},setExcludeWalletIds(r){we.excludeWalletIds=r},setFeaturedWalletIds(r){we.featuredWalletIds=r},setTokens(r){we.tokens=r},setTermsConditionsUrl(r){we.termsConditionsUrl=r},setPrivacyPolicyUrl(r){we.privacyPolicyUrl=r},setCustomWallets(r){we.customWallets=r},setIsSiweEnabled(r){we.isSiweEnabled=r},setIsUniversalProvider(r){we.isUniversalProvider=r},setSdkVersion(r){we.sdkVersion=r},setMetadata(r){we.metadata=r},setDisableAppend(r){we.disableAppend=r},setEIP6963Enabled(r){we.enableEIP6963=r},setDebug(r){we.debug=r},setEnableWalletConnect(r){we.enableWalletConnect=r},setEnableWalletGuide(r){we.enableWalletGuide=r},setEnableAuthLogger(r){we.enableAuthLogger=r},setEnableWallets(r){we.enableWallets=r},setHasMultipleAddresses(r){we.hasMultipleAddresses=r},setSIWX(r){we.siwx=r},setConnectMethodsOrder(r){we.features={...we.features,connectMethodsOrder:r}},setWalletFeaturesOrder(r){we.features={...we.features,walletFeaturesOrder:r}},setSocialsOrder(r){we.features={...we.features,socials:r}},setCollapseWallets(r){we.features={...we.features,collapseWallets:r}},setEnableEmbedded(r){we.enableEmbedded=r},setAllowUnsupportedChain(r){we.allowUnsupportedChain=r},setManualWCControl(r){we.manualWCControl=r},setEnableNetworkSwitch(r){we.enableNetworkSwitch=r},setDefaultAccountTypes(r={}){Object.entries(r).forEach(([e,t])=>{t&&(we.defaultAccountTypes[e]=t)})},setUniversalProviderConfigOverride(r){we.universalProviderConfigOverride=r},getUniversalProviderConfigOverride(){return we.universalProviderConfigOverride},getSnapshot(){return Za(we)}},Vi=St({message:"",variant:"info",open:!1}),Ni={state:Vi,subscribeKey(r,e){return Zr(Vi,r,e)},open(r,e){const{debug:t}=K.state,{shortMessage:n,longMessage:s}=r;t&&(Vi.message=n,Vi.variant=e,Vi.open=!0),s&&console.error(typeof s=="function"?s():s)},close(){Vi.open=!1,Vi.message="",Vi.variant="info"}},MT=Ee.getAnalyticsUrl(),FT=new Ig({baseUrl:MT,clientId:null}),jT=["MODAL_CREATED"],Xs=St({timestamp:Date.now(),reportedErrors:{},data:{type:"track",event:"MODAL_CREATED"}}),At={state:Xs,subscribe(r){return _r(Xs,()=>r(Xs))},getSdkProperties(){const{projectId:r,sdkType:e,sdkVersion:t}=K.state;return{projectId:r,st:e,sv:t||"html-wagmi-4.2.2"}},async _sendAnalyticsEvent(r){try{const e=he.state.address;if(jT.includes(r.data.event)||typeof window>"u")return;await FT.post({path:"/e",params:At.getSdkProperties(),body:{eventId:Ee.getUUID(),url:window.location.href,domain:window.location.hostname,timestamp:r.timestamp,props:{...r.data,address:e}}}),Xs.reportedErrors.FORBIDDEN=!1}catch(e){e instanceof Error&&e.cause instanceof Response&&e.cause.status===ee.HTTP_STATUS_CODES.FORBIDDEN&&!Xs.reportedErrors.FORBIDDEN&&(Ni.open({shortMessage:"Invalid App Configuration",longMessage:`Origin ${bh()?window.origin:"uknown"} not found on Allowlist - update configuration on cloud.reown.com`},"error"),Xs.reportedErrors.FORBIDDEN=!0)}},sendEvent(r){var e;Xs.timestamp=Date.now(),Xs.data=r,(e=K.state.features)!=null&&e.analytics&&At._sendAnalyticsEvent(Xs)}},HT=["1ca0bdd4747578705b1939af023d120677c64fe6ca76add81fda36e350605e79","fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa","a797aa35c0fadbfc1a53e7f675162ed5226968b44a19ee3d24385c64d1d3c393"],zT=Ee.getApiUrl(),nn=new Ig({baseUrl:zT,clientId:null}),qT=40,z0=4,VT=20,xe=St({promises:{},page:1,count:0,featured:[],allFeatured:[],recommended:[],allRecommended:[],wallets:[],filteredWallets:[],search:[],isAnalyticsEnabled:!1,excludedWallets:[],isFetchingRecommendedWallets:!1}),be={state:xe,subscribeKey(r,e){return Zr(xe,r,e)},_getSdkProperties(){const{projectId:r,sdkType:e,sdkVersion:t}=K.state;return{projectId:r,st:e||"appkit",sv:t||"html-wagmi-4.2.2"}},_filterOutExtensions(r){return K.state.isUniversalProvider?r.filter(e=>!!(e.mobile_link||e.desktop_link||e.webapp_link)):r},async _fetchWalletImage(r){const e=`${nn.baseUrl}/getWalletImage/${r}`,t=await nn.getBlob({path:e,params:be._getSdkProperties()});is.setWalletImage(r,URL.createObjectURL(t))},async _fetchNetworkImage(r){const e=`${nn.baseUrl}/public/getAssetImage/${r}`,t=await nn.getBlob({path:e,params:be._getSdkProperties()});is.setNetworkImage(r,URL.createObjectURL(t))},async _fetchConnectorImage(r){const e=`${nn.baseUrl}/public/getAssetImage/${r}`,t=await nn.getBlob({path:e,params:be._getSdkProperties()});is.setConnectorImage(r,URL.createObjectURL(t))},async _fetchCurrencyImage(r){const e=`${nn.baseUrl}/public/getCurrencyImage/${r}`,t=await nn.getBlob({path:e,params:be._getSdkProperties()});is.setCurrencyImage(r,URL.createObjectURL(t))},async _fetchTokenImage(r){const e=`${nn.baseUrl}/public/getTokenImage/${r}`,t=await nn.getBlob({path:e,params:be._getSdkProperties()});is.setTokenImage(r,URL.createObjectURL(t))},async fetchAllowedOrigins(){try{const{allowedOrigins:r}=await nn.get({path:"/projects/v1/origins",params:be._getSdkProperties()});return r}catch{return[]}},async fetchNetworkImages(){const r=S.getAllRequestedCaipNetworks(),e=r==null?void 0:r.map(({assets:t})=>t==null?void 0:t.imageId).filter(Boolean).filter(t=>!UC.getNetworkImageById(t));e&&await Promise.allSettled(e.map(t=>be._fetchNetworkImage(t)))},async fetchConnectorImages(){const{connectors:r}=_e.state,e=r.map(({imageId:t})=>t).filter(Boolean);await Promise.allSettled(e.map(t=>be._fetchConnectorImage(t)))},async fetchCurrencyImages(r=[]){await Promise.allSettled(r.map(e=>be._fetchCurrencyImage(e)))},async fetchTokenImages(r=[]){await Promise.allSettled(r.map(e=>be._fetchTokenImage(e)))},async fetchWallets(r){var n,s;const e=r.exclude??[];return be._getSdkProperties().sv.startsWith("html-core-")&&e.push(...HT),await nn.get({path:"/getWallets",params:{...be._getSdkProperties(),...r,page:String(r.page),entries:String(r.entries),include:(n=r.include)==null?void 0:n.join(","),exclude:(s=r.exclude)==null?void 0:s.join(",")}})},async fetchFeaturedWallets(){const{featuredWalletIds:r}=K.state;if(r!=null&&r.length){const e={...be._getSdkProperties(),page:1,entries:(r==null?void 0:r.length)??z0,include:r},{data:t}=await be.fetchWallets(e);t.sort((s,i)=>r.indexOf(s.id)-r.indexOf(i.id));const n=t.map(s=>s.image_id).filter(Boolean);await Promise.allSettled(n.map(s=>be._fetchWalletImage(s))),xe.featured=t,xe.allFeatured=t}},async fetchRecommendedWallets(){try{xe.isFetchingRecommendedWallets=!0;const{includeWalletIds:r,excludeWalletIds:e,featuredWalletIds:t}=K.state,n=[...e??[],...t??[]].filter(Boolean),s=S.getRequestedCaipNetworkIds().join(","),i={page:1,entries:z0,include:r,exclude:n,chains:s},{data:o,count:a}=await be.fetchWallets(i),c=se.getRecentWallets(),l=o.map(h=>h.image_id).filter(Boolean),u=c.map(h=>h.image_id).filter(Boolean);await Promise.allSettled([...l,...u].map(h=>be._fetchWalletImage(h))),xe.recommended=o,xe.allRecommended=o,xe.count=a??0}catch{}finally{xe.isFetchingRecommendedWallets=!1}},async fetchWalletsByPage({page:r}){const{includeWalletIds:e,excludeWalletIds:t,featuredWalletIds:n}=K.state,s=S.getRequestedCaipNetworkIds().join(","),i=[...xe.recommended.map(({id:u})=>u),...t??[],...n??[]].filter(Boolean),o={page:r,entries:qT,include:e,exclude:i,chains:s},{data:a,count:c}=await be.fetchWallets(o),l=a.slice(0,VT).map(u=>u.image_id).filter(Boolean);await Promise.allSettled(l.map(u=>be._fetchWalletImage(u))),xe.wallets=Ee.uniqueBy([...xe.wallets,...be._filterOutExtensions(a)],"id"),xe.count=c>xe.count?c:xe.count,xe.page=r},async initializeExcludedWallets({ids:r}){const e=S.getRequestedCaipNetworkIds().join(","),t={page:1,entries:r.length,include:r,chains:e},{data:n}=await be.fetchWallets(t);n&&n.forEach(s=>{xe.excludedWallets.push({rdns:s.rdns,name:s.name})})},async searchWallet({search:r,badge:e}){const{includeWalletIds:t,excludeWalletIds:n}=K.state,s=S.getRequestedCaipNetworkIds().join(",");xe.search=[];const i={page:1,entries:100,search:r==null?void 0:r.trim(),badge_type:e,include:t,exclude:n,chains:s},{data:o}=await be.fetchWallets(i);At.sendEvent({type:"track",event:"SEARCH_WALLET",properties:{badge:e??"",search:r??""}});const a=o.map(c=>c.image_id).filter(Boolean);await Promise.allSettled([...a.map(c=>be._fetchWalletImage(c)),Ee.wait(300)]),xe.search=be._filterOutExtensions(o)},initPromise(r,e){const t=xe.promises[r];return t||(xe.promises[r]=e())},prefetch({fetchConnectorImages:r=!0,fetchFeaturedWallets:e=!0,fetchRecommendedWallets:t=!0,fetchNetworkImages:n=!0}={}){const s=[r&&be.initPromise("connectorImages",be.fetchConnectorImages),e&&be.initPromise("featuredWallets",be.fetchFeaturedWallets),t&&be.initPromise("recommendedWallets",be.fetchRecommendedWallets),n&&be.initPromise("networkImages",be.fetchNetworkImages)].filter(Boolean);return Promise.allSettled(s)},prefetchAnalyticsConfig(){var r;(r=K.state.features)!=null&&r.analytics&&be.fetchAnalyticsConfig()},async fetchAnalyticsConfig(){try{const{isAnalyticsEnabled:r}=await nn.get({path:"/getAnalyticsConfig",params:be._getSdkProperties()});K.setFeatures({analytics:r})}catch{K.setFeatures({analytics:!1})}},filterByNamespaces(r){if(!(r!=null&&r.length)){xe.featured=xe.allFeatured,xe.recommended=xe.allRecommended;return}const e=S.getRequestedCaipNetworkIds().join(",");xe.featured=xe.allFeatured.filter(t=>{var n;return(n=t.chains)==null?void 0:n.some(s=>e.includes(s))}),xe.recommended=xe.allRecommended.filter(t=>{var n;return(n=t.chains)==null?void 0:n.some(s=>e.includes(s))}),xe.filteredWallets=xe.wallets.filter(t=>{var n;return(n=t.chains)==null?void 0:n.some(s=>e.includes(s))})},clearFilterByNamespaces(){xe.filteredWallets=[]},setFilterByNamespace(r){if(!r){xe.featured=xe.allFeatured,xe.recommended=xe.allRecommended;return}const e=S.getRequestedCaipNetworkIds().join(",");xe.featured=xe.allFeatured.filter(t=>{var n;return(n=t.chains)==null?void 0:n.some(s=>e.includes(s))}),xe.recommended=xe.allRecommended.filter(t=>{var n;return(n=t.chains)==null?void 0:n.some(s=>e.includes(s))}),xe.filteredWallets=xe.wallets.filter(t=>{var n;return(n=t.chains)==null?void 0:n.some(s=>e.includes(s))})}},Xe=St({view:"Connect",history:["Connect"],transactionStack:[]}),tt={state:Xe,subscribeKey(r,e){return Zr(Xe,r,e)},pushTransactionStack(r){Xe.transactionStack.push(r)},popTransactionStack(r){var t,n;const e=Xe.transactionStack.pop();if(e)if(r)this.goBack(),(t=e==null?void 0:e.onCancel)==null||t.call(e);else{if(e.goBack)this.goBack();else if(e.replace){const i=Xe.history.indexOf("ConnectingSiwe");i>0?this.goBackToIndex(i-1):(Ut.close(!0),Xe.history=[])}else e.view&&this.reset(e.view);(n=e==null?void 0:e.onSuccess)==null||n.call(e)}},push(r,e){r!==Xe.view&&(Xe.view=r,Xe.history.push(r),Xe.data=e)},reset(r,e){Xe.view=r,Xe.history=[r],Xe.data=e},replace(r,e){Xe.history.at(-1)===r||(Xe.view=r,Xe.history[Xe.history.length-1]=r,Xe.data=e)},goBack(){var e;const r=!S.state.activeCaipAddress&&this.state.view==="ConnectingFarcaster";if(Xe.history.length>1&&!Xe.history.includes("UnsupportedChain")){Xe.history.pop();const[t]=Xe.history.slice(-1);t&&(Xe.view=t)}else Ut.close();(e=Xe.data)!=null&&e.wallet&&(Xe.data.wallet=void 0),setTimeout(()=>{var t,n,s;if(r){he.setFarcasterUrl(void 0,S.state.activeChain);const i=_e.getAuthConnector();(t=i==null?void 0:i.provider)==null||t.reload();const o=Za(K.state);(s=(n=i==null?void 0:i.provider)==null?void 0:n.syncDappData)==null||s.call(n,{metadata:o.metadata,sdkVersion:o.sdkVersion,projectId:o.projectId,sdkType:o.sdkType})}},100)},goBackToIndex(r){if(Xe.history.length>1){Xe.history=Xe.history.slice(0,r+1);const[e]=Xe.history.slice(-1);e&&(Xe.view=e)}}},ei=St({themeMode:"dark",themeVariables:{},w3mThemeVariables:void 0}),Ar={state:ei,subscribe(r){return _r(ei,()=>r(ei))},setThemeMode(r){ei.themeMode=r;try{const e=_e.getAuthConnector();if(e){const t=Ar.getSnapshot().themeVariables;e.provider.syncTheme({themeMode:r,themeVariables:t,w3mThemeVariables:xi(t,r)})}}catch{console.info("Unable to sync theme to auth connector")}},setThemeVariables(r){ei.themeVariables={...ei.themeVariables,...r};try{const e=_e.getAuthConnector();if(e){const t=Ar.getSnapshot().themeVariables;e.provider.syncTheme({themeVariables:t,w3mThemeVariables:xi(ei.themeVariables,ei.themeMode)})}}catch{console.info("Unable to sync theme to auth connector")}},getSnapshot(){return Za(ei)}},BC={eip155:void 0,solana:void 0,polkadot:void 0,bip122:void 0,cosmos:void 0},Ve=St({allConnectors:[],connectors:[],activeConnector:void 0,filterByNamespace:void 0,activeConnectorIds:{...BC},filterByNamespaceMap:{eip155:!0,solana:!0,polkadot:!0,bip122:!0,cosmos:!0}}),_e={state:Ve,subscribe(r){return _r(Ve,()=>{r(Ve)})},subscribeKey(r,e){return Zr(Ve,r,e)},initialize(r){r.forEach(e=>{const t=se.getConnectedConnectorId(e);t&&this.setConnectorId(t,e)})},setActiveConnector(r){r&&(Ve.activeConnector=Xa(r))},setConnectors(r){r.filter(s=>!Ve.allConnectors.some(i=>i.id===s.id&&this.getConnectorName(i.name)===this.getConnectorName(s.name)&&i.chain===s.chain)).forEach(s=>{s.type!=="MULTI_CHAIN"&&Ve.allConnectors.push(Xa(s))});const t=this.getEnabledNamespaces(),n=this.getEnabledConnectors(t);Ve.connectors=this.mergeMultiChainConnectors(n)},filterByNamespaces(r){Object.keys(Ve.filterByNamespaceMap).forEach(e=>{Ve.filterByNamespaceMap[e]=!1}),r.forEach(e=>{Ve.filterByNamespaceMap[e]=!0}),this.updateConnectorsForEnabledNamespaces()},filterByNamespace(r,e){Ve.filterByNamespaceMap[r]=e,this.updateConnectorsForEnabledNamespaces()},updateConnectorsForEnabledNamespaces(){const r=this.getEnabledNamespaces(),e=this.getEnabledConnectors(r),t=this.areAllNamespacesEnabled();Ve.connectors=this.mergeMultiChainConnectors(e),t?be.clearFilterByNamespaces():be.filterByNamespaces(r)},getEnabledNamespaces(){return Object.entries(Ve.filterByNamespaceMap).filter(([r,e])=>e).map(([r])=>r)},getEnabledConnectors(r){return Ve.allConnectors.filter(e=>r.includes(e.chain))},areAllNamespacesEnabled(){return Object.values(Ve.filterByNamespaceMap).every(r=>r)},mergeMultiChainConnectors(r){const e=this.generateConnectorMapByName(r),t=[];return e.forEach(n=>{const s=n[0],i=(s==null?void 0:s.id)===ee.CONNECTOR_ID.AUTH;n.length>1&&s?t.push({name:s.name,imageUrl:s.imageUrl,imageId:s.imageId,connectors:[...n],type:i?"AUTH":"MULTI_CHAIN",chain:"eip155",id:(s==null?void 0:s.id)||""}):s&&t.push(s)}),t},generateConnectorMapByName(r){const e=new Map;return r.forEach(t=>{const{name:n}=t,s=this.getConnectorName(n);if(!s)return;const i=e.get(s)||[];i.find(a=>a.chain===t.chain)||i.push(t),e.set(s,i)}),e},getConnectorName(r){return r&&({"Trust Wallet":"Trust"}[r]||r)},getUniqueConnectorsByName(r){const e=[];return r.forEach(t=>{e.find(n=>n.chain===t.chain)||e.push(t)}),e},addConnector(r){var e,t,n;if(r.id===ee.CONNECTOR_ID.AUTH){const s=r,i=Za(K.state),o=Ar.getSnapshot().themeMode,a=Ar.getSnapshot().themeVariables;(t=(e=s==null?void 0:s.provider)==null?void 0:e.syncDappData)==null||t.call(e,{metadata:i.metadata,sdkVersion:i.sdkVersion,projectId:i.projectId,sdkType:i.sdkType}),(n=s==null?void 0:s.provider)==null||n.syncTheme({themeMode:o,themeVariables:a,w3mThemeVariables:xi(a,o)}),this.setConnectors([r])}else this.setConnectors([r])},getAuthConnector(r){var n;const e=r||S.state.activeChain,t=Ve.connectors.find(s=>s.id===ee.CONNECTOR_ID.AUTH);if(t)return(n=t==null?void 0:t.connectors)!=null&&n.length?t.connectors.find(i=>i.chain===e):t},getAnnouncedConnectorRdns(){return Ve.connectors.filter(r=>r.type==="ANNOUNCED").map(r=>{var e;return(e=r.info)==null?void 0:e.rdns})},getConnectorById(r){return Ve.allConnectors.find(e=>e.id===r)},getConnector(r,e){return Ve.allConnectors.filter(n=>n.chain===S.state.activeChain).find(n=>{var s;return n.explorerId===r||((s=n.info)==null?void 0:s.rdns)===e})},syncIfAuthConnector(r){var i,o;if(r.id!=="ID_AUTH")return;const e=r,t=Za(K.state),n=Ar.getSnapshot().themeMode,s=Ar.getSnapshot().themeVariables;(o=(i=e==null?void 0:e.provider)==null?void 0:i.syncDappData)==null||o.call(i,{metadata:t.metadata,sdkVersion:t.sdkVersion,sdkType:t.sdkType,projectId:t.projectId}),e.provider.syncTheme({themeMode:n,themeVariables:s,w3mThemeVariables:xi(s,n)})},getConnectorsByNamespace(r){const e=Ve.allConnectors.filter(t=>t.chain===r);return this.mergeMultiChainConnectors(e)},selectWalletConnector(r){const e=_e.getConnector(r.id,r.rdns);S.state.activeChain===ee.CHAIN.SOLANA&&BT.handleSolanaDeeplinkRedirect((e==null?void 0:e.name)||r.name||""),e?tt.push("ConnectingExternal",{connector:e}):tt.push("ConnectingWalletConnect",{wallet:r})},getConnectors(r){return r?this.getConnectorsByNamespace(r):this.mergeMultiChainConnectors(Ve.allConnectors)},setFilterByNamespace(r){Ve.filterByNamespace=r,Ve.connectors=this.getConnectors(r),be.setFilterByNamespace(r)},setConnectorId(r,e){r&&(Ve.activeConnectorIds={...Ve.activeConnectorIds,[e]:r},se.setConnectedConnectorId(e,r))},removeConnectorId(r){Ve.activeConnectorIds={...Ve.activeConnectorIds,[r]:void 0},se.deleteConnectedConnectorId(r)},getConnectorId(r){if(r)return Ve.activeConnectorIds[r]},isConnected(r){return r?!!Ve.activeConnectorIds[r]:Object.values(Ve.activeConnectorIds).some(e=>!!e)},resetConnectorIds(){Ve.activeConnectorIds={...BC}}};function Df(r,e){return _e.getConnectorId(r)===e}function WT(r){const e=Array.from(S.state.chains.keys());let t=[];return r?(t.push([r,S.state.chains.get(r)]),Df(r,ee.CONNECTOR_ID.WALLET_CONNECT)?e.forEach(n=>{n!==r&&Df(n,ee.CONNECTOR_ID.WALLET_CONNECT)&&t.push([n,S.state.chains.get(n)])}):Df(r,ee.CONNECTOR_ID.AUTH)&&e.forEach(n=>{n!==r&&Df(n,ee.CONNECTOR_ID.AUTH)&&t.push([n,S.state.chains.get(n)])})):t=Array.from(S.state.chains.entries()),t}var Eb={exports:{}},dl=typeof Reflect=="object"?Reflect:null,q0=dl&&typeof dl.apply=="function"?dl.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)},hp;dl&&typeof dl.ownKeys=="function"?hp=dl.ownKeys:Object.getOwnPropertySymbols?hp=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:hp=function(e){return Object.getOwnPropertyNames(e)};function GT(r){console&&console.warn&&console.warn(r)}var LC=Number.isNaN||function(e){return e!==e};function lt(){lt.init.call(this)}Eb.exports=lt;Eb.exports.once=QT;lt.EventEmitter=lt;lt.prototype._events=void 0;lt.prototype._eventsCount=0;lt.prototype._maxListeners=void 0;var V0=10;function Sg(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}Object.defineProperty(lt,"defaultMaxListeners",{enumerable:!0,get:function(){return V0},set:function(r){if(typeof r!="number"||r<0||LC(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");V0=r}});lt.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};lt.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||LC(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function $C(r){return r._maxListeners===void 0?lt.defaultMaxListeners:r._maxListeners}lt.prototype.getMaxListeners=function(){return $C(this)};lt.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var s=e==="error",i=this._events;if(i!==void 0)s=s&&i.error===void 0;else if(!s)return!1;if(s){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var c=i[e];if(c===void 0)return!1;if(typeof c=="function")q0(c,this,t);else for(var l=c.length,u=zC(c,l),n=0;n<l;++n)q0(u[n],this,t);return!0};function MC(r,e,t,n){var s,i,o;if(Sg(t),i=r._events,i===void 0?(i=r._events=Object.create(null),r._eventsCount=0):(i.newListener!==void 0&&(r.emit("newListener",e,t.listener?t.listener:t),i=r._events),o=i[e]),o===void 0)o=i[e]=t,++r._eventsCount;else if(typeof o=="function"?o=i[e]=n?[t,o]:[o,t]:n?o.unshift(t):o.push(t),s=$C(r),s>0&&o.length>s&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=r,a.type=e,a.count=o.length,GT(a)}return r}lt.prototype.addListener=function(e,t){return MC(this,e,t,!1)};lt.prototype.on=lt.prototype.addListener;lt.prototype.prependListener=function(e,t){return MC(this,e,t,!0)};function KT(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function FC(r,e,t){var n={fired:!1,wrapFn:void 0,target:r,type:e,listener:t},s=KT.bind(n);return s.listener=t,n.wrapFn=s,s}lt.prototype.once=function(e,t){return Sg(t),this.on(e,FC(this,e,t)),this};lt.prototype.prependOnceListener=function(e,t){return Sg(t),this.prependListener(e,FC(this,e,t)),this};lt.prototype.removeListener=function(e,t){var n,s,i,o,a;if(Sg(t),s=this._events,s===void 0)return this;if(n=s[e],n===void 0)return this;if(n===t||n.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete s[e],s.removeListener&&this.emit("removeListener",e,n.listener||t));else if(typeof n!="function"){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){a=n[o].listener,i=o;break}if(i<0)return this;i===0?n.shift():JT(n,i),n.length===1&&(s[e]=n[0]),s.removeListener!==void 0&&this.emit("removeListener",e,a||t)}return this};lt.prototype.off=lt.prototype.removeListener;lt.prototype.removeAllListeners=function(e){var t,n,s;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var i=Object.keys(n),o;for(s=0;s<i.length;++s)o=i[s],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=n[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(s=t.length-1;s>=0;s--)this.removeListener(e,t[s]);return this};function jC(r,e,t){var n=r._events;if(n===void 0)return[];var s=n[e];return s===void 0?[]:typeof s=="function"?t?[s.listener||s]:[s]:t?YT(s):zC(s,s.length)}lt.prototype.listeners=function(e){return jC(this,e,!0)};lt.prototype.rawListeners=function(e){return jC(this,e,!1)};lt.listenerCount=function(r,e){return typeof r.listenerCount=="function"?r.listenerCount(e):HC.call(r,e)};lt.prototype.listenerCount=HC;function HC(r){var e=this._events;if(e!==void 0){var t=e[r];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}lt.prototype.eventNames=function(){return this._eventsCount>0?hp(this._events):[]};function zC(r,e){for(var t=new Array(e),n=0;n<e;++n)t[n]=r[n];return t}function JT(r,e){for(;e+1<r.length;e++)r[e]=r[e+1];r.pop()}function YT(r){for(var e=new Array(r.length),t=0;t<e.length;++t)e[t]=r[t].listener||r[t];return e}function QT(r,e){return new Promise(function(t,n){function s(o){r.removeListener(e,i),n(o)}function i(){typeof r.removeListener=="function"&&r.removeListener("error",s),t([].slice.call(arguments))}qC(r,e,i,{once:!0}),e!=="error"&&ZT(r,s,{once:!0})})}function ZT(r,e,t){typeof r.on=="function"&&qC(r,"error",e,t)}function qC(r,e,t,n){if(typeof r.on=="function")n.once?r.once(e,t):r.on(e,t);else if(typeof r.addEventListener=="function")r.addEventListener(e,function s(i){n.once&&r.removeEventListener(e,s),t(i)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r)}var Mn=Eb.exports;const vb=_g(Mn);var X={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Ly=function(r,e){return Ly=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var s in n)n.hasOwnProperty(s)&&(t[s]=n[s])},Ly(r,e)};function XT(r,e){Ly(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var $y=function(){return $y=Object.assign||function(e){for(var t,n=1,s=arguments.length;n<s;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},$y.apply(this,arguments)};function eP(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(r);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(r,n[s])&&(t[n[s]]=r[n[s]]);return t}function tP(r,e,t,n){var s=arguments.length,i=s<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(i=(s<3?o(i):s>3?o(e,t,i):o(e,t))||i);return s>3&&i&&Object.defineProperty(e,t,i),i}function rP(r,e){return function(t,n){e(t,n,r)}}function nP(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)}function sP(r,e,t,n){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(h){o(h)}}function c(u){try{l(n.throw(u))}catch(h){o(h)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})}function iP(r,e){var t={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(u){return c([l,u])}}function c(l){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,s&&(i=l[0]&2?s.return:l[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,l[1])).done)return i;switch(s=0,i&&(l=[l[0]&2,i.value]),l[0]){case 0:case 1:i=l;break;case 4:return t.label++,{value:l[1],done:!1};case 5:t.label++,s=l[1],l=[0];continue;case 7:l=t.ops.pop(),t.trys.pop();continue;default:if(i=t.trys,!(i=i.length>0&&i[i.length-1])&&(l[0]===6||l[0]===2)){t=0;continue}if(l[0]===3&&(!i||l[1]>i[0]&&l[1]<i[3])){t.label=l[1];break}if(l[0]===6&&t.label<i[1]){t.label=i[1],i=l;break}if(i&&t.label<i[2]){t.label=i[2],t.ops.push(l);break}i[2]&&t.ops.pop(),t.trys.pop();continue}l=e.call(r,t)}catch(u){l=[6,u],s=0}finally{n=i=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function oP(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}function aP(r,e){for(var t in r)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=r[t])}function My(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function VC(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var n=t.call(r),s,i=[],o;try{for(;(e===void 0||e-- >0)&&!(s=n.next()).done;)i.push(s.value)}catch(a){o={error:a}}finally{try{s&&!s.done&&(t=n.return)&&t.call(n)}finally{if(o)throw o.error}}return i}function cP(){for(var r=[],e=0;e<arguments.length;e++)r=r.concat(VC(arguments[e]));return r}function lP(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;for(var n=Array(r),s=0,e=0;e<t;e++)for(var i=arguments[e],o=0,a=i.length;o<a;o++,s++)n[s]=i[o];return n}function Hh(r){return this instanceof Hh?(this.v=r,this):new Hh(r)}function uP(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(r,e||[]),s,i=[];return s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s;function o(d){n[d]&&(s[d]=function(f){return new Promise(function(g,p){i.push([d,f,g,p])>1||a(d,f)})})}function a(d,f){try{c(n[d](f))}catch(g){h(i[0][3],g)}}function c(d){d.value instanceof Hh?Promise.resolve(d.value.v).then(l,u):h(i[0][2],d)}function l(d){a("next",d)}function u(d){a("throw",d)}function h(d,f){d(f),i.shift(),i.length&&a(i[0][0],i[0][1])}}function hP(r){var e,t;return e={},n("next"),n("throw",function(s){throw s}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(s,i){e[s]=r[s]?function(o){return(t=!t)?{value:Hh(r[s](o)),done:s==="return"}:i?i(o):o}:i}}function dP(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],t;return e?e.call(r):(r=typeof My=="function"?My(r):r[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(i){t[i]=r[i]&&function(o){return new Promise(function(a,c){o=r[i](o),s(a,c,o.done,o.value)})}}function s(i,o,a,c){Promise.resolve(c).then(function(l){i({value:l,done:a})},o)}}function fP(r,e){return Object.defineProperty?Object.defineProperty(r,"raw",{value:e}):r.raw=e,r}function pP(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)Object.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e.default=r,e}function gP(r){return r&&r.__esModule?r:{default:r}}function mP(r,e){if(!e.has(r))throw new TypeError("attempted to get private field on non-instance");return e.get(r)}function yP(r,e,t){if(!e.has(r))throw new TypeError("attempted to set private field on non-instance");return e.set(r,t),t}const wP=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return $y},__asyncDelegator:hP,__asyncGenerator:uP,__asyncValues:dP,__await:Hh,__awaiter:sP,__classPrivateFieldGet:mP,__classPrivateFieldSet:yP,__createBinding:oP,__decorate:tP,__exportStar:aP,__extends:XT,__generator:iP,__importDefault:gP,__importStar:pP,__makeTemplateObject:fP,__metadata:nP,__param:rP,__read:VC,__rest:eP,__spread:cP,__spreadArrays:lP,__values:My},Symbol.toStringTag,{value:"Module"})),xg=xC(wP);var vm={},th={},W0;function bP(){if(W0)return th;W0=1,Object.defineProperty(th,"__esModule",{value:!0}),th.delay=void 0;function r(e){return new Promise(t=>{setTimeout(()=>{t(!0)},e)})}return th.delay=r,th}var Wo={},Am={},Go={},G0;function EP(){return G0||(G0=1,Object.defineProperty(Go,"__esModule",{value:!0}),Go.ONE_THOUSAND=Go.ONE_HUNDRED=void 0,Go.ONE_HUNDRED=100,Go.ONE_THOUSAND=1e3),Go}var Cm={},K0;function vP(){return K0||(K0=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.ONE_YEAR=r.FOUR_WEEKS=r.THREE_WEEKS=r.TWO_WEEKS=r.ONE_WEEK=r.THIRTY_DAYS=r.SEVEN_DAYS=r.FIVE_DAYS=r.THREE_DAYS=r.ONE_DAY=r.TWENTY_FOUR_HOURS=r.TWELVE_HOURS=r.SIX_HOURS=r.THREE_HOURS=r.ONE_HOUR=r.SIXTY_MINUTES=r.THIRTY_MINUTES=r.TEN_MINUTES=r.FIVE_MINUTES=r.ONE_MINUTE=r.SIXTY_SECONDS=r.THIRTY_SECONDS=r.TEN_SECONDS=r.FIVE_SECONDS=r.ONE_SECOND=void 0,r.ONE_SECOND=1,r.FIVE_SECONDS=5,r.TEN_SECONDS=10,r.THIRTY_SECONDS=30,r.SIXTY_SECONDS=60,r.ONE_MINUTE=r.SIXTY_SECONDS,r.FIVE_MINUTES=r.ONE_MINUTE*5,r.TEN_MINUTES=r.ONE_MINUTE*10,r.THIRTY_MINUTES=r.ONE_MINUTE*30,r.SIXTY_MINUTES=r.ONE_MINUTE*60,r.ONE_HOUR=r.SIXTY_MINUTES,r.THREE_HOURS=r.ONE_HOUR*3,r.SIX_HOURS=r.ONE_HOUR*6,r.TWELVE_HOURS=r.ONE_HOUR*12,r.TWENTY_FOUR_HOURS=r.ONE_HOUR*24,r.ONE_DAY=r.TWENTY_FOUR_HOURS,r.THREE_DAYS=r.ONE_DAY*3,r.FIVE_DAYS=r.ONE_DAY*5,r.SEVEN_DAYS=r.ONE_DAY*7,r.THIRTY_DAYS=r.ONE_DAY*30,r.ONE_WEEK=r.SEVEN_DAYS,r.TWO_WEEKS=r.ONE_WEEK*2,r.THREE_WEEKS=r.ONE_WEEK*3,r.FOUR_WEEKS=r.ONE_WEEK*4,r.ONE_YEAR=r.ONE_DAY*365}(Cm)),Cm}var J0;function WC(){return J0||(J0=1,function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=xg;e.__exportStar(EP(),r),e.__exportStar(vP(),r)}(Am)),Am}var Y0;function AP(){if(Y0)return Wo;Y0=1,Object.defineProperty(Wo,"__esModule",{value:!0}),Wo.fromMiliseconds=Wo.toMiliseconds=void 0;const r=WC();function e(n){return n*r.ONE_THOUSAND}Wo.toMiliseconds=e;function t(n){return Math.floor(n/r.ONE_THOUSAND)}return Wo.fromMiliseconds=t,Wo}var Q0;function CP(){return Q0||(Q0=1,function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=xg;e.__exportStar(bP(),r),e.__exportStar(AP(),r)}(vm)),vm}var Sc={},Z0;function _P(){if(Z0)return Sc;Z0=1,Object.defineProperty(Sc,"__esModule",{value:!0}),Sc.Watch=void 0;class r{constructor(){this.timestamps=new Map}start(t){if(this.timestamps.has(t))throw new Error(`Watch already started for label: ${t}`);this.timestamps.set(t,{started:Date.now()})}stop(t){const n=this.get(t);if(typeof n.elapsed<"u")throw new Error(`Watch already stopped for label: ${t}`);const s=Date.now()-n.started;this.timestamps.set(t,{started:n.started,elapsed:s})}get(t){const n=this.timestamps.get(t);if(typeof n>"u")throw new Error(`No timestamp found for label: ${t}`);return n}elapsed(t){const n=this.get(t);return n.elapsed||Date.now()-n.started}}return Sc.Watch=r,Sc.default=r,Sc}var _m={},rh={},X0;function NP(){if(X0)return rh;X0=1,Object.defineProperty(rh,"__esModule",{value:!0}),rh.IWatch=void 0;class r{}return rh.IWatch=r,rh}var eE;function IP(){return eE||(eE=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),xg.__exportStar(NP(),r)}(_m)),_m}(function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=xg;e.__exportStar(CP(),r),e.__exportStar(_P(),r),e.__exportStar(IP(),r),e.__exportStar(WC(),r)})(X);class mc{}let SP=class extends mc{constructor(e){super()}};const tE=X.FIVE_SECONDS,Uu={pulse:"heartbeat_pulse"};let xP=class GC extends SP{constructor(e){super(e),this.events=new Mn.EventEmitter,this.interval=tE,this.interval=(e==null?void 0:e.interval)||tE}static async init(e){const t=new GC(e);return await t.init(),t}async init(){await this.initialize()}stop(){clearInterval(this.intervalRef)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async initialize(){this.intervalRef=setInterval(()=>this.pulse(),X.toMiliseconds(this.interval))}pulse(){this.events.emit(Uu.pulse)}};const TP=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,PP=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,OP=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function RP(r,e){if(r==="__proto__"||r==="constructor"&&e&&typeof e=="object"&&"prototype"in e){DP(r);return}return e}function DP(r){console.warn(`[destr] Dropping "${r}" key to prevent prototype pollution.`)}function kf(r,e={}){if(typeof r!="string")return r;if(r[0]==='"'&&r[r.length-1]==='"'&&r.indexOf("\\")===-1)return r.slice(1,-1);const t=r.trim();if(t.length<=9)switch(t.toLowerCase()){case"true":return!0;case"false":return!1;case"undefined":return;case"null":return null;case"nan":return Number.NaN;case"infinity":return Number.POSITIVE_INFINITY;case"-infinity":return Number.NEGATIVE_INFINITY}if(!OP.test(r)){if(e.strict)throw new SyntaxError("[destr] Invalid JSON");return r}try{if(TP.test(r)||PP.test(r)){if(e.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(r,RP)}return JSON.parse(r)}catch(n){if(e.strict)throw n;return r}}function kP(r){return!r||typeof r.then!="function"?Promise.resolve(r):r}function Gt(r,...e){try{return kP(r(...e))}catch(t){return Promise.reject(t)}}function UP(r){const e=typeof r;return r===null||e!=="object"&&e!=="function"}function BP(r){const e=Object.getPrototypeOf(r);return!e||e.isPrototypeOf(Object)}function dp(r){if(UP(r))return String(r);if(BP(r)||Array.isArray(r))return JSON.stringify(r);if(typeof r.toJSON=="function")return dp(r.toJSON());throw new Error("[unstorage] Cannot stringify value!")}const Fy="base64:";function LP(r){return typeof r=="string"?r:Fy+FP(r)}function $P(r){return typeof r!="string"||!r.startsWith(Fy)?r:MP(r.slice(Fy.length))}function MP(r){return globalThis.Buffer?Buffer.from(r,"base64"):Uint8Array.from(globalThis.atob(r),e=>e.codePointAt(0))}function FP(r){return globalThis.Buffer?Buffer.from(r).toString("base64"):globalThis.btoa(String.fromCodePoint(...r))}function Hr(r){var e;return r&&((e=r.split("?")[0])==null?void 0:e.replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""))||""}function jP(...r){return Hr(r.join(":"))}function Uf(r){return r=Hr(r),r?r+":":""}function HP(r,e){if(e===void 0)return!0;let t=0,n=r.indexOf(":");for(;n>-1;)t++,n=r.indexOf(":",n+1);return t<=e}function zP(r,e){return e?r.startsWith(e)&&r[r.length-1]!=="$":r[r.length-1]!=="$"}const qP="memory",VP=()=>{const r=new Map;return{name:qP,getInstance:()=>r,hasItem(e){return r.has(e)},getItem(e){return r.get(e)??null},getItemRaw(e){return r.get(e)??null},setItem(e,t){r.set(e,t)},setItemRaw(e,t){r.set(e,t)},removeItem(e){r.delete(e)},getKeys(){return[...r.keys()]},clear(){r.clear()},dispose(){r.clear()}}};function WP(r={}){const e={mounts:{"":r.driver||VP()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},t=l=>{for(const u of e.mountpoints)if(l.startsWith(u))return{base:u,relativeKey:l.slice(u.length),driver:e.mounts[u]};return{base:"",relativeKey:l,driver:e.mounts[""]}},n=(l,u)=>e.mountpoints.filter(h=>h.startsWith(l)||u&&l.startsWith(h)).map(h=>({relativeBase:l.length>h.length?l.slice(h.length):void 0,mountpoint:h,driver:e.mounts[h]})),s=(l,u)=>{if(e.watching){u=Hr(u);for(const h of e.watchListeners)h(l,u)}},i=async()=>{if(!e.watching){e.watching=!0;for(const l in e.mounts)e.unwatch[l]=await rE(e.mounts[l],s,l)}},o=async()=>{if(e.watching){for(const l in e.unwatch)await e.unwatch[l]();e.unwatch={},e.watching=!1}},a=(l,u,h)=>{const d=new Map,f=g=>{let p=d.get(g.base);return p||(p={driver:g.driver,base:g.base,items:[]},d.set(g.base,p)),p};for(const g of l){const p=typeof g=="string",m=Hr(p?g:g.key),w=p?void 0:g.value,A=p||!g.options?u:{...u,...g.options},v=t(m);f(v).items.push({key:m,value:w,relativeKey:v.relativeKey,options:A})}return Promise.all([...d.values()].map(g=>h(g))).then(g=>g.flat())},c={hasItem(l,u={}){l=Hr(l);const{relativeKey:h,driver:d}=t(l);return Gt(d.hasItem,h,u)},getItem(l,u={}){l=Hr(l);const{relativeKey:h,driver:d}=t(l);return Gt(d.getItem,h,u).then(f=>kf(f))},getItems(l,u={}){return a(l,u,h=>h.driver.getItems?Gt(h.driver.getItems,h.items.map(d=>({key:d.relativeKey,options:d.options})),u).then(d=>d.map(f=>({key:jP(h.base,f.key),value:kf(f.value)}))):Promise.all(h.items.map(d=>Gt(h.driver.getItem,d.relativeKey,d.options).then(f=>({key:d.key,value:kf(f)})))))},getItemRaw(l,u={}){l=Hr(l);const{relativeKey:h,driver:d}=t(l);return d.getItemRaw?Gt(d.getItemRaw,h,u):Gt(d.getItem,h,u).then(f=>$P(f))},async setItem(l,u,h={}){if(u===void 0)return c.removeItem(l);l=Hr(l);const{relativeKey:d,driver:f}=t(l);f.setItem&&(await Gt(f.setItem,d,dp(u),h),f.watch||s("update",l))},async setItems(l,u){await a(l,u,async h=>{if(h.driver.setItems)return Gt(h.driver.setItems,h.items.map(d=>({key:d.relativeKey,value:dp(d.value),options:d.options})),u);h.driver.setItem&&await Promise.all(h.items.map(d=>Gt(h.driver.setItem,d.relativeKey,dp(d.value),d.options)))})},async setItemRaw(l,u,h={}){if(u===void 0)return c.removeItem(l,h);l=Hr(l);const{relativeKey:d,driver:f}=t(l);if(f.setItemRaw)await Gt(f.setItemRaw,d,u,h);else if(f.setItem)await Gt(f.setItem,d,LP(u),h);else return;f.watch||s("update",l)},async removeItem(l,u={}){typeof u=="boolean"&&(u={removeMeta:u}),l=Hr(l);const{relativeKey:h,driver:d}=t(l);d.removeItem&&(await Gt(d.removeItem,h,u),(u.removeMeta||u.removeMata)&&await Gt(d.removeItem,h+"$",u),d.watch||s("remove",l))},async getMeta(l,u={}){typeof u=="boolean"&&(u={nativeOnly:u}),l=Hr(l);const{relativeKey:h,driver:d}=t(l),f=Object.create(null);if(d.getMeta&&Object.assign(f,await Gt(d.getMeta,h,u)),!u.nativeOnly){const g=await Gt(d.getItem,h+"$",u).then(p=>kf(p));g&&typeof g=="object"&&(typeof g.atime=="string"&&(g.atime=new Date(g.atime)),typeof g.mtime=="string"&&(g.mtime=new Date(g.mtime)),Object.assign(f,g))}return f},setMeta(l,u,h={}){return this.setItem(l+"$",u,h)},removeMeta(l,u={}){return this.removeItem(l+"$",u)},async getKeys(l,u={}){var m;l=Uf(l);const h=n(l,!0);let d=[];const f=[];let g=!0;for(const w of h){(m=w.driver.flags)!=null&&m.maxDepth||(g=!1);const A=await Gt(w.driver.getKeys,w.relativeBase,u);for(const v of A){const N=w.mountpoint+Hr(v);d.some(T=>N.startsWith(T))||f.push(N)}d=[w.mountpoint,...d.filter(v=>!v.startsWith(w.mountpoint))]}const p=u.maxDepth!==void 0&&!g;return f.filter(w=>(!p||HP(w,u.maxDepth))&&zP(w,l))},async clear(l,u={}){l=Uf(l),await Promise.all(n(l,!1).map(async h=>{if(h.driver.clear)return Gt(h.driver.clear,h.relativeBase,u);if(h.driver.removeItem){const d=await h.driver.getKeys(h.relativeBase||"",u);return Promise.all(d.map(f=>h.driver.removeItem(f,u)))}}))},async dispose(){await Promise.all(Object.values(e.mounts).map(l=>nE(l)))},async watch(l){return await i(),e.watchListeners.push(l),async()=>{e.watchListeners=e.watchListeners.filter(u=>u!==l),e.watchListeners.length===0&&await o()}},async unwatch(){e.watchListeners=[],await o()},mount(l,u){if(l=Uf(l),l&&e.mounts[l])throw new Error(`already mounted at ${l}`);return l&&(e.mountpoints.push(l),e.mountpoints.sort((h,d)=>d.length-h.length)),e.mounts[l]=u,e.watching&&Promise.resolve(rE(u,s,l)).then(h=>{e.unwatch[l]=h}).catch(console.error),c},async unmount(l,u=!0){var h,d;l=Uf(l),!(!l||!e.mounts[l])&&(e.watching&&l in e.unwatch&&((d=(h=e.unwatch)[l])==null||d.call(h),delete e.unwatch[l]),u&&await nE(e.mounts[l]),e.mountpoints=e.mountpoints.filter(f=>f!==l),delete e.mounts[l])},getMount(l=""){l=Hr(l)+":";const u=t(l);return{driver:u.driver,base:u.base}},getMounts(l="",u={}){return l=Hr(l),n(l,u.parents).map(d=>({driver:d.driver,base:d.mountpoint}))},keys:(l,u={})=>c.getKeys(l,u),get:(l,u={})=>c.getItem(l,u),set:(l,u,h={})=>c.setItem(l,u,h),has:(l,u={})=>c.hasItem(l,u),del:(l,u={})=>c.removeItem(l,u),remove:(l,u={})=>c.removeItem(l,u)};return c}function rE(r,e,t){return r.watch?r.watch((n,s)=>e(n,t+s)):()=>{}}async function nE(r){typeof r.dispose=="function"&&await Gt(r.dispose)}function yc(r){return new Promise((e,t)=>{r.oncomplete=r.onsuccess=()=>e(r.result),r.onabort=r.onerror=()=>t(r.error)})}function KC(r,e){let t;const n=()=>{if(t)return t;const s=indexedDB.open(r);return s.onupgradeneeded=()=>s.result.createObjectStore(e),t=yc(s),t.then(i=>{i.onclose=()=>t=void 0},()=>{}),t};return(s,i)=>n().then(o=>i(o.transaction(e,s).objectStore(e)))}let Nm;function sf(){return Nm||(Nm=KC("keyval-store","keyval")),Nm}function sE(r,e=sf()){return e("readonly",t=>yc(t.get(r)))}function GP(r,e,t=sf()){return t("readwrite",n=>(n.put(e,r),yc(n.transaction)))}function KP(r,e=sf()){return e("readwrite",t=>(t.delete(r),yc(t.transaction)))}function JP(r=sf()){return r("readwrite",e=>(e.clear(),yc(e.transaction)))}function YP(r,e){return r.openCursor().onsuccess=function(){this.result&&(e(this.result),this.result.continue())},yc(r.transaction)}function QP(r=sf()){return r("readonly",e=>{if(e.getAllKeys)return yc(e.getAllKeys());const t=[];return YP(e,n=>t.push(n.key)).then(()=>t)})}const ZP=r=>JSON.stringify(r,(e,t)=>typeof t=="bigint"?t.toString()+"n":t),XP=r=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,t=r.replace(e,'$1"$2n"$3');return JSON.parse(t,(n,s)=>typeof s=="string"&&s.match(/^\d+n$/)?BigInt(s.substring(0,s.length-1)):s)};function ec(r){if(typeof r!="string")throw new Error(`Cannot safe json parse value of type ${typeof r}`);try{return XP(r)}catch{return r}}function Bi(r){return typeof r=="string"?r:ZP(r)||""}const eO="idb-keyval";var tO=(r={})=>{const e=r.base&&r.base.length>0?`${r.base}:`:"",t=s=>e+s;let n;return r.dbName&&r.storeName&&(n=KC(r.dbName,r.storeName)),{name:eO,options:r,async hasItem(s){return!(typeof await sE(t(s),n)>"u")},async getItem(s){return await sE(t(s),n)??null},setItem(s,i){return GP(t(s),i,n)},removeItem(s){return KP(t(s),n)},getKeys(){return QP(n)},clear(){return JP(n)}}};const rO="WALLET_CONNECT_V2_INDEXED_DB",nO="keyvaluestorage";let sO=class{constructor(){this.indexedDb=WP({driver:tO({dbName:rO,storeName:nO})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(e=>[e.key,e.value])}async getItem(e){const t=await this.indexedDb.getItem(e);if(t!==null)return t}async setItem(e,t){await this.indexedDb.setItem(e,Bi(t))}async removeItem(e){await this.indexedDb.removeItem(e)}};var Im=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},fp={exports:{}};(function(){let r;function e(){}r=e,r.prototype.getItem=function(t){return this.hasOwnProperty(t)?String(this[t]):null},r.prototype.setItem=function(t,n){this[t]=String(n)},r.prototype.removeItem=function(t){delete this[t]},r.prototype.clear=function(){const t=this;Object.keys(t).forEach(function(n){t[n]=void 0,delete t[n]})},r.prototype.key=function(t){return t=t||0,Object.keys(this)[t]},r.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Im<"u"&&Im.localStorage?fp.exports=Im.localStorage:typeof window<"u"&&window.localStorage?fp.exports=window.localStorage:fp.exports=new e})();function iO(r){var e;return[r[0],ec((e=r[1])!=null?e:"")]}let oO=class{constructor(){this.localStorage=fp.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(iO)}async getItem(e){const t=this.localStorage.getItem(e);if(t!==null)return ec(t)}async setItem(e,t){this.localStorage.setItem(e,Bi(t))}async removeItem(e){this.localStorage.removeItem(e)}};const aO="wc_storage_version",iE=1,cO=async(r,e,t)=>{const n=aO,s=await e.getItem(n);if(s&&s>=iE){t(e);return}const i=await r.getKeys();if(!i.length){t(e);return}const o=[];for(;i.length;){const a=i.shift();if(!a)continue;const c=a.toLowerCase();if(c.includes("wc@")||c.includes("walletconnect")||c.includes("wc_")||c.includes("wallet_connect")){const l=await r.getItem(a);await e.setItem(a,l),o.push(a)}}await e.setItem(n,iE),t(e),lO(r,o)},lO=async(r,e)=>{e.length&&e.forEach(async t=>{await r.removeItem(t)})};let uO=class{constructor(){this.initialized=!1,this.setInitialized=t=>{this.storage=t,this.initialized=!0};const e=new oO;this.storage=e;try{const t=new sO;cO(e,t,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,t){return await this.initialize(),this.storage.setItem(e,t)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise(e=>{const t=setInterval(()=>{this.initialized&&(clearInterval(t),e())},20)})}};function hO(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}var dO=fO;function fO(r,e,t){var n=t&&t.stringify||hO,s=1;if(typeof r=="object"&&r!==null){var i=e.length+s;if(i===1)return r;var o=new Array(i);o[0]=n(r);for(var a=1;a<i;a++)o[a]=n(e[a]);return o.join(" ")}if(typeof r!="string")return r;var c=e.length;if(c===0)return r;for(var l="",u=1-s,h=-1,d=r&&r.length||0,f=0;f<d;){if(r.charCodeAt(f)===37&&f+1<d){switch(h=h>-1?h:0,r.charCodeAt(f+1)){case 100:case 102:if(u>=c||e[u]==null)break;h<f&&(l+=r.slice(h,f)),l+=Number(e[u]),h=f+2,f++;break;case 105:if(u>=c||e[u]==null)break;h<f&&(l+=r.slice(h,f)),l+=Math.floor(Number(e[u])),h=f+2,f++;break;case 79:case 111:case 106:if(u>=c||e[u]===void 0)break;h<f&&(l+=r.slice(h,f));var g=typeof e[u];if(g==="string"){l+="'"+e[u]+"'",h=f+2,f++;break}if(g==="function"){l+=e[u].name||"<anonymous>",h=f+2,f++;break}l+=n(e[u]),h=f+2,f++;break;case 115:if(u>=c)break;h<f&&(l+=r.slice(h,f)),l+=String(e[u]),h=f+2,f++;break;case 37:h<f&&(l+=r.slice(h,f)),l+="%",h=f+2,f++,u--;break}++u}++f}return h===-1?r:(h<d&&(l+=r.slice(h)),l)}const oE=dO;var Qc=qs;const zh=CO().console||{},pO={mapHttpRequest:Bf,mapHttpResponse:Bf,wrapRequestSerializer:Sm,wrapResponseSerializer:Sm,wrapErrorSerializer:Sm,req:Bf,res:Bf,err:bO};function gO(r,e){return Array.isArray(r)?r.filter(function(n){return n!=="!stdSerializers.err"}):r===!0?Object.keys(e):!1}function qs(r){r=r||{},r.browser=r.browser||{};const e=r.browser.transmit;if(e&&typeof e.send!="function")throw Error("pino: transmit option must have a send function");const t=r.browser.write||zh;r.browser.write&&(r.browser.asObject=!0);const n=r.serializers||{},s=gO(r.browser.serialize,n);let i=r.browser.serialize;Array.isArray(r.browser.serialize)&&r.browser.serialize.indexOf("!stdSerializers.err")>-1&&(i=!1);const o=["error","fatal","warn","info","debug","trace"];typeof t=="function"&&(t.error=t.fatal=t.warn=t.info=t.debug=t.trace=t),r.enabled===!1&&(r.level="silent");const a=r.level||"info",c=Object.create(t);c.log||(c.log=qh),Object.defineProperty(c,"levelVal",{get:u}),Object.defineProperty(c,"level",{get:h,set:d});const l={transmit:e,serialize:s,asObject:r.browser.asObject,levels:o,timestamp:EO(r)};c.levels=qs.levels,c.level=a,c.setMaxListeners=c.getMaxListeners=c.emit=c.addListener=c.on=c.prependListener=c.once=c.prependOnceListener=c.removeListener=c.removeAllListeners=c.listeners=c.listenerCount=c.eventNames=c.write=c.flush=qh,c.serializers=n,c._serialize=s,c._stdErrSerialize=i,c.child=f,e&&(c._logEvent=jy());function u(){return this.level==="silent"?1/0:this.levels.values[this.level]}function h(){return this._level}function d(g){if(g!=="silent"&&!this.levels.values[g])throw Error("unknown level "+g);this._level=g,xc(l,c,"error","log"),xc(l,c,"fatal","error"),xc(l,c,"warn","error"),xc(l,c,"info","log"),xc(l,c,"debug","log"),xc(l,c,"trace","log")}function f(g,p){if(!g)throw new Error("missing bindings for child Pino");p=p||{},s&&g.serializers&&(p.serializers=g.serializers);const m=p.serializers;if(s&&m){var w=Object.assign({},n,m),A=r.browser.serialize===!0?Object.keys(w):s;delete g.serializers,Tg([g],A,w,this._stdErrSerialize)}function v(N){this._childLevel=(N._childLevel|0)+1,this.error=Tc(N,g,"error"),this.fatal=Tc(N,g,"fatal"),this.warn=Tc(N,g,"warn"),this.info=Tc(N,g,"info"),this.debug=Tc(N,g,"debug"),this.trace=Tc(N,g,"trace"),w&&(this.serializers=w,this._serialize=A),e&&(this._logEvent=jy([].concat(N._logEvent.bindings,g)))}return v.prototype=this,new v(this)}return c}qs.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}};qs.stdSerializers=pO;qs.stdTimeFunctions=Object.assign({},{nullTime:JC,epochTime:YC,unixTime:vO,isoTime:AO});function xc(r,e,t,n){const s=Object.getPrototypeOf(e);e[t]=e.levelVal>e.levels.values[t]?qh:s[t]?s[t]:zh[t]||zh[n]||qh,mO(r,e,t)}function mO(r,e,t){!r.transmit&&e[t]===qh||(e[t]=function(n){return function(){const i=r.timestamp(),o=new Array(arguments.length),a=Object.getPrototypeOf&&Object.getPrototypeOf(this)===zh?zh:this;for(var c=0;c<o.length;c++)o[c]=arguments[c];if(r.serialize&&!r.asObject&&Tg(o,this._serialize,this.serializers,this._stdErrSerialize),r.asObject?n.call(a,yO(this,t,o,i)):n.apply(a,o),r.transmit){const l=r.transmit.level||e.level,u=qs.levels.values[l],h=qs.levels.values[t];if(h<u)return;wO(this,{ts:i,methodLevel:t,methodValue:h,transmitValue:qs.levels.values[r.transmit.level||e.level],send:r.transmit.send,val:e.levelVal},o)}}}(e[t]))}function yO(r,e,t,n){r._serialize&&Tg(t,r._serialize,r.serializers,r._stdErrSerialize);const s=t.slice();let i=s[0];const o={};n&&(o.time=n),o.level=qs.levels.values[e];let a=(r._childLevel|0)+1;if(a<1&&(a=1),i!==null&&typeof i=="object"){for(;a--&&typeof s[0]=="object";)Object.assign(o,s.shift());i=s.length?oE(s.shift(),s):void 0}else typeof i=="string"&&(i=oE(s.shift(),s));return i!==void 0&&(o.msg=i),o}function Tg(r,e,t,n){for(const s in r)if(n&&r[s]instanceof Error)r[s]=qs.stdSerializers.err(r[s]);else if(typeof r[s]=="object"&&!Array.isArray(r[s]))for(const i in r[s])e&&e.indexOf(i)>-1&&i in t&&(r[s][i]=t[i](r[s][i]))}function Tc(r,e,t){return function(){const n=new Array(1+arguments.length);n[0]=e;for(var s=1;s<n.length;s++)n[s]=arguments[s-1];return r[t].apply(this,n)}}function wO(r,e,t){const n=e.send,s=e.ts,i=e.methodLevel,o=e.methodValue,a=e.val,c=r._logEvent.bindings;Tg(t,r._serialize||Object.keys(r.serializers),r.serializers,r._stdErrSerialize===void 0?!0:r._stdErrSerialize),r._logEvent.ts=s,r._logEvent.messages=t.filter(function(l){return c.indexOf(l)===-1}),r._logEvent.level.label=i,r._logEvent.level.value=o,n(i,r._logEvent,a),r._logEvent=jy(c)}function jy(r){return{ts:0,messages:[],bindings:r||[],level:{label:"",value:0}}}function bO(r){const e={type:r.constructor.name,msg:r.message,stack:r.stack};for(const t in r)e[t]===void 0&&(e[t]=r[t]);return e}function EO(r){return typeof r.timestamp=="function"?r.timestamp:r.timestamp===!1?JC:YC}function Bf(){return{}}function Sm(r){return r}function qh(){}function JC(){return!1}function YC(){return Date.now()}function vO(){return Math.round(Date.now()/1e3)}function AO(){return new Date(Date.now()).toISOString()}function CO(){function r(e){return typeof e<"u"&&e}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return r(self)||r(window)||r(this)||{}}}const of=_g(Qc),_O={level:"info"},af="custom_context",Ab=1e3*1024;let NO=class{constructor(e){this.nodeValue=e,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}},aE=class{constructor(e){this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=e,this.sizeInBytes=0}append(e){const t=new NO(e);if(t.size>this.maxSizeInBytes)throw new Error(`[LinkedList] Value too big to insert into list: ${e} with size ${t.size}`);for(;this.size+t.size>this.maxSizeInBytes;)this.shift();this.head?(this.tail&&(this.tail.next=t),this.tail=t):(this.head=t,this.tail=t),this.lengthInNodes++,this.sizeInBytes+=t.size}shift(){if(!this.head)return;const e=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=e.size}toArray(){const e=[];let t=this.head;for(;t!==null;)e.push(t.value),t=t.next;return e}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let e=this.head;return{next:()=>{if(!e)return{done:!0,value:null};const t=e.value;return e=e.next,{done:!1,value:t}}}}},QC=class{constructor(e,t=Ab){this.level=e??"error",this.levelValue=Qc.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=t,this.logs=new aE(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(e,t){t===Qc.levels.values.error?console.error(e):t===Qc.levels.values.warn?console.warn(e):t===Qc.levels.values.debug?console.debug(e):t===Qc.levels.values.trace?console.trace(e):console.log(e)}appendToLogs(e){this.logs.append(Bi({timestamp:new Date().toISOString(),log:e}));const t=typeof e=="string"?JSON.parse(e).level:e.level;t>=this.levelValue&&this.forwardToConsole(e,t)}getLogs(){return this.logs}clearLogs(){this.logs=new aE(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(e){const t=this.getLogArray();return t.push(Bi({extraMetadata:e})),new Blob(t,{type:"application/json"})}},IO=class{constructor(e,t=Ab){this.baseChunkLogger=new QC(e,t)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}downloadLogsBlobInBrowser(e){const t=URL.createObjectURL(this.logsToBlob(e)),n=document.createElement("a");n.href=t,n.download=`walletconnect-logs-${new Date().toISOString()}.txt`,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(t)}},SO=class{constructor(e,t=Ab){this.baseChunkLogger=new QC(e,t)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}};var xO=Object.defineProperty,TO=Object.defineProperties,PO=Object.getOwnPropertyDescriptors,cE=Object.getOwnPropertySymbols,OO=Object.prototype.hasOwnProperty,RO=Object.prototype.propertyIsEnumerable,lE=(r,e,t)=>e in r?xO(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Lp=(r,e)=>{for(var t in e||(e={}))OO.call(e,t)&&lE(r,t,e[t]);if(cE)for(var t of cE(e))RO.call(e,t)&&lE(r,t,e[t]);return r},$p=(r,e)=>TO(r,PO(e));function Bu(r){return $p(Lp({},r),{level:(r==null?void 0:r.level)||_O.level})}function DO(r,e=af){return r[e]||""}function kO(r,e,t=af){return r[t]=e,r}function Xr(r,e=af){let t="";return typeof r.bindings>"u"?t=DO(r,e):t=r.bindings().context||"",t}function UO(r,e,t=af){const n=Xr(r,t);return n.trim()?`${n}/${e}`:e}function Ir(r,e,t=af){const n=UO(r,e,t),s=r.child({context:n});return kO(s,n,t)}function BO(r){var e,t;const n=new IO((e=r.opts)==null?void 0:e.level,r.maxSizeInBytes);return{logger:of($p(Lp({},r.opts),{level:"trace",browser:$p(Lp({},(t=r.opts)==null?void 0:t.browser),{write:s=>n.write(s)})})),chunkLoggerController:n}}function LO(r){var e;const t=new SO((e=r.opts)==null?void 0:e.level,r.maxSizeInBytes);return{logger:of($p(Lp({},r.opts),{level:"trace"}),t),chunkLoggerController:t}}function Cb(r){return typeof r.loggerOverride<"u"&&typeof r.loggerOverride!="string"?{logger:r.loggerOverride,chunkLoggerController:null}:typeof window<"u"?BO(r):LO(r)}var $O=Object.defineProperty,MO=(r,e,t)=>e in r?$O(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,uE=(r,e,t)=>MO(r,typeof e!="symbol"?e+"":e,t);let FO=class extends mc{constructor(e){super(),this.opts=e,uE(this,"protocol","wc"),uE(this,"version",2)}};var jO=Object.defineProperty,HO=(r,e,t)=>e in r?jO(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,zO=(r,e,t)=>HO(r,e+"",t);let qO=class extends mc{constructor(e,t){super(),this.core=e,this.logger=t,zO(this,"records",new Map)}},VO=class{constructor(e,t){this.logger=e,this.core=t}},WO=class extends mc{constructor(e,t){super(),this.relayer=e,this.logger=t}},GO=class extends mc{constructor(e){super()}},KO=class{constructor(e,t,n,s){this.core=e,this.logger=t,this.name=n}},JO=class extends mc{constructor(e,t){super(),this.relayer=e,this.logger=t}},YO=class extends mc{constructor(e,t){super(),this.core=e,this.logger=t}},QO=class{constructor(e,t,n){this.core=e,this.logger=t,this.store=n}},ZO=class{constructor(e,t){this.projectId=e,this.logger=t}},XO=class{constructor(e,t,n){this.core=e,this.logger=t,this.telemetryEnabled=n}};var e2=Object.defineProperty,t2=(r,e,t)=>e in r?e2(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,hE=(r,e,t)=>t2(r,typeof e!="symbol"?e+"":e,t);let r2=class{constructor(e){this.opts=e,hE(this,"protocol","wc"),hE(this,"version",2)}},n2=class{constructor(e){this.client=e}};function s2(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function ZC(r,...e){if(!s2(r))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(r.length))throw new Error("Uint8Array expected of length "+e+", got length="+r.length)}function dE(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function i2(r,e){ZC(r);const t=e.outputLen;if(r.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}const Pc=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const xm=r=>new DataView(r.buffer,r.byteOffset,r.byteLength);function o2(r){if(typeof r!="string")throw new Error("utf8ToBytes expected string, got "+typeof r);return new Uint8Array(new TextEncoder().encode(r))}function XC(r){return typeof r=="string"&&(r=o2(r)),ZC(r),r}let a2=class{clone(){return this._cloneInto()}};function c2(r){const e=n=>r().update(XC(n)).digest(),t=r();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>r(),e}function e_(r=32){if(Pc&&typeof Pc.getRandomValues=="function")return Pc.getRandomValues(new Uint8Array(r));if(Pc&&typeof Pc.randomBytes=="function")return Pc.randomBytes(r);throw new Error("crypto.getRandomValues must be defined")}function l2(r,e,t,n){if(typeof r.setBigUint64=="function")return r.setBigUint64(e,t,n);const s=BigInt(32),i=BigInt(4294967295),o=Number(t>>s&i),a=Number(t&i),c=n?4:0,l=n?0:4;r.setUint32(e+c,o,n),r.setUint32(e+l,a,n)}let u2=class extends a2{constructor(e,t,n,s){super(),this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=xm(this.buffer)}update(e){dE(this);const{view:t,buffer:n,blockLen:s}=this;e=XC(e);const i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=xm(e);for(;s<=i-o;o+=s)this.process(c,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){dE(this),i2(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:s,isLE:i}=this;let{pos:o}=this;t[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(n,0),o=0);for(let h=o;h<s;h++)t[h]=0;l2(n,s-8,BigInt(this.length*8),i),this.process(n,0);const a=xm(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<l;h++)a.setUint32(4*h,u[h],i)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:s,finished:i,destroyed:o,pos:a}=this;return e.length=s,e.pos=a,e.finished=i,e.destroyed=o,s%t&&e.buffer.set(n),e}};const Lf=BigInt(2**32-1),Hy=BigInt(32);function t_(r,e=!1){return e?{h:Number(r&Lf),l:Number(r>>Hy&Lf)}:{h:Number(r>>Hy&Lf)|0,l:Number(r&Lf)|0}}function h2(r,e=!1){let t=new Uint32Array(r.length),n=new Uint32Array(r.length);for(let s=0;s<r.length;s++){const{h:i,l:o}=t_(r[s],e);[t[s],n[s]]=[i,o]}return[t,n]}const d2=(r,e)=>BigInt(r>>>0)<<Hy|BigInt(e>>>0),f2=(r,e,t)=>r>>>t,p2=(r,e,t)=>r<<32-t|e>>>t,g2=(r,e,t)=>r>>>t|e<<32-t,m2=(r,e,t)=>r<<32-t|e>>>t,y2=(r,e,t)=>r<<64-t|e>>>t-32,w2=(r,e,t)=>r>>>t-32|e<<64-t,b2=(r,e)=>e,E2=(r,e)=>r,v2=(r,e,t)=>r<<t|e>>>32-t,A2=(r,e,t)=>e<<t|r>>>32-t,C2=(r,e,t)=>e<<t-32|r>>>64-t,_2=(r,e,t)=>r<<t-32|e>>>64-t;function N2(r,e,t,n){const s=(e>>>0)+(n>>>0);return{h:r+t+(s/2**32|0)|0,l:s|0}}const I2=(r,e,t)=>(r>>>0)+(e>>>0)+(t>>>0),S2=(r,e,t,n)=>e+t+n+(r/2**32|0)|0,x2=(r,e,t,n)=>(r>>>0)+(e>>>0)+(t>>>0)+(n>>>0),T2=(r,e,t,n,s)=>e+t+n+s+(r/2**32|0)|0,P2=(r,e,t,n,s)=>(r>>>0)+(e>>>0)+(t>>>0)+(n>>>0)+(s>>>0),O2=(r,e,t,n,s,i)=>e+t+n+s+i+(r/2**32|0)|0,De={fromBig:t_,split:h2,toBig:d2,shrSH:f2,shrSL:p2,rotrSH:g2,rotrSL:m2,rotrBH:y2,rotrBL:w2,rotr32H:b2,rotr32L:E2,rotlSH:v2,rotlSL:A2,rotlBH:C2,rotlBL:_2,add:N2,add3L:I2,add3H:S2,add4L:x2,add4H:T2,add5H:O2,add5L:P2},[R2,D2]=De.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(r=>BigInt(r))),Wi=new Uint32Array(80),Gi=new Uint32Array(80);let k2=class extends u2{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:t,Bh:n,Bl:s,Ch:i,Cl:o,Dh:a,Dl:c,Eh:l,El:u,Fh:h,Fl:d,Gh:f,Gl:g,Hh:p,Hl:m}=this;return[e,t,n,s,i,o,a,c,l,u,h,d,f,g,p,m]}set(e,t,n,s,i,o,a,c,l,u,h,d,f,g,p,m){this.Ah=e|0,this.Al=t|0,this.Bh=n|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=u|0,this.Fh=h|0,this.Fl=d|0,this.Gh=f|0,this.Gl=g|0,this.Hh=p|0,this.Hl=m|0}process(e,t){for(let v=0;v<16;v++,t+=4)Wi[v]=e.getUint32(t),Gi[v]=e.getUint32(t+=4);for(let v=16;v<80;v++){const N=Wi[v-15]|0,T=Gi[v-15]|0,P=De.rotrSH(N,T,1)^De.rotrSH(N,T,8)^De.shrSH(N,T,7),D=De.rotrSL(N,T,1)^De.rotrSL(N,T,8)^De.shrSL(N,T,7),U=Wi[v-2]|0,x=Gi[v-2]|0,j=De.rotrSH(U,x,19)^De.rotrBH(U,x,61)^De.shrSH(U,x,6),$=De.rotrSL(U,x,19)^De.rotrBL(U,x,61)^De.shrSL(U,x,6),H=De.add4L(D,$,Gi[v-7],Gi[v-16]),Z=De.add4H(H,P,j,Wi[v-7],Wi[v-16]);Wi[v]=Z|0,Gi[v]=H|0}let{Ah:n,Al:s,Bh:i,Bl:o,Ch:a,Cl:c,Dh:l,Dl:u,Eh:h,El:d,Fh:f,Fl:g,Gh:p,Gl:m,Hh:w,Hl:A}=this;for(let v=0;v<80;v++){const N=De.rotrSH(h,d,14)^De.rotrSH(h,d,18)^De.rotrBH(h,d,41),T=De.rotrSL(h,d,14)^De.rotrSL(h,d,18)^De.rotrBL(h,d,41),P=h&f^~h&p,D=d&g^~d&m,U=De.add5L(A,T,D,D2[v],Gi[v]),x=De.add5H(U,w,N,P,R2[v],Wi[v]),j=U|0,$=De.rotrSH(n,s,28)^De.rotrBH(n,s,34)^De.rotrBH(n,s,39),H=De.rotrSL(n,s,28)^De.rotrBL(n,s,34)^De.rotrBL(n,s,39),Z=n&i^n&a^i&a,z=s&o^s&c^o&c;w=p|0,A=m|0,p=f|0,m=g|0,f=h|0,g=d|0,{h,l:d}=De.add(l|0,u|0,x|0,j|0),l=a|0,u=c|0,a=i|0,c=o|0,i=n|0,o=s|0;const b=De.add3L(j,H,z);n=De.add3H(b,x,$,Z),s=b|0}({h:n,l:s}=De.add(this.Ah|0,this.Al|0,n|0,s|0)),{h:i,l:o}=De.add(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:c}=De.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:u}=De.add(this.Dh|0,this.Dl|0,l|0,u|0),{h,l:d}=De.add(this.Eh|0,this.El|0,h|0,d|0),{h:f,l:g}=De.add(this.Fh|0,this.Fl|0,f|0,g|0),{h:p,l:m}=De.add(this.Gh|0,this.Gl|0,p|0,m|0),{h:w,l:A}=De.add(this.Hh|0,this.Hl|0,w|0,A|0),this.set(n,s,i,o,a,c,l,u,h,d,f,g,p,m,w,A)}roundClean(){Wi.fill(0),Gi.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};const U2=c2(()=>new k2);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const _b=BigInt(0),r_=BigInt(1),B2=BigInt(2);function Nb(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function Ib(r){if(!Nb(r))throw new Error("Uint8Array expected")}function Tm(r,e){if(typeof e!="boolean")throw new Error(r+" boolean expected, got "+e)}const L2=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));function Sb(r){Ib(r);let e="";for(let t=0;t<r.length;t++)e+=L2[r[t]];return e}function n_(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);return r===""?_b:BigInt("0x"+r)}const ti={_0:48,_9:57,A:65,F:70,a:97,f:102};function fE(r){if(r>=ti._0&&r<=ti._9)return r-ti._0;if(r>=ti.A&&r<=ti.F)return r-(ti.A-10);if(r>=ti.a&&r<=ti.f)return r-(ti.a-10)}function s_(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);const e=r.length,t=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(t);for(let s=0,i=0;s<t;s++,i+=2){const o=fE(r.charCodeAt(i)),a=fE(r.charCodeAt(i+1));if(o===void 0||a===void 0){const c=r[i]+r[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}n[s]=o*16+a}return n}function $2(r){return n_(Sb(r))}function pp(r){return Ib(r),n_(Sb(Uint8Array.from(r).reverse()))}function i_(r,e){return s_(r.toString(16).padStart(e*2,"0"))}function zy(r,e){return i_(r,e).reverse()}function ri(r,e,t){let n;if(typeof e=="string")try{n=s_(e)}catch(i){throw new Error(r+" must be hex string or Uint8Array, cause: "+i)}else if(Nb(e))n=Uint8Array.from(e);else throw new Error(r+" must be hex string or Uint8Array");const s=n.length;if(typeof t=="number"&&s!==t)throw new Error(r+" of length "+t+" expected, got "+s);return n}function pE(...r){let e=0;for(let n=0;n<r.length;n++){const s=r[n];Ib(s),e+=s.length}const t=new Uint8Array(e);for(let n=0,s=0;n<r.length;n++){const i=r[n];t.set(i,s),s+=i.length}return t}const Pm=r=>typeof r=="bigint"&&_b<=r;function M2(r,e,t){return Pm(r)&&Pm(e)&&Pm(t)&&e<=r&&r<t}function nh(r,e,t,n){if(!M2(e,t,n))throw new Error("expected valid "+r+": "+t+" <= n < "+n+", got "+e)}function F2(r){let e;for(e=0;r>_b;r>>=r_,e+=1);return e}const j2=r=>(B2<<BigInt(r-1))-r_,H2={bigint:r=>typeof r=="bigint",function:r=>typeof r=="function",boolean:r=>typeof r=="boolean",string:r=>typeof r=="string",stringOrUint8Array:r=>typeof r=="string"||Nb(r),isSafeInteger:r=>Number.isSafeInteger(r),array:r=>Array.isArray(r),field:(r,e)=>e.Fp.isValid(r),hash:r=>typeof r=="function"&&Number.isSafeInteger(r.outputLen)};function xb(r,e,t={}){const n=(s,i,o)=>{const a=H2[i];if(typeof a!="function")throw new Error("invalid validator function");const c=r[s];if(!(o&&c===void 0)&&!a(c,r))throw new Error("param "+String(s)+" is invalid. Expected "+i+", got "+c)};for(const[s,i]of Object.entries(e))n(s,i,!1);for(const[s,i]of Object.entries(t))n(s,i,!0);return r}function gE(r){const e=new WeakMap;return(t,...n)=>{const s=e.get(t);if(s!==void 0)return s;const i=r(t,...n);return e.set(t,i),i}}const Xt=BigInt(0),Dt=BigInt(1),ia=BigInt(2),z2=BigInt(3),qy=BigInt(4),mE=BigInt(5),yE=BigInt(8);function zt(r,e){const t=r%e;return t>=Xt?t:e+t}function q2(r,e,t){if(e<Xt)throw new Error("invalid exponent, negatives unsupported");if(t<=Xt)throw new Error("invalid modulus");if(t===Dt)return Xt;let n=Dt;for(;e>Xt;)e&Dt&&(n=n*r%t),r=r*r%t,e>>=Dt;return n}function bs(r,e,t){let n=r;for(;e-- >Xt;)n*=n,n%=t;return n}function wE(r,e){if(r===Xt)throw new Error("invert: expected non-zero number");if(e<=Xt)throw new Error("invert: expected positive modulus, got "+e);let t=zt(r,e),n=e,s=Xt,i=Dt;for(;t!==Xt;){const o=n/t,a=n%t,c=s-i*o;n=t,t=a,s=i,i=c}if(n!==Dt)throw new Error("invert: does not exist");return zt(s,e)}function V2(r){const e=(r-Dt)/ia;let t,n,s;for(t=r-Dt,n=0;t%ia===Xt;t/=ia,n++);for(s=ia;s<r&&q2(s,e,r)!==r-Dt;s++)if(s>1e3)throw new Error("Cannot find square root: likely non-prime P");if(n===1){const o=(r+Dt)/qy;return function(a,c){const l=a.pow(c,o);if(!a.eql(a.sqr(l),c))throw new Error("Cannot find square root");return l}}const i=(t+Dt)/ia;return function(o,a){if(o.pow(a,e)===o.neg(o.ONE))throw new Error("Cannot find square root");let c=n,l=o.pow(o.mul(o.ONE,s),t),u=o.pow(a,i),h=o.pow(a,t);for(;!o.eql(h,o.ONE);){if(o.eql(h,o.ZERO))return o.ZERO;let d=1;for(let g=o.sqr(h);d<c&&!o.eql(g,o.ONE);d++)g=o.sqr(g);const f=o.pow(l,Dt<<BigInt(c-d-1));l=o.sqr(f),u=o.mul(u,f),h=o.mul(h,l),c=d}return u}}function W2(r){if(r%qy===z2){const e=(r+Dt)/qy;return function(t,n){const s=t.pow(n,e);if(!t.eql(t.sqr(s),n))throw new Error("Cannot find square root");return s}}if(r%yE===mE){const e=(r-mE)/yE;return function(t,n){const s=t.mul(n,ia),i=t.pow(s,e),o=t.mul(n,i),a=t.mul(t.mul(o,ia),i),c=t.mul(o,t.sub(a,t.ONE));if(!t.eql(t.sqr(c),n))throw new Error("Cannot find square root");return c}}return V2(r)}const G2=(r,e)=>(zt(r,e)&Dt)===Dt,K2=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function J2(r){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},t=K2.reduce((n,s)=>(n[s]="function",n),e);return xb(r,t)}function Y2(r,e,t){if(t<Xt)throw new Error("invalid exponent, negatives unsupported");if(t===Xt)return r.ONE;if(t===Dt)return e;let n=r.ONE,s=e;for(;t>Xt;)t&Dt&&(n=r.mul(n,s)),s=r.sqr(s),t>>=Dt;return n}function Q2(r,e){const t=new Array(e.length),n=e.reduce((i,o,a)=>r.is0(o)?i:(t[a]=i,r.mul(i,o)),r.ONE),s=r.inv(n);return e.reduceRight((i,o,a)=>r.is0(o)?i:(t[a]=r.mul(i,t[a]),r.mul(i,o)),s),t}function o_(r,e){const t=e!==void 0?e:r.toString(2).length,n=Math.ceil(t/8);return{nBitLength:t,nByteLength:n}}function a_(r,e,t=!1,n={}){if(r<=Xt)throw new Error("invalid field: expected ORDER > 0, got "+r);const{nBitLength:s,nByteLength:i}=o_(r,e);if(i>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:r,isLE:t,BITS:s,BYTES:i,MASK:j2(s),ZERO:Xt,ONE:Dt,create:c=>zt(c,r),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return Xt<=c&&c<r},is0:c=>c===Xt,isOdd:c=>(c&Dt)===Dt,neg:c=>zt(-c,r),eql:(c,l)=>c===l,sqr:c=>zt(c*c,r),add:(c,l)=>zt(c+l,r),sub:(c,l)=>zt(c-l,r),mul:(c,l)=>zt(c*l,r),pow:(c,l)=>Y2(a,c,l),div:(c,l)=>zt(c*wE(l,r),r),sqrN:c=>c*c,addN:(c,l)=>c+l,subN:(c,l)=>c-l,mulN:(c,l)=>c*l,inv:c=>wE(c,r),sqrt:n.sqrt||(c=>(o||(o=W2(r)),o(a,c))),invertBatch:c=>Q2(a,c),cmov:(c,l,u)=>u?l:c,toBytes:c=>t?zy(c,i):i_(c,i),fromBytes:c=>{if(c.length!==i)throw new Error("Field.fromBytes: expected "+i+" bytes, got "+c.length);return t?pp(c):$2(c)}});return Object.freeze(a)}const bE=BigInt(0),$f=BigInt(1);function Om(r,e){const t=e.negate();return r?t:e}function c_(r,e){if(!Number.isSafeInteger(r)||r<=0||r>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+r)}function Rm(r,e){c_(r,e);const t=Math.ceil(e/r)+1,n=2**(r-1);return{windows:t,windowSize:n}}function Z2(r,e){if(!Array.isArray(r))throw new Error("array expected");r.forEach((t,n)=>{if(!(t instanceof e))throw new Error("invalid point at index "+n)})}function X2(r,e){if(!Array.isArray(r))throw new Error("array of scalars expected");r.forEach((t,n)=>{if(!e.isValid(t))throw new Error("invalid scalar at index "+n)})}const Dm=new WeakMap,l_=new WeakMap;function km(r){return l_.get(r)||1}function eR(r,e){return{constTimeNegate:Om,hasPrecomputes(t){return km(t)!==1},unsafeLadder(t,n,s=r.ZERO){let i=t;for(;n>bE;)n&$f&&(s=s.add(i)),i=i.double(),n>>=$f;return s},precomputeWindow(t,n){const{windows:s,windowSize:i}=Rm(n,e),o=[];let a=t,c=a;for(let l=0;l<s;l++){c=a,o.push(c);for(let u=1;u<i;u++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(t,n,s){const{windows:i,windowSize:o}=Rm(t,e);let a=r.ZERO,c=r.BASE;const l=BigInt(2**t-1),u=2**t,h=BigInt(t);for(let d=0;d<i;d++){const f=d*o;let g=Number(s&l);s>>=h,g>o&&(g-=u,s+=$f);const p=f,m=f+Math.abs(g)-1,w=d%2!==0,A=g<0;g===0?c=c.add(Om(w,n[p])):a=a.add(Om(A,n[m]))}return{p:a,f:c}},wNAFUnsafe(t,n,s,i=r.ZERO){const{windows:o,windowSize:a}=Rm(t,e),c=BigInt(2**t-1),l=2**t,u=BigInt(t);for(let h=0;h<o;h++){const d=h*a;if(s===bE)break;let f=Number(s&c);if(s>>=u,f>a&&(f-=l,s+=$f),f===0)continue;let g=n[d+Math.abs(f)-1];f<0&&(g=g.negate()),i=i.add(g)}return i},getPrecomputes(t,n,s){let i=Dm.get(n);return i||(i=this.precomputeWindow(n,t),t!==1&&Dm.set(n,s(i))),i},wNAFCached(t,n,s){const i=km(t);return this.wNAF(i,this.getPrecomputes(i,t,s),n)},wNAFCachedUnsafe(t,n,s,i){const o=km(t);return o===1?this.unsafeLadder(t,n,i):this.wNAFUnsafe(o,this.getPrecomputes(o,t,s),n,i)},setWindowSize(t,n){c_(n,e),l_.set(t,n),Dm.delete(t)}}}function tR(r,e,t,n){if(Z2(t,r),X2(n,e),t.length!==n.length)throw new Error("arrays of points and scalars must have equal length");const s=r.ZERO,i=F2(BigInt(t.length)),o=i>12?i-3:i>4?i-2:i?2:1,a=(1<<o)-1,c=new Array(a+1).fill(s),l=Math.floor((e.BITS-1)/o)*o;let u=s;for(let h=l;h>=0;h-=o){c.fill(s);for(let f=0;f<n.length;f++){const g=n[f],p=Number(g>>BigInt(h)&BigInt(a));c[p]=c[p].add(t[f])}let d=s;for(let f=c.length-1,g=s;f>0;f--)g=g.add(c[f]),d=d.add(g);if(u=u.add(d),h!==0)for(let f=0;f<o;f++)u=u.double()}return u}function rR(r){return J2(r.Fp),xb(r,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...o_(r.n,r.nBitLength),...r,p:r.Fp.ORDER})}const Vn=BigInt(0),$r=BigInt(1),Mf=BigInt(2),nR=BigInt(8),sR={zip215:!0};function iR(r){const e=rR(r);return xb(r,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function oR(r){const e=iR(r),{Fp:t,n,prehash:s,hash:i,randomBytes:o,nByteLength:a,h:c}=e,l=Mf<<BigInt(a*8)-$r,u=t.create,h=a_(e.n,e.nBitLength),d=e.uvRatio||((b,E)=>{try{return{isValid:!0,value:t.sqrt(b*t.inv(E))}}catch{return{isValid:!1,value:Vn}}}),f=e.adjustScalarBytes||(b=>b),g=e.domain||((b,E,O)=>{if(Tm("phflag",O),E.length||O)throw new Error("Contexts/pre-hash are not supported");return b});function p(b,E){nh("coordinate "+b,E,Vn,l)}function m(b){if(!(b instanceof v))throw new Error("ExtendedPoint expected")}const w=gE((b,E)=>{const{ex:O,ey:B,ez:k}=b,M=b.is0();E==null&&(E=M?nR:t.inv(k));const G=u(O*E),J=u(B*E),oe=u(k*E);if(M)return{x:Vn,y:$r};if(oe!==$r)throw new Error("invZ was invalid");return{x:G,y:J}}),A=gE(b=>{const{a:E,d:O}=e;if(b.is0())throw new Error("bad point: ZERO");const{ex:B,ey:k,ez:M,et:G}=b,J=u(B*B),oe=u(k*k),Q=u(M*M),ge=u(Q*Q),Oe=u(J*E),$e=u(Q*u(Oe+oe)),Me=u(ge+u(O*u(J*oe)));if($e!==Me)throw new Error("bad point: equation left != right (1)");const Ne=u(B*k),Qe=u(M*G);if(Ne!==Qe)throw new Error("bad point: equation left != right (2)");return!0});class v{constructor(E,O,B,k){this.ex=E,this.ey=O,this.ez=B,this.et=k,p("x",E),p("y",O),p("z",B),p("t",k),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(E){if(E instanceof v)throw new Error("extended point not allowed");const{x:O,y:B}=E||{};return p("x",O),p("y",B),new v(O,B,$r,u(O*B))}static normalizeZ(E){const O=t.invertBatch(E.map(B=>B.ez));return E.map((B,k)=>B.toAffine(O[k])).map(v.fromAffine)}static msm(E,O){return tR(v,h,E,O)}_setWindowSize(E){P.setWindowSize(this,E)}assertValidity(){A(this)}equals(E){m(E);const{ex:O,ey:B,ez:k}=this,{ex:M,ey:G,ez:J}=E,oe=u(O*J),Q=u(M*k),ge=u(B*J),Oe=u(G*k);return oe===Q&&ge===Oe}is0(){return this.equals(v.ZERO)}negate(){return new v(u(-this.ex),this.ey,this.ez,u(-this.et))}double(){const{a:E}=e,{ex:O,ey:B,ez:k}=this,M=u(O*O),G=u(B*B),J=u(Mf*u(k*k)),oe=u(E*M),Q=O+B,ge=u(u(Q*Q)-M-G),Oe=oe+G,$e=Oe-J,Me=oe-G,Ne=u(ge*$e),Qe=u(Oe*Me),gt=u(ge*Me),_t=u($e*Oe);return new v(Ne,Qe,_t,gt)}add(E){m(E);const{a:O,d:B}=e,{ex:k,ey:M,ez:G,et:J}=this,{ex:oe,ey:Q,ez:ge,et:Oe}=E;if(O===BigInt(-1)){const um=u((M-k)*(Q+oe)),xf=u((M+k)*(Q-oe)),Ho=u(xf-um);if(Ho===Vn)return this.double();const hm=u(G*Mf*Oe),Tf=u(J*Mf*ge),Gu=Tf+hm,Cc=xf+um,An=Tf-hm,_c=u(Gu*Ho),zn=u(Cc*An),Ku=u(Gu*An),Ju=u(Ho*Cc);return new v(_c,zn,Ju,Ku)}const $e=u(k*oe),Me=u(M*Q),Ne=u(J*B*Oe),Qe=u(G*ge),gt=u((k+M)*(oe+Q)-$e-Me),_t=Qe-Ne,ut=Qe+Ne,Ot=u(Me-O*$e),Hn=u(gt*_t),Wu=u(ut*Ot),N0=u(gt*Ot),I0=u(_t*ut);return new v(Hn,Wu,I0,N0)}subtract(E){return this.add(E.negate())}wNAF(E){return P.wNAFCached(this,E,v.normalizeZ)}multiply(E){const O=E;nh("scalar",O,$r,n);const{p:B,f:k}=this.wNAF(O);return v.normalizeZ([B,k])[0]}multiplyUnsafe(E,O=v.ZERO){const B=E;return nh("scalar",B,Vn,n),B===Vn?T:this.is0()||B===$r?this:P.wNAFCachedUnsafe(this,B,v.normalizeZ,O)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return P.unsafeLadder(this,n).is0()}toAffine(E){return w(this,E)}clearCofactor(){const{h:E}=e;return E===$r?this:this.multiplyUnsafe(E)}static fromHex(E,O=!1){const{d:B,a:k}=e,M=t.BYTES;E=ri("pointHex",E,M),Tm("zip215",O);const G=E.slice(),J=E[M-1];G[M-1]=J&-129;const oe=pp(G),Q=O?l:t.ORDER;nh("pointHex.y",oe,Vn,Q);const ge=u(oe*oe),Oe=u(ge-$r),$e=u(B*ge-k);let{isValid:Me,value:Ne}=d(Oe,$e);if(!Me)throw new Error("Point.fromHex: invalid y coordinate");const Qe=(Ne&$r)===$r,gt=(J&128)!==0;if(!O&&Ne===Vn&&gt)throw new Error("Point.fromHex: x=0 and x_0=1");return gt!==Qe&&(Ne=u(-Ne)),v.fromAffine({x:Ne,y:oe})}static fromPrivateKey(E){return x(E).point}toRawBytes(){const{x:E,y:O}=this.toAffine(),B=zy(O,t.BYTES);return B[B.length-1]|=E&$r?128:0,B}toHex(){return Sb(this.toRawBytes())}}v.BASE=new v(e.Gx,e.Gy,$r,u(e.Gx*e.Gy)),v.ZERO=new v(Vn,$r,$r,Vn);const{BASE:N,ZERO:T}=v,P=eR(v,a*8);function D(b){return zt(b,n)}function U(b){return D(pp(b))}function x(b){const E=t.BYTES;b=ri("private key",b,E);const O=ri("hashed private key",i(b),2*E),B=f(O.slice(0,E)),k=O.slice(E,2*E),M=U(B),G=N.multiply(M),J=G.toRawBytes();return{head:B,prefix:k,scalar:M,point:G,pointBytes:J}}function j(b){return x(b).pointBytes}function $(b=new Uint8Array,...E){const O=pE(...E);return U(i(g(O,ri("context",b),!!s)))}function H(b,E,O={}){b=ri("message",b),s&&(b=s(b));const{prefix:B,scalar:k,pointBytes:M}=x(E),G=$(O.context,B,b),J=N.multiply(G).toRawBytes(),oe=$(O.context,J,M,b),Q=D(G+oe*k);nh("signature.s",Q,Vn,n);const ge=pE(J,zy(Q,t.BYTES));return ri("result",ge,t.BYTES*2)}const Z=sR;function z(b,E,O,B=Z){const{context:k,zip215:M}=B,G=t.BYTES;b=ri("signature",b,2*G),E=ri("message",E),O=ri("publicKey",O,G),M!==void 0&&Tm("zip215",M),s&&(E=s(E));const J=pp(b.slice(G,2*G));let oe,Q,ge;try{oe=v.fromHex(O,M),Q=v.fromHex(b.slice(0,G),M),ge=N.multiplyUnsafe(J)}catch{return!1}if(!M&&oe.isSmallOrder())return!1;const Oe=$(k,Q.toRawBytes(),oe.toRawBytes(),E);return Q.add(oe.multiplyUnsafe(Oe)).subtract(ge).clearCofactor().equals(v.ZERO)}return N._setWindowSize(8),{CURVE:e,getPublicKey:j,sign:H,verify:z,ExtendedPoint:v,utils:{getExtendedPublicKey:x,randomPrivateKey:()=>o(t.BYTES),precompute(b=8,E=v.BASE){return E._setWindowSize(b),E.multiply(BigInt(3)),E}}}}BigInt(0),BigInt(1);const Tb=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),EE=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const aR=BigInt(1),vE=BigInt(2);BigInt(3);const cR=BigInt(5),lR=BigInt(8);function uR(r){const e=BigInt(10),t=BigInt(20),n=BigInt(40),s=BigInt(80),i=Tb,o=r*r%i*r%i,a=bs(o,vE,i)*o%i,c=bs(a,aR,i)*r%i,l=bs(c,cR,i)*c%i,u=bs(l,e,i)*l%i,h=bs(u,t,i)*u%i,d=bs(h,n,i)*h%i,f=bs(d,s,i)*d%i,g=bs(f,s,i)*d%i,p=bs(g,e,i)*l%i;return{pow_p_5_8:bs(p,vE,i)*r%i,b2:o}}function hR(r){return r[0]&=248,r[31]&=127,r[31]|=64,r}function dR(r,e){const t=Tb,n=zt(e*e*e,t),s=zt(n*n*e,t),i=uR(r*s).pow_p_5_8;let o=zt(r*n*i,t);const a=zt(e*o*o,t),c=o,l=zt(o*EE,t),u=a===r,h=a===zt(-r,t),d=a===zt(-r*EE,t);return u&&(o=c),(h||d)&&(o=l),G2(o,t)&&(o=zt(-o,t)),{isValid:u||h,value:o}}const fR=a_(Tb,void 0,!0),pR={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:fR,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:lR,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:U2,randomBytes:e_,adjustScalarBytes:hR,uvRatio:dR},u_=oR(pR),gR="EdDSA",mR="JWT",Mp=".",Pg="base64url",h_="utf8",d_="utf8",yR=":",wR="did",bR="key",AE="base58btc",ER="z",vR="K36",AR=32;function Pb(r){return globalThis.Buffer!=null?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r}function f_(r=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Pb(globalThis.Buffer.allocUnsafe(r)):new Uint8Array(r)}function p_(r,e){e||(e=r.reduce((s,i)=>s+i.length,0));const t=f_(e);let n=0;for(const s of r)t.set(s,n),n+=s.length;return Pb(t)}function CR(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var i=r.charAt(s),o=i.charCodeAt(0);if(t[o]!==255)throw new TypeError(i+" is ambiguous");t[o]=s}var a=r.length,c=r.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(g){if(g instanceof Uint8Array||(ArrayBuffer.isView(g)?g=new Uint8Array(g.buffer,g.byteOffset,g.byteLength):Array.isArray(g)&&(g=Uint8Array.from(g))),!(g instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(g.length===0)return"";for(var p=0,m=0,w=0,A=g.length;w!==A&&g[w]===0;)w++,p++;for(var v=(A-w)*u+1>>>0,N=new Uint8Array(v);w!==A;){for(var T=g[w],P=0,D=v-1;(T!==0||P<m)&&D!==-1;D--,P++)T+=256*N[D]>>>0,N[D]=T%a>>>0,T=T/a>>>0;if(T!==0)throw new Error("Non-zero carry");m=P,w++}for(var U=v-m;U!==v&&N[U]===0;)U++;for(var x=c.repeat(p);U<v;++U)x+=r.charAt(N[U]);return x}function d(g){if(typeof g!="string")throw new TypeError("Expected String");if(g.length===0)return new Uint8Array;var p=0;if(g[p]!==" "){for(var m=0,w=0;g[p]===c;)m++,p++;for(var A=(g.length-p)*l+1>>>0,v=new Uint8Array(A);g[p];){var N=t[g.charCodeAt(p)];if(N===255)return;for(var T=0,P=A-1;(N!==0||T<w)&&P!==-1;P--,T++)N+=a*v[P]>>>0,v[P]=N%256>>>0,N=N/256>>>0;if(N!==0)throw new Error("Non-zero carry");w=T,p++}if(g[p]!==" "){for(var D=A-w;D!==A&&v[D]===0;)D++;for(var U=new Uint8Array(m+(A-D)),x=m;D!==A;)U[x++]=v[D++];return U}}}function f(g){var p=d(g);if(p)return p;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:d,decode:f}}var _R=CR,NR=_R;const g_=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},IR=r=>new TextEncoder().encode(r),SR=r=>new TextDecoder().decode(r);let xR=class{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},TR=class{constructor(e,t,n){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return m_(this,e)}},PR=class{constructor(e){this.decoders=e}or(e){return m_(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const m_=(r,e)=>new PR({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});let OR=class{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new xR(e,t,n),this.decoder=new TR(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};const Og=({name:r,prefix:e,encode:t,decode:n})=>new OR(r,e,t,n),cf=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:s}=NR(t,e);return Og({prefix:r,name:e,encode:n,decode:i=>g_(s(i))})},RR=(r,e,t,n)=>{const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=r.length;for(;r[i-1]==="=";)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,l=0;for(let u=0;u<i;++u){const h=s[r[u]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<t|h,a+=t,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},DR=(r,e,t)=>{const n=e[e.length-1]==="=",s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i},pr=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>Og({prefix:e,name:r,encode(s){return DR(s,n,t)},decode(s){return RR(s,n,t,r)}}),kR=Og({prefix:"\0",name:"identity",encode:r=>SR(r),decode:r=>IR(r)});var UR=Object.freeze({__proto__:null,identity:kR});const BR=pr({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var LR=Object.freeze({__proto__:null,base2:BR});const $R=pr({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var MR=Object.freeze({__proto__:null,base8:$R});const FR=cf({prefix:"9",name:"base10",alphabet:"0123456789"});var jR=Object.freeze({__proto__:null,base10:FR});const HR=pr({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),zR=pr({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var qR=Object.freeze({__proto__:null,base16:HR,base16upper:zR});const VR=pr({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),WR=pr({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),GR=pr({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),KR=pr({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),JR=pr({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),YR=pr({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),QR=pr({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),ZR=pr({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),XR=pr({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var eD=Object.freeze({__proto__:null,base32:VR,base32upper:WR,base32pad:GR,base32padupper:KR,base32hex:JR,base32hexupper:YR,base32hexpad:QR,base32hexpadupper:ZR,base32z:XR});const tD=cf({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),rD=cf({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var nD=Object.freeze({__proto__:null,base36:tD,base36upper:rD});const sD=cf({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),iD=cf({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var oD=Object.freeze({__proto__:null,base58btc:sD,base58flickr:iD});const aD=pr({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),cD=pr({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),lD=pr({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),uD=pr({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var hD=Object.freeze({__proto__:null,base64:aD,base64pad:cD,base64url:lD,base64urlpad:uD});const y_=Array.from(""),dD=y_.reduce((r,e,t)=>(r[t]=e,r),[]),fD=y_.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]);function pD(r){return r.reduce((e,t)=>(e+=dD[t],e),"")}function gD(r){const e=[];for(const t of r){const n=fD[t.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}const mD=Og({prefix:"",name:"base256emoji",encode:pD,decode:gD});var yD=Object.freeze({__proto__:null,base256emoji:mD}),wD=w_,CE=128,bD=-128,ED=Math.pow(2,31);function w_(r,e,t){e=e||[],t=t||0;for(var n=t;r>=ED;)e[t++]=r&255|CE,r/=128;for(;r&bD;)e[t++]=r&255|CE,r>>>=7;return e[t]=r|0,w_.bytes=t-n+1,e}var vD=Vy,AD=128,_E=127;function Vy(r,n){var t=0,n=n||0,s=0,i=n,o,a=r.length;do{if(i>=a)throw Vy.bytes=0,new RangeError("Could not decode varint");o=r[i++],t+=s<28?(o&_E)<<s:(o&_E)*Math.pow(2,s),s+=7}while(o>=AD);return Vy.bytes=i-n,t}var CD=Math.pow(2,7),_D=Math.pow(2,14),ND=Math.pow(2,21),ID=Math.pow(2,28),SD=Math.pow(2,35),xD=Math.pow(2,42),TD=Math.pow(2,49),PD=Math.pow(2,56),OD=Math.pow(2,63),RD=function(r){return r<CD?1:r<_D?2:r<ND?3:r<ID?4:r<SD?5:r<xD?6:r<TD?7:r<PD?8:r<OD?9:10},DD={encode:wD,decode:vD,encodingLength:RD},b_=DD;const NE=(r,e,t=0)=>(b_.encode(r,e,t),e),IE=r=>b_.encodingLength(r),Wy=(r,e)=>{const t=e.byteLength,n=IE(r),s=n+IE(t),i=new Uint8Array(s+t);return NE(r,i,0),NE(t,i,n),i.set(e,s),new kD(r,t,e,i)};let kD=class{constructor(e,t,n,s){this.code=e,this.size=t,this.digest=n,this.bytes=s}};const E_=({name:r,code:e,encode:t})=>new UD(r,e,t);let UD=class{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Wy(this.code,t):t.then(n=>Wy(this.code,n))}else throw Error("Unknown type, must be binary type")}};const v_=r=>async e=>new Uint8Array(await crypto.subtle.digest(r,e)),BD=E_({name:"sha2-256",code:18,encode:v_("SHA-256")}),LD=E_({name:"sha2-512",code:19,encode:v_("SHA-512")});var $D=Object.freeze({__proto__:null,sha256:BD,sha512:LD});const A_=0,MD="identity",C_=g_,FD=r=>Wy(A_,C_(r)),jD={code:A_,name:MD,encode:C_,digest:FD};var HD=Object.freeze({__proto__:null,identity:jD});new TextEncoder,new TextDecoder;const SE={...UR,...LR,...MR,...jR,...qR,...eD,...nD,...oD,...hD,...yD};({...$D,...HD});function __(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}const xE=__("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),Um=__("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);const e=f_(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),N_={utf8:xE,"utf-8":xE,hex:SE.base16,latin1:Um,ascii:Um,binary:Um,...SE};function Rg(r,e="utf8"){const t=N_[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString("utf8"):t.encoder.encode(r).substring(1)}function Lu(r,e="utf8"){const t=N_[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Pb(globalThis.Buffer.from(r,"utf-8")):t.decoder.decode(`${t.prefix}${r}`)}function TE(r){return ec(Rg(Lu(r,Pg),h_))}function Fp(r){return Rg(Lu(Bi(r),h_),Pg)}function I_(r){const e=Lu(vR,AE),t=ER+Rg(p_([e,r]),AE);return[wR,bR,t].join(yR)}function zD(r){return Rg(r,Pg)}function qD(r){return Lu(r,Pg)}function VD(r){return Lu([Fp(r.header),Fp(r.payload)].join(Mp),d_)}function WD(r){return[Fp(r.header),Fp(r.payload),zD(r.signature)].join(Mp)}function Gy(r){const e=r.split(Mp),t=TE(e[0]),n=TE(e[1]),s=qD(e[2]),i=Lu(e.slice(0,2).join(Mp),d_);return{header:t,payload:n,signature:s,data:i}}function PE(r=e_(AR)){const e=u_.getPublicKey(r);return{secretKey:p_([r,e]),publicKey:e}}async function GD(r,e,t,n,s=X.fromMiliseconds(Date.now())){const i={alg:gR,typ:mR},o=I_(n.publicKey),a=s+t,c={iss:o,sub:r,aud:e,iat:s,exp:a},l=VD({header:i,payload:c}),u=u_.sign(l,n.secretKey.slice(0,32));return WD({header:i,payload:c,signature:u})}var OE=function(r,e,t){if(t||arguments.length===2)for(var n=0,s=e.length,i;n<s;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return r.concat(i||Array.prototype.slice.call(e))},KD=function(){function r(e,t,n){this.name=e,this.version=t,this.os=n,this.type="browser"}return r}(),JD=function(){function r(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return r}(),YD=function(){function r(e,t,n,s){this.name=e,this.version=t,this.os=n,this.bot=s,this.type="bot-device"}return r}(),QD=function(){function r(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return r}(),ZD=function(){function r(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return r}(),XD=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,ek=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,RE=3,tk=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",XD]],DE=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function rk(r){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new ZD:typeof navigator<"u"?sk(navigator.userAgent):ok()}function nk(r){return r!==""&&tk.reduce(function(e,t){var n=t[0],s=t[1];if(e)return e;var i=s.exec(r);return!!i&&[n,i]},!1)}function sk(r){var e=nk(r);if(!e)return null;var t=e[0],n=e[1];if(t==="searchbot")return new QD;var s=n[1]&&n[1].split(".").join("_").split("_").slice(0,3);s?s.length<RE&&(s=OE(OE([],s,!0),ak(RE-s.length),!0)):s=[];var i=s.join("."),o=ik(r),a=ek.exec(r);return a&&a[1]?new YD(t,i,o,a[1]):new KD(t,i,o)}function ik(r){for(var e=0,t=DE.length;e<t;e++){var n=DE[e],s=n[0],i=n[1],o=i.exec(r);if(o)return s}return null}function ok(){var r=typeof process<"u"&&process.version;return r?new JD(process.version.slice(1)):null}function ak(r){for(var e=[],t=0;t<r;t++)e.push("0");return e}var bt={};Object.defineProperty(bt,"__esModule",{value:!0});bt.getLocalStorage=bt.getLocalStorageOrThrow=bt.getCrypto=bt.getCryptoOrThrow=S_=bt.getLocation=bt.getLocationOrThrow=Ob=bt.getNavigator=bt.getNavigatorOrThrow=lf=bt.getDocument=bt.getDocumentOrThrow=bt.getFromWindowOrThrow=bt.getFromWindow=void 0;function wc(r){let e;return typeof window<"u"&&typeof window[r]<"u"&&(e=window[r]),e}bt.getFromWindow=wc;function $u(r){const e=wc(r);if(!e)throw new Error(`${r} is not defined in Window`);return e}bt.getFromWindowOrThrow=$u;function ck(){return $u("document")}bt.getDocumentOrThrow=ck;function lk(){return wc("document")}var lf=bt.getDocument=lk;function uk(){return $u("navigator")}bt.getNavigatorOrThrow=uk;function hk(){return wc("navigator")}var Ob=bt.getNavigator=hk;function dk(){return $u("location")}bt.getLocationOrThrow=dk;function fk(){return wc("location")}var S_=bt.getLocation=fk;function pk(){return $u("crypto")}bt.getCryptoOrThrow=pk;function gk(){return wc("crypto")}bt.getCrypto=gk;function mk(){return $u("localStorage")}bt.getLocalStorageOrThrow=mk;function yk(){return wc("localStorage")}bt.getLocalStorage=yk;var Rb={};Object.defineProperty(Rb,"__esModule",{value:!0});var x_=Rb.getWindowMetadata=void 0;const kE=bt;function wk(){let r,e;try{r=kE.getDocumentOrThrow(),e=kE.getLocationOrThrow()}catch{return null}function t(){const h=r.getElementsByTagName("link"),d=[];for(let f=0;f<h.length;f++){const g=h[f],p=g.getAttribute("rel");if(p&&p.toLowerCase().indexOf("icon")>-1){const m=g.getAttribute("href");if(m)if(m.toLowerCase().indexOf("https:")===-1&&m.toLowerCase().indexOf("http:")===-1&&m.indexOf("//")!==0){let w=e.protocol+"//"+e.host;if(m.indexOf("/")===0)w+=m;else{const A=e.pathname.split("/");A.pop();const v=A.join("/");w+=v+"/"+m}d.push(w)}else if(m.indexOf("//")===0){const w=e.protocol+m;d.push(w)}else d.push(m)}}return d}function n(...h){const d=r.getElementsByTagName("meta");for(let f=0;f<d.length;f++){const g=d[f],p=["itemprop","property","name"].map(m=>g.getAttribute(m)).filter(m=>m?h.includes(m):!1);if(p.length&&p){const m=g.getAttribute("content");if(m)return m}}return""}function s(){let h=n("name","og:site_name","og:title","twitter:title");return h||(h=r.title),h}function i(){return n("description","og:description","twitter:description","keywords")}const o=s(),a=i(),c=e.origin,l=t();return{description:a,url:c,icons:l,name:o}}x_=Rb.getWindowMetadata=wk;function Vh(r,{strict:e=!0}={}){return!r||typeof r!="string"?!1:e?/^0x[0-9a-fA-F]*$/.test(r):r.startsWith("0x")}function UE(r){return Vh(r,{strict:!1})?Math.ceil((r.length-2)/2):r.length}const T_="2.23.2";let sh={getDocsUrl:({docsBaseUrl:r,docsPath:e="",docsSlug:t})=>e?`${r??"https://viem.sh"}${e}${t?`#${t}`:""}`:void 0,version:`viem@${T_}`},Dg=class Ky extends Error{constructor(e,t={}){var a;const n=(()=>{var c;return t.cause instanceof Ky?t.cause.details:(c=t.cause)!=null&&c.message?t.cause.message:t.details})(),s=t.cause instanceof Ky&&t.cause.docsPath||t.docsPath,i=(a=sh.getDocsUrl)==null?void 0:a.call(sh,{...t,docsPath:s}),o=[e||"An error occurred.","",...t.metaMessages?[...t.metaMessages,""]:[],...i?[`Docs: ${i}`]:[],...n?[`Details: ${n}`]:[],...sh.version?[`Version: ${sh.version}`]:[]].join(`
`);super(o,t.cause?{cause:t.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=n,this.docsPath=s,this.metaMessages=t.metaMessages,this.name=t.name??this.name,this.shortMessage=e,this.version=T_}walk(e){return P_(this,e)}};function P_(r,e){return e!=null&&e(r)?r:r&&typeof r=="object"&&"cause"in r&&r.cause!==void 0?P_(r.cause,e):e?null:r}let O_=class extends Dg{constructor({size:e,targetSize:t,type:n}){super(`${n.charAt(0).toUpperCase()}${n.slice(1).toLowerCase()} size (${e}) exceeds padding size (${t}).`,{name:"SizeExceedsPaddingSizeError"})}};function Mu(r,{dir:e,size:t=32}={}){return typeof r=="string"?bk(r,{dir:e,size:t}):Ek(r,{dir:e,size:t})}function bk(r,{dir:e,size:t=32}={}){if(t===null)return r;const n=r.replace("0x","");if(n.length>t*2)throw new O_({size:Math.ceil(n.length/2),targetSize:t,type:"hex"});return`0x${n[e==="right"?"padEnd":"padStart"](t*2,"0")}`}function Ek(r,{dir:e,size:t=32}={}){if(t===null)return r;if(r.length>t)throw new O_({size:r.length,targetSize:t,type:"bytes"});const n=new Uint8Array(t);for(let s=0;s<t;s++){const i=e==="right";n[i?s:t-s-1]=r[i?s:r.length-s-1]}return n}let vk=class extends Dg{constructor({max:e,min:t,signed:n,size:s,value:i}){super(`Number "${i}" is not in safe ${s?`${s*8}-bit ${n?"signed":"unsigned"} `:""}integer range ${e?`(${t} to ${e})`:`(above ${t})`}`,{name:"IntegerOutOfRangeError"})}},Ak=class extends Dg{constructor({givenSize:e,maxSize:t}){super(`Size cannot exceed ${t} bytes. Given size: ${e} bytes.`,{name:"SizeOverflowError"})}};function Fu(r,{size:e}){if(UE(r)>e)throw new Ak({givenSize:UE(r),maxSize:e})}function Jy(r,e={}){const{signed:t}=e;e.size&&Fu(r,{size:e.size});const n=BigInt(r);if(!t)return n;const s=(r.length-2)/2,i=(1n<<BigInt(s)*8n-1n)-1n;return n<=i?n:n-BigInt(`0x${"f".padStart(s*2,"f")}`)-1n}function Ck(r,e={}){return Number(Jy(r,e))}const _k=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));function Yy(r,e={}){return typeof r=="number"||typeof r=="bigint"?D_(r,e):typeof r=="string"?Sk(r,e):typeof r=="boolean"?Nk(r,e):R_(r,e)}function Nk(r,e={}){const t=`0x${Number(r)}`;return typeof e.size=="number"?(Fu(t,{size:e.size}),Mu(t,{size:e.size})):t}function R_(r,e={}){let t="";for(let s=0;s<r.length;s++)t+=_k[r[s]];const n=`0x${t}`;return typeof e.size=="number"?(Fu(n,{size:e.size}),Mu(n,{dir:"right",size:e.size})):n}function D_(r,e={}){const{signed:t,size:n}=e,s=BigInt(r);let i;n?t?i=(1n<<BigInt(n)*8n-1n)-1n:i=2n**(BigInt(n)*8n)-1n:typeof r=="number"&&(i=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof i=="bigint"&&t?-i-1n:0;if(i&&s>i||s<o){const c=typeof r=="bigint"?"n":"";throw new vk({max:i?`${i}${c}`:void 0,min:`${o}${c}`,signed:t,size:n,value:`${r}${c}`})}const a=`0x${(t&&s<0?(1n<<BigInt(n*8))+BigInt(s):s).toString(16)}`;return n?Mu(a,{size:n}):a}const Ik=new TextEncoder;function Sk(r,e={}){const t=Ik.encode(r);return R_(t,e)}const xk=new TextEncoder;function Tk(r,e={}){return typeof r=="number"||typeof r=="bigint"?Ok(r,e):typeof r=="boolean"?Pk(r,e):Vh(r)?k_(r,e):U_(r,e)}function Pk(r,e={}){const t=new Uint8Array(1);return t[0]=Number(r),typeof e.size=="number"?(Fu(t,{size:e.size}),Mu(t,{size:e.size})):t}const ni={zero:48,nine:57,A:65,F:70,a:97,f:102};function BE(r){if(r>=ni.zero&&r<=ni.nine)return r-ni.zero;if(r>=ni.A&&r<=ni.F)return r-(ni.A-10);if(r>=ni.a&&r<=ni.f)return r-(ni.a-10)}function k_(r,e={}){let t=r;e.size&&(Fu(t,{size:e.size}),t=Mu(t,{dir:"right",size:e.size}));let n=t.slice(2);n.length%2&&(n=`0${n}`);const s=n.length/2,i=new Uint8Array(s);for(let o=0,a=0;o<s;o++){const c=BE(n.charCodeAt(a++)),l=BE(n.charCodeAt(a++));if(c===void 0||l===void 0)throw new Dg(`Invalid byte sequence ("${n[a-2]}${n[a-1]}" in "${n}").`);i[o]=c*16+l}return i}function Ok(r,e){const t=D_(r,e);return k_(t)}function U_(r,e={}){const t=xk.encode(r);return typeof e.size=="number"?(Fu(t,{size:e.size}),Mu(t,{dir:"right",size:e.size})):t}function jp(r){if(!Number.isSafeInteger(r)||r<0)throw new Error("positive integer expected, got "+r)}function Rk(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function kg(r,...e){if(!Rk(r))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(r.length))throw new Error("Uint8Array expected of length "+e+", got length="+r.length)}function GK(r){if(typeof r!="function"||typeof r.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");jp(r.outputLen),jp(r.blockLen)}function LE(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function Dk(r,e){kg(r);const t=e.outputLen;if(r.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}const Ff=BigInt(2**32-1),$E=BigInt(32);function kk(r,e=!1){return e?{h:Number(r&Ff),l:Number(r>>$E&Ff)}:{h:Number(r>>$E&Ff)|0,l:Number(r&Ff)|0}}function Uk(r,e=!1){let t=new Uint32Array(r.length),n=new Uint32Array(r.length);for(let s=0;s<r.length;s++){const{h:i,l:o}=kk(r[s],e);[t[s],n[s]]=[i,o]}return[t,n]}const Bk=(r,e,t)=>r<<t|e>>>32-t,Lk=(r,e,t)=>e<<t|r>>>32-t,$k=(r,e,t)=>e<<t-32|r>>>64-t,Mk=(r,e,t)=>r<<t-32|e>>>64-t,Oc=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Fk(r){return new Uint32Array(r.buffer,r.byteOffset,Math.floor(r.byteLength/4))}function KK(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}function JK(r,e){return r<<32-e|r>>>e}const ME=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function jk(r){return r<<24&4278190080|r<<8&16711680|r>>>8&65280|r>>>24&255}function FE(r){for(let e=0;e<r.length;e++)r[e]=jk(r[e])}function Hk(r){if(typeof r!="string")throw new Error("utf8ToBytes expected string, got "+typeof r);return new Uint8Array(new TextEncoder().encode(r))}function B_(r){return typeof r=="string"&&(r=Hk(r)),kg(r),r}function YK(...r){let e=0;for(let n=0;n<r.length;n++){const s=r[n];kg(s),e+=s.length}const t=new Uint8Array(e);for(let n=0,s=0;n<r.length;n++){const i=r[n];t.set(i,s),s+=i.length}return t}let zk=class{clone(){return this._cloneInto()}};function qk(r){const e=n=>r().update(B_(n)).digest(),t=r();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>r(),e}function ZK(r=32){if(Oc&&typeof Oc.getRandomValues=="function")return Oc.getRandomValues(new Uint8Array(r));if(Oc&&typeof Oc.randomBytes=="function")return Oc.randomBytes(r);throw new Error("crypto.getRandomValues must be defined")}const L_=[],$_=[],M_=[],Vk=BigInt(0),ih=BigInt(1),Wk=BigInt(2),Gk=BigInt(7),Kk=BigInt(256),Jk=BigInt(113);for(let r=0,e=ih,t=1,n=0;r<24;r++){[t,n]=[n,(2*t+3*n)%5],L_.push(2*(5*n+t)),$_.push((r+1)*(r+2)/2%64);let s=Vk;for(let i=0;i<7;i++)e=(e<<ih^(e>>Gk)*Jk)%Kk,e&Wk&&(s^=ih<<(ih<<BigInt(i))-ih);M_.push(s)}const[Yk,Qk]=Uk(M_,!0),jE=(r,e,t)=>t>32?$k(r,e,t):Bk(r,e,t),HE=(r,e,t)=>t>32?Mk(r,e,t):Lk(r,e,t);function Zk(r,e=24){const t=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let o=0;o<10;o++)t[o]=r[o]^r[o+10]^r[o+20]^r[o+30]^r[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=t[c],u=t[c+1],h=jE(l,u,1)^t[a],d=HE(l,u,1)^t[a+1];for(let f=0;f<50;f+=10)r[o+f]^=h,r[o+f+1]^=d}let s=r[2],i=r[3];for(let o=0;o<24;o++){const a=$_[o],c=jE(s,i,a),l=HE(s,i,a),u=L_[o];s=r[u],i=r[u+1],r[u]=c,r[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)t[a]=r[o+a];for(let a=0;a<10;a++)r[o+a]^=~t[(a+2)%10]&t[(a+4)%10]}r[0]^=Yk[n],r[1]^=Qk[n]}t.fill(0)}let Xk=class F_ extends zk{constructor(e,t,n,s=!1,i=24){if(super(),this.blockLen=e,this.suffix=t,this.outputLen=n,this.enableXOF=s,this.rounds=i,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,jp(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=Fk(this.state)}keccak(){ME||FE(this.state32),Zk(this.state32,this.rounds),ME||FE(this.state32),this.posOut=0,this.pos=0}update(e){LE(this);const{blockLen:t,state:n}=this;e=B_(e);const s=e.length;for(let i=0;i<s;){const o=Math.min(t-this.pos,s-i);for(let a=0;a<o;a++)n[this.pos++]^=e[i++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:n,blockLen:s}=this;e[n]^=t,t&128&&n===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){LE(this,!1),kg(e),this.finish();const t=this.state,{blockLen:n}=this;for(let s=0,i=e.length;s<i;){this.posOut>=n&&this.keccak();const o=Math.min(n-this.posOut,i-s);e.set(t.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return jp(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(Dk(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:t,suffix:n,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new F_(t,n,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=n,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}};const e3=(r,e,t)=>qk(()=>new Xk(e,r,t)),t3=e3(1,136,256/8);function j_(r,e){const t=e||"hex",n=t3(Vh(r,{strict:!1})?Tk(r):r);return t==="bytes"?n:Yy(n)}let r3=class extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const t=super.get(e);return super.has(e)&&t!==void 0&&(this.delete(e),super.set(e,t)),t}set(e,t){if(super.set(e,t),this.maxSize&&this.size>this.maxSize){const n=this.keys().next().value;n&&this.delete(n)}return this}};const Bm=new r3(8192);function n3(r,e){if(Bm.has(`${r}.${e}`))return Bm.get(`${r}.${e}`);const t=r.substring(2).toLowerCase(),n=j_(U_(t),"bytes"),s=t.split("");for(let o=0;o<40;o+=2)n[o>>1]>>4>=8&&s[o]&&(s[o]=s[o].toUpperCase()),(n[o>>1]&15)>=8&&s[o+1]&&(s[o+1]=s[o+1].toUpperCase());const i=`0x${s.join("")}`;return Bm.set(`${r}.${e}`,i),i}function s3(r){const e=j_(`0x${r.substring(4)}`).substring(26);return n3(`0x${e}`)}async function i3({hash:r,signature:e}){const t=Vh(r)?r:Yy(r),{secp256k1:n}=await cn(async()=>{const{secp256k1:o}=await import("./secp256k1-CXafz8lr.js");return{secp256k1:o}},__vite__mapDeps([0,1,2,3,4,5,6]));return`0x${(()=>{if(typeof e=="object"&&"r"in e&&"s"in e){const{r:l,s:u,v:h,yParity:d}=e,f=Number(d??h),g=zE(f);return new n.Signature(Jy(l),Jy(u)).addRecoveryBit(g)}const o=Vh(e)?e:Yy(e),a=Ck(`0x${o.slice(130)}`),c=zE(a);return n.Signature.fromCompact(o.substring(2,130)).addRecoveryBit(c)})().recoverPublicKey(t.substring(2)).toHex(!1)}`}function zE(r){if(r===0||r===1)return r;if(r===27)return 0;if(r===28)return 1;throw new Error("Invalid yParityOrV value")}async function o3({hash:r,signature:e}){return s3(await i3({hash:r,signature:e}))}function a3(r){if(r.length>=255)throw new TypeError("Alphabet too long");const e=new Uint8Array(256);for(let l=0;l<e.length;l++)e[l]=255;for(let l=0;l<r.length;l++){const u=r.charAt(l),h=u.charCodeAt(0);if(e[h]!==255)throw new TypeError(u+" is ambiguous");e[h]=l}const t=r.length,n=r.charAt(0),s=Math.log(t)/Math.log(256),i=Math.log(256)/Math.log(t);function o(l){if(l instanceof Uint8Array||(ArrayBuffer.isView(l)?l=new Uint8Array(l.buffer,l.byteOffset,l.byteLength):Array.isArray(l)&&(l=Uint8Array.from(l))),!(l instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(l.length===0)return"";let u=0,h=0,d=0;const f=l.length;for(;d!==f&&l[d]===0;)d++,u++;const g=(f-d)*i+1>>>0,p=new Uint8Array(g);for(;d!==f;){let A=l[d],v=0;for(let N=g-1;(A!==0||v<h)&&N!==-1;N--,v++)A+=256*p[N]>>>0,p[N]=A%t>>>0,A=A/t>>>0;if(A!==0)throw new Error("Non-zero carry");h=v,d++}let m=g-h;for(;m!==g&&p[m]===0;)m++;let w=n.repeat(u);for(;m<g;++m)w+=r.charAt(p[m]);return w}function a(l){if(typeof l!="string")throw new TypeError("Expected String");if(l.length===0)return new Uint8Array;let u=0,h=0,d=0;for(;l[u]===n;)h++,u++;const f=(l.length-u)*s+1>>>0,g=new Uint8Array(f);for(;u<l.length;){const A=l.charCodeAt(u);if(A>255)return;let v=e[A];if(v===255)return;let N=0;for(let T=f-1;(v!==0||N<d)&&T!==-1;T--,N++)v+=t*g[T]>>>0,g[T]=v%256>>>0,v=v/256>>>0;if(v!==0)throw new Error("Non-zero carry");d=N,u++}let p=f-d;for(;p!==f&&g[p]===0;)p++;const m=new Uint8Array(h+(f-p));let w=h;for(;p!==f;)m[w++]=g[p++];return m}function c(l){const u=a(l);if(u)return u;throw new Error("Non-base"+t+" character")}return{encode:o,decodeUnsafe:a,decode:c}}var c3="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";const H_=a3(c3);function z_(r=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(r):new Uint8Array(r)}function Th(r,e){e||(e=r.reduce((s,i)=>s+i.length,0));const t=z_(e);let n=0;for(const s of r)t.set(s,n),n+=s.length;return t}function l3(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var i=r.charAt(s),o=i.charCodeAt(0);if(t[o]!==255)throw new TypeError(i+" is ambiguous");t[o]=s}var a=r.length,c=r.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(g){if(g instanceof Uint8Array||(ArrayBuffer.isView(g)?g=new Uint8Array(g.buffer,g.byteOffset,g.byteLength):Array.isArray(g)&&(g=Uint8Array.from(g))),!(g instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(g.length===0)return"";for(var p=0,m=0,w=0,A=g.length;w!==A&&g[w]===0;)w++,p++;for(var v=(A-w)*u+1>>>0,N=new Uint8Array(v);w!==A;){for(var T=g[w],P=0,D=v-1;(T!==0||P<m)&&D!==-1;D--,P++)T+=256*N[D]>>>0,N[D]=T%a>>>0,T=T/a>>>0;if(T!==0)throw new Error("Non-zero carry");m=P,w++}for(var U=v-m;U!==v&&N[U]===0;)U++;for(var x=c.repeat(p);U<v;++U)x+=r.charAt(N[U]);return x}function d(g){if(typeof g!="string")throw new TypeError("Expected String");if(g.length===0)return new Uint8Array;var p=0;if(g[p]!==" "){for(var m=0,w=0;g[p]===c;)m++,p++;for(var A=(g.length-p)*l+1>>>0,v=new Uint8Array(A);g[p];){var N=t[g.charCodeAt(p)];if(N===255)return;for(var T=0,P=A-1;(N!==0||T<w)&&P!==-1;P--,T++)N+=a*v[P]>>>0,v[P]=N%256>>>0,N=N/256>>>0;if(N!==0)throw new Error("Non-zero carry");w=T,p++}if(g[p]!==" "){for(var D=A-w;D!==A&&v[D]===0;)D++;for(var U=new Uint8Array(m+(A-D)),x=m;D!==A;)U[x++]=v[D++];return U}}}function f(g){var p=d(g);if(p)return p;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:d,decode:f}}var u3=l3,h3=u3;const d3=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},f3=r=>new TextEncoder().encode(r),p3=r=>new TextDecoder().decode(r);class g3{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class m3{constructor(e,t,n){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return q_(this,e)}}class y3{constructor(e){this.decoders=e}or(e){return q_(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const q_=(r,e)=>new y3({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class w3{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new g3(e,t,n),this.decoder=new m3(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Ug=({name:r,prefix:e,encode:t,decode:n})=>new w3(r,e,t,n),uf=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:s}=h3(t,e);return Ug({prefix:r,name:e,encode:n,decode:i=>d3(s(i))})},b3=(r,e,t,n)=>{const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=r.length;for(;r[i-1]==="=";)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,l=0;for(let u=0;u<i;++u){const h=s[r[u]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<t|h,a+=t,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},E3=(r,e,t)=>{const n=e[e.length-1]==="=",s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i},gr=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>Ug({prefix:e,name:r,encode(s){return E3(s,n,t)},decode(s){return b3(s,n,t,r)}}),v3=Ug({prefix:"\0",name:"identity",encode:r=>p3(r),decode:r=>f3(r)}),A3=Object.freeze(Object.defineProperty({__proto__:null,identity:v3},Symbol.toStringTag,{value:"Module"})),C3=gr({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),_3=Object.freeze(Object.defineProperty({__proto__:null,base2:C3},Symbol.toStringTag,{value:"Module"})),N3=gr({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),I3=Object.freeze(Object.defineProperty({__proto__:null,base8:N3},Symbol.toStringTag,{value:"Module"})),S3=uf({prefix:"9",name:"base10",alphabet:"0123456789"}),x3=Object.freeze(Object.defineProperty({__proto__:null,base10:S3},Symbol.toStringTag,{value:"Module"})),T3=gr({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),P3=gr({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),O3=Object.freeze(Object.defineProperty({__proto__:null,base16:T3,base16upper:P3},Symbol.toStringTag,{value:"Module"})),R3=gr({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),D3=gr({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),k3=gr({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),U3=gr({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),B3=gr({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),L3=gr({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),$3=gr({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),M3=gr({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),F3=gr({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),j3=Object.freeze(Object.defineProperty({__proto__:null,base32:R3,base32hex:B3,base32hexpad:$3,base32hexpadupper:M3,base32hexupper:L3,base32pad:k3,base32padupper:U3,base32upper:D3,base32z:F3},Symbol.toStringTag,{value:"Module"})),H3=uf({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),z3=uf({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),q3=Object.freeze(Object.defineProperty({__proto__:null,base36:H3,base36upper:z3},Symbol.toStringTag,{value:"Module"})),V3=uf({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),W3=uf({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),G3=Object.freeze(Object.defineProperty({__proto__:null,base58btc:V3,base58flickr:W3},Symbol.toStringTag,{value:"Module"})),K3=gr({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),J3=gr({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Y3=gr({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Q3=gr({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),Z3=Object.freeze(Object.defineProperty({__proto__:null,base64:K3,base64pad:J3,base64url:Y3,base64urlpad:Q3},Symbol.toStringTag,{value:"Module"})),V_=Array.from(""),X3=V_.reduce((r,e,t)=>(r[t]=e,r),[]),eU=V_.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]);function tU(r){return r.reduce((e,t)=>(e+=X3[t],e),"")}function rU(r){const e=[];for(const t of r){const n=eU[t.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}const nU=Ug({prefix:"",name:"base256emoji",encode:tU,decode:rU}),sU=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:nU},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const qE={...A3,..._3,...I3,...x3,...O3,...j3,...q3,...G3,...Z3,...sU};function W_(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}const VE=W_("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),Lm=W_("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);const e=z_(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),G_={utf8:VE,"utf-8":VE,hex:qE.base16,latin1:Lm,ascii:Lm,binary:Lm,...qE};function $n(r,e="utf8"){const t=G_[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r,"utf8"):t.decoder.decode(`${t.prefix}${r}`)}function Jr(r,e="utf8"){const t=G_[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString("utf8"):t.encoder.encode(r).substring(1)}const iU={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe",batchFetchMessages:"waku_batchFetchMessages"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe",batchFetchMessages:"irn_batchFetchMessages"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe",batchFetchMessages:"iridium_batchFetchMessages"}};var oU={};const aU=":";function fl(r){const[e,t]=r.split(aU);return{namespace:e,reference:t}}function K_(r,e){return r.includes(":")?[r]:e.chains||[]}var cU=Object.defineProperty,lU=Object.defineProperties,uU=Object.getOwnPropertyDescriptors,WE=Object.getOwnPropertySymbols,hU=Object.prototype.hasOwnProperty,dU=Object.prototype.propertyIsEnumerable,GE=(r,e,t)=>e in r?cU(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,KE=(r,e)=>{for(var t in e||(e={}))hU.call(e,t)&&GE(r,t,e[t]);if(WE)for(var t of WE(e))dU.call(e,t)&&GE(r,t,e[t]);return r},fU=(r,e)=>lU(r,uU(e));const pU="ReactNative",wn={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},gU="js";function Hp(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Fo(){return!lf()&&!!Ob()&&navigator.product===pU}function mU(){return Fo()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="android"}function yU(){return Fo()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="ios"}function hf(){return!Hp()&&!!Ob()&&!!lf()}function df(){return Fo()?wn.reactNative:Hp()?wn.node:hf()?wn.browser:wn.unknown}function JE(){var r;try{return Fo()&&typeof global<"u"&&typeof(global==null?void 0:global.Application)<"u"?(r=global.Application)==null?void 0:r.applicationId:void 0}catch{return}}function wU(r,e){const t=new URLSearchParams(r);for(const n of Object.keys(e).sort())if(e.hasOwnProperty(n)){const s=e[n];s!==void 0&&t.set(n,s)}return t.toString()}function bU(r){var e,t;const n=J_();try{return r!=null&&r.url&&n.url&&r.url!==n.url&&(console.warn(`The configured WalletConnect 'metadata.url':${r.url} differs from the actual page url:${n.url}. This is probably unintended and can lead to issues.`),r.url=n.url),(e=r==null?void 0:r.icons)!=null&&e.length&&r.icons.length>0&&(r.icons=r.icons.filter(s=>s!=="")),fU(KE(KE({},n),r),{url:(r==null?void 0:r.url)||n.url,name:(r==null?void 0:r.name)||n.name,description:(r==null?void 0:r.description)||n.description,icons:(t=r==null?void 0:r.icons)!=null&&t.length&&r.icons.length>0?r.icons:n.icons})}catch(s){return console.warn("Error populating app metadata",s),r||n}}function J_(){return x_()||{name:"",description:"",url:"",icons:[""]}}function EU(){if(df()===wn.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:t,Version:n}=global.Platform;return[t,n].join("-")}const r=rk();if(r===null)return"unknown";const e=r.os?r.os.replace(" ","").toLowerCase():"unknown";return r.type==="browser"?[e,r.name,r.version].join("-"):[e,r.version].join("-")}function vU(){var r;const e=df();return e===wn.browser?[e,((r=S_())==null?void 0:r.host)||"unknown"].join(":"):e}function Y_(r,e,t){const n=EU(),s=vU();return[[r,e].join("-"),[gU,t].join("-"),n,s].join("/")}function AU({protocol:r,version:e,relayUrl:t,sdkVersion:n,auth:s,projectId:i,useOnCloseEvent:o,bundleId:a,packageName:c}){const l=t.split("?"),u=Y_(r,e,n),h={auth:s,ua:u,projectId:i,useOnCloseEvent:o,packageName:c||void 0,bundleId:a||void 0},d=wU(l[1]||"",h);return l[0]+"?"+d}function pa(r,e){return r.filter(t=>e.includes(t)).length===r.length}function Qy(r){return Object.fromEntries(r.entries())}function Zy(r){return new Map(Object.entries(r))}function ta(r=X.FIVE_MINUTES,e){const t=X.toMiliseconds(r||X.FIVE_MINUTES);let n,s,i,o;return{resolve:a=>{i&&n&&(clearTimeout(i),n(a),o=Promise.resolve(a))},reject:a=>{i&&s&&(clearTimeout(i),s(a))},done:()=>new Promise((a,c)=>{if(o)return a(o);i=setTimeout(()=>{const l=new Error(e);o=Promise.reject(l),c(l)},t),n=a,s=c})}}function Io(r,e,t){return new Promise(async(n,s)=>{const i=setTimeout(()=>s(new Error(t)),e);try{const o=await r;n(o)}catch(o){s(o)}clearTimeout(i)})}function Q_(r,e){if(typeof e=="string"&&e.startsWith(`${r}:`))return e;if(r.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(r.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${r}`)}function CU(r){return Q_("topic",r)}function _U(r){return Q_("id",r)}function Z_(r){const[e,t]=r.split(":"),n={id:void 0,topic:void 0};if(e==="topic"&&typeof t=="string")n.topic=t;else if(e==="id"&&Number.isInteger(Number(t)))n.id=Number(t);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${t}`);return n}function Ht(r,e){return X.fromMiliseconds(Date.now()+X.toMiliseconds(r))}function no(r){return Date.now()>=X.toMiliseconds(r)}function et(r,e){return`${r}${e?`:${e}`:""}`}function gp(r=[],e=[]){return[...new Set([...r,...e])]}async function NU({id:r,topic:e,wcDeepLink:t}){var n;try{if(!t)return;const s=typeof t=="string"?JSON.parse(t):t,i=s==null?void 0:s.href;if(typeof i!="string")return;const o=IU(i,r,e),a=df();if(a===wn.browser){if(!((n=lf())!=null&&n.hasFocus())){console.warn("Document does not have focus, skipping deeplink.");return}SU(o)}else a===wn.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(o)}catch(s){console.error(s)}}function IU(r,e,t){const n=`requestId=${e}&sessionTopic=${t}`;r.endsWith("/")&&(r=r.slice(0,-1));let s=`${r}`;if(r.startsWith("https://t.me")){const i=r.includes("?")?"&startapp=":"?startapp=";s=`${s}${i}${OU(n,!0)}`}else s=`${s}/wc?${n}`;return s}function SU(r){let e="_self";PU()?e="_top":(TU()||r.startsWith("https://")||r.startsWith("http://"))&&(e="_blank"),window.open(r,e,"noreferrer noopener")}async function xU(r,e){let t="";try{if(hf()&&(t=localStorage.getItem(e),t))return t;t=await r.getItem(e)}catch(n){console.error(n)}return t}function YE(r,e){if(!r.includes(e))return null;const t=r.split(/([&,?,=])/),n=t.indexOf(e);return t[n+2]}function QE(){return typeof crypto<"u"&&crypto!=null&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,r=>{const e=Math.random()*16|0;return(r==="x"?e:e&3|8).toString(16)})}function Db(){return typeof process<"u"&&oU.IS_VITEST==="true"}function TU(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)}function PU(){try{return window.self!==window.top}catch{return!1}}function OU(r,e=!1){const t=Buffer.from(r).toString("base64");return e?t.replace(/[=]/g,""):t}function X_(r){return Buffer.from(r,"base64").toString("utf-8")}function RU(r){return new Promise(e=>setTimeout(e,r))}function Wh(r){if(!Number.isSafeInteger(r)||r<0)throw new Error("positive integer expected, got "+r)}function DU(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function ff(r,...e){if(!DU(r))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(r.length))throw new Error("Uint8Array expected of length "+e+", got length="+r.length)}function kb(r){if(typeof r!="function"||typeof r.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Wh(r.outputLen),Wh(r.blockLen)}function uu(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function eN(r,e){ff(r);const t=e.outputLen;if(r.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}const jf=BigInt(2**32-1),ZE=BigInt(32);function kU(r,e=!1){return e?{h:Number(r&jf),l:Number(r>>ZE&jf)}:{h:Number(r>>ZE&jf)|0,l:Number(r&jf)|0}}function UU(r,e=!1){let t=new Uint32Array(r.length),n=new Uint32Array(r.length);for(let s=0;s<r.length;s++){const{h:i,l:o}=kU(r[s],e);[t[s],n[s]]=[i,o]}return[t,n]}const BU=(r,e,t)=>r<<t|e>>>32-t,LU=(r,e,t)=>e<<t|r>>>32-t,$U=(r,e,t)=>e<<t-32|r>>>64-t,MU=(r,e,t)=>r<<t-32|e>>>64-t,Rc=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function FU(r){return new Uint32Array(r.buffer,r.byteOffset,Math.floor(r.byteLength/4))}function $m(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}function Es(r,e){return r<<32-e|r>>>e}const XE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function jU(r){return r<<24&4278190080|r<<8&16711680|r>>>8&65280|r>>>24&255}function ev(r){for(let e=0;e<r.length;e++)r[e]=jU(r[e])}function HU(r){if(typeof r!="string")throw new Error("utf8ToBytes expected string, got "+typeof r);return new Uint8Array(new TextEncoder().encode(r))}function hu(r){return typeof r=="string"&&(r=HU(r)),ff(r),r}function zU(...r){let e=0;for(let n=0;n<r.length;n++){const s=r[n];ff(s),e+=s.length}const t=new Uint8Array(e);for(let n=0,s=0;n<r.length;n++){const i=r[n];t.set(i,s),s+=i.length}return t}let Ub=class{clone(){return this._cloneInto()}};function tN(r){const e=n=>r().update(hu(n)).digest(),t=r();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>r(),e}function ju(r=32){if(Rc&&typeof Rc.getRandomValues=="function")return Rc.getRandomValues(new Uint8Array(r));if(Rc&&typeof Rc.randomBytes=="function")return Rc.randomBytes(r);throw new Error("crypto.getRandomValues must be defined")}const rN=[],nN=[],sN=[],qU=BigInt(0),oh=BigInt(1),VU=BigInt(2),WU=BigInt(7),GU=BigInt(256),KU=BigInt(113);for(let r=0,e=oh,t=1,n=0;r<24;r++){[t,n]=[n,(2*t+3*n)%5],rN.push(2*(5*n+t)),nN.push((r+1)*(r+2)/2%64);let s=qU;for(let i=0;i<7;i++)e=(e<<oh^(e>>WU)*KU)%GU,e&VU&&(s^=oh<<(oh<<BigInt(i))-oh);sN.push(s)}const[JU,YU]=UU(sN,!0),tv=(r,e,t)=>t>32?$U(r,e,t):BU(r,e,t),rv=(r,e,t)=>t>32?MU(r,e,t):LU(r,e,t);function QU(r,e=24){const t=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let o=0;o<10;o++)t[o]=r[o]^r[o+10]^r[o+20]^r[o+30]^r[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=t[c],u=t[c+1],h=tv(l,u,1)^t[a],d=rv(l,u,1)^t[a+1];for(let f=0;f<50;f+=10)r[o+f]^=h,r[o+f+1]^=d}let s=r[2],i=r[3];for(let o=0;o<24;o++){const a=nN[o],c=tv(s,i,a),l=rv(s,i,a),u=rN[o];s=r[u],i=r[u+1],r[u]=c,r[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)t[a]=r[o+a];for(let a=0;a<10;a++)r[o+a]^=~t[(a+2)%10]&t[(a+4)%10]}r[0]^=JU[n],r[1]^=YU[n]}t.fill(0)}let ZU=class iN extends Ub{constructor(e,t,n,s=!1,i=24){if(super(),this.blockLen=e,this.suffix=t,this.outputLen=n,this.enableXOF=s,this.rounds=i,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,Wh(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=FU(this.state)}keccak(){XE||ev(this.state32),QU(this.state32,this.rounds),XE||ev(this.state32),this.posOut=0,this.pos=0}update(e){uu(this);const{blockLen:t,state:n}=this;e=hu(e);const s=e.length;for(let i=0;i<s;){const o=Math.min(t-this.pos,s-i);for(let a=0;a<o;a++)n[this.pos++]^=e[i++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:n,blockLen:s}=this;e[n]^=t,t&128&&n===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){uu(this,!1),ff(e),this.finish();const t=this.state,{blockLen:n}=this;for(let s=0,i=e.length;s<i;){this.posOut>=n&&this.keccak();const o=Math.min(n-this.posOut,i-s);e.set(t.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return Wh(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(eN(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:t,suffix:n,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new iN(t,n,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=n,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}};const XU=(r,e,t)=>tN(()=>new ZU(e,r,t)),e5=XU(1,136,256/8),t5="https://rpc.walletconnect.org/v1";function oN(r){const e=`Ethereum Signed Message:
${r.length}`,t=new TextEncoder().encode(e+r);return"0x"+Buffer.from(e5(t)).toString("hex")}async function r5(r,e,t,n,s,i){switch(t.t){case"eip191":return await n5(r,e,t.s);case"eip1271":return await s5(r,e,t.s,n,s,i);default:throw new Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${t.t}`)}}async function n5(r,e,t){return(await o3({hash:oN(e),signature:t})).toLowerCase()===r.toLowerCase()}async function s5(r,e,t,n,s,i){const o=fl(n);if(!o.namespace||!o.reference)throw new Error(`isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ${n}`);try{const a="0x1626ba7e",c="0000000000000000000000000000000000000000000000000000000000000040",l="0000000000000000000000000000000000000000000000000000000000000041",u=t.substring(2),h=oN(e).substring(2),d=a+h+c+l+u,f=await fetch(`${i||t5}/?chainId=${n}&projectId=${s}`,{method:"POST",body:JSON.stringify({id:i5(),jsonrpc:"2.0",method:"eth_call",params:[{to:r,data:d},"latest"]})}),{result:g}=await f.json();return g?g.slice(0,a.length).toLowerCase()===a.toLowerCase():!1}catch(a){return console.error("isValidEip1271Signature: ",a),!1}}function i5(){return Date.now()+Math.floor(Math.random()*1e3)}function o5(r){const e=atob(r),t=new Uint8Array(e.length);for(let o=0;o<e.length;o++)t[o]=e.charCodeAt(o);const n=t[0];if(n===0)throw new Error("No signatures found");const s=1+n*64;if(t.length<s)throw new Error("Transaction data too short for claimed signature count");if(t.length<100)throw new Error("Transaction too short");const i=Buffer.from(r,"base64").slice(1,65);return H_.encode(i)}var a5=Object.defineProperty,c5=Object.defineProperties,l5=Object.getOwnPropertyDescriptors,nv=Object.getOwnPropertySymbols,u5=Object.prototype.hasOwnProperty,h5=Object.prototype.propertyIsEnumerable,sv=(r,e,t)=>e in r?a5(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,d5=(r,e)=>{for(var t in e||(e={}))u5.call(e,t)&&sv(r,t,e[t]);if(nv)for(var t of nv(e))h5.call(e,t)&&sv(r,t,e[t]);return r},f5=(r,e)=>c5(r,l5(e));const p5="did:pkh:",Bb=r=>r==null?void 0:r.split(":"),g5=r=>{const e=r&&Bb(r);if(e)return r.includes(p5)?e[3]:e[1]},Xy=r=>{const e=r&&Bb(r);if(e)return e[2]+":"+e[3]},zp=r=>{const e=r&&Bb(r);if(e)return e.pop()};async function iv(r){const{cacao:e,projectId:t}=r,{s:n,p:s}=e,i=aN(s,s.iss),o=zp(s.iss);return await r5(o,i,n,Xy(s.iss),t)}const aN=(r,e)=>{const t=`${r.domain} wants you to sign in with your Ethereum account:`,n=zp(e);if(!r.aud&&!r.uri)throw new Error("Either `aud` or `uri` is required to construct the message");let s=r.statement||void 0;const i=`URI: ${r.aud||r.uri}`,o=`Version: ${r.version}`,a=`Chain ID: ${g5(e)}`,c=`Nonce: ${r.nonce}`,l=`Issued At: ${r.iat}`,u=r.exp?`Expiration Time: ${r.exp}`:void 0,h=r.nbf?`Not Before: ${r.nbf}`:void 0,d=r.requestId?`Request ID: ${r.requestId}`:void 0,f=r.resources?`Resources:${r.resources.map(p=>`
- ${p}`).join("")}`:void 0,g=mp(r.resources);if(g){const p=Gh(g);s=_5(s,p)}return[t,n,"",s,"",i,o,a,c,l,u,h,d,f].filter(p=>p!=null).join(`
`)};function m5(r){return Buffer.from(JSON.stringify(r)).toString("base64")}function y5(r){return JSON.parse(Buffer.from(r,"base64").toString("utf-8"))}function tc(r){if(!r)throw new Error("No recap provided, value is undefined");if(!r.att)throw new Error("No `att` property found");const e=Object.keys(r.att);if(!(e!=null&&e.length))throw new Error("No resources found in `att` property");e.forEach(t=>{const n=r.att[t];if(Array.isArray(n))throw new Error(`Resource must be an object: ${t}`);if(typeof n!="object")throw new Error(`Resource must be an object: ${t}`);if(!Object.keys(n).length)throw new Error(`Resource object is empty: ${t}`);Object.keys(n).forEach(s=>{const i=n[s];if(!Array.isArray(i))throw new Error(`Ability limits ${s} must be an array of objects, found: ${i}`);if(!i.length)throw new Error(`Value of ${s} is empty array, must be an array with objects`);i.forEach(o=>{if(typeof o!="object")throw new Error(`Ability limits (${s}) must be an array of objects, found: ${o}`)})})})}function w5(r,e,t,n={}){return t==null||t.sort((s,i)=>s.localeCompare(i)),{att:{[r]:b5(e,t,n)}}}function b5(r,e,t={}){e=e==null?void 0:e.sort((s,i)=>s.localeCompare(i));const n=e.map(s=>({[`${r}/${s}`]:[t]}));return Object.assign({},...n)}function cN(r){return tc(r),`urn:recap:${m5(r).replace(/=/g,"")}`}function Gh(r){const e=y5(r.replace("urn:recap:",""));return tc(e),e}function E5(r,e,t){const n=w5(r,e,t);return cN(n)}function v5(r){return r&&r.includes("urn:recap:")}function A5(r,e){const t=Gh(r),n=Gh(e),s=C5(t,n);return cN(s)}function C5(r,e){tc(r),tc(e);const t=Object.keys(r.att).concat(Object.keys(e.att)).sort((s,i)=>s.localeCompare(i)),n={att:{}};return t.forEach(s=>{var i,o;Object.keys(((i=r.att)==null?void 0:i[s])||{}).concat(Object.keys(((o=e.att)==null?void 0:o[s])||{})).sort((a,c)=>a.localeCompare(c)).forEach(a=>{var c,l;n.att[s]=f5(d5({},n.att[s]),{[a]:((c=r.att[s])==null?void 0:c[a])||((l=e.att[s])==null?void 0:l[a])})})}),n}function _5(r="",e){tc(e);const t="I further authorize the stated URI to perform the following actions on my behalf: ";if(r.includes(t))return r;const n=[];let s=0;Object.keys(e.att).forEach(a=>{const c=Object.keys(e.att[a]).map(h=>({ability:h.split("/")[0],action:h.split("/")[1]}));c.sort((h,d)=>h.action.localeCompare(d.action));const l={};c.forEach(h=>{l[h.ability]||(l[h.ability]=[]),l[h.ability].push(h.action)});const u=Object.keys(l).map(h=>(s++,`(${s}) '${h}': '${l[h].join("', '")}' for '${a}'.`));n.push(u.join(", ").replace(".,","."))});const i=n.join(" "),o=`${t}${i}`;return`${r?r+" ":""}${o}`}function ov(r){var e;const t=Gh(r);tc(t);const n=(e=t.att)==null?void 0:e.eip155;return n?Object.keys(n).map(s=>s.split("/")[1]):[]}function av(r){const e=Gh(r);tc(e);const t=[];return Object.values(e.att).forEach(n=>{Object.values(n).forEach(s=>{var i;(i=s==null?void 0:s[0])!=null&&i.chains&&t.push(s[0].chains)})}),[...new Set(t.flat())]}function mp(r){if(!r)return;const e=r==null?void 0:r[r.length-1];return v5(e)?e:void 0}function Mm(r){if(!Number.isSafeInteger(r)||r<0)throw new Error("positive integer expected, got "+r)}function lN(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function mn(r,...e){if(!lN(r))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(r.length))throw new Error("Uint8Array expected of length "+e+", got length="+r.length)}function cv(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function N5(r,e){mn(r);const t=e.outputLen;if(r.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}function lv(r){if(typeof r!="boolean")throw new Error(`boolean expected, not ${r}`)}const xo=r=>new Uint32Array(r.buffer,r.byteOffset,Math.floor(r.byteLength/4)),I5=r=>new DataView(r.buffer,r.byteOffset,r.byteLength),S5=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!S5)throw new Error("Non little-endian hardware is not supported");function x5(r){if(typeof r!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(r))}function ew(r){if(typeof r=="string")r=x5(r);else if(lN(r))r=tw(r);else throw new Error("Uint8Array expected, got "+typeof r);return r}function T5(r,e){if(e==null||typeof e!="object")throw new Error("options must be defined");return Object.assign(r,e)}function P5(r,e){if(r.length!==e.length)return!1;let t=0;for(let n=0;n<r.length;n++)t|=r[n]^e[n];return t===0}const O5=(r,e)=>{function t(n,...s){if(mn(n),r.nonceLength!==void 0){const l=s[0];if(!l)throw new Error("nonce / iv required");r.varSizeNonce?mn(l):mn(l,r.nonceLength)}const i=r.tagLength;i&&s[1]!==void 0&&mn(s[1]);const o=e(n,...s),a=(l,u)=>{if(u!==void 0){if(l!==2)throw new Error("cipher output not supported");mn(u)}};let c=!1;return{encrypt(l,u){if(c)throw new Error("cannot encrypt() twice with same key + nonce");return c=!0,mn(l),a(o.encrypt.length,u),o.encrypt(l,u)},decrypt(l,u){if(mn(l),i&&l.length<i)throw new Error("invalid ciphertext length: smaller than tagLength="+i);return a(o.decrypt.length,u),o.decrypt(l,u)}}}return Object.assign(t,r),t};function uv(r,e,t=!0){if(e===void 0)return new Uint8Array(r);if(e.length!==r)throw new Error("invalid output length, expected "+r+", got: "+e.length);if(t&&!R5(e))throw new Error("invalid output, must be aligned");return e}function hv(r,e,t,n){if(typeof r.setBigUint64=="function")return r.setBigUint64(e,t,n);const s=BigInt(32),i=BigInt(4294967295),o=Number(t>>s&i),a=Number(t&i);r.setUint32(e+4,o,n),r.setUint32(e+0,a,n)}function R5(r){return r.byteOffset%4===0}function tw(r){return Uint8Array.from(r)}function du(...r){for(let e=0;e<r.length;e++)r[e].fill(0)}const uN=r=>Uint8Array.from(r.split("").map(e=>e.charCodeAt(0))),D5=uN("expand 16-byte k"),k5=uN("expand 32-byte k"),U5=xo(D5),B5=xo(k5);function We(r,e){return r<<e|r>>>32-e}function rw(r){return r.byteOffset%4===0}const Hf=64,L5=16,hN=2**32-1,dv=new Uint32Array;function $5(r,e,t,n,s,i,o,a){const c=s.length,l=new Uint8Array(Hf),u=xo(l),h=rw(s)&&rw(i),d=h?xo(s):dv,f=h?xo(i):dv;for(let g=0;g<c;o++){if(r(e,t,n,u,o,a),o>=hN)throw new Error("arx: counter overflow");const p=Math.min(Hf,c-g);if(h&&p===Hf){const m=g/4;if(g%4!==0)throw new Error("arx: invalid block position");for(let w=0,A;w<L5;w++)A=m+w,f[A]=d[A]^u[w];g+=Hf;continue}for(let m=0,w;m<p;m++)w=g+m,i[w]=s[w]^l[m];g+=p}}function M5(r,e){const{allowShortKeys:t,extendNonceFn:n,counterLength:s,counterRight:i,rounds:o}=T5({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if(typeof r!="function")throw new Error("core must be a function");return Mm(s),Mm(o),lv(i),lv(t),(a,c,l,u,h=0)=>{mn(a),mn(c),mn(l);const d=l.length;if(u===void 0&&(u=new Uint8Array(d)),mn(u),Mm(h),h<0||h>=hN)throw new Error("arx: counter overflow");if(u.length<d)throw new Error(`arx: output (${u.length}) is shorter than data (${d})`);const f=[];let g=a.length,p,m;if(g===32)f.push(p=tw(a)),m=B5;else if(g===16&&t)p=new Uint8Array(32),p.set(a),p.set(a,16),m=U5,f.push(p);else throw new Error(`arx: invalid 32-byte key, got length=${g}`);rw(c)||f.push(c=tw(c));const w=xo(p);if(n){if(c.length!==24)throw new Error("arx: extended nonce must be 24 bytes");n(m,w,xo(c.subarray(0,16)),w),c=c.subarray(16)}const A=16-s;if(A!==c.length)throw new Error(`arx: nonce must be ${A} or 16 bytes`);if(A!==12){const N=new Uint8Array(12);N.set(c,i?0:12-c.length),c=N,f.push(c)}const v=xo(c);return $5(r,m,w,v,l,u,h,o),du(...f),u}}const rr=(r,e)=>r[e++]&255|(r[e++]&255)<<8;class F5{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,e=ew(e),mn(e,32);const t=rr(e,0),n=rr(e,2),s=rr(e,4),i=rr(e,6),o=rr(e,8),a=rr(e,10),c=rr(e,12),l=rr(e,14);this.r[0]=t&8191,this.r[1]=(t>>>13|n<<3)&8191,this.r[2]=(n>>>10|s<<6)&7939,this.r[3]=(s>>>7|i<<9)&8191,this.r[4]=(i>>>4|o<<12)&255,this.r[5]=o>>>1&8190,this.r[6]=(o>>>14|a<<2)&8191,this.r[7]=(a>>>11|c<<5)&8065,this.r[8]=(c>>>8|l<<8)&8191,this.r[9]=l>>>5&127;for(let u=0;u<8;u++)this.pad[u]=rr(e,16+2*u)}process(e,t,n=!1){const s=n?0:2048,{h:i,r:o}=this,a=o[0],c=o[1],l=o[2],u=o[3],h=o[4],d=o[5],f=o[6],g=o[7],p=o[8],m=o[9],w=rr(e,t+0),A=rr(e,t+2),v=rr(e,t+4),N=rr(e,t+6),T=rr(e,t+8),P=rr(e,t+10),D=rr(e,t+12),U=rr(e,t+14);let x=i[0]+(w&8191),j=i[1]+((w>>>13|A<<3)&8191),$=i[2]+((A>>>10|v<<6)&8191),H=i[3]+((v>>>7|N<<9)&8191),Z=i[4]+((N>>>4|T<<12)&8191),z=i[5]+(T>>>1&8191),b=i[6]+((T>>>14|P<<2)&8191),E=i[7]+((P>>>11|D<<5)&8191),O=i[8]+((D>>>8|U<<8)&8191),B=i[9]+(U>>>5|s),k=0,M=k+x*a+j*(5*m)+$*(5*p)+H*(5*g)+Z*(5*f);k=M>>>13,M&=8191,M+=z*(5*d)+b*(5*h)+E*(5*u)+O*(5*l)+B*(5*c),k+=M>>>13,M&=8191;let G=k+x*c+j*a+$*(5*m)+H*(5*p)+Z*(5*g);k=G>>>13,G&=8191,G+=z*(5*f)+b*(5*d)+E*(5*h)+O*(5*u)+B*(5*l),k+=G>>>13,G&=8191;let J=k+x*l+j*c+$*a+H*(5*m)+Z*(5*p);k=J>>>13,J&=8191,J+=z*(5*g)+b*(5*f)+E*(5*d)+O*(5*h)+B*(5*u),k+=J>>>13,J&=8191;let oe=k+x*u+j*l+$*c+H*a+Z*(5*m);k=oe>>>13,oe&=8191,oe+=z*(5*p)+b*(5*g)+E*(5*f)+O*(5*d)+B*(5*h),k+=oe>>>13,oe&=8191;let Q=k+x*h+j*u+$*l+H*c+Z*a;k=Q>>>13,Q&=8191,Q+=z*(5*m)+b*(5*p)+E*(5*g)+O*(5*f)+B*(5*d),k+=Q>>>13,Q&=8191;let ge=k+x*d+j*h+$*u+H*l+Z*c;k=ge>>>13,ge&=8191,ge+=z*a+b*(5*m)+E*(5*p)+O*(5*g)+B*(5*f),k+=ge>>>13,ge&=8191;let Oe=k+x*f+j*d+$*h+H*u+Z*l;k=Oe>>>13,Oe&=8191,Oe+=z*c+b*a+E*(5*m)+O*(5*p)+B*(5*g),k+=Oe>>>13,Oe&=8191;let $e=k+x*g+j*f+$*d+H*h+Z*u;k=$e>>>13,$e&=8191,$e+=z*l+b*c+E*a+O*(5*m)+B*(5*p),k+=$e>>>13,$e&=8191;let Me=k+x*p+j*g+$*f+H*d+Z*h;k=Me>>>13,Me&=8191,Me+=z*u+b*l+E*c+O*a+B*(5*m),k+=Me>>>13,Me&=8191;let Ne=k+x*m+j*p+$*g+H*f+Z*d;k=Ne>>>13,Ne&=8191,Ne+=z*h+b*u+E*l+O*c+B*a,k+=Ne>>>13,Ne&=8191,k=(k<<2)+k|0,k=k+M|0,M=k&8191,k=k>>>13,G+=k,i[0]=M,i[1]=G,i[2]=J,i[3]=oe,i[4]=Q,i[5]=ge,i[6]=Oe,i[7]=$e,i[8]=Me,i[9]=Ne}finalize(){const{h:e,pad:t}=this,n=new Uint16Array(10);let s=e[1]>>>13;e[1]&=8191;for(let a=2;a<10;a++)e[a]+=s,s=e[a]>>>13,e[a]&=8191;e[0]+=s*5,s=e[0]>>>13,e[0]&=8191,e[1]+=s,s=e[1]>>>13,e[1]&=8191,e[2]+=s,n[0]=e[0]+5,s=n[0]>>>13,n[0]&=8191;for(let a=1;a<10;a++)n[a]=e[a]+s,s=n[a]>>>13,n[a]&=8191;n[9]-=8192;let i=(s^1)-1;for(let a=0;a<10;a++)n[a]&=i;i=~i;for(let a=0;a<10;a++)e[a]=e[a]&i|n[a];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let o=e[0]+t[0];e[0]=o&65535;for(let a=1;a<8;a++)o=(e[a]+t[a]|0)+(o>>>16)|0,e[a]=o&65535;du(n)}update(e){cv(this);const{buffer:t,blockLen:n}=this;e=ew(e);const s=e.length;for(let i=0;i<s;){const o=Math.min(n-this.pos,s-i);if(o===n){for(;n<=s-i;i+=n)this.process(e,i);continue}t.set(e.subarray(i,i+o),this.pos),this.pos+=o,i+=o,this.pos===n&&(this.process(t,0,!1),this.pos=0)}return this}destroy(){du(this.h,this.r,this.buffer,this.pad)}digestInto(e){cv(this),N5(e,this),this.finished=!0;const{buffer:t,h:n}=this;let{pos:s}=this;if(s){for(t[s++]=1;s<16;s++)t[s]=0;this.process(t,0,!0)}this.finalize();let i=0;for(let o=0;o<8;o++)e[i++]=n[o]>>>0,e[i++]=n[o]>>>8;return e}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}}function j5(r){const e=(n,s)=>r(s).update(ew(n)).digest(),t=r(new Uint8Array(32));return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=n=>r(n),e}const H5=j5(r=>new F5(r));function z5(r,e,t,n,s,i=20){let o=r[0],a=r[1],c=r[2],l=r[3],u=e[0],h=e[1],d=e[2],f=e[3],g=e[4],p=e[5],m=e[6],w=e[7],A=s,v=t[0],N=t[1],T=t[2],P=o,D=a,U=c,x=l,j=u,$=h,H=d,Z=f,z=g,b=p,E=m,O=w,B=A,k=v,M=N,G=T;for(let oe=0;oe<i;oe+=2)P=P+j|0,B=We(B^P,16),z=z+B|0,j=We(j^z,12),P=P+j|0,B=We(B^P,8),z=z+B|0,j=We(j^z,7),D=D+$|0,k=We(k^D,16),b=b+k|0,$=We($^b,12),D=D+$|0,k=We(k^D,8),b=b+k|0,$=We($^b,7),U=U+H|0,M=We(M^U,16),E=E+M|0,H=We(H^E,12),U=U+H|0,M=We(M^U,8),E=E+M|0,H=We(H^E,7),x=x+Z|0,G=We(G^x,16),O=O+G|0,Z=We(Z^O,12),x=x+Z|0,G=We(G^x,8),O=O+G|0,Z=We(Z^O,7),P=P+$|0,G=We(G^P,16),E=E+G|0,$=We($^E,12),P=P+$|0,G=We(G^P,8),E=E+G|0,$=We($^E,7),D=D+H|0,B=We(B^D,16),O=O+B|0,H=We(H^O,12),D=D+H|0,B=We(B^D,8),O=O+B|0,H=We(H^O,7),U=U+Z|0,k=We(k^U,16),z=z+k|0,Z=We(Z^z,12),U=U+Z|0,k=We(k^U,8),z=z+k|0,Z=We(Z^z,7),x=x+j|0,M=We(M^x,16),b=b+M|0,j=We(j^b,12),x=x+j|0,M=We(M^x,8),b=b+M|0,j=We(j^b,7);let J=0;n[J++]=o+P|0,n[J++]=a+D|0,n[J++]=c+U|0,n[J++]=l+x|0,n[J++]=u+j|0,n[J++]=h+$|0,n[J++]=d+H|0,n[J++]=f+Z|0,n[J++]=g+z|0,n[J++]=p+b|0,n[J++]=m+E|0,n[J++]=w+O|0,n[J++]=A+B|0,n[J++]=v+k|0,n[J++]=N+M|0,n[J++]=T+G|0}const q5=M5(z5,{counterRight:!1,counterLength:4,allowShortKeys:!1}),V5=new Uint8Array(16),fv=(r,e)=>{r.update(e);const t=e.length%16;t&&r.update(V5.subarray(t))},W5=new Uint8Array(32);function pv(r,e,t,n,s){const i=r(e,t,W5),o=H5.create(i);s&&fv(o,s),fv(o,n);const a=new Uint8Array(16),c=I5(a);hv(c,0,BigInt(s?s.length:0),!0),hv(c,8,BigInt(n.length),!0),o.update(a);const l=o.digest();return du(i,a),l}const G5=r=>(e,t,n)=>({encrypt(s,i){const o=s.length;i=uv(o+16,i,!1),i.set(s);const a=i.subarray(0,-16);r(e,t,a,a,1);const c=pv(r,e,t,a,n);return i.set(c,o),du(c),i},decrypt(s,i){i=uv(s.length-16,i,!1);const o=s.subarray(0,-16),a=s.subarray(-16),c=pv(r,e,t,o,n);if(!P5(a,c))throw new Error("invalid tag");return i.set(s.subarray(0,-16)),r(e,t,i,i,1),du(c),i}}),dN=O5({blockSize:64,nonceLength:12,tagLength:16},G5(q5));let fN=class extends Ub{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,kb(e);const n=hu(t);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,i=new Uint8Array(s);i.set(n.length>s?e.create().update(n).digest():n);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=e.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),i.fill(0)}update(e){return uu(this),this.iHash.update(e),this}digestInto(e){uu(this),ff(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:n,finished:s,destroyed:i,blockLen:o,outputLen:a}=this;return e=e,e.finished=s,e.destroyed=i,e.blockLen=o,e.outputLen=a,e.oHash=t._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const Bg=(r,e,t)=>new fN(r,e).update(t).digest();Bg.create=(r,e)=>new fN(r,e);function K5(r,e,t){return kb(r),t===void 0&&(t=new Uint8Array(r.outputLen)),Bg(r,hu(t),hu(e))}const Fm=new Uint8Array([0]),gv=new Uint8Array;function J5(r,e,t,n=32){if(kb(r),Wh(n),n>255*r.outputLen)throw new Error("Length should be <= 255*HashLen");const s=Math.ceil(n/r.outputLen);t===void 0&&(t=gv);const i=new Uint8Array(s*r.outputLen),o=Bg.create(r,e),a=o._cloneInto(),c=new Uint8Array(o.outputLen);for(let l=0;l<s;l++)Fm[0]=l+1,a.update(l===0?gv:c).update(t).update(Fm).digestInto(c),i.set(c,r.outputLen*l),o._cloneInto(a);return o.destroy(),a.destroy(),c.fill(0),Fm.fill(0),i.slice(0,n)}const Y5=(r,e,t,n,s)=>J5(r,K5(r,e,t),n,s);function Q5(r,e,t,n){if(typeof r.setBigUint64=="function")return r.setBigUint64(e,t,n);const s=BigInt(32),i=BigInt(4294967295),o=Number(t>>s&i),a=Number(t&i),c=n?4:0,l=n?0:4;r.setUint32(e+c,o,n),r.setUint32(e+l,a,n)}function Z5(r,e,t){return r&e^~r&t}function X5(r,e,t){return r&e^r&t^e&t}let e8=class extends Ub{constructor(e,t,n,s){super(),this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=$m(this.buffer)}update(e){uu(this);const{view:t,buffer:n,blockLen:s}=this;e=hu(e);const i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=$m(e);for(;s<=i-o;o+=s)this.process(c,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){uu(this),eN(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:s,isLE:i}=this;let{pos:o}=this;t[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(n,0),o=0);for(let h=o;h<s;h++)t[h]=0;Q5(n,s-8,BigInt(this.length*8),i),this.process(n,0);const a=$m(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<l;h++)a.setUint32(4*h,u[h],i)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:s,finished:i,destroyed:o,pos:a}=this;return e.length=s,e.pos=a,e.finished=i,e.destroyed=o,s%t&&e.buffer.set(n),e}};const t8=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Ki=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Ji=new Uint32Array(64);class r8 extends e8{constructor(){super(64,32,8,!1),this.A=Ki[0]|0,this.B=Ki[1]|0,this.C=Ki[2]|0,this.D=Ki[3]|0,this.E=Ki[4]|0,this.F=Ki[5]|0,this.G=Ki[6]|0,this.H=Ki[7]|0}get(){const{A:e,B:t,C:n,D:s,E:i,F:o,G:a,H:c}=this;return[e,t,n,s,i,o,a,c]}set(e,t,n,s,i,o,a,c){this.A=e|0,this.B=t|0,this.C=n|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,t){for(let h=0;h<16;h++,t+=4)Ji[h]=e.getUint32(t,!1);for(let h=16;h<64;h++){const d=Ji[h-15],f=Ji[h-2],g=Es(d,7)^Es(d,18)^d>>>3,p=Es(f,17)^Es(f,19)^f>>>10;Ji[h]=p+Ji[h-7]+g+Ji[h-16]|0}let{A:n,B:s,C:i,D:o,E:a,F:c,G:l,H:u}=this;for(let h=0;h<64;h++){const d=Es(a,6)^Es(a,11)^Es(a,25),f=u+d+Z5(a,c,l)+t8[h]+Ji[h]|0,g=(Es(n,2)^Es(n,13)^Es(n,22))+X5(n,s,i)|0;u=l,l=c,c=a,a=o+f|0,o=i,i=s,s=n,n=f+g|0}n=n+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(n,s,i,o,a,c,l,u)}roundClean(){Ji.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const pf=tN(()=>new r8);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Lg=BigInt(0),$g=BigInt(1),n8=BigInt(2);function rc(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function gf(r){if(!rc(r))throw new Error("Uint8Array expected")}function fu(r,e){if(typeof e!="boolean")throw new Error(r+" boolean expected, got "+e)}const s8=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));function pu(r){gf(r);let e="";for(let t=0;t<r.length;t++)e+=s8[r[t]];return e}function il(r){const e=r.toString(16);return e.length&1?"0"+e:e}function Lb(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);return r===""?Lg:BigInt("0x"+r)}const si={_0:48,_9:57,A:65,F:70,a:97,f:102};function mv(r){if(r>=si._0&&r<=si._9)return r-si._0;if(r>=si.A&&r<=si.F)return r-(si.A-10);if(r>=si.a&&r<=si.f)return r-(si.a-10)}function gu(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);const e=r.length,t=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(t);for(let s=0,i=0;s<t;s++,i+=2){const o=mv(r.charCodeAt(i)),a=mv(r.charCodeAt(i+1));if(o===void 0||a===void 0){const c=r[i]+r[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}n[s]=o*16+a}return n}function Ha(r){return Lb(pu(r))}function Kh(r){return gf(r),Lb(pu(Uint8Array.from(r).reverse()))}function mu(r,e){return gu(r.toString(16).padStart(e*2,"0"))}function Mg(r,e){return mu(r,e).reverse()}function i8(r){return gu(il(r))}function gn(r,e,t){let n;if(typeof e=="string")try{n=gu(e)}catch(i){throw new Error(r+" must be hex string or Uint8Array, cause: "+i)}else if(rc(e))n=Uint8Array.from(e);else throw new Error(r+" must be hex string or Uint8Array");const s=n.length;if(typeof t=="number"&&s!==t)throw new Error(r+" of length "+t+" expected, got "+s);return n}function Jh(...r){let e=0;for(let n=0;n<r.length;n++){const s=r[n];gf(s),e+=s.length}const t=new Uint8Array(e);for(let n=0,s=0;n<r.length;n++){const i=r[n];t.set(i,s),s+=i.length}return t}function o8(r,e){if(r.length!==e.length)return!1;let t=0;for(let n=0;n<r.length;n++)t|=r[n]^e[n];return t===0}function a8(r){if(typeof r!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(r))}const jm=r=>typeof r=="bigint"&&Lg<=r;function Fg(r,e,t){return jm(r)&&jm(e)&&jm(t)&&e<=r&&r<t}function Ri(r,e,t,n){if(!Fg(e,t,n))throw new Error("expected valid "+r+": "+t+" <= n < "+n+", got "+e)}function pN(r){let e;for(e=0;r>Lg;r>>=$g,e+=1);return e}function c8(r,e){return r>>BigInt(e)&$g}function l8(r,e,t){return r|(t?$g:Lg)<<BigInt(e)}const $b=r=>(n8<<BigInt(r-1))-$g,Hm=r=>new Uint8Array(r),yv=r=>Uint8Array.from(r);function gN(r,e,t){if(typeof r!="number"||r<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof t!="function")throw new Error("hmacFn must be a function");let n=Hm(r),s=Hm(r),i=0;const o=()=>{n.fill(1),s.fill(0),i=0},a=(...u)=>t(s,n,...u),c=(u=Hm())=>{s=a(yv([0]),u),n=a(),u.length!==0&&(s=a(yv([1]),u),n=a())},l=()=>{if(i++>=1e3)throw new Error("drbg: tried 1000 values");let u=0;const h=[];for(;u<e;){n=a();const d=n.slice();h.push(d),u+=n.length}return Jh(...h)};return(u,h)=>{o(),c(u);let d;for(;!(d=h(l()));)c();return o(),d}}const u8={bigint:r=>typeof r=="bigint",function:r=>typeof r=="function",boolean:r=>typeof r=="boolean",string:r=>typeof r=="string",stringOrUint8Array:r=>typeof r=="string"||rc(r),isSafeInteger:r=>Number.isSafeInteger(r),array:r=>Array.isArray(r),field:(r,e)=>e.Fp.isValid(r),hash:r=>typeof r=="function"&&Number.isSafeInteger(r.outputLen)};function Hu(r,e,t={}){const n=(s,i,o)=>{const a=u8[i];if(typeof a!="function")throw new Error("invalid validator function");const c=r[s];if(!(o&&c===void 0)&&!a(c,r))throw new Error("param "+String(s)+" is invalid. Expected "+i+", got "+c)};for(const[s,i]of Object.entries(e))n(s,i,!1);for(const[s,i]of Object.entries(t))n(s,i,!0);return r}const h8=()=>{throw new Error("not implemented")};function nw(r){const e=new WeakMap;return(t,...n)=>{const s=e.get(t);if(s!==void 0)return s;const i=r(t,...n);return e.set(t,i),i}}var d8=Object.freeze({__proto__:null,isBytes:rc,abytes:gf,abool:fu,bytesToHex:pu,numberToHexUnpadded:il,hexToNumber:Lb,hexToBytes:gu,bytesToNumberBE:Ha,bytesToNumberLE:Kh,numberToBytesBE:mu,numberToBytesLE:Mg,numberToVarBytesBE:i8,ensureBytes:gn,concatBytes:Jh,equalBytes:o8,utf8ToBytes:a8,inRange:Fg,aInRange:Ri,bitLen:pN,bitGet:c8,bitSet:l8,bitMask:$b,createHmacDrbg:gN,validateObject:Hu,notImplemented:h8,memoized:nw});const er=BigInt(0),kt=BigInt(1),oa=BigInt(2),f8=BigInt(3),sw=BigInt(4),wv=BigInt(5),bv=BigInt(8);function Wr(r,e){const t=r%e;return t>=er?t:e+t}function mN(r,e,t){if(e<er)throw new Error("invalid exponent, negatives unsupported");if(t<=er)throw new Error("invalid modulus");if(t===kt)return er;let n=kt;for(;e>er;)e&kt&&(n=n*r%t),r=r*r%t,e>>=kt;return n}function Jn(r,e,t){let n=r;for(;e-- >er;)n*=n,n%=t;return n}function iw(r,e){if(r===er)throw new Error("invert: expected non-zero number");if(e<=er)throw new Error("invert: expected positive modulus, got "+e);let t=Wr(r,e),n=e,s=er,i=kt;for(;t!==er;){const o=n/t,a=n%t,c=s-i*o;n=t,t=a,s=i,i=c}if(n!==kt)throw new Error("invert: does not exist");return Wr(s,e)}function p8(r){const e=(r-kt)/oa;let t,n,s;for(t=r-kt,n=0;t%oa===er;t/=oa,n++);for(s=oa;s<r&&mN(s,e,r)!==r-kt;s++)if(s>1e3)throw new Error("Cannot find square root: likely non-prime P");if(n===1){const o=(r+kt)/sw;return function(a,c){const l=a.pow(c,o);if(!a.eql(a.sqr(l),c))throw new Error("Cannot find square root");return l}}const i=(t+kt)/oa;return function(o,a){if(o.pow(a,e)===o.neg(o.ONE))throw new Error("Cannot find square root");let c=n,l=o.pow(o.mul(o.ONE,s),t),u=o.pow(a,i),h=o.pow(a,t);for(;!o.eql(h,o.ONE);){if(o.eql(h,o.ZERO))return o.ZERO;let d=1;for(let g=o.sqr(h);d<c&&!o.eql(g,o.ONE);d++)g=o.sqr(g);const f=o.pow(l,kt<<BigInt(c-d-1));l=o.sqr(f),u=o.mul(u,f),h=o.mul(h,l),c=d}return u}}function g8(r){if(r%sw===f8){const e=(r+kt)/sw;return function(t,n){const s=t.pow(n,e);if(!t.eql(t.sqr(s),n))throw new Error("Cannot find square root");return s}}if(r%bv===wv){const e=(r-wv)/bv;return function(t,n){const s=t.mul(n,oa),i=t.pow(s,e),o=t.mul(n,i),a=t.mul(t.mul(o,oa),i),c=t.mul(o,t.sub(a,t.ONE));if(!t.eql(t.sqr(c),n))throw new Error("Cannot find square root");return c}}return p8(r)}const m8=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function y8(r){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},t=m8.reduce((n,s)=>(n[s]="function",n),e);return Hu(r,t)}function w8(r,e,t){if(t<er)throw new Error("invalid exponent, negatives unsupported");if(t===er)return r.ONE;if(t===kt)return e;let n=r.ONE,s=e;for(;t>er;)t&kt&&(n=r.mul(n,s)),s=r.sqr(s),t>>=kt;return n}function b8(r,e){const t=new Array(e.length),n=e.reduce((i,o,a)=>r.is0(o)?i:(t[a]=i,r.mul(i,o)),r.ONE),s=r.inv(n);return e.reduceRight((i,o,a)=>r.is0(o)?i:(t[a]=r.mul(i,t[a]),r.mul(i,o)),s),t}function yN(r,e){const t=e!==void 0?e:r.toString(2).length,n=Math.ceil(t/8);return{nBitLength:t,nByteLength:n}}function wN(r,e,t=!1,n={}){if(r<=er)throw new Error("invalid field: expected ORDER > 0, got "+r);const{nBitLength:s,nByteLength:i}=yN(r,e);if(i>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:r,isLE:t,BITS:s,BYTES:i,MASK:$b(s),ZERO:er,ONE:kt,create:c=>Wr(c,r),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return er<=c&&c<r},is0:c=>c===er,isOdd:c=>(c&kt)===kt,neg:c=>Wr(-c,r),eql:(c,l)=>c===l,sqr:c=>Wr(c*c,r),add:(c,l)=>Wr(c+l,r),sub:(c,l)=>Wr(c-l,r),mul:(c,l)=>Wr(c*l,r),pow:(c,l)=>w8(a,c,l),div:(c,l)=>Wr(c*iw(l,r),r),sqrN:c=>c*c,addN:(c,l)=>c+l,subN:(c,l)=>c-l,mulN:(c,l)=>c*l,inv:c=>iw(c,r),sqrt:n.sqrt||(c=>(o||(o=g8(r)),o(a,c))),invertBatch:c=>b8(a,c),cmov:(c,l,u)=>u?l:c,toBytes:c=>t?Mg(c,i):mu(c,i),fromBytes:c=>{if(c.length!==i)throw new Error("Field.fromBytes: expected "+i+" bytes, got "+c.length);return t?Kh(c):Ha(c)}});return Object.freeze(a)}function bN(r){if(typeof r!="bigint")throw new Error("field order must be bigint");const e=r.toString(2).length;return Math.ceil(e/8)}function EN(r){const e=bN(r);return e+Math.ceil(e/2)}function E8(r,e,t=!1){const n=r.length,s=bN(e),i=EN(e);if(n<16||n<i||n>1024)throw new Error("expected "+i+"-1024 bytes of input, got "+n);const o=t?Kh(r):Ha(r),a=Wr(o,e-kt)+kt;return t?Mg(a,s):mu(a,s)}const Ev=BigInt(0),zf=BigInt(1);function zm(r,e){const t=e.negate();return r?t:e}function vN(r,e){if(!Number.isSafeInteger(r)||r<=0||r>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+r)}function qm(r,e){vN(r,e);const t=Math.ceil(e/r)+1,n=2**(r-1);return{windows:t,windowSize:n}}function v8(r,e){if(!Array.isArray(r))throw new Error("array expected");r.forEach((t,n)=>{if(!(t instanceof e))throw new Error("invalid point at index "+n)})}function A8(r,e){if(!Array.isArray(r))throw new Error("array of scalars expected");r.forEach((t,n)=>{if(!e.isValid(t))throw new Error("invalid scalar at index "+n)})}const Vm=new WeakMap,AN=new WeakMap;function Wm(r){return AN.get(r)||1}function C8(r,e){return{constTimeNegate:zm,hasPrecomputes(t){return Wm(t)!==1},unsafeLadder(t,n,s=r.ZERO){let i=t;for(;n>Ev;)n&zf&&(s=s.add(i)),i=i.double(),n>>=zf;return s},precomputeWindow(t,n){const{windows:s,windowSize:i}=qm(n,e),o=[];let a=t,c=a;for(let l=0;l<s;l++){c=a,o.push(c);for(let u=1;u<i;u++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(t,n,s){const{windows:i,windowSize:o}=qm(t,e);let a=r.ZERO,c=r.BASE;const l=BigInt(2**t-1),u=2**t,h=BigInt(t);for(let d=0;d<i;d++){const f=d*o;let g=Number(s&l);s>>=h,g>o&&(g-=u,s+=zf);const p=f,m=f+Math.abs(g)-1,w=d%2!==0,A=g<0;g===0?c=c.add(zm(w,n[p])):a=a.add(zm(A,n[m]))}return{p:a,f:c}},wNAFUnsafe(t,n,s,i=r.ZERO){const{windows:o,windowSize:a}=qm(t,e),c=BigInt(2**t-1),l=2**t,u=BigInt(t);for(let h=0;h<o;h++){const d=h*a;if(s===Ev)break;let f=Number(s&c);if(s>>=u,f>a&&(f-=l,s+=zf),f===0)continue;let g=n[d+Math.abs(f)-1];f<0&&(g=g.negate()),i=i.add(g)}return i},getPrecomputes(t,n,s){let i=Vm.get(n);return i||(i=this.precomputeWindow(n,t),t!==1&&Vm.set(n,s(i))),i},wNAFCached(t,n,s){const i=Wm(t);return this.wNAF(i,this.getPrecomputes(i,t,s),n)},wNAFCachedUnsafe(t,n,s,i){const o=Wm(t);return o===1?this.unsafeLadder(t,n,i):this.wNAFUnsafe(o,this.getPrecomputes(o,t,s),n,i)},setWindowSize(t,n){vN(n,e),AN.set(t,n),Vm.delete(t)}}}function _8(r,e,t,n){if(v8(t,r),A8(n,e),t.length!==n.length)throw new Error("arrays of points and scalars must have equal length");const s=r.ZERO,i=pN(BigInt(t.length)),o=i>12?i-3:i>4?i-2:i?2:1,a=(1<<o)-1,c=new Array(a+1).fill(s),l=Math.floor((e.BITS-1)/o)*o;let u=s;for(let h=l;h>=0;h-=o){c.fill(s);for(let f=0;f<n.length;f++){const g=n[f],p=Number(g>>BigInt(h)&BigInt(a));c[p]=c[p].add(t[f])}let d=s;for(let f=c.length-1,g=s;f>0;f--)g=g.add(c[f]),d=d.add(g);if(u=u.add(d),h!==0)for(let f=0;f<o;f++)u=u.double()}return u}function CN(r){return y8(r.Fp),Hu(r,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...yN(r.n,r.nBitLength),...r,p:r.Fp.ORDER})}BigInt(0),BigInt(1),BigInt(2),BigInt(8);const Dc=BigInt(0),Gm=BigInt(1);function N8(r){return Hu(r,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...r})}function I8(r){const e=N8(r),{P:t}=e,n=A=>Wr(A,t),s=e.montgomeryBits,i=Math.ceil(s/8),o=e.nByteLength,a=e.adjustScalarBytes||(A=>A),c=e.powPminus2||(A=>mN(A,t-BigInt(2),t));function l(A,v,N){const T=n(A*(v-N));return v=n(v-T),N=n(N+T),[v,N]}const u=(e.a-BigInt(2))/BigInt(4);function h(A,v){Ri("u",A,Dc,t),Ri("scalar",v,Dc,t);const N=v,T=A;let P=Gm,D=Dc,U=A,x=Gm,j=Dc,$;for(let Z=BigInt(s-1);Z>=Dc;Z--){const z=N>>Z&Gm;j^=z,$=l(j,P,U),P=$[0],U=$[1],$=l(j,D,x),D=$[0],x=$[1],j=z;const b=P+D,E=n(b*b),O=P-D,B=n(O*O),k=E-B,M=U+x,G=U-x,J=n(G*b),oe=n(M*O),Q=J+oe,ge=J-oe;U=n(Q*Q),x=n(T*n(ge*ge)),P=n(E*B),D=n(k*(E+n(u*k)))}$=l(j,P,U),P=$[0],U=$[1],$=l(j,D,x),D=$[0],x=$[1];const H=c(D);return n(P*H)}function d(A){return Mg(n(A),i)}function f(A){const v=gn("u coordinate",A,i);return o===32&&(v[31]&=127),Kh(v)}function g(A){const v=gn("scalar",A),N=v.length;if(N!==i&&N!==o){let T=""+i+" or "+o;throw new Error("invalid scalar, expected "+T+" bytes, got "+N)}return Kh(a(v))}function p(A,v){const N=f(v),T=g(A),P=h(N,T);if(P===Dc)throw new Error("invalid private or public key received");return d(P)}const m=d(e.Gu);function w(A){return p(A,m)}return{scalarMult:p,scalarMultBase:w,getSharedSecret:(A,v)=>p(A,v),getPublicKey:A=>w(A),utils:{randomPrivateKey:()=>e.randomBytes(e.nByteLength)},GuBytes:m}}const ow=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949");BigInt(0);const S8=BigInt(1),vv=BigInt(2),x8=BigInt(3),T8=BigInt(5);BigInt(8);function P8(r){const e=BigInt(10),t=BigInt(20),n=BigInt(40),s=BigInt(80),i=ow,o=r*r%i*r%i,a=Jn(o,vv,i)*o%i,c=Jn(a,S8,i)*r%i,l=Jn(c,T8,i)*c%i,u=Jn(l,e,i)*l%i,h=Jn(u,t,i)*u%i,d=Jn(h,n,i)*h%i,f=Jn(d,s,i)*d%i,g=Jn(f,s,i)*d%i,p=Jn(g,e,i)*l%i;return{pow_p_5_8:Jn(p,vv,i)*r%i,b2:o}}function O8(r){return r[0]&=248,r[31]&=127,r[31]|=64,r}const aw=I8({P:ow,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:r=>{const e=ow,{pow_p_5_8:t,b2:n}=P8(r);return Wr(Jn(t,x8,e)*n,e)},adjustScalarBytes:O8,randomBytes:ju});function Av(r){r.lowS!==void 0&&fu("lowS",r.lowS),r.prehash!==void 0&&fu("prehash",r.prehash)}function R8(r){const e=CN(r);Hu(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:t,Fp:n,a:s}=e;if(t){if(!n.eql(s,n.ZERO))throw new Error("invalid endomorphism, can only be defined for Koblitz curves that have a=0");if(typeof t!="object"||typeof t.beta!="bigint"||typeof t.splitScalar!="function")throw new Error("invalid endomorphism, expected beta: bigint and splitScalar: function")}return Object.freeze({...e})}const{bytesToNumberBE:D8,hexToBytes:k8}=d8;class U8 extends Error{constructor(e=""){super(e)}}const di={Err:U8,_tlv:{encode:(r,e)=>{const{Err:t}=di;if(r<0||r>256)throw new t("tlv.encode: wrong tag");if(e.length&1)throw new t("tlv.encode: unpadded data");const n=e.length/2,s=il(n);if(s.length/2&128)throw new t("tlv.encode: long form length too big");const i=n>127?il(s.length/2|128):"";return il(r)+i+s+e},decode(r,e){const{Err:t}=di;let n=0;if(r<0||r>256)throw new t("tlv.encode: wrong tag");if(e.length<2||e[n++]!==r)throw new t("tlv.decode: wrong tlv");const s=e[n++],i=!!(s&128);let o=0;if(!i)o=s;else{const c=s&127;if(!c)throw new t("tlv.decode(long): indefinite length not supported");if(c>4)throw new t("tlv.decode(long): byte length is too big");const l=e.subarray(n,n+c);if(l.length!==c)throw new t("tlv.decode: length bytes not complete");if(l[0]===0)throw new t("tlv.decode(long): zero leftmost byte");for(const u of l)o=o<<8|u;if(n+=c,o<128)throw new t("tlv.decode(long): not minimal encoding")}const a=e.subarray(n,n+o);if(a.length!==o)throw new t("tlv.decode: wrong value length");return{v:a,l:e.subarray(n+o)}}},_int:{encode(r){const{Err:e}=di;if(r<Ii)throw new e("integer: negative integers are not allowed");let t=il(r);if(Number.parseInt(t[0],16)&8&&(t="00"+t),t.length&1)throw new e("unexpected DER parsing assertion: unpadded hex");return t},decode(r){const{Err:e}=di;if(r[0]&128)throw new e("invalid signature integer: negative");if(r[0]===0&&!(r[1]&128))throw new e("invalid signature integer: unnecessary leading zero");return D8(r)}},toSig(r){const{Err:e,_int:t,_tlv:n}=di,s=typeof r=="string"?k8(r):r;gf(s);const{v:i,l:o}=n.decode(48,s);if(o.length)throw new e("invalid signature: left bytes after parsing");const{v:a,l:c}=n.decode(2,i),{v:l,l:u}=n.decode(2,c);if(u.length)throw new e("invalid signature: left bytes after parsing");return{r:t.decode(a),s:t.decode(l)}},hexFromSig(r){const{_tlv:e,_int:t}=di,n=e.encode(2,t.encode(r.r)),s=e.encode(2,t.encode(r.s)),i=n+s;return e.encode(48,i)}},Ii=BigInt(0),Jt=BigInt(1);BigInt(2);const Cv=BigInt(3);BigInt(4);function B8(r){const e=R8(r),{Fp:t}=e,n=wN(e.n,e.nBitLength),s=e.toBytes||((p,m,w)=>{const A=m.toAffine();return Jh(Uint8Array.from([4]),t.toBytes(A.x),t.toBytes(A.y))}),i=e.fromBytes||(p=>{const m=p.subarray(1),w=t.fromBytes(m.subarray(0,t.BYTES)),A=t.fromBytes(m.subarray(t.BYTES,2*t.BYTES));return{x:w,y:A}});function o(p){const{a:m,b:w}=e,A=t.sqr(p),v=t.mul(A,p);return t.add(t.add(v,t.mul(p,m)),w)}if(!t.eql(t.sqr(e.Gy),o(e.Gx)))throw new Error("bad generator point: equation left != right");function a(p){return Fg(p,Jt,e.n)}function c(p){const{allowedPrivateKeyLengths:m,nByteLength:w,wrapPrivateKey:A,n:v}=e;if(m&&typeof p!="bigint"){if(rc(p)&&(p=pu(p)),typeof p!="string"||!m.includes(p.length))throw new Error("invalid private key");p=p.padStart(w*2,"0")}let N;try{N=typeof p=="bigint"?p:Ha(gn("private key",p,w))}catch{throw new Error("invalid private key, expected hex or "+w+" bytes, got "+typeof p)}return A&&(N=Wr(N,v)),Ri("private key",N,Jt,v),N}function l(p){if(!(p instanceof d))throw new Error("ProjectivePoint expected")}const u=nw((p,m)=>{const{px:w,py:A,pz:v}=p;if(t.eql(v,t.ONE))return{x:w,y:A};const N=p.is0();m==null&&(m=N?t.ONE:t.inv(v));const T=t.mul(w,m),P=t.mul(A,m),D=t.mul(v,m);if(N)return{x:t.ZERO,y:t.ZERO};if(!t.eql(D,t.ONE))throw new Error("invZ was invalid");return{x:T,y:P}}),h=nw(p=>{if(p.is0()){if(e.allowInfinityPoint&&!t.is0(p.py))return;throw new Error("bad point: ZERO")}const{x:m,y:w}=p.toAffine();if(!t.isValid(m)||!t.isValid(w))throw new Error("bad point: x or y not FE");const A=t.sqr(w),v=o(m);if(!t.eql(A,v))throw new Error("bad point: equation left != right");if(!p.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class d{constructor(m,w,A){if(this.px=m,this.py=w,this.pz=A,m==null||!t.isValid(m))throw new Error("x required");if(w==null||!t.isValid(w))throw new Error("y required");if(A==null||!t.isValid(A))throw new Error("z required");Object.freeze(this)}static fromAffine(m){const{x:w,y:A}=m||{};if(!m||!t.isValid(w)||!t.isValid(A))throw new Error("invalid affine point");if(m instanceof d)throw new Error("projective point not allowed");const v=N=>t.eql(N,t.ZERO);return v(w)&&v(A)?d.ZERO:new d(w,A,t.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(m){const w=t.invertBatch(m.map(A=>A.pz));return m.map((A,v)=>A.toAffine(w[v])).map(d.fromAffine)}static fromHex(m){const w=d.fromAffine(i(gn("pointHex",m)));return w.assertValidity(),w}static fromPrivateKey(m){return d.BASE.multiply(c(m))}static msm(m,w){return _8(d,n,m,w)}_setWindowSize(m){g.setWindowSize(this,m)}assertValidity(){h(this)}hasEvenY(){const{y:m}=this.toAffine();if(t.isOdd)return!t.isOdd(m);throw new Error("Field doesn't support isOdd")}equals(m){l(m);const{px:w,py:A,pz:v}=this,{px:N,py:T,pz:P}=m,D=t.eql(t.mul(w,P),t.mul(N,v)),U=t.eql(t.mul(A,P),t.mul(T,v));return D&&U}negate(){return new d(this.px,t.neg(this.py),this.pz)}double(){const{a:m,b:w}=e,A=t.mul(w,Cv),{px:v,py:N,pz:T}=this;let P=t.ZERO,D=t.ZERO,U=t.ZERO,x=t.mul(v,v),j=t.mul(N,N),$=t.mul(T,T),H=t.mul(v,N);return H=t.add(H,H),U=t.mul(v,T),U=t.add(U,U),P=t.mul(m,U),D=t.mul(A,$),D=t.add(P,D),P=t.sub(j,D),D=t.add(j,D),D=t.mul(P,D),P=t.mul(H,P),U=t.mul(A,U),$=t.mul(m,$),H=t.sub(x,$),H=t.mul(m,H),H=t.add(H,U),U=t.add(x,x),x=t.add(U,x),x=t.add(x,$),x=t.mul(x,H),D=t.add(D,x),$=t.mul(N,T),$=t.add($,$),x=t.mul($,H),P=t.sub(P,x),U=t.mul($,j),U=t.add(U,U),U=t.add(U,U),new d(P,D,U)}add(m){l(m);const{px:w,py:A,pz:v}=this,{px:N,py:T,pz:P}=m;let D=t.ZERO,U=t.ZERO,x=t.ZERO;const j=e.a,$=t.mul(e.b,Cv);let H=t.mul(w,N),Z=t.mul(A,T),z=t.mul(v,P),b=t.add(w,A),E=t.add(N,T);b=t.mul(b,E),E=t.add(H,Z),b=t.sub(b,E),E=t.add(w,v);let O=t.add(N,P);return E=t.mul(E,O),O=t.add(H,z),E=t.sub(E,O),O=t.add(A,v),D=t.add(T,P),O=t.mul(O,D),D=t.add(Z,z),O=t.sub(O,D),x=t.mul(j,E),D=t.mul($,z),x=t.add(D,x),D=t.sub(Z,x),x=t.add(Z,x),U=t.mul(D,x),Z=t.add(H,H),Z=t.add(Z,H),z=t.mul(j,z),E=t.mul($,E),Z=t.add(Z,z),z=t.sub(H,z),z=t.mul(j,z),E=t.add(E,z),H=t.mul(Z,E),U=t.add(U,H),H=t.mul(O,E),D=t.mul(b,D),D=t.sub(D,H),H=t.mul(b,Z),x=t.mul(O,x),x=t.add(x,H),new d(D,U,x)}subtract(m){return this.add(m.negate())}is0(){return this.equals(d.ZERO)}wNAF(m){return g.wNAFCached(this,m,d.normalizeZ)}multiplyUnsafe(m){const{endo:w,n:A}=e;Ri("scalar",m,Ii,A);const v=d.ZERO;if(m===Ii)return v;if(this.is0()||m===Jt)return this;if(!w||g.hasPrecomputes(this))return g.wNAFCachedUnsafe(this,m,d.normalizeZ);let{k1neg:N,k1:T,k2neg:P,k2:D}=w.splitScalar(m),U=v,x=v,j=this;for(;T>Ii||D>Ii;)T&Jt&&(U=U.add(j)),D&Jt&&(x=x.add(j)),j=j.double(),T>>=Jt,D>>=Jt;return N&&(U=U.negate()),P&&(x=x.negate()),x=new d(t.mul(x.px,w.beta),x.py,x.pz),U.add(x)}multiply(m){const{endo:w,n:A}=e;Ri("scalar",m,Jt,A);let v,N;if(w){const{k1neg:T,k1:P,k2neg:D,k2:U}=w.splitScalar(m);let{p:x,f:j}=this.wNAF(P),{p:$,f:H}=this.wNAF(U);x=g.constTimeNegate(T,x),$=g.constTimeNegate(D,$),$=new d(t.mul($.px,w.beta),$.py,$.pz),v=x.add($),N=j.add(H)}else{const{p:T,f:P}=this.wNAF(m);v=T,N=P}return d.normalizeZ([v,N])[0]}multiplyAndAddUnsafe(m,w,A){const v=d.BASE,N=(P,D)=>D===Ii||D===Jt||!P.equals(v)?P.multiplyUnsafe(D):P.multiply(D),T=N(this,w).add(N(m,A));return T.is0()?void 0:T}toAffine(m){return u(this,m)}isTorsionFree(){const{h:m,isTorsionFree:w}=e;if(m===Jt)return!0;if(w)return w(d,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:m,clearCofactor:w}=e;return m===Jt?this:w?w(d,this):this.multiplyUnsafe(e.h)}toRawBytes(m=!0){return fu("isCompressed",m),this.assertValidity(),s(d,this,m)}toHex(m=!0){return fu("isCompressed",m),pu(this.toRawBytes(m))}}d.BASE=new d(e.Gx,e.Gy,t.ONE),d.ZERO=new d(t.ZERO,t.ONE,t.ZERO);const f=e.nBitLength,g=C8(d,e.endo?Math.ceil(f/2):f);return{CURVE:e,ProjectivePoint:d,normPrivateKeyToScalar:c,weierstrassEquation:o,isWithinCurveOrder:a}}function L8(r){const e=CN(r);return Hu(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function $8(r){const e=L8(r),{Fp:t,n}=e,s=t.BYTES+1,i=2*t.BYTES+1;function o(z){return Wr(z,n)}function a(z){return iw(z,n)}const{ProjectivePoint:c,normPrivateKeyToScalar:l,weierstrassEquation:u,isWithinCurveOrder:h}=B8({...e,toBytes(z,b,E){const O=b.toAffine(),B=t.toBytes(O.x),k=Jh;return fu("isCompressed",E),E?k(Uint8Array.from([b.hasEvenY()?2:3]),B):k(Uint8Array.from([4]),B,t.toBytes(O.y))},fromBytes(z){const b=z.length,E=z[0],O=z.subarray(1);if(b===s&&(E===2||E===3)){const B=Ha(O);if(!Fg(B,Jt,t.ORDER))throw new Error("Point is not on curve");const k=u(B);let M;try{M=t.sqrt(k)}catch(J){const oe=J instanceof Error?": "+J.message:"";throw new Error("Point is not on curve"+oe)}const G=(M&Jt)===Jt;return(E&1)===1!==G&&(M=t.neg(M)),{x:B,y:M}}else if(b===i&&E===4){const B=t.fromBytes(O.subarray(0,t.BYTES)),k=t.fromBytes(O.subarray(t.BYTES,2*t.BYTES));return{x:B,y:k}}else{const B=s,k=i;throw new Error("invalid Point, expected length of "+B+", or uncompressed "+k+", got "+b)}}}),d=z=>pu(mu(z,e.nByteLength));function f(z){const b=n>>Jt;return z>b}function g(z){return f(z)?o(-z):z}const p=(z,b,E)=>Ha(z.slice(b,E));class m{constructor(b,E,O){this.r=b,this.s=E,this.recovery=O,this.assertValidity()}static fromCompact(b){const E=e.nByteLength;return b=gn("compactSignature",b,E*2),new m(p(b,0,E),p(b,E,2*E))}static fromDER(b){const{r:E,s:O}=di.toSig(gn("DER",b));return new m(E,O)}assertValidity(){Ri("r",this.r,Jt,n),Ri("s",this.s,Jt,n)}addRecoveryBit(b){return new m(this.r,this.s,b)}recoverPublicKey(b){const{r:E,s:O,recovery:B}=this,k=P(gn("msgHash",b));if(B==null||![0,1,2,3].includes(B))throw new Error("recovery id invalid");const M=B===2||B===3?E+e.n:E;if(M>=t.ORDER)throw new Error("recovery id 2 or 3 invalid");const G=B&1?"03":"02",J=c.fromHex(G+d(M)),oe=a(M),Q=o(-k*oe),ge=o(O*oe),Oe=c.BASE.multiplyAndAddUnsafe(J,Q,ge);if(!Oe)throw new Error("point at infinify");return Oe.assertValidity(),Oe}hasHighS(){return f(this.s)}normalizeS(){return this.hasHighS()?new m(this.r,o(-this.s),this.recovery):this}toDERRawBytes(){return gu(this.toDERHex())}toDERHex(){return di.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return gu(this.toCompactHex())}toCompactHex(){return d(this.r)+d(this.s)}}const w={isValidPrivateKey(z){try{return l(z),!0}catch{return!1}},normPrivateKeyToScalar:l,randomPrivateKey:()=>{const z=EN(e.n);return E8(e.randomBytes(z),e.n)},precompute(z=8,b=c.BASE){return b._setWindowSize(z),b.multiply(BigInt(3)),b}};function A(z,b=!0){return c.fromPrivateKey(z).toRawBytes(b)}function v(z){const b=rc(z),E=typeof z=="string",O=(b||E)&&z.length;return b?O===s||O===i:E?O===2*s||O===2*i:z instanceof c}function N(z,b,E=!0){if(v(z))throw new Error("first arg must be private key");if(!v(b))throw new Error("second arg must be public key");return c.fromHex(b).multiply(l(z)).toRawBytes(E)}const T=e.bits2int||function(z){if(z.length>8192)throw new Error("input is too large");const b=Ha(z),E=z.length*8-e.nBitLength;return E>0?b>>BigInt(E):b},P=e.bits2int_modN||function(z){return o(T(z))},D=$b(e.nBitLength);function U(z){return Ri("num < 2^"+e.nBitLength,z,Ii,D),mu(z,e.nByteLength)}function x(z,b,E=j){if(["recovered","canonical"].some(Me=>Me in E))throw new Error("sign() legacy options not supported");const{hash:O,randomBytes:B}=e;let{lowS:k,prehash:M,extraEntropy:G}=E;k==null&&(k=!0),z=gn("msgHash",z),Av(E),M&&(z=gn("prehashed msgHash",O(z)));const J=P(z),oe=l(b),Q=[U(oe),U(J)];if(G!=null&&G!==!1){const Me=G===!0?B(t.BYTES):G;Q.push(gn("extraEntropy",Me))}const ge=Jh(...Q),Oe=J;function $e(Me){const Ne=T(Me);if(!h(Ne))return;const Qe=a(Ne),gt=c.BASE.multiply(Ne).toAffine(),_t=o(gt.x);if(_t===Ii)return;const ut=o(Qe*o(Oe+_t*oe));if(ut===Ii)return;let Ot=(gt.x===_t?0:2)|Number(gt.y&Jt),Hn=ut;return k&&f(ut)&&(Hn=g(ut),Ot^=1),new m(_t,Hn,Ot)}return{seed:ge,k2sig:$e}}const j={lowS:e.lowS,prehash:!1},$={lowS:e.lowS,prehash:!1};function H(z,b,E=j){const{seed:O,k2sig:B}=x(z,b,E),k=e;return gN(k.hash.outputLen,k.nByteLength,k.hmac)(O,B)}c.BASE._setWindowSize(8);function Z(z,b,E,O=$){var ut;const B=z;b=gn("msgHash",b),E=gn("publicKey",E);const{lowS:k,prehash:M,format:G}=O;if(Av(O),"strict"in O)throw new Error("options.strict was renamed to lowS");if(G!==void 0&&G!=="compact"&&G!=="der")throw new Error("format must be compact or der");const J=typeof B=="string"||rc(B),oe=!J&&!G&&typeof B=="object"&&B!==null&&typeof B.r=="bigint"&&typeof B.s=="bigint";if(!J&&!oe)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let Q,ge;try{if(oe&&(Q=new m(B.r,B.s)),J){try{G!=="compact"&&(Q=m.fromDER(B))}catch(Ot){if(!(Ot instanceof di.Err))throw Ot}!Q&&G!=="der"&&(Q=m.fromCompact(B))}ge=c.fromHex(E)}catch{return!1}if(!Q||k&&Q.hasHighS())return!1;M&&(b=e.hash(b));const{r:Oe,s:$e}=Q,Me=P(b),Ne=a($e),Qe=o(Me*Ne),gt=o(Oe*Ne),_t=(ut=c.BASE.multiplyAndAddUnsafe(ge,Qe,gt))==null?void 0:ut.toAffine();return _t?o(_t.x)===Oe:!1}return{CURVE:e,getPublicKey:A,getSharedSecret:N,sign:H,verify:Z,ProjectivePoint:c,Signature:m,utils:w}}function M8(r){return{hash:r,hmac:(e,...t)=>Bg(r,e,zU(...t)),randomBytes:ju}}function F8(r,e){const t=n=>$8({...r,...M8(n)});return{...t(e),create:t}}const _N=wN(BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff")),j8=_N.create(BigInt("-3")),H8=BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),z8=F8({a:j8,b:H8,Fp:_N,n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),h:BigInt(1),lowS:!1},pf),NN="base10",Ur="base16",cs="base64pad",io="base64url",mf="utf8",IN=0,Di=1,yf=2,q8=0,_v=1,Ph=12,Mb=32;function V8(){const r=aw.utils.randomPrivateKey(),e=aw.getPublicKey(r);return{privateKey:Jr(r,Ur),publicKey:Jr(e,Ur)}}function cw(){const r=ju(Mb);return Jr(r,Ur)}function W8(r,e){const t=aw.getSharedSecret($n(r,Ur),$n(e,Ur)),n=Y5(pf,t,void 0,void 0,Mb);return Jr(n,Ur)}function yp(r){const e=pf($n(r,Ur));return Jr(e,Ur)}function Ls(r){const e=pf($n(r,mf));return Jr(e,Ur)}function SN(r){return $n(`${r}`,NN)}function nc(r){return Number(Jr(r,NN))}function xN(r){return r.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function TN(r){const e=r.replace(/-/g,"+").replace(/_/g,"/"),t=(4-e.length%4)%4;return e+"=".repeat(t)}function G8(r){const e=SN(typeof r.type<"u"?r.type:IN);if(nc(e)===Di&&typeof r.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const t=typeof r.senderPublicKey<"u"?$n(r.senderPublicKey,Ur):void 0,n=typeof r.iv<"u"?$n(r.iv,Ur):ju(Ph),s=$n(r.symKey,Ur),i=dN(s,n).encrypt($n(r.message,mf)),o=PN({type:e,sealed:i,iv:n,senderPublicKey:t});return r.encoding===io?xN(o):o}function K8(r){const e=$n(r.symKey,Ur),{sealed:t,iv:n}=Yh({encoded:r.encoded,encoding:r.encoding}),s=dN(e,n).decrypt(t);if(s===null)throw new Error("Failed to decrypt");return Jr(s,mf)}function J8(r,e){const t=SN(yf),n=ju(Ph),s=$n(r,mf),i=PN({type:t,sealed:s,iv:n});return e===io?xN(i):i}function Y8(r,e){const{sealed:t}=Yh({encoded:r,encoding:e});return Jr(t,mf)}function PN(r){if(nc(r.type)===yf)return Jr(Th([r.type,r.sealed]),cs);if(nc(r.type)===Di){if(typeof r.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return Jr(Th([r.type,r.senderPublicKey,r.iv,r.sealed]),cs)}return Jr(Th([r.type,r.iv,r.sealed]),cs)}function Yh(r){const e=(r.encoding||cs)===io?TN(r.encoded):r.encoded,t=$n(e,cs),n=t.slice(q8,_v),s=_v;if(nc(n)===Di){const c=s+Mb,l=c+Ph,u=t.slice(s,c),h=t.slice(c,l),d=t.slice(l);return{type:n,sealed:d,iv:h,senderPublicKey:u}}if(nc(n)===yf){const c=t.slice(s),l=ju(Ph);return{type:n,sealed:c,iv:l}}const i=s+Ph,o=t.slice(s,i),a=t.slice(i);return{type:n,sealed:a,iv:o}}function Q8(r,e){const t=Yh({encoded:r,encoding:e==null?void 0:e.encoding});return ON({type:nc(t.type),senderPublicKey:typeof t.senderPublicKey<"u"?Jr(t.senderPublicKey,Ur):void 0,receiverPublicKey:e==null?void 0:e.receiverPublicKey})}function ON(r){const e=(r==null?void 0:r.type)||IN;if(e===Di){if(typeof(r==null?void 0:r.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(r==null?void 0:r.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:r==null?void 0:r.senderPublicKey,receiverPublicKey:r==null?void 0:r.receiverPublicKey}}function Nv(r){return r.type===Di&&typeof r.senderPublicKey=="string"&&typeof r.receiverPublicKey=="string"}function Iv(r){return r.type===yf}function Z8(r){const e=Buffer.from(r.x,"base64"),t=Buffer.from(r.y,"base64");return Th([new Uint8Array([4]),e,t])}function X8(r,e){const[t,n,s]=r.split("."),i=Buffer.from(TN(s),"base64");if(i.length!==64)throw new Error("Invalid signature length");const o=i.slice(0,32),a=i.slice(32,64),c=`${t}.${n}`,l=pf(c),u=Z8(e);if(!z8.verify(Th([o,a]),l,u))throw new Error("Invalid signature");return Gy(r).payload}const eB="irn";function qp(r){return(r==null?void 0:r.relay)||{protocol:eB}}function Eh(r){const e=iU[r];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${r}`);return e}function tB(r,e="-"){const t={},n="relay"+e;return Object.keys(r).forEach(s=>{if(s.startsWith(n)){const i=s.replace(n,""),o=r[s];t[i]=o}}),t}function Sv(r){if(!r.includes("wc:")){const l=X_(r);l!=null&&l.includes("wc:")&&(r=l)}r=r.includes("wc://")?r.replace("wc://",""):r,r=r.includes("wc:")?r.replace("wc:",""):r;const e=r.indexOf(":"),t=r.indexOf("?")!==-1?r.indexOf("?"):void 0,n=r.substring(0,e),s=r.substring(e+1,t).split("@"),i=typeof t<"u"?r.substring(t):"",o=new URLSearchParams(i),a={};o.forEach((l,u)=>{a[u]=l});const c=typeof a.methods=="string"?a.methods.split(","):void 0;return{protocol:n,topic:rB(s[0]),version:parseInt(s[1],10),symKey:a.symKey,relay:tB(a),methods:c,expiryTimestamp:a.expiryTimestamp?parseInt(a.expiryTimestamp,10):void 0}}function rB(r){return r.startsWith("//")?r.substring(2):r}function nB(r,e="-"){const t="relay",n={};return Object.keys(r).forEach(s=>{const i=s,o=t+e+i;r[i]&&(n[o]=r[i])}),n}function xv(r){const e=new URLSearchParams,t=nB(r.relay);Object.keys(t).sort().forEach(s=>{e.set(s,t[s])}),e.set("symKey",r.symKey),r.expiryTimestamp&&e.set("expiryTimestamp",r.expiryTimestamp.toString()),r.methods&&e.set("methods",r.methods.join(","));const n=e.toString();return`${r.protocol}:${r.topic}@${r.version}?${n}`}function qf(r,e,t){return`${r}?wc_ev=${t}&topic=${e}`}function zu(r){const e=[];return r.forEach(t=>{const[n,s]=t.split(":");e.push(`${n}:${s}`)}),e}function sB(r){const e=[];return Object.values(r).forEach(t=>{e.push(...zu(t.accounts))}),e}function iB(r,e){const t=[];return Object.values(r).forEach(n=>{zu(n.accounts).includes(e)&&t.push(...n.methods)}),t}function oB(r,e){const t=[];return Object.values(r).forEach(n=>{zu(n.accounts).includes(e)&&t.push(...n.events)}),t}function Fb(r){return r.includes(":")}function vh(r){return Fb(r)?r.split(":")[0]:r}function aB(r){const e={};return r==null||r.forEach(t=>{var n;const[s,i]=t.split(":");e[s]||(e[s]={accounts:[],chains:[],events:[],methods:[]}),e[s].accounts.push(t),(n=e[s].chains)==null||n.push(`${s}:${i}`)}),e}function Tv(r,e){e=e.map(n=>n.replace("did:pkh:",""));const t=aB(e);for(const[n,s]of Object.entries(t))s.methods?s.methods=gp(s.methods,r):s.methods=r,s.events=["chainChanged","accountsChanged"];return t}const cB={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},lB={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function te(r,e){const{message:t,code:n}=lB[r];return{message:e?`${t} ${e}`:t,code:n}}function at(r,e){const{message:t,code:n}=cB[r];return{message:e?`${t} ${e}`:t,code:n}}function To(r,e){return!!Array.isArray(r)}function Qh(r){return Object.getPrototypeOf(r)===Object.prototype&&Object.keys(r).length}function ar(r){return typeof r>"u"}function Mt(r,e){return e&&ar(r)?!0:typeof r=="string"&&!!r.trim().length}function jb(r,e){return e&&ar(r)?!0:typeof r=="number"&&!isNaN(r)}function uB(r,e){const{requiredNamespaces:t}=e,n=Object.keys(r.namespaces),s=Object.keys(t);let i=!0;return pa(s,n)?(n.forEach(o=>{const{accounts:a,methods:c,events:l}=r.namespaces[o],u=zu(a),h=t[o];(!pa(K_(o,h),u)||!pa(h.methods,c)||!pa(h.events,l))&&(i=!1)}),i):!1}function Vp(r){return Mt(r,!1)&&r.includes(":")?r.split(":").length===2:!1}function hB(r){if(Mt(r,!1)&&r.includes(":")){const e=r.split(":");if(e.length===3){const t=e[0]+":"+e[1];return!!e[2]&&Vp(t)}}return!1}function dB(r){function e(t){try{return typeof new URL(t)<"u"}catch{return!1}}try{if(Mt(r,!1)){if(e(r))return!0;const t=X_(r);return e(t)}}catch{}return!1}function fB(r){var e;return(e=r==null?void 0:r.proposer)==null?void 0:e.publicKey}function pB(r){return r==null?void 0:r.topic}function gB(r,e){let t=null;return Mt(r==null?void 0:r.publicKey,!1)||(t=te("MISSING_OR_INVALID",`${e} controller public key should be a string`)),t}function Pv(r){let e=!0;return To(r)?r.length&&(e=r.every(t=>Mt(t,!1))):e=!1,e}function mB(r,e,t){let n=null;return To(e)&&e.length?e.forEach(s=>{n||Vp(s)||(n=at("UNSUPPORTED_CHAINS",`${t}, chain ${s} should be a string and conform to "namespace:chainId" format`))}):Vp(r)||(n=at("UNSUPPORTED_CHAINS",`${t}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),n}function yB(r,e,t){let n=null;return Object.entries(r).forEach(([s,i])=>{if(n)return;const o=mB(s,K_(s,i),`${e} ${t}`);o&&(n=o)}),n}function wB(r,e){let t=null;return To(r)?r.forEach(n=>{t||hB(n)||(t=at("UNSUPPORTED_ACCOUNTS",`${e}, account ${n} should be a string and conform to "namespace:chainId:address" format`))}):t=at("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),t}function bB(r,e){let t=null;return Object.values(r).forEach(n=>{if(t)return;const s=wB(n==null?void 0:n.accounts,`${e} namespace`);s&&(t=s)}),t}function EB(r,e){let t=null;return Pv(r==null?void 0:r.methods)?Pv(r==null?void 0:r.events)||(t=at("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):t=at("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),t}function RN(r,e){let t=null;return Object.values(r).forEach(n=>{if(t)return;const s=EB(n,`${e}, namespace`);s&&(t=s)}),t}function vB(r,e,t){let n=null;if(r&&Qh(r)){const s=RN(r,e);s&&(n=s);const i=yB(r,e,t);i&&(n=i)}else n=te("MISSING_OR_INVALID",`${e}, ${t} should be an object with data`);return n}function Km(r,e){let t=null;if(r&&Qh(r)){const n=RN(r,e);n&&(t=n);const s=bB(r,e);s&&(t=s)}else t=te("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return t}function DN(r){return Mt(r.protocol,!0)}function AB(r,e){let t=!1;return r?r&&To(r)&&r.length&&r.forEach(n=>{t=DN(n)}):t=!0,t}function CB(r){return typeof r=="number"}function zr(r){return typeof r<"u"&&typeof r!==null}function _B(r){return!(!r||typeof r!="object"||!r.code||!jb(r.code,!1)||!r.message||!Mt(r.message,!1))}function NB(r){return!(ar(r)||!Mt(r.method,!1))}function IB(r){return!(ar(r)||ar(r.result)&&ar(r.error)||!jb(r.id,!1)||!Mt(r.jsonrpc,!1))}function SB(r){return!(ar(r)||!Mt(r.name,!1))}function Ov(r,e){return!(!Vp(e)||!sB(r).includes(e))}function xB(r,e,t){return Mt(t,!1)?iB(r,e).includes(t):!1}function TB(r,e,t){return Mt(t,!1)?oB(r,e).includes(t):!1}function Rv(r,e,t){let n=null;const s=PB(r),i=OB(e),o=Object.keys(s),a=Object.keys(i),c=Dv(Object.keys(r)),l=Dv(Object.keys(e)),u=c.filter(h=>!l.includes(h));return u.length&&(n=te("NON_CONFORMING_NAMESPACES",`${t} namespaces keys don't satisfy requiredNamespaces.
      Required: ${u.toString()}
      Received: ${Object.keys(e).toString()}`)),pa(o,a)||(n=te("NON_CONFORMING_NAMESPACES",`${t} namespaces chains don't satisfy required namespaces.
      Required: ${o.toString()}
      Approved: ${a.toString()}`)),Object.keys(e).forEach(h=>{if(!h.includes(":")||n)return;const d=zu(e[h].accounts);d.includes(h)||(n=te("NON_CONFORMING_NAMESPACES",`${t} namespaces accounts don't satisfy namespace accounts for ${h}
        Required: ${h}
        Approved: ${d.toString()}`))}),o.forEach(h=>{n||(pa(s[h].methods,i[h].methods)?pa(s[h].events,i[h].events)||(n=te("NON_CONFORMING_NAMESPACES",`${t} namespaces events don't satisfy namespace events for ${h}`)):n=te("NON_CONFORMING_NAMESPACES",`${t} namespaces methods don't satisfy namespace methods for ${h}`))}),n}function PB(r){const e={};return Object.keys(r).forEach(t=>{var n;t.includes(":")?e[t]=r[t]:(n=r[t].chains)==null||n.forEach(s=>{e[s]={methods:r[t].methods,events:r[t].events}})}),e}function Dv(r){return[...new Set(r.map(e=>e.includes(":")?e.split(":")[0]:e))]}function OB(r){const e={};return Object.keys(r).forEach(t=>{if(t.includes(":"))e[t]=r[t];else{const n=zu(r[t].accounts);n==null||n.forEach(s=>{e[s]={accounts:r[t].accounts.filter(i=>i.includes(`${s}:`)),methods:r[t].methods,events:r[t].events}})}}),e}function RB(r,e){return jb(r,!1)&&r<=e.max&&r>=e.min}function kv(){const r=df();return new Promise(e=>{switch(r){case wn.browser:e(DB());break;case wn.reactNative:e(kB());break;case wn.node:e(UB());break;default:e(!0)}})}function DB(){return hf()&&(navigator==null?void 0:navigator.onLine)}async function kB(){if(Fo()&&typeof global<"u"&&global!=null&&global.NetInfo){const r=await(global==null?void 0:global.NetInfo.fetch());return r==null?void 0:r.isConnected}return!0}function UB(){return!0}function BB(r){switch(df()){case wn.browser:LB(r);break;case wn.reactNative:$B(r);break}}function LB(r){!Fo()&&hf()&&(window.addEventListener("online",()=>r(!0)),window.addEventListener("offline",()=>r(!1)))}function $B(r){Fo()&&typeof global<"u"&&global!=null&&global.NetInfo&&(global==null||global.NetInfo.addEventListener(e=>r(e==null?void 0:e.isConnected)))}const Jm={};class ah{static get(e){return Jm[e]}static set(e,t){Jm[e]=t}static delete(e){delete Jm[e]}}const MB="PARSE_ERROR",FB="INVALID_REQUEST",jB="METHOD_NOT_FOUND",HB="INVALID_PARAMS",kN="INTERNAL_ERROR",Hb="SERVER_ERROR",zB=[-32700,-32600,-32601,-32602,-32603],Oh={[MB]:{code:-32700,message:"Parse error"},[FB]:{code:-32600,message:"Invalid Request"},[jB]:{code:-32601,message:"Method not found"},[HB]:{code:-32602,message:"Invalid params"},[kN]:{code:-32603,message:"Internal error"},[Hb]:{code:-32e3,message:"Server error"}},UN=Hb;function qB(r){return zB.includes(r)}function Uv(r){return Object.keys(Oh).includes(r)?Oh[r]:Oh[UN]}function VB(r){const e=Object.values(Oh).find(t=>t.code===r);return e||Oh[UN]}function BN(r,e,t){return r.message.includes("getaddrinfo ENOTFOUND")||r.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${t} RPC url at ${e}`):r}var LN={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var lw=function(r,e){return lw=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var s in n)n.hasOwnProperty(s)&&(t[s]=n[s])},lw(r,e)};function WB(r,e){lw(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var uw=function(){return uw=Object.assign||function(e){for(var t,n=1,s=arguments.length;n<s;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},uw.apply(this,arguments)};function GB(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(r);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(r,n[s])&&(t[n[s]]=r[n[s]]);return t}function KB(r,e,t,n){var s=arguments.length,i=s<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(i=(s<3?o(i):s>3?o(e,t,i):o(e,t))||i);return s>3&&i&&Object.defineProperty(e,t,i),i}function JB(r,e){return function(t,n){e(t,n,r)}}function YB(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)}function QB(r,e,t,n){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(h){o(h)}}function c(u){try{l(n.throw(u))}catch(h){o(h)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})}function ZB(r,e){var t={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(u){return c([l,u])}}function c(l){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,s&&(i=l[0]&2?s.return:l[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,l[1])).done)return i;switch(s=0,i&&(l=[l[0]&2,i.value]),l[0]){case 0:case 1:i=l;break;case 4:return t.label++,{value:l[1],done:!1};case 5:t.label++,s=l[1],l=[0];continue;case 7:l=t.ops.pop(),t.trys.pop();continue;default:if(i=t.trys,!(i=i.length>0&&i[i.length-1])&&(l[0]===6||l[0]===2)){t=0;continue}if(l[0]===3&&(!i||l[1]>i[0]&&l[1]<i[3])){t.label=l[1];break}if(l[0]===6&&t.label<i[1]){t.label=i[1],i=l;break}if(i&&t.label<i[2]){t.label=i[2],t.ops.push(l);break}i[2]&&t.ops.pop(),t.trys.pop();continue}l=e.call(r,t)}catch(u){l=[6,u],s=0}finally{n=i=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function XB(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}function eL(r,e){for(var t in r)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=r[t])}function hw(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function $N(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var n=t.call(r),s,i=[],o;try{for(;(e===void 0||e-- >0)&&!(s=n.next()).done;)i.push(s.value)}catch(a){o={error:a}}finally{try{s&&!s.done&&(t=n.return)&&t.call(n)}finally{if(o)throw o.error}}return i}function tL(){for(var r=[],e=0;e<arguments.length;e++)r=r.concat($N(arguments[e]));return r}function rL(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;for(var n=Array(r),s=0,e=0;e<t;e++)for(var i=arguments[e],o=0,a=i.length;o<a;o++,s++)n[s]=i[o];return n}function Zh(r){return this instanceof Zh?(this.v=r,this):new Zh(r)}function nL(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(r,e||[]),s,i=[];return s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s;function o(d){n[d]&&(s[d]=function(f){return new Promise(function(g,p){i.push([d,f,g,p])>1||a(d,f)})})}function a(d,f){try{c(n[d](f))}catch(g){h(i[0][3],g)}}function c(d){d.value instanceof Zh?Promise.resolve(d.value.v).then(l,u):h(i[0][2],d)}function l(d){a("next",d)}function u(d){a("throw",d)}function h(d,f){d(f),i.shift(),i.length&&a(i[0][0],i[0][1])}}function sL(r){var e,t;return e={},n("next"),n("throw",function(s){throw s}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(s,i){e[s]=r[s]?function(o){return(t=!t)?{value:Zh(r[s](o)),done:s==="return"}:i?i(o):o}:i}}function iL(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],t;return e?e.call(r):(r=typeof hw=="function"?hw(r):r[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(i){t[i]=r[i]&&function(o){return new Promise(function(a,c){o=r[i](o),s(a,c,o.done,o.value)})}}function s(i,o,a,c){Promise.resolve(c).then(function(l){i({value:l,done:a})},o)}}function oL(r,e){return Object.defineProperty?Object.defineProperty(r,"raw",{value:e}):r.raw=e,r}function aL(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)Object.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e.default=r,e}function cL(r){return r&&r.__esModule?r:{default:r}}function lL(r,e){if(!e.has(r))throw new TypeError("attempted to get private field on non-instance");return e.get(r)}function uL(r,e,t){if(!e.has(r))throw new TypeError("attempted to set private field on non-instance");return e.set(r,t),t}const hL=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return uw},__asyncDelegator:sL,__asyncGenerator:nL,__asyncValues:iL,__await:Zh,__awaiter:QB,__classPrivateFieldGet:lL,__classPrivateFieldSet:uL,__createBinding:XB,__decorate:KB,__exportStar:eL,__extends:WB,__generator:ZB,__importDefault:cL,__importStar:aL,__makeTemplateObject:oL,__metadata:YB,__param:JB,__read:$N,__rest:GB,__spread:tL,__spreadArrays:rL,__values:hw},Symbol.toStringTag,{value:"Module"})),dL=xC(hL);var ii={},Bv;function fL(){if(Bv)return ii;Bv=1,Object.defineProperty(ii,"__esModule",{value:!0}),ii.isBrowserCryptoAvailable=ii.getSubtleCrypto=ii.getBrowerCrypto=void 0;function r(){return(Bs===null||Bs===void 0?void 0:Bs.crypto)||(Bs===null||Bs===void 0?void 0:Bs.msCrypto)||{}}ii.getBrowerCrypto=r;function e(){const n=r();return n.subtle||n.webkitSubtle}ii.getSubtleCrypto=e;function t(){return!!r()&&!!e()}return ii.isBrowserCryptoAvailable=t,ii}var oi={},Lv;function pL(){if(Lv)return oi;Lv=1,Object.defineProperty(oi,"__esModule",{value:!0}),oi.isBrowser=oi.isNode=oi.isReactNative=void 0;function r(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}oi.isReactNative=r;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}oi.isNode=e;function t(){return!r()&&!e()}return oi.isBrowser=t,oi}(function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=dL;e.__exportStar(fL(),r),e.__exportStar(pL(),r)})(LN);function Ns(r=3){const e=Date.now()*Math.pow(10,r),t=Math.floor(Math.random()*Math.pow(10,r));return e+t}function ga(r=6){return BigInt(Ns(r))}function So(r,e,t){return{id:t||Ns(),jsonrpc:"2.0",method:r,params:e}}function jg(r,e){return{id:r,jsonrpc:"2.0",result:e}}function Hg(r,e,t){return{id:r,jsonrpc:"2.0",error:gL(e)}}function gL(r,e){return typeof r>"u"?Uv(kN):(typeof r=="string"&&(r=Object.assign(Object.assign({},Uv(Hb)),{message:r})),qB(r.code)&&(r=VB(r.code)),r)}let mL=class{},yL=class extends mL{constructor(){super()}},wL=class extends yL{constructor(e){super()}};const bL="^https?:",EL="^wss?:";function vL(r){const e=r.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function MN(r,e){const t=vL(r);return typeof t>"u"?!1:new RegExp(e).test(t)}function $v(r){return MN(r,bL)}function Mv(r){return MN(r,EL)}function AL(r){return new RegExp("wss?://localhost(:d{2,5})?").test(r)}function FN(r){return typeof r=="object"&&"id"in r&&"jsonrpc"in r&&r.jsonrpc==="2.0"}function zb(r){return FN(r)&&"method"in r}function zg(r){return FN(r)&&(Is(r)||Bn(r))}function Is(r){return"result"in r}function Bn(r){return"error"in r}let Fn=class extends wL{constructor(e){super(e),this.events=new Mn.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async request(e,t){return this.requestStrict(So(e.method,e.params||[],e.id||ga().toString()),t)}async requestStrict(e,t){return new Promise(async(n,s)=>{if(!this.connection.connected)try{await this.open()}catch(i){s(i)}this.events.on(`${e.id}`,i=>{Bn(i)?s(i.error):n(i.result)});try{await this.connection.send(e,t)}catch(i){s(i)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),zg(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}};const CL=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),_L=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",Fv=r=>r.split("?")[0],jv=10,NL=CL();let IL=class{constructor(e){if(this.url=e,this.events=new Mn.EventEmitter,this.registering=!1,!Mv(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,t)=>{if(typeof this.socket>"u"){t(new Error("Connection already closed"));return}this.socket.onclose=n=>{this.onClose(n),e()},this.socket.close()})}async send(e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Bi(e))}catch(t){this.onError(e.id,t)}}register(e=this.url){if(!Mv(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((n,s)=>{this.events.once("register_error",i=>{this.resetMaxListeners(),s(i)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return s(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=e,this.registering=!0,new Promise((t,n)=>{const s=LN.isReactNative()?void 0:{rejectUnauthorized:!AL(e)},i=new NL(e,[],s);_L()?i.onerror=o=>{const a=o;n(this.emitError(a.error))}:i.on("error",o=>{n(this.emitError(o))}),i.onopen=()=>{this.onOpen(i),t(i)}})}onOpen(e){e.onmessage=t=>this.onPayload(t),e.onclose=t=>this.onClose(t),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?ec(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const n=this.parseError(t),s=n.message||n.toString(),i=Hg(e,s);this.events.emit("payload",i)}parseError(e,t=this.url){return BN(e,Fv(t),"WS")}resetMaxListeners(){this.events.getMaxListeners()>jv&&this.events.setMaxListeners(jv)}emitError(e){const t=this.parseError(new Error((e==null?void 0:e.message)||`WebSocket connection failed for host: ${Fv(this.url)}`));return this.events.emit("register_error",t),t}};var SL={};const jN="wc",HN=2,dw="core",Ks=`${jN}@2:${dw}:`,xL={logger:"error"},TL={database:":memory:"},PL="crypto",Hv="client_ed25519_seed",OL=X.ONE_DAY,RL="keychain",DL="0.3",kL="messages",UL="0.3",zv=X.SIX_HOURS,BL="publisher",zN="irn",LL="error",qN="wss://relay.walletconnect.org",$L="relayer",Qt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},ML="_subscription",Cn={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},FL=.1,fw="2.19.2",vt={link_mode:"link_mode",relay:"relay"},wp={inbound:"inbound",outbound:"outbound"},jL="0.3",HL="WALLETCONNECT_CLIENT_ID",qv="WALLETCONNECT_LINK_MODE_APPS",ln={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},zL="subscription",qL="0.3",VL="pairing",WL="0.3",ch={wc_pairingDelete:{req:{ttl:X.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:X.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:X.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:X.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:X.ONE_DAY,prompt:!1,tag:0},res:{ttl:X.ONE_DAY,prompt:!1,tag:0}}},aa={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},Wn={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},GL="history",KL="0.3",JL="expirer",Tn={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},YL="0.3",QL="verify-api",ZL="https://verify.walletconnect.com",VN="https://verify.walletconnect.org",Rh=VN,XL=`${Rh}/v3`,e$=[ZL,VN],t$="echo",r$="https://echo.walletconnect.com",_s={pairing_started:"pairing_started",pairing_uri_validation_success:"pairing_uri_validation_success",pairing_uri_not_expired:"pairing_uri_not_expired",store_new_pairing:"store_new_pairing",subscribing_pairing_topic:"subscribing_pairing_topic",subscribe_pairing_topic_success:"subscribe_pairing_topic_success",existing_pairing:"existing_pairing",pairing_not_expired:"pairing_not_expired",emit_inactive_pairing:"emit_inactive_pairing",emit_session_proposal:"emit_session_proposal",subscribing_to_pairing_topic:"subscribing_to_pairing_topic"},ci={no_wss_connection:"no_wss_connection",no_internet_connection:"no_internet_connection",malformed_pairing_uri:"malformed_pairing_uri",active_pairing_already_exists:"active_pairing_already_exists",subscribe_pairing_topic_failure:"subscribe_pairing_topic_failure",pairing_expired:"pairing_expired",proposal_expired:"proposal_expired",proposal_listener_not_found:"proposal_listener_not_found"},Gn={session_approve_started:"session_approve_started",proposal_not_expired:"proposal_not_expired",session_namespaces_validation_success:"session_namespaces_validation_success",create_session_topic:"create_session_topic",subscribing_session_topic:"subscribing_session_topic",subscribe_session_topic_success:"subscribe_session_topic_success",publishing_session_approve:"publishing_session_approve",session_approve_publish_success:"session_approve_publish_success",store_session:"store_session",publishing_session_settle:"publishing_session_settle",session_settle_publish_success:"session_settle_publish_success"},Ko={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",proposal_expired:"proposal_expired",subscribe_session_topic_failure:"subscribe_session_topic_failure",session_approve_publish_failure:"session_approve_publish_failure",session_settle_publish_failure:"session_settle_publish_failure",session_approve_namespace_validation_failure:"session_approve_namespace_validation_failure",proposal_not_found:"proposal_not_found"},Jo={authenticated_session_approve_started:"authenticated_session_approve_started",create_authenticated_session_topic:"create_authenticated_session_topic",cacaos_verified:"cacaos_verified",store_authenticated_session:"store_authenticated_session",subscribing_authenticated_session_topic:"subscribing_authenticated_session_topic",subscribe_authenticated_session_topic_success:"subscribe_authenticated_session_topic_success",publishing_authenticated_session_approve:"publishing_authenticated_session_approve"},lh={no_internet_connection:"no_internet_connection",invalid_cacao:"invalid_cacao",subscribe_authenticated_session_topic_failure:"subscribe_authenticated_session_topic_failure",authenticated_session_approve_publish_failure:"authenticated_session_approve_publish_failure",authenticated_session_pending_request_not_found:"authenticated_session_pending_request_not_found"},n$=.1,s$="event-client",i$=86400,o$="https://pulse.walletconnect.org/batch";function a$(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var i=r.charAt(s),o=i.charCodeAt(0);if(t[o]!==255)throw new TypeError(i+" is ambiguous");t[o]=s}var a=r.length,c=r.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(g){if(g instanceof Uint8Array||(ArrayBuffer.isView(g)?g=new Uint8Array(g.buffer,g.byteOffset,g.byteLength):Array.isArray(g)&&(g=Uint8Array.from(g))),!(g instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(g.length===0)return"";for(var p=0,m=0,w=0,A=g.length;w!==A&&g[w]===0;)w++,p++;for(var v=(A-w)*u+1>>>0,N=new Uint8Array(v);w!==A;){for(var T=g[w],P=0,D=v-1;(T!==0||P<m)&&D!==-1;D--,P++)T+=256*N[D]>>>0,N[D]=T%a>>>0,T=T/a>>>0;if(T!==0)throw new Error("Non-zero carry");m=P,w++}for(var U=v-m;U!==v&&N[U]===0;)U++;for(var x=c.repeat(p);U<v;++U)x+=r.charAt(N[U]);return x}function d(g){if(typeof g!="string")throw new TypeError("Expected String");if(g.length===0)return new Uint8Array;var p=0;if(g[p]!==" "){for(var m=0,w=0;g[p]===c;)m++,p++;for(var A=(g.length-p)*l+1>>>0,v=new Uint8Array(A);g[p];){var N=t[g.charCodeAt(p)];if(N===255)return;for(var T=0,P=A-1;(N!==0||T<w)&&P!==-1;P--,T++)N+=a*v[P]>>>0,v[P]=N%256>>>0,N=N/256>>>0;if(N!==0)throw new Error("Non-zero carry");w=T,p++}if(g[p]!==" "){for(var D=A-w;D!==A&&v[D]===0;)D++;for(var U=new Uint8Array(m+(A-D)),x=m;D!==A;)U[x++]=v[D++];return U}}}function f(g){var p=d(g);if(p)return p;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:d,decode:f}}var c$=a$,l$=c$;const WN=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},u$=r=>new TextEncoder().encode(r),h$=r=>new TextDecoder().decode(r);class d${constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class f${constructor(e,t,n){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return GN(this,e)}}class p${constructor(e){this.decoders=e}or(e){return GN(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const GN=(r,e)=>new p$({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class g${constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new d$(e,t,n),this.decoder=new f$(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const qg=({name:r,prefix:e,encode:t,decode:n})=>new g$(r,e,t,n),wf=({prefix:r,name:e,alphabet:t})=>{const{encode:n,decode:s}=l$(t,e);return qg({prefix:r,name:e,encode:n,decode:i=>WN(s(i))})},m$=(r,e,t,n)=>{const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=r.length;for(;r[i-1]==="=";)--i;const o=new Uint8Array(i*t/8|0);let a=0,c=0,l=0;for(let u=0;u<i;++u){const h=s[r[u]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<t|h,a+=t,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},y$=(r,e,t)=>{const n=e[e.length-1]==="=",s=(1<<t)-1;let i="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,i+=e[s&a>>o];if(o&&(i+=e[s&a<<t-o]),n)for(;i.length*t&7;)i+="=";return i},mr=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>qg({prefix:e,name:r,encode(s){return y$(s,n,t)},decode(s){return m$(s,n,t,r)}}),w$=qg({prefix:"\0",name:"identity",encode:r=>h$(r),decode:r=>u$(r)});var b$=Object.freeze({__proto__:null,identity:w$});const E$=mr({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var v$=Object.freeze({__proto__:null,base2:E$});const A$=mr({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var C$=Object.freeze({__proto__:null,base8:A$});const _$=wf({prefix:"9",name:"base10",alphabet:"0123456789"});var N$=Object.freeze({__proto__:null,base10:_$});const I$=mr({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),S$=mr({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var x$=Object.freeze({__proto__:null,base16:I$,base16upper:S$});const T$=mr({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),P$=mr({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),O$=mr({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),R$=mr({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),D$=mr({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),k$=mr({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),U$=mr({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),B$=mr({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),L$=mr({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var $$=Object.freeze({__proto__:null,base32:T$,base32upper:P$,base32pad:O$,base32padupper:R$,base32hex:D$,base32hexupper:k$,base32hexpad:U$,base32hexpadupper:B$,base32z:L$});const M$=wf({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),F$=wf({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var j$=Object.freeze({__proto__:null,base36:M$,base36upper:F$});const H$=wf({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),z$=wf({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var q$=Object.freeze({__proto__:null,base58btc:H$,base58flickr:z$});const V$=mr({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),W$=mr({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),G$=mr({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),K$=mr({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var J$=Object.freeze({__proto__:null,base64:V$,base64pad:W$,base64url:G$,base64urlpad:K$});const KN=Array.from(""),Y$=KN.reduce((r,e,t)=>(r[t]=e,r),[]),Q$=KN.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]);function Z$(r){return r.reduce((e,t)=>(e+=Y$[t],e),"")}function X$(r){const e=[];for(const t of r){const n=Q$[t.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(n)}return new Uint8Array(e)}const e4=qg({prefix:"",name:"base256emoji",encode:Z$,decode:X$});var t4=Object.freeze({__proto__:null,base256emoji:e4}),r4=JN,Vv=128,n4=-128,s4=Math.pow(2,31);function JN(r,e,t){e=e||[],t=t||0;for(var n=t;r>=s4;)e[t++]=r&255|Vv,r/=128;for(;r&n4;)e[t++]=r&255|Vv,r>>>=7;return e[t]=r|0,JN.bytes=t-n+1,e}var i4=pw,o4=128,Wv=127;function pw(r,n){var t=0,n=n||0,s=0,i=n,o,a=r.length;do{if(i>=a)throw pw.bytes=0,new RangeError("Could not decode varint");o=r[i++],t+=s<28?(o&Wv)<<s:(o&Wv)*Math.pow(2,s),s+=7}while(o>=o4);return pw.bytes=i-n,t}var a4=Math.pow(2,7),c4=Math.pow(2,14),l4=Math.pow(2,21),u4=Math.pow(2,28),h4=Math.pow(2,35),d4=Math.pow(2,42),f4=Math.pow(2,49),p4=Math.pow(2,56),g4=Math.pow(2,63),m4=function(r){return r<a4?1:r<c4?2:r<l4?3:r<u4?4:r<h4?5:r<d4?6:r<f4?7:r<p4?8:r<g4?9:10},y4={encode:r4,decode:i4,encodingLength:m4},YN=y4;const Gv=(r,e,t=0)=>(YN.encode(r,e,t),e),Kv=r=>YN.encodingLength(r),gw=(r,e)=>{const t=e.byteLength,n=Kv(r),s=n+Kv(t),i=new Uint8Array(s+t);return Gv(r,i,0),Gv(t,i,n),i.set(e,s),new w4(r,t,e,i)};class w4{constructor(e,t,n,s){this.code=e,this.size=t,this.digest=n,this.bytes=s}}const QN=({name:r,code:e,encode:t})=>new b4(r,e,t);class b4{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?gw(this.code,t):t.then(n=>gw(this.code,n))}else throw Error("Unknown type, must be binary type")}}const ZN=r=>async e=>new Uint8Array(await crypto.subtle.digest(r,e)),E4=QN({name:"sha2-256",code:18,encode:ZN("SHA-256")}),v4=QN({name:"sha2-512",code:19,encode:ZN("SHA-512")});var A4=Object.freeze({__proto__:null,sha256:E4,sha512:v4});const XN=0,C4="identity",eI=WN,_4=r=>gw(XN,eI(r)),N4={code:XN,name:C4,encode:eI,digest:_4};var I4=Object.freeze({__proto__:null,identity:N4});new TextEncoder,new TextDecoder;const Jv={...b$,...v$,...C$,...N$,...x$,...$$,...j$,...q$,...J$,...t4};({...A4,...I4});function S4(r=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(r):new Uint8Array(r)}function tI(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}const Yv=tI("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),Ym=tI("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);const e=S4(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),x4={utf8:Yv,"utf-8":Yv,hex:Jv.base16,latin1:Ym,ascii:Ym,binary:Ym,...Jv};function T4(r,e="utf8"){const t=x4[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r,"utf8"):t.decoder.decode(`${t.prefix}${r}`)}var P4=Object.defineProperty,O4=(r,e,t)=>e in r?P4(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,vs=(r,e,t)=>O4(r,typeof e!="symbol"?e+"":e,t);class R4{constructor(e,t){this.core=e,this.logger=t,vs(this,"keychain",new Map),vs(this,"name",RL),vs(this,"version",DL),vs(this,"initialized",!1),vs(this,"storagePrefix",Ks),vs(this,"init",async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}}),vs(this,"has",n=>(this.isInitialized(),this.keychain.has(n))),vs(this,"set",async(n,s)=>{this.isInitialized(),this.keychain.set(n,s),await this.persist()}),vs(this,"get",n=>{this.isInitialized();const s=this.keychain.get(n);if(typeof s>"u"){const{message:i}=te("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(i)}return s}),vs(this,"del",async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()}),this.core=e,this.logger=Ir(t,this.name)}get context(){return Xr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,Qy(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Zy(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=te("NOT_INITIALIZED",this.name);throw new Error(e)}}}var D4=Object.defineProperty,k4=(r,e,t)=>e in r?D4(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,nr=(r,e,t)=>k4(r,typeof e!="symbol"?e+"":e,t);class U4{constructor(e,t,n){this.core=e,this.logger=t,nr(this,"name",PL),nr(this,"keychain"),nr(this,"randomSessionIdentifier",cw()),nr(this,"initialized",!1),nr(this,"init",async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)}),nr(this,"hasKeys",s=>(this.isInitialized(),this.keychain.has(s))),nr(this,"getClientId",async()=>{this.isInitialized();const s=await this.getClientSeed(),i=PE(s);return I_(i.publicKey)}),nr(this,"generateKeyPair",()=>{this.isInitialized();const s=V8();return this.setPrivateKey(s.publicKey,s.privateKey)}),nr(this,"signJWT",async s=>{this.isInitialized();const i=await this.getClientSeed(),o=PE(i),a=this.randomSessionIdentifier;return await GD(a,s,OL,o)}),nr(this,"generateSharedKey",(s,i,o)=>{this.isInitialized();const a=this.getPrivateKey(s),c=W8(a,i);return this.setSymKey(c,o)}),nr(this,"setSymKey",async(s,i)=>{this.isInitialized();const o=i||yp(s);return await this.keychain.set(o,s),o}),nr(this,"deleteKeyPair",async s=>{this.isInitialized(),await this.keychain.del(s)}),nr(this,"deleteSymKey",async s=>{this.isInitialized(),await this.keychain.del(s)}),nr(this,"encode",async(s,i,o)=>{this.isInitialized();const a=ON(o),c=Bi(i);if(Iv(a))return J8(c,o==null?void 0:o.encoding);if(Nv(a)){const d=a.senderPublicKey,f=a.receiverPublicKey;s=await this.generateSharedKey(d,f)}const l=this.getSymKey(s),{type:u,senderPublicKey:h}=a;return G8({type:u,symKey:l,message:c,senderPublicKey:h,encoding:o==null?void 0:o.encoding})}),nr(this,"decode",async(s,i,o)=>{this.isInitialized();const a=Q8(i,o);if(Iv(a)){const c=Y8(i,o==null?void 0:o.encoding);return ec(c)}if(Nv(a)){const c=a.receiverPublicKey,l=a.senderPublicKey;s=await this.generateSharedKey(c,l)}try{const c=this.getSymKey(s),l=K8({symKey:c,encoded:i,encoding:o==null?void 0:o.encoding});return ec(l)}catch(c){this.logger.error(`Failed to decode message from topic: '${s}', clientId: '${await this.getClientId()}'`),this.logger.error(c)}}),nr(this,"getPayloadType",(s,i=cs)=>{const o=Yh({encoded:s,encoding:i});return nc(o.type)}),nr(this,"getPayloadSenderPublicKey",(s,i=cs)=>{const o=Yh({encoded:s,encoding:i});return o.senderPublicKey?Jr(o.senderPublicKey,Ur):void 0}),this.core=e,this.logger=Ir(t,this.name),this.keychain=n||new R4(this.core,this.logger)}get context(){return Xr(this.logger)}async setPrivateKey(e,t){return await this.keychain.set(e,t),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(Hv)}catch{e=cw(),await this.keychain.set(Hv,e)}return T4(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=te("NOT_INITIALIZED",this.name);throw new Error(e)}}}var B4=Object.defineProperty,L4=Object.defineProperties,$4=Object.getOwnPropertyDescriptors,Qv=Object.getOwnPropertySymbols,M4=Object.prototype.hasOwnProperty,F4=Object.prototype.propertyIsEnumerable,mw=(r,e,t)=>e in r?B4(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,j4=(r,e)=>{for(var t in e||(e={}))M4.call(e,t)&&mw(r,t,e[t]);if(Qv)for(var t of Qv(e))F4.call(e,t)&&mw(r,t,e[t]);return r},H4=(r,e)=>L4(r,$4(e)),sn=(r,e,t)=>mw(r,typeof e!="symbol"?e+"":e,t);class z4 extends VO{constructor(e,t){super(e,t),this.logger=e,this.core=t,sn(this,"messages",new Map),sn(this,"messagesWithoutClientAck",new Map),sn(this,"name",kL),sn(this,"version",UL),sn(this,"initialized",!1),sn(this,"storagePrefix",Ks),sn(this,"init",async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n);const s=await this.getRelayerMessagesWithoutClientAck();typeof s<"u"&&(this.messagesWithoutClientAck=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}}),sn(this,"set",async(n,s,i)=>{this.isInitialized();const o=Ls(s);let a=this.messages.get(n);if(typeof a>"u"&&(a={}),typeof a[o]<"u")return o;if(a[o]=s,this.messages.set(n,a),i===wp.inbound){const c=this.messagesWithoutClientAck.get(n)||{};this.messagesWithoutClientAck.set(n,H4(j4({},c),{[o]:s}))}return await this.persist(),o}),sn(this,"get",n=>{this.isInitialized();let s=this.messages.get(n);return typeof s>"u"&&(s={}),s}),sn(this,"getWithoutAck",n=>{this.isInitialized();const s={};for(const i of n){const o=this.messagesWithoutClientAck.get(i)||{};s[i]=Object.values(o)}return s}),sn(this,"has",(n,s)=>{this.isInitialized();const i=this.get(n),o=Ls(s);return typeof i[o]<"u"}),sn(this,"ack",async(n,s)=>{this.isInitialized();const i=this.messagesWithoutClientAck.get(n);if(typeof i>"u")return;const o=Ls(s);delete i[o],Object.keys(i).length===0?this.messagesWithoutClientAck.delete(n):this.messagesWithoutClientAck.set(n,i),await this.persist()}),sn(this,"del",async n=>{this.isInitialized(),this.messages.delete(n),this.messagesWithoutClientAck.delete(n),await this.persist()}),this.logger=Ir(e,this.name),this.core=t}get context(){return Xr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get storageKeyWithoutClientAck(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name+"_withoutClientAck"}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,Qy(e))}async setRelayerMessagesWithoutClientAck(e){await this.core.storage.setItem(this.storageKeyWithoutClientAck,Qy(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Zy(e):void 0}async getRelayerMessagesWithoutClientAck(){const e=await this.core.storage.getItem(this.storageKeyWithoutClientAck);return typeof e<"u"?Zy(e):void 0}async persist(){await this.setRelayerMessages(this.messages),await this.setRelayerMessagesWithoutClientAck(this.messagesWithoutClientAck)}isInitialized(){if(!this.initialized){const{message:e}=te("NOT_INITIALIZED",this.name);throw new Error(e)}}}var q4=Object.defineProperty,V4=Object.defineProperties,W4=Object.getOwnPropertyDescriptors,Zv=Object.getOwnPropertySymbols,G4=Object.prototype.hasOwnProperty,K4=Object.prototype.propertyIsEnumerable,yw=(r,e,t)=>e in r?q4(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Vf=(r,e)=>{for(var t in e||(e={}))G4.call(e,t)&&yw(r,t,e[t]);if(Zv)for(var t of Zv(e))K4.call(e,t)&&yw(r,t,e[t]);return r},Qm=(r,e)=>V4(r,W4(e)),Kn=(r,e,t)=>yw(r,typeof e!="symbol"?e+"":e,t);class J4 extends WO{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,Kn(this,"events",new Mn.EventEmitter),Kn(this,"name",BL),Kn(this,"queue",new Map),Kn(this,"publishTimeout",X.toMiliseconds(X.ONE_MINUTE)),Kn(this,"initialPublishTimeout",X.toMiliseconds(X.ONE_SECOND*15)),Kn(this,"needsTransportRestart",!1),Kn(this,"publish",async(n,s,i)=>{var o;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:s,opts:i}});const a=(i==null?void 0:i.ttl)||zv,c=qp(i),l=(i==null?void 0:i.prompt)||!1,u=(i==null?void 0:i.tag)||0,h=(i==null?void 0:i.id)||ga().toString(),d={topic:n,message:s,opts:{ttl:a,relay:c,prompt:l,tag:u,id:h,attestation:i==null?void 0:i.attestation,tvf:i==null?void 0:i.tvf}},f=`Failed to publish payload, please try again. id:${h} tag:${u}`;try{const g=new Promise(async p=>{const m=({id:A})=>{d.opts.id===A&&(this.removeRequestFromQueue(A),this.relayer.events.removeListener(Qt.publish,m),p(d))};this.relayer.events.on(Qt.publish,m);const w=Io(new Promise((A,v)=>{this.rpcPublish({topic:n,message:s,ttl:a,prompt:l,tag:u,id:h,attestation:i==null?void 0:i.attestation,tvf:i==null?void 0:i.tvf}).then(A).catch(N=>{this.logger.warn(N,N==null?void 0:N.message),v(N)})}),this.initialPublishTimeout,`Failed initial publish, retrying.... id:${h} tag:${u}`);try{await w,this.events.removeListener(Qt.publish,m)}catch(A){this.queue.set(h,Qm(Vf({},d),{attempt:1})),this.logger.warn(A,A==null?void 0:A.message)}});this.logger.trace({type:"method",method:"publish",params:{id:h,topic:n,message:s,opts:i}}),await Io(g,this.publishTimeout,f)}catch(g){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(g),(o=i==null?void 0:i.internal)!=null&&o.throwOnFailedPublish)throw g}finally{this.queue.delete(h)}}),Kn(this,"on",(n,s)=>{this.events.on(n,s)}),Kn(this,"once",(n,s)=>{this.events.once(n,s)}),Kn(this,"off",(n,s)=>{this.events.off(n,s)}),Kn(this,"removeListener",(n,s)=>{this.events.removeListener(n,s)}),this.relayer=e,this.logger=Ir(t,this.name),this.registerEventListeners()}get context(){return Xr(this.logger)}async rpcPublish(e){var t,n,s,i;const{topic:o,message:a,ttl:c=zv,prompt:l,tag:u,id:h,attestation:d,tvf:f}=e,g={method:Eh(qp().protocol).publish,params:Vf({topic:o,message:a,ttl:c,prompt:l,tag:u,attestation:d},f),id:h};ar((t=g.params)==null?void 0:t.prompt)&&((n=g.params)==null||delete n.prompt),ar((s=g.params)==null?void 0:s.tag)&&((i=g.params)==null||delete i.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:g});const p=await this.relayer.request(g);return this.relayer.events.emit(Qt.publish,e),this.logger.debug("Successfully Published Payload"),p}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async(e,t)=>{const n=e.attempt+1;this.queue.set(t,Qm(Vf({},e),{attempt:n}));const{topic:s,message:i,opts:o,attestation:a}=e;this.logger.warn({},`Publisher: queue->publishing: ${e.opts.id}, tag: ${e.opts.tag}, attempt: ${n}`),await this.rpcPublish(Qm(Vf({},e),{topic:s,message:i,ttl:o.ttl,prompt:o.prompt,tag:o.tag,id:o.id,attestation:a,tvf:o.tvf})),this.logger.warn({},`Publisher: queue->published: ${e.opts.id}`)})}registerEventListeners(){this.relayer.core.heartbeat.on(Uu.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Qt.connection_stalled);return}this.checkQueue()}),this.relayer.on(Qt.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}var Y4=Object.defineProperty,Q4=(r,e,t)=>e in r?Y4(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,kc=(r,e,t)=>Q4(r,typeof e!="symbol"?e+"":e,t);class Z4{constructor(){kc(this,"map",new Map),kc(this,"set",(e,t)=>{const n=this.get(e);this.exists(e,t)||this.map.set(e,[...n,t])}),kc(this,"get",e=>this.map.get(e)||[]),kc(this,"exists",(e,t)=>this.get(e).includes(t)),kc(this,"delete",(e,t)=>{if(typeof t>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const n=this.get(e);if(!this.exists(e,t))return;const s=n.filter(i=>i!==t);if(!s.length){this.map.delete(e);return}this.map.set(e,s)}),kc(this,"clear",()=>{this.map.clear()})}get topics(){return Array.from(this.map.keys())}}var X4=Object.defineProperty,eM=Object.defineProperties,tM=Object.getOwnPropertyDescriptors,Xv=Object.getOwnPropertySymbols,rM=Object.prototype.hasOwnProperty,nM=Object.prototype.propertyIsEnumerable,ww=(r,e,t)=>e in r?X4(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,uh=(r,e)=>{for(var t in e||(e={}))rM.call(e,t)&&ww(r,t,e[t]);if(Xv)for(var t of Xv(e))nM.call(e,t)&&ww(r,t,e[t]);return r},Zm=(r,e)=>eM(r,tM(e)),ht=(r,e,t)=>ww(r,typeof e!="symbol"?e+"":e,t);class sM extends JO{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,ht(this,"subscriptions",new Map),ht(this,"topicMap",new Z4),ht(this,"events",new Mn.EventEmitter),ht(this,"name",zL),ht(this,"version",qL),ht(this,"pending",new Map),ht(this,"cached",[]),ht(this,"initialized",!1),ht(this,"storagePrefix",Ks),ht(this,"subscribeTimeout",X.toMiliseconds(X.ONE_MINUTE)),ht(this,"initialSubscribeTimeout",X.toMiliseconds(X.ONE_SECOND*15)),ht(this,"clientId"),ht(this,"batchSubscribeTopicsLimit",500),ht(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),await this.restore()),this.initialized=!0}),ht(this,"subscribe",async(n,s)=>{this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:s}});try{const i=qp(s),o={topic:n,relay:i,transportType:s==null?void 0:s.transportType};this.pending.set(n,o);const a=await this.rpcSubscribe(n,i,s);return typeof a=="string"&&(this.onSubscribe(a,o),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:s}})),a}catch(i){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(i),i}}),ht(this,"unsubscribe",async(n,s)=>{this.isInitialized(),typeof(s==null?void 0:s.id)<"u"?await this.unsubscribeById(n,s.id,s):await this.unsubscribeByTopic(n,s)}),ht(this,"isSubscribed",n=>new Promise(s=>{s(this.topicMap.topics.includes(n))})),ht(this,"isKnownTopic",n=>new Promise(s=>{s(this.topicMap.topics.includes(n)||this.pending.has(n)||this.cached.some(i=>i.topic===n))})),ht(this,"on",(n,s)=>{this.events.on(n,s)}),ht(this,"once",(n,s)=>{this.events.once(n,s)}),ht(this,"off",(n,s)=>{this.events.off(n,s)}),ht(this,"removeListener",(n,s)=>{this.events.removeListener(n,s)}),ht(this,"start",async()=>{await this.onConnect()}),ht(this,"stop",async()=>{await this.onDisconnect()}),ht(this,"restart",async()=>{await this.restore(),await this.onRestart()}),ht(this,"checkPending",async()=>{if(this.pending.size===0&&(!this.initialized||!this.relayer.connected))return;const n=[];this.pending.forEach(s=>{n.push(s)}),await this.batchSubscribe(n)}),ht(this,"registerEventListeners",()=>{this.relayer.core.heartbeat.on(Uu.pulse,async()=>{await this.checkPending()}),this.events.on(ln.created,async n=>{const s=ln.created;this.logger.info(`Emitting ${s}`),this.logger.debug({type:"event",event:s,data:n}),await this.persist()}),this.events.on(ln.deleted,async n=>{const s=ln.deleted;this.logger.info(`Emitting ${s}`),this.logger.debug({type:"event",event:s,data:n}),await this.persist()})}),this.relayer=e,this.logger=Ir(t,this.name),this.clientId=""}get context(){return Xr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}get hasAnyTopics(){return this.topicMap.topics.length>0||this.pending.size>0||this.cached.length>0||this.subscriptions.size>0}hasSubscription(e,t){let n=!1;try{n=this.getSubscription(e).topic===t}catch{}return n}reset(){this.cached=[],this.initialized=!0}onDisable(){this.values.length>0&&(this.cached=this.values),this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,t){const n=this.topicMap.get(e);await Promise.all(n.map(async s=>await this.unsubscribeById(e,s,t)))}async unsubscribeById(e,t,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:n}});try{const s=qp(n);await this.restartToComplete({topic:e,id:t,relay:s}),await this.rpcUnsubscribe(e,t,s);const i=at("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,t,i),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:n}})}catch(s){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(s),s}}async rpcSubscribe(e,t,n){var s;(!n||(n==null?void 0:n.transportType)===vt.relay)&&await this.restartToComplete({topic:e,id:e,relay:t});const i={method:Eh(t.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});const o=(s=n==null?void 0:n.internal)==null?void 0:s.throwOnFailedPublish;try{const a=await this.getSubscriptionId(e);if((n==null?void 0:n.transportType)===vt.link_mode)return setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(i).catch(u=>this.logger.warn(u))},X.toMiliseconds(X.ONE_SECOND)),a;const c=new Promise(async u=>{const h=d=>{d.topic===e&&(this.events.removeListener(ln.created,h),u(d.id))};this.events.on(ln.created,h);try{const d=await Io(new Promise((f,g)=>{this.relayer.request(i).catch(p=>{this.logger.warn(p,p==null?void 0:p.message),g(p)}).then(f)}),this.initialSubscribeTimeout,`Subscribing to ${e} failed, please try again`);this.events.removeListener(ln.created,h),u(d)}catch{}}),l=await Io(c,this.subscribeTimeout,`Subscribing to ${e} failed, please try again`);if(!l&&o)throw new Error(`Subscribing to ${e} failed, please try again`);return l?a:null}catch(a){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Qt.connection_stalled),o)throw a}return null}async rpcBatchSubscribe(e){if(!e.length)return;const t=e[0].relay,n={method:Eh(t.protocol).batchSubscribe,params:{topics:e.map(s=>s.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{await await Io(new Promise(s=>{this.relayer.request(n).catch(i=>this.logger.warn(i)).then(s)}),this.subscribeTimeout,"rpcBatchSubscribe failed, please try again")}catch{this.relayer.events.emit(Qt.connection_stalled)}}async rpcBatchFetchMessages(e){if(!e.length)return;const t=e[0].relay,n={method:Eh(t.protocol).batchFetchMessages,params:{topics:e.map(i=>i.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});let s;try{s=await await Io(new Promise((i,o)=>{this.relayer.request(n).catch(a=>{this.logger.warn(a),o(a)}).then(i)}),this.subscribeTimeout,"rpcBatchFetchMessages failed, please try again")}catch{this.relayer.events.emit(Qt.connection_stalled)}return s}rpcUnsubscribe(e,t,n){const s={method:Eh(n.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s}),this.relayer.request(s)}onSubscribe(e,t){this.setSubscription(e,Zm(uh({},t),{id:e})),this.pending.delete(t.topic)}onBatchSubscribe(e){e.length&&e.forEach(t=>{this.setSubscription(t.id,uh({},t)),this.pending.delete(t.topic)})}async onUnsubscribe(e,t,n){this.events.removeAllListeners(t),this.hasSubscription(t,e)&&this.deleteSubscription(t,n),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,t){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t)}addSubscription(e,t){this.subscriptions.set(e,uh({},t)),this.topicMap.set(t.topic,e),this.events.emit(ln.created,t)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const t=this.subscriptions.get(e);if(!t){const{message:n}=te("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(n)}return t}deleteSubscription(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});const n=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(n.topic,e),this.events.emit(ln.deleted,Zm(uh({},n),{reason:t}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(ln.sync)}async onRestart(){if(this.cached.length){const e=[...this.cached],t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let n=0;n<t;n++){const s=e.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(ln.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:t}=te("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){e.length&&(await this.rpcBatchSubscribe(e),this.onBatchSubscribe(await Promise.all(e.map(async t=>Zm(uh({},t),{id:await this.getSubscriptionId(t.topic)})))))}async batchFetchMessages(e){if(!e.length)return;this.logger.trace(`Fetching batch messages for ${e.length} subscriptions`);const t=await this.rpcBatchFetchMessages(e);t&&t.messages&&(await RU(X.toMiliseconds(X.ONE_SECOND)),await this.relayer.handleBatchMessageEvents(t.messages))}async onConnect(){await this.restart(),this.reset()}onDisconnect(){this.onDisable()}isInitialized(){if(!this.initialized){const{message:e}=te("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(e){!this.relayer.connected&&!this.relayer.connecting&&(this.cached.push(e),await this.relayer.transportOpen())}async getClientId(){return this.clientId||(this.clientId=await this.relayer.core.crypto.getClientId()),this.clientId}async getSubscriptionId(e){return Ls(e+await this.getClientId())}}var iM=Object.defineProperty,eA=Object.getOwnPropertySymbols,oM=Object.prototype.hasOwnProperty,aM=Object.prototype.propertyIsEnumerable,bw=(r,e,t)=>e in r?iM(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,tA=(r,e)=>{for(var t in e||(e={}))oM.call(e,t)&&bw(r,t,e[t]);if(eA)for(var t of eA(e))aM.call(e,t)&&bw(r,t,e[t]);return r},Ge=(r,e,t)=>bw(r,typeof e!="symbol"?e+"":e,t);class cM extends GO{constructor(e){super(e),Ge(this,"protocol","wc"),Ge(this,"version",2),Ge(this,"core"),Ge(this,"logger"),Ge(this,"events",new Mn.EventEmitter),Ge(this,"provider"),Ge(this,"messages"),Ge(this,"subscriber"),Ge(this,"publisher"),Ge(this,"name",$L),Ge(this,"transportExplicitlyClosed",!1),Ge(this,"initialized",!1),Ge(this,"connectionAttemptInProgress",!1),Ge(this,"relayUrl"),Ge(this,"projectId"),Ge(this,"packageName"),Ge(this,"bundleId"),Ge(this,"hasExperiencedNetworkDisruption",!1),Ge(this,"pingTimeout"),Ge(this,"heartBeatTimeout",X.toMiliseconds(X.THIRTY_SECONDS+X.FIVE_SECONDS)),Ge(this,"reconnectTimeout"),Ge(this,"connectPromise"),Ge(this,"reconnectInProgress",!1),Ge(this,"requestsInFlight",[]),Ge(this,"connectTimeout",X.toMiliseconds(X.ONE_SECOND*15)),Ge(this,"request",async t=>{var n,s;this.logger.debug("Publishing Request Payload");const i=t.id||ga().toString();await this.toEstablishConnection();try{this.logger.trace({id:i,method:t.method,topic:(n=t.params)==null?void 0:n.topic},"relayer.request - publishing...");const o=`${i}:${((s=t.params)==null?void 0:s.tag)||""}`;this.requestsInFlight.push(o);const a=await this.provider.request(t);return this.requestsInFlight=this.requestsInFlight.filter(c=>c!==o),a}catch(o){throw this.logger.debug(`Failed to Publish Request: ${i}`),o}}),Ge(this,"resetPingTimeout",()=>{Hp()&&(clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var t,n,s,i;try{this.logger.debug({},"pingTimeout: Connection stalled, terminating..."),(i=(s=(n=(t=this.provider)==null?void 0:t.connection)==null?void 0:n.socket)==null?void 0:s.terminate)==null||i.call(s)}catch(o){this.logger.warn(o,o==null?void 0:o.message)}},this.heartBeatTimeout))}),Ge(this,"onPayloadHandler",t=>{this.onProviderPayload(t),this.resetPingTimeout()}),Ge(this,"onConnectHandler",()=>{this.logger.warn({},"Relayer connected "),this.startPingTimeout(),this.events.emit(Qt.connect)}),Ge(this,"onDisconnectHandler",()=>{this.logger.warn({},"Relayer disconnected "),this.requestsInFlight=[],this.onProviderDisconnect()}),Ge(this,"onProviderErrorHandler",t=>{this.logger.fatal(`Fatal socket error: ${t.message}`),this.events.emit(Qt.error,t),this.logger.fatal("Fatal socket error received, closing transport"),this.transportClose()}),Ge(this,"registerProviderListeners",()=>{this.provider.on(Cn.payload,this.onPayloadHandler),this.provider.on(Cn.connect,this.onConnectHandler),this.provider.on(Cn.disconnect,this.onDisconnectHandler),this.provider.on(Cn.error,this.onProviderErrorHandler)}),this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?Ir(e.logger,this.name):of(Bu({level:e.logger||LL})),this.messages=new z4(this.logger,e.core),this.subscriber=new sM(this,this.logger),this.publisher=new J4(this,this.logger),this.relayUrl=(e==null?void 0:e.relayUrl)||qN,this.projectId=e.projectId,mU()?this.packageName=JE():yU()&&(this.bundleId=JE()),this.provider={}}async init(){if(this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.subscriber.hasAnyTopics)try{await this.transportOpen()}catch(e){this.logger.warn(e,e==null?void 0:e.message)}}get context(){return Xr(this.logger)}get connected(){var e,t,n;return((n=(t=(e=this.provider)==null?void 0:e.connection)==null?void 0:t.socket)==null?void 0:n.readyState)===1||!1}get connecting(){var e,t,n;return((n=(t=(e=this.provider)==null?void 0:e.connection)==null?void 0:t.socket)==null?void 0:n.readyState)===0||this.connectPromise!==void 0||!1}async publish(e,t,n){this.isInitialized(),await this.publisher.publish(e,t,n),await this.recordMessageEvent({topic:e,message:t,publishedAt:Date.now(),transportType:vt.relay},wp.outbound)}async subscribe(e,t){var n,s,i;this.isInitialized(),(!(t!=null&&t.transportType)||(t==null?void 0:t.transportType)==="relay")&&await this.toEstablishConnection();const o=typeof((n=t==null?void 0:t.internal)==null?void 0:n.throwOnFailedPublish)>"u"?!0:(s=t==null?void 0:t.internal)==null?void 0:s.throwOnFailedPublish;let a=((i=this.subscriber.topicMap.get(e))==null?void 0:i[0])||"",c;const l=u=>{u.topic===e&&(this.subscriber.off(ln.created,l),c())};return await Promise.all([new Promise(u=>{c=u,this.subscriber.on(ln.created,l)}),new Promise(async(u,h)=>{a=await this.subscriber.subscribe(e,tA({internal:{throwOnFailedPublish:o}},t)).catch(d=>{o&&h(d)})||a,u()})]),a}async unsubscribe(e,t){this.isInitialized(),await this.subscriber.unsubscribe(e,t)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async transportDisconnect(){this.provider.disconnect&&(this.hasExperiencedNetworkDisruption||this.connected)?await Io(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(e){if(!this.subscriber.hasAnyTopics){this.logger.warn("Starting WS connection skipped because the client has no topics to work with.");return}if(this.connectPromise?(this.logger.debug({},"Waiting for existing connection attempt to resolve..."),await this.connectPromise,this.logger.debug({},"Existing connection attempt resolved")):(this.connectPromise=new Promise(async(t,n)=>{await this.connect(e).then(t).catch(n).finally(()=>{this.connectPromise=void 0})}),await this.connectPromise),!this.connected)throw new Error(`Couldn't establish socket connection to the relay server: ${this.relayUrl}`)}async restartTransport(e){this.logger.debug({},"Restarting transport..."),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await kv())throw new Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(e){if((e==null?void 0:e.length)===0){this.logger.trace("Batch message events is empty. Ignoring...");return}const t=e.sort((n,s)=>n.publishedAt-s.publishedAt);this.logger.debug(`Batch of ${t.length} message events sorted`);for(const n of t)try{await this.onMessageEvent(n)}catch(s){this.logger.warn(s,"Error while processing batch message event: "+(s==null?void 0:s.message))}this.logger.trace(`Batch of ${t.length} message events processed`)}async onLinkMessageEvent(e,t){const{topic:n}=e;if(!t.sessionExists){const s=Ht(X.FIVE_MINUTES),i={topic:n,expiry:s,relay:{protocol:"irn"},active:!1};await this.core.pairing.pairings.set(n,i)}this.events.emit(Qt.message,e),await this.recordMessageEvent(e,wp.inbound)}async connect(e){await this.confirmOnlineStateOrThrow(),e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportDisconnect()),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;let t=1;for(;t<6;){try{if(this.transportExplicitlyClosed)break;this.logger.debug({},`Connecting to ${this.relayUrl}, attempt: ${t}...`),await this.createProvider(),await new Promise(async(n,s)=>{const i=()=>{s(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(Cn.disconnect,i),await Io(new Promise((o,a)=>{this.provider.connect().then(o).catch(a)}),this.connectTimeout,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(o=>{s(o)}).finally(()=>{this.provider.off(Cn.disconnect,i),clearTimeout(this.reconnectTimeout)}),await new Promise(async(o,a)=>{const c=()=>{a(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(Cn.disconnect,c),await this.subscriber.start().then(o).catch(a).finally(()=>{this.provider.off(Cn.disconnect,c)})}),this.hasExperiencedNetworkDisruption=!1,n()})}catch(n){await this.subscriber.stop();const s=n;this.logger.warn({},s.message),this.hasExperiencedNetworkDisruption=!0}finally{this.connectionAttemptInProgress=!1}if(this.connected){this.logger.debug({},`Connected to ${this.relayUrl} successfully on attempt: ${t}`);break}await new Promise(n=>setTimeout(n,X.toMiliseconds(t*1))),t++}}startPingTimeout(){var e,t,n,s,i;if(Hp())try{(t=(e=this.provider)==null?void 0:e.connection)!=null&&t.socket&&((i=(s=(n=this.provider)==null?void 0:n.connection)==null?void 0:s.socket)==null||i.on("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(o){this.logger.warn(o,o==null?void 0:o.message)}}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Fn(new IL(AU({sdkVersion:fw,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId,packageName:this.packageName}))),this.registerProviderListeners()}async recordMessageEvent(e,t){const{topic:n,message:s}=e;await this.messages.set(n,s,t)}async shouldIgnoreMessageEvent(e){const{topic:t,message:n}=e;if(!n||n.length===0)return this.logger.warn(`Ignoring invalid/empty message: ${n}`),!0;if(!await this.subscriber.isKnownTopic(t))return this.logger.warn(`Ignoring message for unknown topic ${t}`),!0;const s=this.messages.has(t,n);return s&&this.logger.warn(`Ignoring duplicate message: ${n}`),s}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),zb(e)){if(!e.method.endsWith(ML))return;const t=e.params,{topic:n,message:s,publishedAt:i,attestation:o}=t.data,a={topic:n,message:s,publishedAt:i,transportType:vt.relay,attestation:o};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(tA({type:"event",event:t.id},a)),this.events.emit(t.id,a),await this.acknowledgePayload(e),await this.onMessageEvent(a)}else zg(e)&&this.events.emit(Qt.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(await this.recordMessageEvent(e,wp.inbound),this.events.emit(Qt.message,e))}async acknowledgePayload(e){const t=jg(e.id,!0);await this.provider.connection.send(t)}unregisterProviderListeners(){this.provider.off(Cn.payload,this.onPayloadHandler),this.provider.off(Cn.connect,this.onConnectHandler),this.provider.off(Cn.disconnect,this.onDisconnectHandler),this.provider.off(Cn.error,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let e=await kv();BB(async t=>{e!==t&&(e=t,t?await this.transportOpen().catch(n=>this.logger.error(n,n==null?void 0:n.message)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))})}async onProviderDisconnect(){clearTimeout(this.pingTimeout),this.events.emit(Qt.disconnect),this.connectionAttemptInProgress=!1,!this.reconnectInProgress&&(this.reconnectInProgress=!0,await this.subscriber.stop(),this.subscriber.hasAnyTopics&&(this.transportExplicitlyClosed||(this.reconnectTimeout=setTimeout(async()=>{await this.transportOpen().catch(e=>this.logger.error(e,e==null?void 0:e.message)),this.reconnectTimeout=void 0,this.reconnectInProgress=!1},X.toMiliseconds(FL)))))}isInitialized(){if(!this.initialized){const{message:e}=te("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectPromise){await this.connectPromise;return}await this.connect()}}}function lM(){}function rA(r){if(!r||typeof r!="object")return!1;const e=Object.getPrototypeOf(r);return e===null||e===Object.prototype||Object.getPrototypeOf(e)===null?Object.prototype.toString.call(r)==="[object Object]":!1}function nA(r){return Object.getOwnPropertySymbols(r).filter(e=>Object.prototype.propertyIsEnumerable.call(r,e))}function sA(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}const uM="[object RegExp]",hM="[object String]",dM="[object Number]",fM="[object Boolean]",iA="[object Arguments]",pM="[object Symbol]",gM="[object Date]",mM="[object Map]",yM="[object Set]",wM="[object Array]",bM="[object Function]",EM="[object ArrayBuffer]",Xm="[object Object]",vM="[object Error]",AM="[object DataView]",CM="[object Uint8Array]",_M="[object Uint8ClampedArray]",NM="[object Uint16Array]",IM="[object Uint32Array]",SM="[object BigUint64Array]",xM="[object Int8Array]",TM="[object Int16Array]",PM="[object Int32Array]",OM="[object BigInt64Array]",RM="[object Float32Array]",DM="[object Float64Array]";function kM(r,e){return r===e||Number.isNaN(r)&&Number.isNaN(e)}function UM(r,e,t){return Ah(r,e,void 0,void 0,void 0,void 0,t)}function Ah(r,e,t,n,s,i,o){const a=o(r,e,t,n,s,i);if(a!==void 0)return a;if(typeof r==typeof e)switch(typeof r){case"bigint":case"string":case"boolean":case"symbol":case"undefined":return r===e;case"number":return r===e||Object.is(r,e);case"function":return r===e;case"object":return Dh(r,e,i,o)}return Dh(r,e,i,o)}function Dh(r,e,t,n){if(Object.is(r,e))return!0;let s=sA(r),i=sA(e);if(s===iA&&(s=Xm),i===iA&&(i=Xm),s!==i)return!1;switch(s){case hM:return r.toString()===e.toString();case dM:{const c=r.valueOf(),l=e.valueOf();return kM(c,l)}case fM:case gM:case pM:return Object.is(r.valueOf(),e.valueOf());case uM:return r.source===e.source&&r.flags===e.flags;case bM:return r===e}t=t??new Map;const o=t.get(r),a=t.get(e);if(o!=null&&a!=null)return o===e;t.set(r,e),t.set(e,r);try{switch(s){case mM:{if(r.size!==e.size)return!1;for(const[c,l]of r.entries())if(!e.has(c)||!Ah(l,e.get(c),c,r,e,t,n))return!1;return!0}case yM:{if(r.size!==e.size)return!1;const c=Array.from(r.values()),l=Array.from(e.values());for(let u=0;u<c.length;u++){const h=c[u],d=l.findIndex(f=>Ah(h,f,void 0,r,e,t,n));if(d===-1)return!1;l.splice(d,1)}return!0}case wM:case CM:case _M:case NM:case IM:case SM:case xM:case TM:case PM:case OM:case RM:case DM:{if(typeof Buffer<"u"&&Buffer.isBuffer(r)!==Buffer.isBuffer(e)||r.length!==e.length)return!1;for(let c=0;c<r.length;c++)if(!Ah(r[c],e[c],c,r,e,t,n))return!1;return!0}case EM:return r.byteLength!==e.byteLength?!1:Dh(new Uint8Array(r),new Uint8Array(e),t,n);case AM:return r.byteLength!==e.byteLength||r.byteOffset!==e.byteOffset?!1:Dh(new Uint8Array(r),new Uint8Array(e),t,n);case vM:return r.name===e.name&&r.message===e.message;case Xm:{if(!(Dh(r.constructor,e.constructor,t,n)||rA(r)&&rA(e)))return!1;const c=[...Object.keys(r),...nA(r)],l=[...Object.keys(e),...nA(e)];if(c.length!==l.length)return!1;for(let u=0;u<c.length;u++){const h=c[u],d=r[h];if(!Object.hasOwn(e,h))return!1;const f=e[h];if(!Ah(d,f,h,r,e,t,n))return!1}return!0}default:return!1}}finally{t.delete(r),t.delete(e)}}function BM(r,e){return UM(r,e,lM)}var LM=Object.defineProperty,oA=Object.getOwnPropertySymbols,$M=Object.prototype.hasOwnProperty,MM=Object.prototype.propertyIsEnumerable,Ew=(r,e,t)=>e in r?LM(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,aA=(r,e)=>{for(var t in e||(e={}))$M.call(e,t)&&Ew(r,t,e[t]);if(oA)for(var t of oA(e))MM.call(e,t)&&Ew(r,t,e[t]);return r},Mr=(r,e,t)=>Ew(r,typeof e!="symbol"?e+"":e,t);class bc extends KO{constructor(e,t,n,s=Ks,i=void 0){super(e,t,n,s),this.core=e,this.logger=t,this.name=n,Mr(this,"map",new Map),Mr(this,"version",jL),Mr(this,"cached",[]),Mr(this,"initialized",!1),Mr(this,"getKey"),Mr(this,"storagePrefix",Ks),Mr(this,"recentlyDeleted",[]),Mr(this,"recentlyDeletedLimit",200),Mr(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(o=>{this.getKey&&o!==null&&!ar(o)?this.map.set(this.getKey(o),o):fB(o)?this.map.set(o.id,o):pB(o)&&this.map.set(o.topic,o)}),this.cached=[],this.initialized=!0)}),Mr(this,"set",async(o,a)=>{this.isInitialized(),this.map.has(o)?await this.update(o,a):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:o,value:a}),this.map.set(o,a),await this.persist())}),Mr(this,"get",o=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:o}),this.getData(o))),Mr(this,"getAll",o=>(this.isInitialized(),o?this.values.filter(a=>Object.keys(o).every(c=>BM(a[c],o[c]))):this.values)),Mr(this,"update",async(o,a)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:o,update:a});const c=aA(aA({},this.getData(o)),a);this.map.set(o,c),await this.persist()}),Mr(this,"delete",async(o,a)=>{this.isInitialized(),this.map.has(o)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:o,reason:a}),this.map.delete(o),this.addToRecentlyDeleted(o),await this.persist())}),this.logger=Ir(t,this.name),this.storagePrefix=s,this.getKey=i}get context(){return Xr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(e){this.recentlyDeleted.push(e),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const t=this.map.get(e);if(!t){if(this.recentlyDeleted.includes(e)){const{message:s}=te("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}const{message:n}=te("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(n),new Error(n)}return t}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:t}=te("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=te("NOT_INITIALIZED",this.name);throw new Error(e)}}}var FM=Object.defineProperty,jM=(r,e,t)=>e in r?FM(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Fe=(r,e,t)=>jM(r,typeof e!="symbol"?e+"":e,t);class HM{constructor(e,t){this.core=e,this.logger=t,Fe(this,"name",VL),Fe(this,"version",WL),Fe(this,"events",new vb),Fe(this,"pairings"),Fe(this,"initialized",!1),Fe(this,"storagePrefix",Ks),Fe(this,"ignoredPayloadTypes",[Di]),Fe(this,"registeredMethods",[]),Fe(this,"init",async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))}),Fe(this,"register",({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]}),Fe(this,"create",async n=>{this.isInitialized();const s=cw(),i=await this.core.crypto.setSymKey(s),o=Ht(X.FIVE_MINUTES),a={protocol:zN},c={topic:i,expiry:o,relay:a,active:!1,methods:n==null?void 0:n.methods},l=xv({protocol:this.core.protocol,version:this.core.version,topic:i,symKey:s,relay:a,expiryTimestamp:o,methods:n==null?void 0:n.methods});return this.events.emit(aa.create,c),this.core.expirer.set(i,o),await this.pairings.set(i,c),await this.core.relayer.subscribe(i,{transportType:n==null?void 0:n.transportType}),{topic:i,uri:l}}),Fe(this,"pair",async n=>{this.isInitialized();const s=this.core.eventClient.createEvent({properties:{topic:n==null?void 0:n.uri,trace:[_s.pairing_started]}});this.isValidPair(n,s);const{topic:i,symKey:o,relay:a,expiryTimestamp:c,methods:l}=Sv(n.uri);s.props.properties.topic=i,s.addTrace(_s.pairing_uri_validation_success),s.addTrace(_s.pairing_uri_not_expired);let u;if(this.pairings.keys.includes(i)){if(u=this.pairings.get(i),s.addTrace(_s.existing_pairing),u.active)throw s.setError(ci.active_pairing_already_exists),new Error(`Pairing already exists: ${i}. Please try again with a new connection URI.`);s.addTrace(_s.pairing_not_expired)}const h=c||Ht(X.FIVE_MINUTES),d={topic:i,relay:a,expiry:h,active:!1,methods:l};this.core.expirer.set(i,h),await this.pairings.set(i,d),s.addTrace(_s.store_new_pairing),n.activatePairing&&await this.activate({topic:i}),this.events.emit(aa.create,d),s.addTrace(_s.emit_inactive_pairing),this.core.crypto.keychain.has(i)||await this.core.crypto.setSymKey(o,i),s.addTrace(_s.subscribing_pairing_topic);try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{s.setError(ci.no_internet_connection)}try{await this.core.relayer.subscribe(i,{relay:a})}catch(f){throw s.setError(ci.subscribe_pairing_topic_failure),f}return s.addTrace(_s.subscribe_pairing_topic_success),d}),Fe(this,"activate",async({topic:n})=>{this.isInitialized();const s=Ht(X.FIVE_MINUTES);this.core.expirer.set(n,s),await this.pairings.update(n,{active:!0,expiry:s})}),Fe(this,"ping",async n=>{this.isInitialized(),await this.isValidPing(n),this.logger.warn("ping() is deprecated and will be removed in the next major release.");const{topic:s}=n;if(this.pairings.keys.includes(s)){const i=await this.sendRequest(s,"wc_pairingPing",{}),{done:o,resolve:a,reject:c}=ta();this.events.once(et("pairing_ping",i),({error:l})=>{l?c(l):a()}),await o()}}),Fe(this,"updateExpiry",async({topic:n,expiry:s})=>{this.isInitialized(),await this.pairings.update(n,{expiry:s})}),Fe(this,"updateMetadata",async({topic:n,metadata:s})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:s})}),Fe(this,"getPairings",()=>(this.isInitialized(),this.pairings.values)),Fe(this,"disconnect",async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:s}=n;this.pairings.keys.includes(s)&&(await this.sendRequest(s,"wc_pairingDelete",at("USER_DISCONNECTED")),await this.deletePairing(s))}),Fe(this,"formatUriFromPairing",n=>{this.isInitialized();const{topic:s,relay:i,expiry:o,methods:a}=n,c=this.core.crypto.keychain.get(s);return xv({protocol:this.core.protocol,version:this.core.version,topic:s,symKey:c,relay:i,expiryTimestamp:o,methods:a})}),Fe(this,"sendRequest",async(n,s,i)=>{const o=So(s,i),a=await this.core.crypto.encode(n,o),c=ch[s].req;return this.core.history.set(n,o),this.core.relayer.publish(n,a,c),o.id}),Fe(this,"sendResult",async(n,s,i)=>{const o=jg(n,i),a=await this.core.crypto.encode(s,o),c=(await this.core.history.get(s,n)).request.method,l=ch[c].res;await this.core.relayer.publish(s,a,l),await this.core.history.resolve(o)}),Fe(this,"sendError",async(n,s,i)=>{const o=Hg(n,i),a=await this.core.crypto.encode(s,o),c=(await this.core.history.get(s,n)).request.method,l=ch[c]?ch[c].res:ch.unregistered_method.res;await this.core.relayer.publish(s,a,l),await this.core.history.resolve(o)}),Fe(this,"deletePairing",async(n,s)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,at("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),s?Promise.resolve():this.core.expirer.del(n)])}),Fe(this,"cleanup",async()=>{const n=this.pairings.getAll().filter(s=>no(s.expiry));await Promise.all(n.map(s=>this.deletePairing(s.topic)))}),Fe(this,"onRelayEventRequest",async n=>{const{topic:s,payload:i}=n;switch(i.method){case"wc_pairingPing":return await this.onPairingPingRequest(s,i);case"wc_pairingDelete":return await this.onPairingDeleteRequest(s,i);default:return await this.onUnknownRpcMethodRequest(s,i)}}),Fe(this,"onRelayEventResponse",async n=>{const{topic:s,payload:i}=n,o=(await this.core.history.get(s,i.id)).request.method;switch(o){case"wc_pairingPing":return this.onPairingPingResponse(s,i);default:return this.onUnknownRpcMethodResponse(o)}}),Fe(this,"onPairingPingRequest",async(n,s)=>{const{id:i}=s;try{this.isValidPing({topic:n}),await this.sendResult(i,n,!0),this.events.emit(aa.ping,{id:i,topic:n})}catch(o){await this.sendError(i,n,o),this.logger.error(o)}}),Fe(this,"onPairingPingResponse",(n,s)=>{const{id:i}=s;setTimeout(()=>{Is(s)?this.events.emit(et("pairing_ping",i),{}):Bn(s)&&this.events.emit(et("pairing_ping",i),{error:s.error})},500)}),Fe(this,"onPairingDeleteRequest",async(n,s)=>{const{id:i}=s;try{this.isValidDisconnect({topic:n}),await this.deletePairing(n),this.events.emit(aa.delete,{id:i,topic:n})}catch(o){await this.sendError(i,n,o),this.logger.error(o)}}),Fe(this,"onUnknownRpcMethodRequest",async(n,s)=>{const{id:i,method:o}=s;try{if(this.registeredMethods.includes(o))return;const a=at("WC_METHOD_UNSUPPORTED",o);await this.sendError(i,n,a),this.logger.error(a)}catch(a){await this.sendError(i,n,a),this.logger.error(a)}}),Fe(this,"onUnknownRpcMethodResponse",n=>{this.registeredMethods.includes(n)||this.logger.error(at("WC_METHOD_UNSUPPORTED",n))}),Fe(this,"isValidPair",(n,s)=>{var i;if(!zr(n)){const{message:a}=te("MISSING_OR_INVALID",`pair() params: ${n}`);throw s.setError(ci.malformed_pairing_uri),new Error(a)}if(!dB(n.uri)){const{message:a}=te("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw s.setError(ci.malformed_pairing_uri),new Error(a)}const o=Sv(n==null?void 0:n.uri);if(!((i=o==null?void 0:o.relay)!=null&&i.protocol)){const{message:a}=te("MISSING_OR_INVALID","pair() uri#relay-protocol");throw s.setError(ci.malformed_pairing_uri),new Error(a)}if(!(o!=null&&o.symKey)){const{message:a}=te("MISSING_OR_INVALID","pair() uri#symKey");throw s.setError(ci.malformed_pairing_uri),new Error(a)}if(o!=null&&o.expiryTimestamp&&X.toMiliseconds(o==null?void 0:o.expiryTimestamp)<Date.now()){s.setError(ci.pairing_expired);const{message:a}=te("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(a)}}),Fe(this,"isValidPing",async n=>{if(!zr(n)){const{message:i}=te("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(i)}const{topic:s}=n;await this.isValidPairingTopic(s)}),Fe(this,"isValidDisconnect",async n=>{if(!zr(n)){const{message:i}=te("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(i)}const{topic:s}=n;await this.isValidPairingTopic(s)}),Fe(this,"isValidPairingTopic",async n=>{if(!Mt(n,!1)){const{message:s}=te("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(s)}if(!this.pairings.keys.includes(n)){const{message:s}=te("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(s)}if(no(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:s}=te("EXPIRED",`pairing topic: ${n}`);throw new Error(s)}}),this.core=e,this.logger=Ir(t,this.name),this.pairings=new bc(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Xr(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=te("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(Qt.message,async e=>{const{topic:t,message:n,transportType:s}=e;if(this.pairings.keys.includes(t)&&s!==vt.link_mode&&!this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))try{const i=await this.core.crypto.decode(t,n);zb(i)?(this.core.history.set(t,i),await this.onRelayEventRequest({topic:t,payload:i})):zg(i)&&(await this.core.history.resolve(i),await this.onRelayEventResponse({topic:t,payload:i}),this.core.history.delete(t,i.id)),await this.core.relayer.messages.ack(t,n)}catch(i){this.logger.error(i)}})}registerExpirerEvents(){this.core.expirer.on(Tn.expired,async e=>{const{topic:t}=Z_(e.target);t&&this.pairings.keys.includes(t)&&(await this.deletePairing(t,!0),this.events.emit(aa.expire,{topic:t}))})}}var zM=Object.defineProperty,qM=(r,e,t)=>e in r?zM(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,sr=(r,e,t)=>qM(r,typeof e!="symbol"?e+"":e,t);class VM extends qO{constructor(e,t){super(e,t),this.core=e,this.logger=t,sr(this,"records",new Map),sr(this,"events",new Mn.EventEmitter),sr(this,"name",GL),sr(this,"version",KL),sr(this,"cached",[]),sr(this,"initialized",!1),sr(this,"storagePrefix",Ks),sr(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),sr(this,"set",(n,s,i)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:s,chainId:i}),this.records.has(s.id))return;const o={id:s.id,topic:n,request:{method:s.method,params:s.params||null},chainId:i,expiry:Ht(X.THIRTY_DAYS)};this.records.set(o.id,o),this.persist(),this.events.emit(Wn.created,o)}),sr(this,"resolve",async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const s=await this.getRecord(n.id);typeof s.response>"u"&&(s.response=Bn(n)?{error:n.error}:{result:n.result},this.records.set(s.id,s),this.persist(),this.events.emit(Wn.updated,s))}),sr(this,"get",async(n,s)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:s}),await this.getRecord(s))),sr(this,"delete",(n,s)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:s}),this.values.forEach(i=>{if(i.topic===n){if(typeof s<"u"&&i.id!==s)return;this.records.delete(i.id),this.events.emit(Wn.deleted,i)}}),this.persist()}),sr(this,"exists",async(n,s)=>(this.isInitialized(),this.records.has(s)?(await this.getRecord(s)).topic===n:!1)),sr(this,"on",(n,s)=>{this.events.on(n,s)}),sr(this,"once",(n,s)=>{this.events.once(n,s)}),sr(this,"off",(n,s)=>{this.events.off(n,s)}),sr(this,"removeListener",(n,s)=>{this.events.removeListener(n,s)}),this.logger=Ir(t,this.name)}get context(){return Xr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(t=>{if(typeof t.response<"u")return;const n={topic:t.topic,request:So(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(n)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const t=this.records.get(e);if(!t){const{message:n}=te("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(n)}return t}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Wn.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:t}=te("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(Wn.created,e=>{const t=Wn.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.events.on(Wn.updated,e=>{const t=Wn.updated;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.events.on(Wn.deleted,e=>{const t=Wn.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.core.heartbeat.on(Uu.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let e=!1;this.records.forEach(t=>{X.toMiliseconds(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.records.delete(t.id),this.events.emit(Wn.deleted,t,!1),e=!0)}),e&&this.persist()}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=te("NOT_INITIALIZED",this.name);throw new Error(e)}}}var WM=Object.defineProperty,GM=(r,e,t)=>e in r?WM(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,wr=(r,e,t)=>GM(r,typeof e!="symbol"?e+"":e,t);class KM extends YO{constructor(e,t){super(e,t),this.core=e,this.logger=t,wr(this,"expirations",new Map),wr(this,"events",new Mn.EventEmitter),wr(this,"name",JL),wr(this,"version",YL),wr(this,"cached",[]),wr(this,"initialized",!1),wr(this,"storagePrefix",Ks),wr(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),wr(this,"has",n=>{try{const s=this.formatTarget(n);return typeof this.getExpiration(s)<"u"}catch{return!1}}),wr(this,"set",(n,s)=>{this.isInitialized();const i=this.formatTarget(n),o={target:i,expiry:s};this.expirations.set(i,o),this.checkExpiry(i,o),this.events.emit(Tn.created,{target:i,expiration:o})}),wr(this,"get",n=>{this.isInitialized();const s=this.formatTarget(n);return this.getExpiration(s)}),wr(this,"del",n=>{if(this.isInitialized(),this.has(n)){const s=this.formatTarget(n),i=this.getExpiration(s);this.expirations.delete(s),this.events.emit(Tn.deleted,{target:s,expiration:i})}}),wr(this,"on",(n,s)=>{this.events.on(n,s)}),wr(this,"once",(n,s)=>{this.events.once(n,s)}),wr(this,"off",(n,s)=>{this.events.off(n,s)}),wr(this,"removeListener",(n,s)=>{this.events.removeListener(n,s)}),this.logger=Ir(t,this.name)}get context(){return Xr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return CU(e);if(typeof e=="number")return _U(e);const{message:t}=te("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(t)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Tn.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:t}=te("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const t=this.expirations.get(e);if(!t){const{message:n}=te("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.warn(n),new Error(n)}return t}checkExpiry(e,t){const{expiry:n}=t;X.toMiliseconds(n)-Date.now()<=0&&this.expire(e,t)}expire(e,t){this.expirations.delete(e),this.events.emit(Tn.expired,{target:e,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,t)=>this.checkExpiry(t,e))}registerEventListeners(){this.core.heartbeat.on(Uu.pulse,()=>this.checkExpirations()),this.events.on(Tn.created,e=>{const t=Tn.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(Tn.expired,e=>{const t=Tn.expired;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(Tn.deleted,e=>{const t=Tn.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=te("NOT_INITIALIZED",this.name);throw new Error(e)}}}var JM=Object.defineProperty,YM=(r,e,t)=>e in r?JM(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,$t=(r,e,t)=>YM(r,typeof e!="symbol"?e+"":e,t);class QM extends QO{constructor(e,t,n){super(e,t,n),this.core=e,this.logger=t,this.store=n,$t(this,"name",QL),$t(this,"abortController"),$t(this,"isDevEnv"),$t(this,"verifyUrlV3",XL),$t(this,"storagePrefix",Ks),$t(this,"version",HN),$t(this,"publicKey"),$t(this,"fetchPromise"),$t(this,"init",async()=>{var s;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&X.toMiliseconds((s=this.publicKey)==null?void 0:s.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))}),$t(this,"register",async s=>{if(!hf()||this.isDevEnv)return;const i=window.location.origin,{id:o,decryptedId:a}=s,c=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${i}&id=${o}&decryptedId=${a}`;try{const l=lf(),u=this.startAbortTimer(X.ONE_SECOND*5),h=await new Promise((d,f)=>{const g=()=>{window.removeEventListener("message",m),l.body.removeChild(p),f("attestation aborted")};this.abortController.signal.addEventListener("abort",g);const p=l.createElement("iframe");p.src=c,p.style.display="none",p.addEventListener("error",g,{signal:this.abortController.signal});const m=w=>{if(w.data&&typeof w.data=="string")try{const A=JSON.parse(w.data);if(A.type==="verify_attestation"){if(Gy(A.attestation).payload.id!==o)return;clearInterval(u),l.body.removeChild(p),this.abortController.signal.removeEventListener("abort",g),window.removeEventListener("message",m),d(A.attestation===null?"":A.attestation)}}catch(A){this.logger.warn(A)}};l.body.appendChild(p),window.addEventListener("message",m,{signal:this.abortController.signal})});return this.logger.debug("jwt attestation",h),h}catch(l){this.logger.warn(l)}return""}),$t(this,"resolve",async s=>{if(this.isDevEnv)return"";const{attestationId:i,hash:o,encryptedId:a}=s;if(i===""){this.logger.debug("resolve: attestationId is empty, skipping");return}if(i){if(Gy(i).payload.id!==a)return;const l=await this.isValidJwtAttestation(i);if(l){if(!l.isVerified){this.logger.warn("resolve: jwt attestation: origin url not verified");return}return l}}if(!o)return;const c=this.getVerifyUrl(s==null?void 0:s.verifyUrl);return this.fetchAttestation(o,c)}),$t(this,"fetchAttestation",async(s,i)=>{this.logger.debug(`resolving attestation: ${s} from url: ${i}`);const o=this.startAbortTimer(X.ONE_SECOND*5),a=await fetch(`${i}/attestation/${s}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(o),a.status===200?await a.json():void 0}),$t(this,"getVerifyUrl",s=>{let i=s||Rh;return e$.includes(i)||(this.logger.info(`verify url: ${i}, not included in trusted list, assigning default: ${Rh}`),i=Rh),i}),$t(this,"fetchPublicKey",async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);const s=this.startAbortTimer(X.FIVE_SECONDS),i=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(s),await i.json()}catch(s){this.logger.warn(s)}}),$t(this,"persistPublicKey",async s=>{this.logger.debug("persisting public key to local storage",s),await this.store.setItem(this.storeKey,s),this.publicKey=s}),$t(this,"removePublicKey",async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0}),$t(this,"isValidJwtAttestation",async s=>{const i=await this.getPublicKey();try{if(i)return this.validateAttestation(s,i)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}const o=await this.fetchAndPersistPublicKey();try{if(o)return this.validateAttestation(s,o)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}}),$t(this,"getPublicKey",async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey()),$t(this,"fetchAndPersistPublicKey",async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async i=>{const o=await this.fetchPublicKey();o&&(await this.persistPublicKey(o),i(o))});const s=await this.fetchPromise;return this.fetchPromise=void 0,s}),$t(this,"validateAttestation",(s,i)=>{const o=X8(s,i.publicKey),a={hasExpired:X.toMiliseconds(o.exp)<Date.now(),payload:o};if(a.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),new Error("JWT attestation expired");return{origin:a.payload.origin,isScam:a.payload.isScam,isVerified:a.payload.isVerified}}),this.logger=Ir(t,this.name),this.abortController=new AbortController,this.isDevEnv=Db(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return Xr(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),X.toMiliseconds(e))}}var ZM=Object.defineProperty,XM=(r,e,t)=>e in r?ZM(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,cA=(r,e,t)=>XM(r,typeof e!="symbol"?e+"":e,t);class e6 extends ZO{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,cA(this,"context",t$),cA(this,"registerDeviceToken",async n=>{const{clientId:s,token:i,notificationType:o,enableEncrypted:a=!1}=n,c=`${r$}/${this.projectId}/clients`;await fetch(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:s,type:o,token:i,always_raw:a})})}),this.logger=Ir(t,this.context)}}var t6=Object.defineProperty,lA=Object.getOwnPropertySymbols,r6=Object.prototype.hasOwnProperty,n6=Object.prototype.propertyIsEnumerable,vw=(r,e,t)=>e in r?t6(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,hh=(r,e)=>{for(var t in e||(e={}))r6.call(e,t)&&vw(r,t,e[t]);if(lA)for(var t of lA(e))n6.call(e,t)&&vw(r,t,e[t]);return r},Vt=(r,e,t)=>vw(r,typeof e!="symbol"?e+"":e,t);class s6 extends XO{constructor(e,t,n=!0){super(e,t,n),this.core=e,this.logger=t,Vt(this,"context",s$),Vt(this,"storagePrefix",Ks),Vt(this,"storageVersion",n$),Vt(this,"events",new Map),Vt(this,"shouldPersist",!1),Vt(this,"init",async()=>{if(!Db())try{const s={eventId:QE(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:Y_(this.core.relayer.protocol,this.core.relayer.version,fw)}}};await this.sendEvent([s])}catch(s){this.logger.warn(s)}}),Vt(this,"createEvent",s=>{const{event:i="ERROR",type:o="",properties:{topic:a,trace:c}}=s,l=QE(),u=this.core.projectId||"",h=Date.now(),d=hh({eventId:l,timestamp:h,props:{event:i,type:o,properties:{topic:a,trace:c}},bundleId:u,domain:this.getAppDomain()},this.setMethods(l));return this.telemetryEnabled&&(this.events.set(l,d),this.shouldPersist=!0),d}),Vt(this,"getEvent",s=>{const{eventId:i,topic:o}=s;if(i)return this.events.get(i);const a=Array.from(this.events.values()).find(c=>c.props.properties.topic===o);if(a)return hh(hh({},a),this.setMethods(a.eventId))}),Vt(this,"deleteEvent",s=>{const{eventId:i}=s;this.events.delete(i),this.shouldPersist=!0}),Vt(this,"setEventListeners",()=>{this.core.heartbeat.on(Uu.pulse,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(s=>{X.fromMiliseconds(Date.now())-X.fromMiliseconds(s.timestamp)>i$&&(this.events.delete(s.eventId),this.shouldPersist=!0)})})}),Vt(this,"setMethods",s=>({addTrace:i=>this.addTrace(s,i),setError:i=>this.setError(s,i)})),Vt(this,"addTrace",(s,i)=>{const o=this.events.get(s);o&&(o.props.properties.trace.push(i),this.events.set(s,o),this.shouldPersist=!0)}),Vt(this,"setError",(s,i)=>{const o=this.events.get(s);o&&(o.props.type=i,o.timestamp=Date.now(),this.events.set(s,o),this.shouldPersist=!0)}),Vt(this,"persist",async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1}),Vt(this,"restore",async()=>{try{const s=await this.core.storage.getItem(this.storageKey)||[];if(!s.length)return;s.forEach(i=>{this.events.set(i.eventId,hh(hh({},i),this.setMethods(i.eventId)))})}catch(s){this.logger.warn(s)}}),Vt(this,"submit",async()=>{if(!this.telemetryEnabled||this.events.size===0)return;const s=[];for(const[i,o]of this.events)o.props.type&&s.push(o);if(s.length!==0)try{if((await this.sendEvent(s)).ok)for(const i of s)this.events.delete(i.eventId),this.shouldPersist=!0}catch(i){this.logger.warn(i)}}),Vt(this,"sendEvent",async s=>{const i=this.getAppDomain()?"":"&sp=desktop";return await fetch(`${o$}?projectId=${this.core.projectId}&st=events_sdk&sv=js-${fw}${i}`,{method:"POST",body:JSON.stringify(s)})}),Vt(this,"getAppDomain",()=>J_().url),this.logger=Ir(t,this.context),this.telemetryEnabled=n,n?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}var i6=Object.defineProperty,uA=Object.getOwnPropertySymbols,o6=Object.prototype.hasOwnProperty,a6=Object.prototype.propertyIsEnumerable,Aw=(r,e,t)=>e in r?i6(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,hA=(r,e)=>{for(var t in e||(e={}))o6.call(e,t)&&Aw(r,t,e[t]);if(uA)for(var t of uA(e))a6.call(e,t)&&Aw(r,t,e[t]);return r},mt=(r,e,t)=>Aw(r,typeof e!="symbol"?e+"":e,t);let c6=class rI extends FO{constructor(e){var t;super(e),mt(this,"protocol",jN),mt(this,"version",HN),mt(this,"name",dw),mt(this,"relayUrl"),mt(this,"projectId"),mt(this,"customStoragePrefix"),mt(this,"events",new Mn.EventEmitter),mt(this,"logger"),mt(this,"heartbeat"),mt(this,"relayer"),mt(this,"crypto"),mt(this,"storage"),mt(this,"history"),mt(this,"expirer"),mt(this,"pairing"),mt(this,"verify"),mt(this,"echoClient"),mt(this,"linkModeSupportedApps"),mt(this,"eventClient"),mt(this,"initialized",!1),mt(this,"logChunkController"),mt(this,"on",(a,c)=>this.events.on(a,c)),mt(this,"once",(a,c)=>this.events.once(a,c)),mt(this,"off",(a,c)=>this.events.off(a,c)),mt(this,"removeListener",(a,c)=>this.events.removeListener(a,c)),mt(this,"dispatchEnvelope",({topic:a,message:c,sessionExists:l})=>{if(!a||!c)return;const u={topic:a,message:c,publishedAt:Date.now(),transportType:vt.link_mode};this.relayer.onLinkMessageEvent(u,{sessionExists:l})});const n=this.getGlobalCore(e==null?void 0:e.customStoragePrefix);if(n)try{return this.customStoragePrefix=n.customStoragePrefix,this.logger=n.logger,this.heartbeat=n.heartbeat,this.crypto=n.crypto,this.history=n.history,this.expirer=n.expirer,this.storage=n.storage,this.relayer=n.relayer,this.pairing=n.pairing,this.verify=n.verify,this.echoClient=n.echoClient,this.linkModeSupportedApps=n.linkModeSupportedApps,this.eventClient=n.eventClient,this.initialized=n.initialized,this.logChunkController=n.logChunkController,n}catch(a){console.warn("Failed to copy global core",a)}this.projectId=e==null?void 0:e.projectId,this.relayUrl=(e==null?void 0:e.relayUrl)||qN,this.customStoragePrefix=e!=null&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const s=Bu({level:typeof(e==null?void 0:e.logger)=="string"&&e.logger?e.logger:xL.logger,name:dw}),{logger:i,chunkLoggerController:o}=Cb({opts:s,maxSizeInBytes:e==null?void 0:e.maxLogBlobSizeInBytes,loggerOverride:e==null?void 0:e.logger});this.logChunkController=o,(t=this.logChunkController)!=null&&t.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var a,c;(a=this.logChunkController)!=null&&a.downloadLogsBlobInBrowser&&((c=this.logChunkController)==null||c.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=Ir(i,this.name),this.heartbeat=new xP,this.crypto=new U4(this,this.logger,e==null?void 0:e.keychain),this.history=new VM(this,this.logger),this.expirer=new KM(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new uO(hA(hA({},TL),e==null?void 0:e.storageOptions)),this.relayer=new cM({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new HM(this,this.logger),this.verify=new QM(this,this.logger,this.storage),this.echoClient=new e6(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new s6(this,this.logger,e==null?void 0:e.telemetryEnabled),this.setGlobalCore(this)}static async init(e){const t=new rI(e);await t.initialize();const n=await t.crypto.getClientId();return await t.storage.setItem(HL,n),t}get context(){return Xr(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var e;return(e=this.logChunkController)==null?void 0:e.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(e){this.linkModeSupportedApps.includes(e)||(this.linkModeSupportedApps.push(e),await this.storage.setItem(qv,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.linkModeSupportedApps=await this.storage.getItem(qv)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}getGlobalCore(e=""){try{if(this.isGlobalCoreDisabled())return;const t=`_walletConnectCore_${e}`,n=`${t}_count`;return globalThis[n]=(globalThis[n]||0)+1,globalThis[n]>1&&console.warn(`WalletConnect Core is already initialized. This is probably a mistake and can lead to unexpected behavior. Init() was called ${globalThis[n]} times.`),globalThis[t]}catch(t){console.warn("Failed to get global WalletConnect core",t);return}}setGlobalCore(e){var t;try{if(this.isGlobalCoreDisabled())return;const n=`_walletConnectCore_${((t=e.opts)==null?void 0:t.customStoragePrefix)||""}`;globalThis[n]=e}catch(n){console.warn("Failed to set global WalletConnect core",n)}}isGlobalCoreDisabled(){try{return typeof process<"u"&&SL.DISABLE_GLOBAL_CORE==="true"}catch{return!0}}};const l6=c6,nI="wc",sI=2,iI="client",qb=`${nI}@${sI}:${iI}:`,ey={name:iI,logger:"error"},dA="WALLETCONNECT_DEEPLINK_CHOICE",u6="proposal",fA="Proposal expired",h6="session",Uc=X.SEVEN_DAYS,d6="engine",Wt={wc_sessionPropose:{req:{ttl:X.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:X.ONE_DAY,prompt:!1,tag:1104},res:{ttl:X.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:X.ONE_DAY,prompt:!1,tag:1106},res:{ttl:X.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:X.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:X.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:X.ONE_DAY,prompt:!1,tag:1112},res:{ttl:X.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:X.ONE_DAY,prompt:!1,tag:1114},res:{ttl:X.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:X.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:X.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:X.FIVE_MINUTES,prompt:!1,tag:1119}}},ty={min:X.FIVE_MINUTES,max:X.SEVEN_DAYS},As={idle:"IDLE",active:"ACTIVE"},pA={eth_sendTransaction:{key:""},eth_sendRawTransaction:{key:""},wallet_sendCalls:{key:""},solana_signTransaction:{key:"signature"},solana_signAllTransactions:{key:"transactions"},solana_signAndSendTransaction:{key:"signature"}},f6="request",p6=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],g6="wc",m6="auth",y6="authKeys",w6="pairingTopics",b6="requests",Vg=`${g6}@${1.5}:${m6}:`,bp=`${Vg}:PUB_KEY`;var E6=Object.defineProperty,v6=Object.defineProperties,A6=Object.getOwnPropertyDescriptors,gA=Object.getOwnPropertySymbols,C6=Object.prototype.hasOwnProperty,_6=Object.prototype.propertyIsEnumerable,Cw=(r,e,t)=>e in r?E6(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,dt=(r,e)=>{for(var t in e||(e={}))C6.call(e,t)&&Cw(r,t,e[t]);if(gA)for(var t of gA(e))_6.call(e,t)&&Cw(r,t,e[t]);return r},Sr=(r,e)=>v6(r,A6(e)),V=(r,e,t)=>Cw(r,typeof e!="symbol"?e+"":e,t);class N6 extends n2{constructor(e){super(e),V(this,"name",d6),V(this,"events",new vb),V(this,"initialized",!1),V(this,"requestQueue",{state:As.idle,queue:[]}),V(this,"sessionRequestQueue",{state:As.idle,queue:[]}),V(this,"requestQueueDelay",X.ONE_SECOND),V(this,"expectedPairingMethodMap",new Map),V(this,"recentlyDeletedMap",new Map),V(this,"recentlyDeletedLimit",200),V(this,"relayMessageCache",[]),V(this,"pendingSessions",new Map),V(this,"init",async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),await this.registerLinkModeListeners(),this.client.core.pairing.register({methods:Object.keys(Wt)}),this.initialized=!0,setTimeout(async()=>{await this.processPendingMessageEvents(),this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},X.toMiliseconds(this.requestQueueDelay)))}),V(this,"connect",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();const n=Sr(dt({},t),{requiredNamespaces:t.requiredNamespaces||{},optionalNamespaces:t.optionalNamespaces||{}});await this.isValidConnect(n);const{pairingTopic:s,requiredNamespaces:i,optionalNamespaces:o,sessionProperties:a,scopedProperties:c,relays:l}=n;let u=s,h,d=!1;try{if(u){const P=this.client.core.pairing.pairings.get(u);this.client.logger.warn("connect() with existing pairing topic is deprecated and will be removed in the next major release."),d=P.active}}catch(P){throw this.client.logger.error(`connect() -> pairing.get(${u}) failed`),P}if(!u||!d){const{topic:P,uri:D}=await this.client.core.pairing.create();u=P,h=D}if(!u){const{message:P}=te("NO_MATCHING_KEY",`connect() pairing topic: ${u}`);throw new Error(P)}const f=await this.client.core.crypto.generateKeyPair(),g=Wt.wc_sessionPropose.req.ttl||X.FIVE_MINUTES,p=Ht(g),m=Sr(dt(dt({requiredNamespaces:i,optionalNamespaces:o,relays:l??[{protocol:zN}],proposer:{publicKey:f,metadata:this.client.metadata},expiryTimestamp:p,pairingTopic:u},a&&{sessionProperties:a}),c&&{scopedProperties:c}),{id:Ns()}),w=et("session_connect",m.id),{reject:A,resolve:v,done:N}=ta(g,fA),T=({id:P})=>{P===m.id&&(this.client.events.off("proposal_expire",T),this.pendingSessions.delete(m.id),this.events.emit(w,{error:{message:fA,code:0}}))};return this.client.events.on("proposal_expire",T),this.events.once(w,({error:P,session:D})=>{this.client.events.off("proposal_expire",T),P?A(P):D&&v(D)}),await this.sendRequest({topic:u,method:"wc_sessionPropose",params:m,throwOnFailedPublish:!0,clientRpcId:m.id}),await this.setProposal(m.id,m),{uri:h,approval:N}}),V(this,"pair",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{return await this.client.core.pairing.pair(t)}catch(n){throw this.client.logger.error("pair() failed"),n}}),V(this,"approve",async t=>{var n,s,i;const o=this.client.core.eventClient.createEvent({properties:{topic:(n=t==null?void 0:t.id)==null?void 0:n.toString(),trace:[Gn.session_approve_started]}});try{this.isInitialized(),await this.confirmOnlineStateOrThrow()}catch(x){throw o.setError(Ko.no_internet_connection),x}try{await this.isValidProposalId(t==null?void 0:t.id)}catch(x){throw this.client.logger.error(`approve() -> proposal.get(${t==null?void 0:t.id}) failed`),o.setError(Ko.proposal_not_found),x}try{await this.isValidApprove(t)}catch(x){throw this.client.logger.error("approve() -> isValidApprove() failed"),o.setError(Ko.session_approve_namespace_validation_failure),x}const{id:a,relayProtocol:c,namespaces:l,sessionProperties:u,scopedProperties:h,sessionConfig:d}=t,f=this.client.proposal.get(a);this.client.core.eventClient.deleteEvent({eventId:o.eventId});const{pairingTopic:g,proposer:p,requiredNamespaces:m,optionalNamespaces:w}=f;let A=(s=this.client.core.eventClient)==null?void 0:s.getEvent({topic:g});A||(A=(i=this.client.core.eventClient)==null?void 0:i.createEvent({type:Gn.session_approve_started,properties:{topic:g,trace:[Gn.session_approve_started,Gn.session_namespaces_validation_success]}}));const v=await this.client.core.crypto.generateKeyPair(),N=p.publicKey,T=await this.client.core.crypto.generateSharedKey(v,N),P=dt(dt(dt({relay:{protocol:c??"irn"},namespaces:l,controller:{publicKey:v,metadata:this.client.metadata},expiry:Ht(Uc)},u&&{sessionProperties:u}),h&&{scopedProperties:h}),d&&{sessionConfig:d}),D=vt.relay;A.addTrace(Gn.subscribing_session_topic);try{await this.client.core.relayer.subscribe(T,{transportType:D})}catch(x){throw A.setError(Ko.subscribe_session_topic_failure),x}A.addTrace(Gn.subscribe_session_topic_success);const U=Sr(dt({},P),{topic:T,requiredNamespaces:m,optionalNamespaces:w,pairingTopic:g,acknowledged:!1,self:P.controller,peer:{publicKey:p.publicKey,metadata:p.metadata},controller:v,transportType:vt.relay});await this.client.session.set(T,U),A.addTrace(Gn.store_session);try{A.addTrace(Gn.publishing_session_settle),await this.sendRequest({topic:T,method:"wc_sessionSettle",params:P,throwOnFailedPublish:!0}).catch(x=>{throw A==null||A.setError(Ko.session_settle_publish_failure),x}),A.addTrace(Gn.session_settle_publish_success),A.addTrace(Gn.publishing_session_approve),await this.sendResult({id:a,topic:g,result:{relay:{protocol:c??"irn"},responderPublicKey:v},throwOnFailedPublish:!0}).catch(x=>{throw A==null||A.setError(Ko.session_approve_publish_failure),x}),A.addTrace(Gn.session_approve_publish_success)}catch(x){throw this.client.logger.error(x),this.client.session.delete(T,at("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(T),x}return this.client.core.eventClient.deleteEvent({eventId:A.eventId}),await this.client.core.pairing.updateMetadata({topic:g,metadata:p.metadata}),await this.client.proposal.delete(a,at("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:g}),await this.setExpiry(T,Ht(Uc)),{topic:T,acknowledged:()=>Promise.resolve(this.client.session.get(T))}}),V(this,"reject",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidReject(t)}catch(o){throw this.client.logger.error("reject() -> isValidReject() failed"),o}const{id:n,reason:s}=t;let i;try{i=this.client.proposal.get(n).pairingTopic}catch(o){throw this.client.logger.error(`reject() -> proposal.get(${n}) failed`),o}i&&(await this.sendError({id:n,topic:i,error:s,rpcOpts:Wt.wc_sessionPropose.reject}),await this.client.proposal.delete(n,at("USER_DISCONNECTED")))}),V(this,"update",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidUpdate(t)}catch(h){throw this.client.logger.error("update() -> isValidUpdate() failed"),h}const{topic:n,namespaces:s}=t,{done:i,resolve:o,reject:a}=ta(),c=Ns(),l=ga().toString(),u=this.client.session.get(n).namespaces;return this.events.once(et("session_update",c),({error:h})=>{h?a(h):o()}),await this.client.session.update(n,{namespaces:s}),await this.sendRequest({topic:n,method:"wc_sessionUpdate",params:{namespaces:s},throwOnFailedPublish:!0,clientRpcId:c,relayRpcId:l}).catch(h=>{this.client.logger.error(h),this.client.session.update(n,{namespaces:u}),a(h)}),{acknowledged:i}}),V(this,"extend",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidExtend(t)}catch(c){throw this.client.logger.error("extend() -> isValidExtend() failed"),c}const{topic:n}=t,s=Ns(),{done:i,resolve:o,reject:a}=ta();return this.events.once(et("session_extend",s),({error:c})=>{c?a(c):o()}),await this.setExpiry(n,Ht(Uc)),this.sendRequest({topic:n,method:"wc_sessionExtend",params:{},clientRpcId:s,throwOnFailedPublish:!0}).catch(c=>{a(c)}),{acknowledged:i}}),V(this,"request",async t=>{this.isInitialized();try{await this.isValidRequest(t)}catch(w){throw this.client.logger.error("request() -> isValidRequest() failed"),w}const{chainId:n,request:s,topic:i,expiry:o=Wt.wc_sessionRequest.req.ttl}=t,a=this.client.session.get(i);(a==null?void 0:a.transportType)===vt.relay&&await this.confirmOnlineStateOrThrow();const c=Ns(),l=ga().toString(),{done:u,resolve:h,reject:d}=ta(o,"Request expired. Please try again.");this.events.once(et("session_request",c),({error:w,result:A})=>{w?d(w):h(A)});const f="wc_sessionRequest",g=this.getAppLinkIfEnabled(a.peer.metadata,a.transportType);if(g)return await this.sendRequest({clientRpcId:c,relayRpcId:l,topic:i,method:f,params:{request:Sr(dt({},s),{expiryTimestamp:Ht(o)}),chainId:n},expiry:o,throwOnFailedPublish:!0,appLink:g}).catch(w=>d(w)),this.client.events.emit("session_request_sent",{topic:i,request:s,chainId:n,id:c}),await u();const p={request:Sr(dt({},s),{expiryTimestamp:Ht(o)}),chainId:n},m=this.shouldSetTVF(f,p);return await Promise.all([new Promise(async w=>{await this.sendRequest(dt({clientRpcId:c,relayRpcId:l,topic:i,method:f,params:p,expiry:o,throwOnFailedPublish:!0},m&&{tvf:this.getTVFParams(c,p)})).catch(A=>d(A)),this.client.events.emit("session_request_sent",{topic:i,request:s,chainId:n,id:c}),w()}),new Promise(async w=>{var A;if(!((A=a.sessionConfig)!=null&&A.disableDeepLink)){const v=await xU(this.client.core.storage,dA);await NU({id:c,topic:i,wcDeepLink:v})}w()}),u()]).then(w=>w[2])}),V(this,"respond",async t=>{this.isInitialized(),await this.isValidRespond(t);const{topic:n,response:s}=t,{id:i}=s,o=this.client.session.get(n);o.transportType===vt.relay&&await this.confirmOnlineStateOrThrow();const a=this.getAppLinkIfEnabled(o.peer.metadata,o.transportType);Is(s)?await this.sendResult({id:i,topic:n,result:s.result,throwOnFailedPublish:!0,appLink:a}):Bn(s)&&await this.sendError({id:i,topic:n,error:s.error,appLink:a}),this.cleanupAfterResponse(t)}),V(this,"ping",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidPing(t)}catch(s){throw this.client.logger.error("ping() -> isValidPing() failed"),s}const{topic:n}=t;if(this.client.session.keys.includes(n)){const s=Ns(),i=ga().toString(),{done:o,resolve:a,reject:c}=ta();this.events.once(et("session_ping",s),({error:l})=>{l?c(l):a()}),await Promise.all([this.sendRequest({topic:n,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:s,relayRpcId:i}),o()])}else this.client.core.pairing.pairings.keys.includes(n)&&(this.client.logger.warn("ping() on pairing topic is deprecated and will be removed in the next major release."),await this.client.core.pairing.ping({topic:n}))}),V(this,"emit",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidEmit(t);const{topic:n,event:s,chainId:i}=t,o=ga().toString(),a=Ns();await this.sendRequest({topic:n,method:"wc_sessionEvent",params:{event:s,chainId:i},throwOnFailedPublish:!0,relayRpcId:o,clientRpcId:a})}),V(this,"disconnect",async t=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidDisconnect(t);const{topic:n}=t;if(this.client.session.keys.includes(n))await this.sendRequest({topic:n,method:"wc_sessionDelete",params:at("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:n,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(n))await this.client.core.pairing.disconnect({topic:n});else{const{message:s}=te("MISMATCHED_TOPIC",`Session or pairing topic not found: ${n}`);throw new Error(s)}}),V(this,"find",t=>(this.isInitialized(),this.client.session.getAll().filter(n=>uB(n,t)))),V(this,"getPendingSessionRequests",()=>this.client.pendingRequest.getAll()),V(this,"authenticate",async(t,n)=>{var s;this.isInitialized(),this.isValidAuthenticate(t);const i=n&&this.client.core.linkModeSupportedApps.includes(n)&&((s=this.client.metadata.redirect)==null?void 0:s.linkMode),o=i?vt.link_mode:vt.relay;o===vt.relay&&await this.confirmOnlineStateOrThrow();const{chains:a,statement:c="",uri:l,domain:u,nonce:h,type:d,exp:f,nbf:g,methods:p=[],expiry:m}=t,w=[...t.resources||[]],{topic:A,uri:v}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:o});this.client.logger.info({message:"Generated new pairing",pairing:{topic:A,uri:v}});const N=await this.client.core.crypto.generateKeyPair(),T=yp(N);if(await Promise.all([this.client.auth.authKeys.set(bp,{responseTopic:T,publicKey:N}),this.client.auth.pairingTopics.set(T,{topic:T,pairingTopic:A})]),await this.client.core.relayer.subscribe(T,{transportType:o}),this.client.logger.info(`sending request to new pairing topic: ${A}`),p.length>0){const{namespace:k}=fl(a[0]);let M=E5(k,"request",p);mp(w)&&(M=A5(M,w.pop())),w.push(M)}const P=m&&m>Wt.wc_sessionAuthenticate.req.ttl?m:Wt.wc_sessionAuthenticate.req.ttl,D={authPayload:{type:d??"caip122",chains:a,statement:c,aud:l,domain:u,version:"1",nonce:h,iat:new Date().toISOString(),exp:f,nbf:g,resources:w},requester:{publicKey:N,metadata:this.client.metadata},expiryTimestamp:Ht(P)},U={eip155:{chains:a,methods:[...new Set(["personal_sign",...p])],events:["chainChanged","accountsChanged"]}},x={requiredNamespaces:{},optionalNamespaces:U,relays:[{protocol:"irn"}],pairingTopic:A,proposer:{publicKey:N,metadata:this.client.metadata},expiryTimestamp:Ht(Wt.wc_sessionPropose.req.ttl),id:Ns()},{done:j,resolve:$,reject:H}=ta(P,"Request expired"),Z=Ns(),z=et("session_connect",x.id),b=et("session_request",Z),E=async({error:k,session:M})=>{this.events.off(b,O),k?H(k):M&&$({session:M})},O=async k=>{var M,G,J;if(await this.deletePendingAuthRequest(Z,{message:"fulfilled",code:0}),k.error){const Ne=at("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return k.error.code===Ne.code?void 0:(this.events.off(z,E),H(k.error.message))}await this.deleteProposal(x.id),this.events.off(z,E);const{cacaos:oe,responder:Q}=k.result,ge=[],Oe=[];for(const Ne of oe){await iv({cacao:Ne,projectId:this.client.core.projectId})||(this.client.logger.error(Ne,"Signature verification failed"),H(at("SESSION_SETTLEMENT_FAILED","Signature verification failed")));const{p:Qe}=Ne,gt=mp(Qe.resources),_t=[Xy(Qe.iss)],ut=zp(Qe.iss);if(gt){const Ot=ov(gt),Hn=av(gt);ge.push(...Ot),_t.push(...Hn)}for(const Ot of _t)Oe.push(`${Ot}:${ut}`)}const $e=await this.client.core.crypto.generateSharedKey(N,Q.publicKey);let Me;ge.length>0&&(Me={topic:$e,acknowledged:!0,self:{publicKey:N,metadata:this.client.metadata},peer:Q,controller:Q.publicKey,expiry:Ht(Uc),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:A,namespaces:Tv([...new Set(ge)],[...new Set(Oe)]),transportType:o},await this.client.core.relayer.subscribe($e,{transportType:o}),await this.client.session.set($e,Me),A&&await this.client.core.pairing.updateMetadata({topic:A,metadata:Q.metadata}),Me=this.client.session.get($e)),(M=this.client.metadata.redirect)!=null&&M.linkMode&&(G=Q.metadata.redirect)!=null&&G.linkMode&&(J=Q.metadata.redirect)!=null&&J.universal&&n&&(this.client.core.addLinkModeSupportedApp(Q.metadata.redirect.universal),this.client.session.update($e,{transportType:vt.link_mode})),$({auths:oe,session:Me})};this.events.once(z,E),this.events.once(b,O);let B;try{if(i){const k=So("wc_sessionAuthenticate",D,Z);this.client.core.history.set(A,k);const M=await this.client.core.crypto.encode("",k,{type:yf,encoding:io});B=qf(n,A,M)}else await Promise.all([this.sendRequest({topic:A,method:"wc_sessionAuthenticate",params:D,expiry:t.expiry,throwOnFailedPublish:!0,clientRpcId:Z}),this.sendRequest({topic:A,method:"wc_sessionPropose",params:x,expiry:Wt.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:x.id})])}catch(k){throw this.events.off(z,E),this.events.off(b,O),k}return await this.setProposal(x.id,x),await this.setAuthRequest(Z,{request:Sr(dt({},D),{verifyContext:{}}),pairingTopic:A,transportType:o}),{uri:B??v,response:j}}),V(this,"approveSessionAuthenticate",async t=>{const{id:n,auths:s}=t,i=this.client.core.eventClient.createEvent({properties:{topic:n.toString(),trace:[Jo.authenticated_session_approve_started]}});try{this.isInitialized()}catch(m){throw i.setError(lh.no_internet_connection),m}const o=this.getPendingAuthRequest(n);if(!o)throw i.setError(lh.authenticated_session_pending_request_not_found),new Error(`Could not find pending auth request with id ${n}`);const a=o.transportType||vt.relay;a===vt.relay&&await this.confirmOnlineStateOrThrow();const c=o.requester.publicKey,l=await this.client.core.crypto.generateKeyPair(),u=yp(c),h={type:Di,receiverPublicKey:c,senderPublicKey:l},d=[],f=[];for(const m of s){if(!await iv({cacao:m,projectId:this.client.core.projectId})){i.setError(lh.invalid_cacao);const T=at("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:n,topic:u,error:T,encodeOpts:h}),new Error(T.message)}i.addTrace(Jo.cacaos_verified);const{p:w}=m,A=mp(w.resources),v=[Xy(w.iss)],N=zp(w.iss);if(A){const T=ov(A),P=av(A);d.push(...T),v.push(...P)}for(const T of v)f.push(`${T}:${N}`)}const g=await this.client.core.crypto.generateSharedKey(l,c);i.addTrace(Jo.create_authenticated_session_topic);let p;if((d==null?void 0:d.length)>0){p={topic:g,acknowledged:!0,self:{publicKey:l,metadata:this.client.metadata},peer:{publicKey:c,metadata:o.requester.metadata},controller:c,expiry:Ht(Uc),authentication:s,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:o.pairingTopic,namespaces:Tv([...new Set(d)],[...new Set(f)]),transportType:a},i.addTrace(Jo.subscribing_authenticated_session_topic);try{await this.client.core.relayer.subscribe(g,{transportType:a})}catch(m){throw i.setError(lh.subscribe_authenticated_session_topic_failure),m}i.addTrace(Jo.subscribe_authenticated_session_topic_success),await this.client.session.set(g,p),i.addTrace(Jo.store_authenticated_session),await this.client.core.pairing.updateMetadata({topic:o.pairingTopic,metadata:o.requester.metadata})}i.addTrace(Jo.publishing_authenticated_session_approve);try{await this.sendResult({topic:u,id:n,result:{cacaos:s,responder:{publicKey:l,metadata:this.client.metadata}},encodeOpts:h,throwOnFailedPublish:!0,appLink:this.getAppLinkIfEnabled(o.requester.metadata,a)})}catch(m){throw i.setError(lh.authenticated_session_approve_publish_failure),m}return await this.client.auth.requests.delete(n,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:o.pairingTopic}),this.client.core.eventClient.deleteEvent({eventId:i.eventId}),{session:p}}),V(this,"rejectSessionAuthenticate",async t=>{this.isInitialized();const{id:n,reason:s}=t,i=this.getPendingAuthRequest(n);if(!i)throw new Error(`Could not find pending auth request with id ${n}`);i.transportType===vt.relay&&await this.confirmOnlineStateOrThrow();const o=i.requester.publicKey,a=await this.client.core.crypto.generateKeyPair(),c=yp(o),l={type:Di,receiverPublicKey:o,senderPublicKey:a};await this.sendError({id:n,topic:c,error:s,encodeOpts:l,rpcOpts:Wt.wc_sessionAuthenticate.reject,appLink:this.getAppLinkIfEnabled(i.requester.metadata,i.transportType)}),await this.client.auth.requests.delete(n,{message:"rejected",code:0}),await this.client.proposal.delete(n,at("USER_DISCONNECTED"))}),V(this,"formatAuthMessage",t=>{this.isInitialized();const{request:n,iss:s}=t;return aN(n,s)}),V(this,"processRelayMessageCache",()=>{setTimeout(async()=>{if(this.relayMessageCache.length!==0)for(;this.relayMessageCache.length>0;)try{const t=this.relayMessageCache.shift();t&&await this.onRelayMessage(t)}catch(t){this.client.logger.error(t)}},50)}),V(this,"cleanupDuplicatePairings",async t=>{if(t.pairingTopic)try{const n=this.client.core.pairing.pairings.get(t.pairingTopic),s=this.client.core.pairing.pairings.getAll().filter(i=>{var o,a;return((o=i.peerMetadata)==null?void 0:o.url)&&((a=i.peerMetadata)==null?void 0:a.url)===t.peer.metadata.url&&i.topic&&i.topic!==n.topic});if(s.length===0)return;this.client.logger.info(`Cleaning up ${s.length} duplicate pairing(s)`),await Promise.all(s.map(i=>this.client.core.pairing.disconnect({topic:i.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(n){this.client.logger.error(n)}}),V(this,"deleteSession",async t=>{var n;const{topic:s,expirerHasDeleted:i=!1,emitEvent:o=!0,id:a=0}=t,{self:c}=this.client.session.get(s);await this.client.core.relayer.unsubscribe(s),await this.client.session.delete(s,at("USER_DISCONNECTED")),this.addToRecentlyDeleted(s,"session"),this.client.core.crypto.keychain.has(c.publicKey)&&await this.client.core.crypto.deleteKeyPair(c.publicKey),this.client.core.crypto.keychain.has(s)&&await this.client.core.crypto.deleteSymKey(s),i||this.client.core.expirer.del(s),this.client.core.storage.removeItem(dA).catch(l=>this.client.logger.warn(l)),this.getPendingSessionRequests().forEach(l=>{l.topic===s&&this.deletePendingSessionRequest(l.id,at("USER_DISCONNECTED"))}),s===((n=this.sessionRequestQueue.queue[0])==null?void 0:n.topic)&&(this.sessionRequestQueue.state=As.idle),o&&this.client.events.emit("session_delete",{id:a,topic:s})}),V(this,"deleteProposal",async(t,n)=>{if(n)try{const s=this.client.proposal.get(t),i=this.client.core.eventClient.getEvent({topic:s.pairingTopic});i==null||i.setError(Ko.proposal_expired)}catch{}await Promise.all([this.client.proposal.delete(t,at("USER_DISCONNECTED")),n?Promise.resolve():this.client.core.expirer.del(t)]),this.addToRecentlyDeleted(t,"proposal")}),V(this,"deletePendingSessionRequest",async(t,n,s=!1)=>{await Promise.all([this.client.pendingRequest.delete(t,n),s?Promise.resolve():this.client.core.expirer.del(t)]),this.addToRecentlyDeleted(t,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(i=>i.id!==t),s&&(this.sessionRequestQueue.state=As.idle,this.client.events.emit("session_request_expire",{id:t}))}),V(this,"deletePendingAuthRequest",async(t,n,s=!1)=>{await Promise.all([this.client.auth.requests.delete(t,n),s?Promise.resolve():this.client.core.expirer.del(t)])}),V(this,"setExpiry",async(t,n)=>{this.client.session.keys.includes(t)&&(this.client.core.expirer.set(t,n),await this.client.session.update(t,{expiry:n}))}),V(this,"setProposal",async(t,n)=>{this.client.core.expirer.set(t,Ht(Wt.wc_sessionPropose.req.ttl)),await this.client.proposal.set(t,n)}),V(this,"setAuthRequest",async(t,n)=>{const{request:s,pairingTopic:i,transportType:o=vt.relay}=n;this.client.core.expirer.set(t,s.expiryTimestamp),await this.client.auth.requests.set(t,{authPayload:s.authPayload,requester:s.requester,expiryTimestamp:s.expiryTimestamp,id:t,pairingTopic:i,verifyContext:s.verifyContext,transportType:o})}),V(this,"setPendingSessionRequest",async t=>{const{id:n,topic:s,params:i,verifyContext:o}=t,a=i.request.expiryTimestamp||Ht(Wt.wc_sessionRequest.req.ttl);this.client.core.expirer.set(n,a),await this.client.pendingRequest.set(n,{id:n,topic:s,params:i,verifyContext:o})}),V(this,"sendRequest",async t=>{const{topic:n,method:s,params:i,expiry:o,relayRpcId:a,clientRpcId:c,throwOnFailedPublish:l,appLink:u,tvf:h}=t,d=So(s,i,c);let f;const g=!!u;try{const w=g?io:cs;f=await this.client.core.crypto.encode(n,d,{encoding:w})}catch(w){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${n} failed`),w}let p;if(p6.includes(s)){const w=Ls(JSON.stringify(d)),A=Ls(f);p=await this.client.core.verify.register({id:A,decryptedId:w})}const m=Wt[s].req;if(m.attestation=p,o&&(m.ttl=o),a&&(m.id=a),this.client.core.history.set(n,d),g){const w=qf(u,n,f);await global.Linking.openURL(w,this.client.name)}else{const w=Wt[s].req;o&&(w.ttl=o),a&&(w.id=a),w.tvf=Sr(dt({},h),{correlationId:d.id}),l?(w.internal=Sr(dt({},w.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(n,f,w)):this.client.core.relayer.publish(n,f,w).catch(A=>this.client.logger.error(A))}return d.id}),V(this,"sendResult",async t=>{const{id:n,topic:s,result:i,throwOnFailedPublish:o,encodeOpts:a,appLink:c}=t,l=jg(n,i);let u;const h=c&&typeof(global==null?void 0:global.Linking)<"u";try{const g=h?io:cs;u=await this.client.core.crypto.encode(s,l,Sr(dt({},a||{}),{encoding:g}))}catch(g){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${s} failed`),g}let d,f;try{d=await this.client.core.history.get(s,n);const g=d.request;try{this.shouldSetTVF(g.method,g.params)&&(f=this.getTVFParams(n,g.params,i))}catch(p){this.client.logger.warn("sendResult() -> getTVFParams() failed",p)}}catch(g){throw this.client.logger.error(`sendResult() -> history.get(${s}, ${n}) failed`),g}if(h){const g=qf(c,s,u);await global.Linking.openURL(g,this.client.name)}else{const g=d.request.method,p=Wt[g].res;p.tvf=Sr(dt({},f),{correlationId:n}),o?(p.internal=Sr(dt({},p.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,u,p)):this.client.core.relayer.publish(s,u,p).catch(m=>this.client.logger.error(m))}await this.client.core.history.resolve(l)}),V(this,"sendError",async t=>{const{id:n,topic:s,error:i,encodeOpts:o,rpcOpts:a,appLink:c}=t,l=Hg(n,i);let u;const h=c&&typeof(global==null?void 0:global.Linking)<"u";try{const f=h?io:cs;u=await this.client.core.crypto.encode(s,l,Sr(dt({},o||{}),{encoding:f}))}catch(f){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${s} failed`),f}let d;try{d=await this.client.core.history.get(s,n)}catch(f){throw this.client.logger.error(`sendError() -> history.get(${s}, ${n}) failed`),f}if(h){const f=qf(c,s,u);await global.Linking.openURL(f,this.client.name)}else{const f=d.request.method,g=a||Wt[f].res;this.client.core.relayer.publish(s,u,g)}await this.client.core.history.resolve(l)}),V(this,"cleanup",async()=>{const t=[],n=[];this.client.session.getAll().forEach(s=>{let i=!1;no(s.expiry)&&(i=!0),this.client.core.crypto.keychain.has(s.topic)||(i=!0),i&&t.push(s.topic)}),this.client.proposal.getAll().forEach(s=>{no(s.expiryTimestamp)&&n.push(s.id)}),await Promise.all([...t.map(s=>this.deleteSession({topic:s})),...n.map(s=>this.deleteProposal(s))])}),V(this,"onProviderMessageEvent",async t=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(t):await this.onRelayMessage(t)}),V(this,"onRelayEventRequest",async t=>{this.requestQueue.queue.push(t),await this.processRequestsQueue()}),V(this,"processRequestsQueue",async()=>{if(this.requestQueue.state===As.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=As.active;const t=this.requestQueue.queue.shift();if(t)try{await this.processRequest(t)}catch(n){this.client.logger.warn(n)}}this.requestQueue.state=As.idle}),V(this,"processRequest",async t=>{const{topic:n,payload:s,attestation:i,transportType:o,encryptedId:a}=t,c=s.method;if(!this.shouldIgnorePairingRequest({topic:n,requestMethod:c}))switch(c){case"wc_sessionPropose":return await this.onSessionProposeRequest({topic:n,payload:s,attestation:i,encryptedId:a});case"wc_sessionSettle":return await this.onSessionSettleRequest(n,s);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(n,s);case"wc_sessionExtend":return await this.onSessionExtendRequest(n,s);case"wc_sessionPing":return await this.onSessionPingRequest(n,s);case"wc_sessionDelete":return await this.onSessionDeleteRequest(n,s);case"wc_sessionRequest":return await this.onSessionRequest({topic:n,payload:s,attestation:i,encryptedId:a,transportType:o});case"wc_sessionEvent":return await this.onSessionEventRequest(n,s);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest({topic:n,payload:s,attestation:i,encryptedId:a,transportType:o});default:return this.client.logger.info(`Unsupported request method ${c}`)}}),V(this,"onRelayEventResponse",async t=>{const{topic:n,payload:s,transportType:i}=t,o=(await this.client.core.history.get(n,s.id)).request.method;switch(o){case"wc_sessionPropose":return this.onSessionProposeResponse(n,s,i);case"wc_sessionSettle":return this.onSessionSettleResponse(n,s);case"wc_sessionUpdate":return this.onSessionUpdateResponse(n,s);case"wc_sessionExtend":return this.onSessionExtendResponse(n,s);case"wc_sessionPing":return this.onSessionPingResponse(n,s);case"wc_sessionRequest":return this.onSessionRequestResponse(n,s);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(n,s);default:return this.client.logger.info(`Unsupported response method ${o}`)}}),V(this,"onRelayEventUnknownPayload",t=>{const{topic:n}=t,{message:s}=te("MISSING_OR_INVALID",`Decoded payload on topic ${n} is not identifiable as a JSON-RPC request or a response.`);throw new Error(s)}),V(this,"shouldIgnorePairingRequest",t=>{const{topic:n,requestMethod:s}=t,i=this.expectedPairingMethodMap.get(n);return!i||i.includes(s)?!1:!!(i.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)}),V(this,"onSessionProposeRequest",async t=>{const{topic:n,payload:s,attestation:i,encryptedId:o}=t,{params:a,id:c}=s;try{const l=this.client.core.eventClient.getEvent({topic:n});this.client.events.listenerCount("session_proposal")===0&&(console.warn("No listener for session_proposal event"),l==null||l.setError(ci.proposal_listener_not_found)),this.isValidConnect(dt({},s.params));const u=a.expiryTimestamp||Ht(Wt.wc_sessionPropose.req.ttl),h=dt({id:c,pairingTopic:n,expiryTimestamp:u},a);await this.setProposal(c,h);const d=await this.getVerifyContext({attestationId:i,hash:Ls(JSON.stringify(s)),encryptedId:o,metadata:h.proposer.metadata});l==null||l.addTrace(_s.emit_session_proposal),this.client.events.emit("session_proposal",{id:c,params:h,verifyContext:d})}catch(l){await this.sendError({id:c,topic:n,error:l,rpcOpts:Wt.wc_sessionPropose.autoReject}),this.client.logger.error(l)}}),V(this,"onSessionProposeResponse",async(t,n,s)=>{const{id:i}=n;if(Is(n)){const{result:o}=n;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:o});const a=this.client.proposal.get(i);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:a});const c=a.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:c});const l=o.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:l});const u=await this.client.core.crypto.generateSharedKey(c,l);this.pendingSessions.set(i,{sessionTopic:u,pairingTopic:t,proposalId:i,publicKey:c});const h=await this.client.core.relayer.subscribe(u,{transportType:s});this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:h}),await this.client.core.pairing.activate({topic:t})}else if(Bn(n)){await this.client.proposal.delete(i,at("USER_DISCONNECTED"));const o=et("session_connect",i);if(this.events.listenerCount(o)===0)throw new Error(`emitting ${o} without any listeners, 954`);this.events.emit(o,{error:n.error})}}),V(this,"onSessionSettleRequest",async(t,n)=>{const{id:s,params:i}=n;try{this.isValidSessionSettleRequest(i);const{relay:o,controller:a,expiry:c,namespaces:l,sessionProperties:u,scopedProperties:h,sessionConfig:d}=n.params,f=[...this.pendingSessions.values()].find(m=>m.sessionTopic===t);if(!f)return this.client.logger.error(`Pending session not found for topic ${t}`);const g=this.client.proposal.get(f.proposalId),p=Sr(dt(dt(dt({topic:t,relay:o,expiry:c,namespaces:l,acknowledged:!0,pairingTopic:f.pairingTopic,requiredNamespaces:g.requiredNamespaces,optionalNamespaces:g.optionalNamespaces,controller:a.publicKey,self:{publicKey:f.publicKey,metadata:this.client.metadata},peer:{publicKey:a.publicKey,metadata:a.metadata}},u&&{sessionProperties:u}),h&&{scopedProperties:h}),d&&{sessionConfig:d}),{transportType:vt.relay});await this.client.session.set(p.topic,p),await this.setExpiry(p.topic,p.expiry),await this.client.core.pairing.updateMetadata({topic:f.pairingTopic,metadata:p.peer.metadata}),this.client.events.emit("session_connect",{session:p}),this.events.emit(et("session_connect",f.proposalId),{session:p}),this.pendingSessions.delete(f.proposalId),this.deleteProposal(f.proposalId,!1),this.cleanupDuplicatePairings(p),await this.sendResult({id:n.id,topic:t,result:!0,throwOnFailedPublish:!0})}catch(o){await this.sendError({id:s,topic:t,error:o}),this.client.logger.error(o)}}),V(this,"onSessionSettleResponse",async(t,n)=>{const{id:s}=n;Is(n)?(await this.client.session.update(t,{acknowledged:!0}),this.events.emit(et("session_approve",s),{})):Bn(n)&&(await this.client.session.delete(t,at("USER_DISCONNECTED")),this.events.emit(et("session_approve",s),{error:n.error}))}),V(this,"onSessionUpdateRequest",async(t,n)=>{const{params:s,id:i}=n;try{const o=`${t}_session_update`,a=ah.get(o);if(a&&this.isRequestOutOfSync(a,i)){this.client.logger.warn(`Discarding out of sync request - ${i}`),this.sendError({id:i,topic:t,error:at("INVALID_UPDATE_REQUEST")});return}this.isValidUpdate(dt({topic:t},s));try{ah.set(o,i),await this.client.session.update(t,{namespaces:s.namespaces}),await this.sendResult({id:i,topic:t,result:!0,throwOnFailedPublish:!0})}catch(c){throw ah.delete(o),c}this.client.events.emit("session_update",{id:i,topic:t,params:s})}catch(o){await this.sendError({id:i,topic:t,error:o}),this.client.logger.error(o)}}),V(this,"isRequestOutOfSync",(t,n)=>n.toString().slice(0,-3)<t.toString().slice(0,-3)),V(this,"onSessionUpdateResponse",(t,n)=>{const{id:s}=n,i=et("session_update",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);Is(n)?this.events.emit(et("session_update",s),{}):Bn(n)&&this.events.emit(et("session_update",s),{error:n.error})}),V(this,"onSessionExtendRequest",async(t,n)=>{const{id:s}=n;try{this.isValidExtend({topic:t}),await this.setExpiry(t,Ht(Uc)),await this.sendResult({id:s,topic:t,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_extend",{id:s,topic:t})}catch(i){await this.sendError({id:s,topic:t,error:i}),this.client.logger.error(i)}}),V(this,"onSessionExtendResponse",(t,n)=>{const{id:s}=n,i=et("session_extend",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);Is(n)?this.events.emit(et("session_extend",s),{}):Bn(n)&&this.events.emit(et("session_extend",s),{error:n.error})}),V(this,"onSessionPingRequest",async(t,n)=>{const{id:s}=n;try{this.isValidPing({topic:t}),await this.sendResult({id:s,topic:t,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:s,topic:t})}catch(i){await this.sendError({id:s,topic:t,error:i}),this.client.logger.error(i)}}),V(this,"onSessionPingResponse",(t,n)=>{const{id:s}=n,i=et("session_ping",s);setTimeout(()=>{if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners 2176`);Is(n)?this.events.emit(et("session_ping",s),{}):Bn(n)&&this.events.emit(et("session_ping",s),{error:n.error})},500)}),V(this,"onSessionDeleteRequest",async(t,n)=>{const{id:s}=n;try{this.isValidDisconnect({topic:t,reason:n.params}),Promise.all([new Promise(i=>{this.client.core.relayer.once(Qt.publish,async()=>{i(await this.deleteSession({topic:t,id:s}))})}),this.sendResult({id:s,topic:t,result:!0,throwOnFailedPublish:!0}),this.cleanupPendingSentRequestsForTopic({topic:t,error:at("USER_DISCONNECTED")})]).catch(i=>this.client.logger.error(i))}catch(i){this.client.logger.error(i)}}),V(this,"onSessionRequest",async t=>{var n,s,i;const{topic:o,payload:a,attestation:c,encryptedId:l,transportType:u}=t,{id:h,params:d}=a;try{await this.isValidRequest(dt({topic:o},d));const f=this.client.session.get(o),g=await this.getVerifyContext({attestationId:c,hash:Ls(JSON.stringify(So("wc_sessionRequest",d,h))),encryptedId:l,metadata:f.peer.metadata,transportType:u}),p={id:h,topic:o,params:d,verifyContext:g};await this.setPendingSessionRequest(p),u===vt.link_mode&&(n=f.peer.metadata.redirect)!=null&&n.universal&&this.client.core.addLinkModeSupportedApp((s=f.peer.metadata.redirect)==null?void 0:s.universal),(i=this.client.signConfig)!=null&&i.disableRequestQueue?this.emitSessionRequest(p):(this.addSessionRequestToSessionRequestQueue(p),this.processSessionRequestQueue())}catch(f){await this.sendError({id:h,topic:o,error:f}),this.client.logger.error(f)}}),V(this,"onSessionRequestResponse",(t,n)=>{const{id:s}=n,i=et("session_request",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);Is(n)?this.events.emit(et("session_request",s),{result:n.result}):Bn(n)&&this.events.emit(et("session_request",s),{error:n.error})}),V(this,"onSessionEventRequest",async(t,n)=>{const{id:s,params:i}=n;try{const o=`${t}_session_event_${i.event.name}`,a=ah.get(o);if(a&&this.isRequestOutOfSync(a,s)){this.client.logger.info(`Discarding out of sync request - ${s}`);return}this.isValidEmit(dt({topic:t},i)),this.client.events.emit("session_event",{id:s,topic:t,params:i}),ah.set(o,s)}catch(o){await this.sendError({id:s,topic:t,error:o}),this.client.logger.error(o)}}),V(this,"onSessionAuthenticateResponse",(t,n)=>{const{id:s}=n;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:t,payload:n}),Is(n)?this.events.emit(et("session_request",s),{result:n.result}):Bn(n)&&this.events.emit(et("session_request",s),{error:n.error})}),V(this,"onSessionAuthenticateRequest",async t=>{var n;const{topic:s,payload:i,attestation:o,encryptedId:a,transportType:c}=t;try{const{requester:l,authPayload:u,expiryTimestamp:h}=i.params,d=await this.getVerifyContext({attestationId:o,hash:Ls(JSON.stringify(i)),encryptedId:a,metadata:l.metadata,transportType:c}),f={requester:l,pairingTopic:s,id:i.id,authPayload:u,verifyContext:d,expiryTimestamp:h};await this.setAuthRequest(i.id,{request:f,pairingTopic:s,transportType:c}),c===vt.link_mode&&(n=l.metadata.redirect)!=null&&n.universal&&this.client.core.addLinkModeSupportedApp(l.metadata.redirect.universal),this.client.events.emit("session_authenticate",{topic:s,params:i.params,id:i.id,verifyContext:d})}catch(l){this.client.logger.error(l);const u=i.params.requester.publicKey,h=await this.client.core.crypto.generateKeyPair(),d=this.getAppLinkIfEnabled(i.params.requester.metadata,c),f={type:Di,receiverPublicKey:u,senderPublicKey:h};await this.sendError({id:i.id,topic:s,error:l,encodeOpts:f,rpcOpts:Wt.wc_sessionAuthenticate.autoReject,appLink:d})}}),V(this,"addSessionRequestToSessionRequestQueue",t=>{this.sessionRequestQueue.queue.push(t)}),V(this,"cleanupAfterResponse",t=>{this.deletePendingSessionRequest(t.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=As.idle,this.processSessionRequestQueue()},X.toMiliseconds(this.requestQueueDelay))}),V(this,"cleanupPendingSentRequestsForTopic",({topic:t,error:n})=>{const s=this.client.core.history.pending;s.length>0&&s.filter(i=>i.topic===t&&i.request.method==="wc_sessionRequest").forEach(i=>{const o=i.request.id,a=et("session_request",o);if(this.events.listenerCount(a)===0)throw new Error(`emitting ${a} without any listeners`);this.events.emit(et("session_request",i.request.id),{error:n})})}),V(this,"processSessionRequestQueue",()=>{if(this.sessionRequestQueue.state===As.active){this.client.logger.info("session request queue is already active.");return}const t=this.sessionRequestQueue.queue[0];if(!t){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=As.active,this.emitSessionRequest(t)}catch(n){this.client.logger.error(n)}}),V(this,"emitSessionRequest",t=>{this.client.events.emit("session_request",t)}),V(this,"onPairingCreated",t=>{if(t.methods&&this.expectedPairingMethodMap.set(t.topic,t.methods),t.active)return;const n=this.client.proposal.getAll().find(s=>s.pairingTopic===t.topic);n&&this.onSessionProposeRequest({topic:t.topic,payload:So("wc_sessionPropose",Sr(dt({},n),{requiredNamespaces:n.requiredNamespaces,optionalNamespaces:n.optionalNamespaces,relays:n.relays,proposer:n.proposer,sessionProperties:n.sessionProperties,scopedProperties:n.scopedProperties}),n.id)})}),V(this,"isValidConnect",async t=>{if(!zr(t)){const{message:l}=te("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(t)}`);throw new Error(l)}const{pairingTopic:n,requiredNamespaces:s,optionalNamespaces:i,sessionProperties:o,scopedProperties:a,relays:c}=t;if(ar(n)||await this.isValidPairingTopic(n),!AB(c)){const{message:l}=te("MISSING_OR_INVALID",`connect() relays: ${c}`);throw new Error(l)}if(!ar(s)&&Qh(s)!==0&&this.validateNamespaces(s,"requiredNamespaces"),!ar(i)&&Qh(i)!==0&&this.validateNamespaces(i,"optionalNamespaces"),ar(o)||this.validateSessionProps(o,"sessionProperties"),!ar(a)){this.validateSessionProps(a,"scopedProperties");const l=Object.keys(s||{}).concat(Object.keys(i||{}));if(!Object.keys(a).every(u=>l.includes(u)))throw new Error(`Scoped properties must be a subset of required/optional namespaces, received: ${JSON.stringify(a)}, required/optional namespaces: ${JSON.stringify(l)}`)}}),V(this,"validateNamespaces",(t,n)=>{const s=vB(t,"connect()",n);if(s)throw new Error(s.message)}),V(this,"isValidApprove",async t=>{if(!zr(t))throw new Error(te("MISSING_OR_INVALID",`approve() params: ${t}`).message);const{id:n,namespaces:s,relayProtocol:i,sessionProperties:o,scopedProperties:a}=t;this.checkRecentlyDeleted(n),await this.isValidProposalId(n);const c=this.client.proposal.get(n),l=Km(s,"approve()");if(l)throw new Error(l.message);const u=Rv(c.requiredNamespaces,s,"approve()");if(u)throw new Error(u.message);if(!Mt(i,!0)){const{message:h}=te("MISSING_OR_INVALID",`approve() relayProtocol: ${i}`);throw new Error(h)}if(ar(o)||this.validateSessionProps(o,"sessionProperties"),!ar(a)){this.validateSessionProps(a,"scopedProperties");const h=new Set(Object.keys(s));if(!Object.keys(a).every(d=>h.has(d)))throw new Error(`Scoped properties must be a subset of approved namespaces, received: ${JSON.stringify(a)}, approved namespaces: ${Array.from(h).join(", ")}`)}}),V(this,"isValidReject",async t=>{if(!zr(t)){const{message:i}=te("MISSING_OR_INVALID",`reject() params: ${t}`);throw new Error(i)}const{id:n,reason:s}=t;if(this.checkRecentlyDeleted(n),await this.isValidProposalId(n),!_B(s)){const{message:i}=te("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(s)}`);throw new Error(i)}}),V(this,"isValidSessionSettleRequest",t=>{if(!zr(t)){const{message:l}=te("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${t}`);throw new Error(l)}const{relay:n,controller:s,namespaces:i,expiry:o}=t;if(!DN(n)){const{message:l}=te("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(l)}const a=gB(s,"onSessionSettleRequest()");if(a)throw new Error(a.message);const c=Km(i,"onSessionSettleRequest()");if(c)throw new Error(c.message);if(no(o)){const{message:l}=te("EXPIRED","onSessionSettleRequest()");throw new Error(l)}}),V(this,"isValidUpdate",async t=>{if(!zr(t)){const{message:c}=te("MISSING_OR_INVALID",`update() params: ${t}`);throw new Error(c)}const{topic:n,namespaces:s}=t;this.checkRecentlyDeleted(n),await this.isValidSessionTopic(n);const i=this.client.session.get(n),o=Km(s,"update()");if(o)throw new Error(o.message);const a=Rv(i.requiredNamespaces,s,"update()");if(a)throw new Error(a.message)}),V(this,"isValidExtend",async t=>{if(!zr(t)){const{message:s}=te("MISSING_OR_INVALID",`extend() params: ${t}`);throw new Error(s)}const{topic:n}=t;this.checkRecentlyDeleted(n),await this.isValidSessionTopic(n)}),V(this,"isValidRequest",async t=>{if(!zr(t)){const{message:c}=te("MISSING_OR_INVALID",`request() params: ${t}`);throw new Error(c)}const{topic:n,request:s,chainId:i,expiry:o}=t;this.checkRecentlyDeleted(n),await this.isValidSessionTopic(n);const{namespaces:a}=this.client.session.get(n);if(!Ov(a,i)){const{message:c}=te("MISSING_OR_INVALID",`request() chainId: ${i}`);throw new Error(c)}if(!NB(s)){const{message:c}=te("MISSING_OR_INVALID",`request() ${JSON.stringify(s)}`);throw new Error(c)}if(!xB(a,i,s.method)){const{message:c}=te("MISSING_OR_INVALID",`request() method: ${s.method}`);throw new Error(c)}if(o&&!RB(o,ty)){const{message:c}=te("MISSING_OR_INVALID",`request() expiry: ${o}. Expiry must be a number (in seconds) between ${ty.min} and ${ty.max}`);throw new Error(c)}}),V(this,"isValidRespond",async t=>{var n;if(!zr(t)){const{message:o}=te("MISSING_OR_INVALID",`respond() params: ${t}`);throw new Error(o)}const{topic:s,response:i}=t;try{await this.isValidSessionTopic(s)}catch(o){throw(n=t==null?void 0:t.response)!=null&&n.id&&this.cleanupAfterResponse(t),o}if(!IB(i)){const{message:o}=te("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(i)}`);throw new Error(o)}}),V(this,"isValidPing",async t=>{if(!zr(t)){const{message:s}=te("MISSING_OR_INVALID",`ping() params: ${t}`);throw new Error(s)}const{topic:n}=t;await this.isValidSessionOrPairingTopic(n)}),V(this,"isValidEmit",async t=>{if(!zr(t)){const{message:a}=te("MISSING_OR_INVALID",`emit() params: ${t}`);throw new Error(a)}const{topic:n,event:s,chainId:i}=t;await this.isValidSessionTopic(n);const{namespaces:o}=this.client.session.get(n);if(!Ov(o,i)){const{message:a}=te("MISSING_OR_INVALID",`emit() chainId: ${i}`);throw new Error(a)}if(!SB(s)){const{message:a}=te("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(a)}if(!TB(o,i,s.name)){const{message:a}=te("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(a)}}),V(this,"isValidDisconnect",async t=>{if(!zr(t)){const{message:s}=te("MISSING_OR_INVALID",`disconnect() params: ${t}`);throw new Error(s)}const{topic:n}=t;await this.isValidSessionOrPairingTopic(n)}),V(this,"isValidAuthenticate",t=>{const{chains:n,uri:s,domain:i,nonce:o}=t;if(!Array.isArray(n)||n.length===0)throw new Error("chains is required and must be a non-empty array");if(!Mt(s,!1))throw new Error("uri is required parameter");if(!Mt(i,!1))throw new Error("domain is required parameter");if(!Mt(o,!1))throw new Error("nonce is required parameter");if([...new Set(n.map(c=>fl(c).namespace))].length>1)throw new Error("Multi-namespace requests are not supported. Please request single namespace only.");const{namespace:a}=fl(n[0]);if(a!=="eip155")throw new Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")}),V(this,"getVerifyContext",async t=>{const{attestationId:n,hash:s,encryptedId:i,metadata:o,transportType:a}=t,c={verified:{verifyUrl:o.verifyUrl||Rh,validation:"UNKNOWN",origin:o.url||""}};try{if(a===vt.link_mode){const u=this.getAppLinkIfEnabled(o,a);return c.verified.validation=u&&new URL(u).origin===new URL(o.url).origin?"VALID":"INVALID",c}const l=await this.client.core.verify.resolve({attestationId:n,hash:s,encryptedId:i,verifyUrl:o.verifyUrl});l&&(c.verified.origin=l.origin,c.verified.isScam=l.isScam,c.verified.validation=l.origin===new URL(o.url).origin?"VALID":"INVALID")}catch(l){this.client.logger.warn(l)}return this.client.logger.debug(`Verify context: ${JSON.stringify(c)}`),c}),V(this,"validateSessionProps",(t,n)=>{Object.values(t).forEach((s,i)=>{if(s==null){const{message:o}=te("MISSING_OR_INVALID",`${n} must contain an existing value for each key. Received: ${s} for key ${Object.keys(t)[i]}`);throw new Error(o)}})}),V(this,"getPendingAuthRequest",t=>{const n=this.client.auth.requests.get(t);return typeof n=="object"?n:void 0}),V(this,"addToRecentlyDeleted",(t,n)=>{if(this.recentlyDeletedMap.set(t,n),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let s=0;const i=this.recentlyDeletedLimit/2;for(const o of this.recentlyDeletedMap.keys()){if(s++>=i)break;this.recentlyDeletedMap.delete(o)}}}),V(this,"checkRecentlyDeleted",t=>{const n=this.recentlyDeletedMap.get(t);if(n){const{message:s}=te("MISSING_OR_INVALID",`Record was recently deleted - ${n}: ${t}`);throw new Error(s)}}),V(this,"isLinkModeEnabled",(t,n)=>{var s,i,o,a,c,l,u,h,d;return!t||n!==vt.link_mode?!1:((i=(s=this.client.metadata)==null?void 0:s.redirect)==null?void 0:i.linkMode)===!0&&((a=(o=this.client.metadata)==null?void 0:o.redirect)==null?void 0:a.universal)!==void 0&&((l=(c=this.client.metadata)==null?void 0:c.redirect)==null?void 0:l.universal)!==""&&((u=t==null?void 0:t.redirect)==null?void 0:u.universal)!==void 0&&((h=t==null?void 0:t.redirect)==null?void 0:h.universal)!==""&&((d=t==null?void 0:t.redirect)==null?void 0:d.linkMode)===!0&&this.client.core.linkModeSupportedApps.includes(t.redirect.universal)&&typeof(global==null?void 0:global.Linking)<"u"}),V(this,"getAppLinkIfEnabled",(t,n)=>{var s;return this.isLinkModeEnabled(t,n)?(s=t==null?void 0:t.redirect)==null?void 0:s.universal:void 0}),V(this,"handleLinkModeMessage",({url:t})=>{if(!t||!t.includes("wc_ev")||!t.includes("topic"))return;const n=YE(t,"topic")||"",s=decodeURIComponent(YE(t,"wc_ev")||""),i=this.client.session.keys.includes(n);i&&this.client.session.update(n,{transportType:vt.link_mode}),this.client.core.dispatchEnvelope({topic:n,message:s,sessionExists:i})}),V(this,"registerLinkModeListeners",async()=>{var t;if(Db()||Fo()&&(t=this.client.metadata.redirect)!=null&&t.linkMode){const n=global==null?void 0:global.Linking;if(typeof n<"u"){n.addEventListener("url",this.handleLinkModeMessage,this.client.name);const s=await n.getInitialURL();s&&setTimeout(()=>{this.handleLinkModeMessage({url:s})},50)}}}),V(this,"shouldSetTVF",(t,n)=>{if(!n||t!=="wc_sessionRequest")return!1;const{request:s}=n;return Object.keys(pA).includes(s.method)}),V(this,"getTVFParams",(t,n,s)=>{var i,o;try{const a=n.request.method,c=this.extractTxHashesFromResult(a,s);return Sr(dt({correlationId:t,rpcMethods:[a],chainId:n.chainId},this.isValidContractData(n.request.params)&&{contractAddresses:[(o=(i=n.request.params)==null?void 0:i[0])==null?void 0:o.to]}),{txHashes:c})}catch(a){this.client.logger.warn("Error getting TVF params",a)}return{}}),V(this,"isValidContractData",t=>{var n;if(!t)return!1;try{const s=(t==null?void 0:t.data)||((n=t==null?void 0:t[0])==null?void 0:n.data);if(!s.startsWith("0x"))return!1;const i=s.slice(2);return/^[0-9a-fA-F]*$/.test(i)?i.length%2===0:!1}catch{}return!1}),V(this,"extractTxHashesFromResult",(t,n)=>{try{const s=pA[t];if(typeof n=="string")return[n];const i=n[s.key];if(To(i))return t==="solana_signAllTransactions"?i.map(o=>o5(o)):i;if(typeof i=="string")return[i]}catch(s){this.client.logger.warn("Error extracting tx hashes from result",s)}return[]})}async processPendingMessageEvents(){try{const e=this.client.session.keys,t=this.client.core.relayer.messages.getWithoutAck(e);for(const[n,s]of Object.entries(t))for(const i of s)try{await this.onProviderMessageEvent({topic:n,message:i,publishedAt:Date.now()})}catch{this.client.logger.warn(`Error processing pending message event for topic: ${n}, message: ${i}`)}}catch(e){this.client.logger.warn("processPendingMessageEvents failed",e)}}isInitialized(){if(!this.initialized){const{message:e}=te("NOT_INITIALIZED",this.name);throw new Error(e)}}async confirmOnlineStateOrThrow(){await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Qt.message,e=>{this.onProviderMessageEvent(e)})}async onRelayMessage(e){const{topic:t,message:n,attestation:s,transportType:i}=e,{publicKey:o}=this.client.auth.authKeys.keys.includes(bp)?this.client.auth.authKeys.get(bp):{publicKey:void 0};try{const a=await this.client.core.crypto.decode(t,n,{receiverPublicKey:o,encoding:i===vt.link_mode?io:cs});zb(a)?(this.client.core.history.set(t,a),await this.onRelayEventRequest({topic:t,payload:a,attestation:s,transportType:i,encryptedId:Ls(n)})):zg(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:t,payload:a,transportType:i}),this.client.core.history.delete(t,a.id)):await this.onRelayEventUnknownPayload({topic:t,payload:a,transportType:i}),await this.client.core.relayer.messages.ack(t,n)}catch(a){this.client.logger.error(a)}}registerExpirerEvents(){this.client.core.expirer.on(Tn.expired,async e=>{const{topic:t,id:n}=Z_(e.target);if(n&&this.client.pendingRequest.keys.includes(n))return await this.deletePendingSessionRequest(n,te("EXPIRED"),!0);if(n&&this.client.auth.requests.keys.includes(n))return await this.deletePendingAuthRequest(n,te("EXPIRED"),!0);t?this.client.session.keys.includes(t)&&(await this.deleteSession({topic:t,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:t})):n&&(await this.deleteProposal(n,!0),this.client.events.emit("proposal_expire",{id:n}))})}registerPairingEvents(){this.client.core.pairing.events.on(aa.create,e=>this.onPairingCreated(e)),this.client.core.pairing.events.on(aa.delete,e=>{this.addToRecentlyDeleted(e.topic,"pairing")})}isValidPairingTopic(e){if(!Mt(e,!1)){const{message:t}=te("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:t}=te("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(t)}if(no(this.client.core.pairing.pairings.get(e).expiry)){const{message:t}=te("EXPIRED",`pairing topic: ${e}`);throw new Error(t)}}async isValidSessionTopic(e){if(!Mt(e,!1)){const{message:t}=te("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(t)}if(this.checkRecentlyDeleted(e),!this.client.session.keys.includes(e)){const{message:t}=te("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(t)}if(no(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});const{message:t}=te("EXPIRED",`session topic: ${e}`);throw new Error(t)}if(!this.client.core.crypto.keychain.has(e)){const{message:t}=te("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),new Error(t)}}async isValidSessionOrPairingTopic(e){if(this.checkRecentlyDeleted(e),this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(Mt(e,!1)){const{message:t}=te("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(t)}else{const{message:t}=te("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(t)}}async isValidProposalId(e){if(!CB(e)){const{message:t}=te("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(t)}if(!this.client.proposal.keys.includes(e)){const{message:t}=te("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(t)}if(no(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);const{message:t}=te("EXPIRED",`proposal id: ${e}`);throw new Error(t)}}}class I6 extends bc{constructor(e,t){super(e,t,u6,qb),this.core=e,this.logger=t}}let S6=class extends bc{constructor(e,t){super(e,t,h6,qb),this.core=e,this.logger=t}};class x6 extends bc{constructor(e,t){super(e,t,f6,qb,n=>n.id),this.core=e,this.logger=t}}class T6 extends bc{constructor(e,t){super(e,t,y6,Vg,()=>bp),this.core=e,this.logger=t}}class P6 extends bc{constructor(e,t){super(e,t,w6,Vg),this.core=e,this.logger=t}}class O6 extends bc{constructor(e,t){super(e,t,b6,Vg,n=>n.id),this.core=e,this.logger=t}}var R6=Object.defineProperty,D6=(r,e,t)=>e in r?R6(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,ry=(r,e,t)=>D6(r,typeof e!="symbol"?e+"":e,t);class k6{constructor(e,t){this.core=e,this.logger=t,ry(this,"authKeys"),ry(this,"pairingTopics"),ry(this,"requests"),this.authKeys=new T6(this.core,this.logger),this.pairingTopics=new P6(this.core,this.logger),this.requests=new O6(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}}var U6=Object.defineProperty,B6=(r,e,t)=>e in r?U6(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,je=(r,e,t)=>B6(r,typeof e!="symbol"?e+"":e,t);let L6=class oI extends r2{constructor(e){super(e),je(this,"protocol",nI),je(this,"version",sI),je(this,"name",ey.name),je(this,"metadata"),je(this,"core"),je(this,"logger"),je(this,"events",new Mn.EventEmitter),je(this,"engine"),je(this,"session"),je(this,"proposal"),je(this,"pendingRequest"),je(this,"auth"),je(this,"signConfig"),je(this,"on",(n,s)=>this.events.on(n,s)),je(this,"once",(n,s)=>this.events.once(n,s)),je(this,"off",(n,s)=>this.events.off(n,s)),je(this,"removeListener",(n,s)=>this.events.removeListener(n,s)),je(this,"removeAllListeners",n=>this.events.removeAllListeners(n)),je(this,"connect",async n=>{try{return await this.engine.connect(n)}catch(s){throw this.logger.error(s.message),s}}),je(this,"pair",async n=>{try{return await this.engine.pair(n)}catch(s){throw this.logger.error(s.message),s}}),je(this,"approve",async n=>{try{return await this.engine.approve(n)}catch(s){throw this.logger.error(s.message),s}}),je(this,"reject",async n=>{try{return await this.engine.reject(n)}catch(s){throw this.logger.error(s.message),s}}),je(this,"update",async n=>{try{return await this.engine.update(n)}catch(s){throw this.logger.error(s.message),s}}),je(this,"extend",async n=>{try{return await this.engine.extend(n)}catch(s){throw this.logger.error(s.message),s}}),je(this,"request",async n=>{try{return await this.engine.request(n)}catch(s){throw this.logger.error(s.message),s}}),je(this,"respond",async n=>{try{return await this.engine.respond(n)}catch(s){throw this.logger.error(s.message),s}}),je(this,"ping",async n=>{try{return await this.engine.ping(n)}catch(s){throw this.logger.error(s.message),s}}),je(this,"emit",async n=>{try{return await this.engine.emit(n)}catch(s){throw this.logger.error(s.message),s}}),je(this,"disconnect",async n=>{try{return await this.engine.disconnect(n)}catch(s){throw this.logger.error(s.message),s}}),je(this,"find",n=>{try{return this.engine.find(n)}catch(s){throw this.logger.error(s.message),s}}),je(this,"getPendingSessionRequests",()=>{try{return this.engine.getPendingSessionRequests()}catch(n){throw this.logger.error(n.message),n}}),je(this,"authenticate",async(n,s)=>{try{return await this.engine.authenticate(n,s)}catch(i){throw this.logger.error(i.message),i}}),je(this,"formatAuthMessage",n=>{try{return this.engine.formatAuthMessage(n)}catch(s){throw this.logger.error(s.message),s}}),je(this,"approveSessionAuthenticate",async n=>{try{return await this.engine.approveSessionAuthenticate(n)}catch(s){throw this.logger.error(s.message),s}}),je(this,"rejectSessionAuthenticate",async n=>{try{return await this.engine.rejectSessionAuthenticate(n)}catch(s){throw this.logger.error(s.message),s}}),this.name=(e==null?void 0:e.name)||ey.name,this.metadata=bU(e==null?void 0:e.metadata),this.signConfig=e==null?void 0:e.signConfig;const t=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:of(Bu({level:(e==null?void 0:e.logger)||ey.logger}));this.core=(e==null?void 0:e.core)||new l6(e),this.logger=Ir(t,this.name),this.session=new S6(this.core,this.logger),this.proposal=new I6(this.core,this.logger),this.pendingRequest=new x6(this.core,this.logger),this.engine=new N6(this),this.auth=new k6(this.core,this.logger)}static async init(e){const t=new oI(e);return await t.initialize(),t}get context(){return Xr(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.auth.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success"),setTimeout(()=>{this.engine.processRelayMessageCache()},X.toMiliseconds(X.ONE_SECOND))}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}};var _w={exports:{}};(function(r,e){var t=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof Bs<"u"&&Bs,n=function(){function i(){this.fetch=!1,this.DOMException=t.DOMException}return i.prototype=t,new i}();(function(i){(function(o){var a=typeof i<"u"&&i||typeof self<"u"&&self||typeof Bs<"u"&&Bs||{},c={searchParams:"URLSearchParams"in a,iterable:"Symbol"in a&&"iterator"in Symbol,blob:"FileReader"in a&&"Blob"in a&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in a,arrayBuffer:"ArrayBuffer"in a};function l(b){return b&&DataView.prototype.isPrototypeOf(b)}if(c.arrayBuffer)var u=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],h=ArrayBuffer.isView||function(b){return b&&u.indexOf(Object.prototype.toString.call(b))>-1};function d(b){if(typeof b!="string"&&(b=String(b)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(b)||b==="")throw new TypeError('Invalid character in header field name: "'+b+'"');return b.toLowerCase()}function f(b){return typeof b!="string"&&(b=String(b)),b}function g(b){var E={next:function(){var O=b.shift();return{done:O===void 0,value:O}}};return c.iterable&&(E[Symbol.iterator]=function(){return E}),E}function p(b){this.map={},b instanceof p?b.forEach(function(E,O){this.append(O,E)},this):Array.isArray(b)?b.forEach(function(E){if(E.length!=2)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+E.length);this.append(E[0],E[1])},this):b&&Object.getOwnPropertyNames(b).forEach(function(E){this.append(E,b[E])},this)}p.prototype.append=function(b,E){b=d(b),E=f(E);var O=this.map[b];this.map[b]=O?O+", "+E:E},p.prototype.delete=function(b){delete this.map[d(b)]},p.prototype.get=function(b){return b=d(b),this.has(b)?this.map[b]:null},p.prototype.has=function(b){return this.map.hasOwnProperty(d(b))},p.prototype.set=function(b,E){this.map[d(b)]=f(E)},p.prototype.forEach=function(b,E){for(var O in this.map)this.map.hasOwnProperty(O)&&b.call(E,this.map[O],O,this)},p.prototype.keys=function(){var b=[];return this.forEach(function(E,O){b.push(O)}),g(b)},p.prototype.values=function(){var b=[];return this.forEach(function(E){b.push(E)}),g(b)},p.prototype.entries=function(){var b=[];return this.forEach(function(E,O){b.push([O,E])}),g(b)},c.iterable&&(p.prototype[Symbol.iterator]=p.prototype.entries);function m(b){if(!b._noBody){if(b.bodyUsed)return Promise.reject(new TypeError("Already read"));b.bodyUsed=!0}}function w(b){return new Promise(function(E,O){b.onload=function(){E(b.result)},b.onerror=function(){O(b.error)}})}function A(b){var E=new FileReader,O=w(E);return E.readAsArrayBuffer(b),O}function v(b){var E=new FileReader,O=w(E),B=/charset=([A-Za-z0-9_-]+)/.exec(b.type),k=B?B[1]:"utf-8";return E.readAsText(b,k),O}function N(b){for(var E=new Uint8Array(b),O=new Array(E.length),B=0;B<E.length;B++)O[B]=String.fromCharCode(E[B]);return O.join("")}function T(b){if(b.slice)return b.slice(0);var E=new Uint8Array(b.byteLength);return E.set(new Uint8Array(b)),E.buffer}function P(){return this.bodyUsed=!1,this._initBody=function(b){this.bodyUsed=this.bodyUsed,this._bodyInit=b,b?typeof b=="string"?this._bodyText=b:c.blob&&Blob.prototype.isPrototypeOf(b)?this._bodyBlob=b:c.formData&&FormData.prototype.isPrototypeOf(b)?this._bodyFormData=b:c.searchParams&&URLSearchParams.prototype.isPrototypeOf(b)?this._bodyText=b.toString():c.arrayBuffer&&c.blob&&l(b)?(this._bodyArrayBuffer=T(b.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):c.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(b)||h(b))?this._bodyArrayBuffer=T(b):this._bodyText=b=Object.prototype.toString.call(b):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||(typeof b=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):c.searchParams&&URLSearchParams.prototype.isPrototypeOf(b)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},c.blob&&(this.blob=function(){var b=m(this);if(b)return b;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var b=m(this);return b||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else{if(c.blob)return this.blob().then(A);throw new Error("could not read as ArrayBuffer")}},this.text=function(){var b=m(this);if(b)return b;if(this._bodyBlob)return v(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(N(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},c.formData&&(this.formData=function(){return this.text().then(j)}),this.json=function(){return this.text().then(JSON.parse)},this}var D=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function U(b){var E=b.toUpperCase();return D.indexOf(E)>-1?E:b}function x(b,E){if(!(this instanceof x))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');E=E||{};var O=E.body;if(b instanceof x){if(b.bodyUsed)throw new TypeError("Already read");this.url=b.url,this.credentials=b.credentials,E.headers||(this.headers=new p(b.headers)),this.method=b.method,this.mode=b.mode,this.signal=b.signal,!O&&b._bodyInit!=null&&(O=b._bodyInit,b.bodyUsed=!0)}else this.url=String(b);if(this.credentials=E.credentials||this.credentials||"same-origin",(E.headers||!this.headers)&&(this.headers=new p(E.headers)),this.method=U(E.method||this.method||"GET"),this.mode=E.mode||this.mode||null,this.signal=E.signal||this.signal||function(){if("AbortController"in a){var M=new AbortController;return M.signal}}(),this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&O)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(O),(this.method==="GET"||this.method==="HEAD")&&(E.cache==="no-store"||E.cache==="no-cache")){var B=/([?&])_=[^&]*/;if(B.test(this.url))this.url=this.url.replace(B,"$1_="+new Date().getTime());else{var k=/\?/;this.url+=(k.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}x.prototype.clone=function(){return new x(this,{body:this._bodyInit})};function j(b){var E=new FormData;return b.trim().split("&").forEach(function(O){if(O){var B=O.split("="),k=B.shift().replace(/\+/g," "),M=B.join("=").replace(/\+/g," ");E.append(decodeURIComponent(k),decodeURIComponent(M))}}),E}function $(b){var E=new p,O=b.replace(/\r?\n[\t ]+/g," ");return O.split("\r").map(function(B){return B.indexOf(`
`)===0?B.substr(1,B.length):B}).forEach(function(B){var k=B.split(":"),M=k.shift().trim();if(M){var G=k.join(":").trim();try{E.append(M,G)}catch(J){console.warn("Response "+J.message)}}}),E}P.call(x.prototype);function H(b,E){if(!(this instanceof H))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(E||(E={}),this.type="default",this.status=E.status===void 0?200:E.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=E.statusText===void 0?"":""+E.statusText,this.headers=new p(E.headers),this.url=E.url||"",this._initBody(b)}P.call(H.prototype),H.prototype.clone=function(){return new H(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new p(this.headers),url:this.url})},H.error=function(){var b=new H(null,{status:200,statusText:""});return b.ok=!1,b.status=0,b.type="error",b};var Z=[301,302,303,307,308];H.redirect=function(b,E){if(Z.indexOf(E)===-1)throw new RangeError("Invalid status code");return new H(null,{status:E,headers:{location:b}})},o.DOMException=a.DOMException;try{new o.DOMException}catch{o.DOMException=function(E,O){this.message=E,this.name=O;var B=Error(E);this.stack=B.stack},o.DOMException.prototype=Object.create(Error.prototype),o.DOMException.prototype.constructor=o.DOMException}function z(b,E){return new Promise(function(O,B){var k=new x(b,E);if(k.signal&&k.signal.aborted)return B(new o.DOMException("Aborted","AbortError"));var M=new XMLHttpRequest;function G(){M.abort()}M.onload=function(){var Q={statusText:M.statusText,headers:$(M.getAllResponseHeaders()||"")};k.url.indexOf("file://")===0&&(M.status<200||M.status>599)?Q.status=200:Q.status=M.status,Q.url="responseURL"in M?M.responseURL:Q.headers.get("X-Request-URL");var ge="response"in M?M.response:M.responseText;setTimeout(function(){O(new H(ge,Q))},0)},M.onerror=function(){setTimeout(function(){B(new TypeError("Network request failed"))},0)},M.ontimeout=function(){setTimeout(function(){B(new TypeError("Network request timed out"))},0)},M.onabort=function(){setTimeout(function(){B(new o.DOMException("Aborted","AbortError"))},0)};function J(Q){try{return Q===""&&a.location.href?a.location.href:Q}catch{return Q}}if(M.open(k.method,J(k.url),!0),k.credentials==="include"?M.withCredentials=!0:k.credentials==="omit"&&(M.withCredentials=!1),"responseType"in M&&(c.blob?M.responseType="blob":c.arrayBuffer&&(M.responseType="arraybuffer")),E&&typeof E.headers=="object"&&!(E.headers instanceof p||a.Headers&&E.headers instanceof a.Headers)){var oe=[];Object.getOwnPropertyNames(E.headers).forEach(function(Q){oe.push(d(Q)),M.setRequestHeader(Q,f(E.headers[Q]))}),k.headers.forEach(function(Q,ge){oe.indexOf(ge)===-1&&M.setRequestHeader(ge,Q)})}else k.headers.forEach(function(Q,ge){M.setRequestHeader(ge,Q)});k.signal&&(k.signal.addEventListener("abort",G),M.onreadystatechange=function(){M.readyState===4&&k.signal.removeEventListener("abort",G)}),M.send(typeof k._bodyInit>"u"?null:k._bodyInit)})}return z.polyfill=!0,a.fetch||(a.fetch=z,a.Headers=p,a.Request=x,a.Response=H),o.Headers=p,o.Request=x,o.Response=H,o.fetch=z,Object.defineProperty(o,"__esModule",{value:!0}),o})({})})(n),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var s=t.fetch?t:n;e=s.fetch,e.default=s.fetch,e.fetch=s.fetch,e.Headers=s.Headers,e.Request=s.Request,e.Response=s.Response,r.exports=e})(_w,_w.exports);var $6=_w.exports;const mA=_g($6);var M6=Object.defineProperty,F6=Object.defineProperties,j6=Object.getOwnPropertyDescriptors,yA=Object.getOwnPropertySymbols,H6=Object.prototype.hasOwnProperty,z6=Object.prototype.propertyIsEnumerable,wA=(r,e,t)=>e in r?M6(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,bA=(r,e)=>{for(var t in e||(e={}))H6.call(e,t)&&wA(r,t,e[t]);if(yA)for(var t of yA(e))z6.call(e,t)&&wA(r,t,e[t]);return r},EA=(r,e)=>F6(r,j6(e));const q6={Accept:"application/json","Content-Type":"application/json"},V6="POST",vA={headers:q6,method:V6},AA=10;let ps=class{constructor(e,t=!1){if(this.url=e,this.disableProviderPing=t,this.events=new Mn.EventEmitter,this.isAvailable=!1,this.registering=!1,!$v(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=t}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e){this.isAvailable||await this.register();try{const t=Bi(e),n=await(await mA(this.url,EA(bA({},vA),{body:t}))).json();this.onPayload({data:n})}catch(t){this.onError(e.id,t)}}async register(e=this.url){if(!$v(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((n,s)=>{this.events.once("register_error",i=>{this.resetMaxListeners(),s(i)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return s(new Error("HTTP connection is missing or invalid"));n()})})}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){const t=Bi({id:1,jsonrpc:"2.0",method:"test",params:[]});await mA(e,EA(bA({},vA),{body:t}))}this.onOpen()}catch(t){const n=this.parseError(t);throw this.events.emit("register_error",n),this.onClose(),n}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?ec(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const n=this.parseError(t),s=n.message||n.toString(),i=Hg(e,s);this.events.emit("payload",i)}parseError(e,t=this.url){return BN(e,t,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>AA&&this.events.setMaxListeners(AA)}};const CA="error",W6="wss://relay.walletconnect.org",G6="wc",K6="universal_provider",Wf=`${G6}@2:${K6}:`,aI="https://rpc.walletconnect.org/v1/",Zc="generic",J6=`${aI}bundler`,jn={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};function Y6(){}function Vb(r){return r==null||typeof r!="object"&&typeof r!="function"}function Wb(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}function Q6(r){if(Vb(r))return r;if(Array.isArray(r)||Wb(r)||r instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&r instanceof SharedArrayBuffer)return r.slice(0);const e=Object.getPrototypeOf(r),t=e.constructor;if(r instanceof Date||r instanceof Map||r instanceof Set)return new t(r);if(r instanceof RegExp){const n=new t(r);return n.lastIndex=r.lastIndex,n}if(r instanceof DataView)return new t(r.buffer.slice(0));if(r instanceof Error){const n=new t(r.message);return n.stack=r.stack,n.name=r.name,n.cause=r.cause,n}if(typeof File<"u"&&r instanceof File)return new t([r],r.name,{type:r.type,lastModified:r.lastModified});if(typeof r=="object"){const n=Object.create(e);return Object.assign(n,r)}return r}function _A(r){return typeof r=="object"&&r!==null}function cI(r){return Object.getOwnPropertySymbols(r).filter(e=>Object.prototype.propertyIsEnumerable.call(r,e))}function lI(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}const Z6="[object RegExp]",uI="[object String]",hI="[object Number]",dI="[object Boolean]",fI="[object Arguments]",X6="[object Symbol]",eF="[object Date]",tF="[object Map]",rF="[object Set]",nF="[object Array]",sF="[object ArrayBuffer]",iF="[object Object]",oF="[object DataView]",aF="[object Uint8Array]",cF="[object Uint8ClampedArray]",lF="[object Uint16Array]",uF="[object Uint32Array]",hF="[object Int8Array]",dF="[object Int16Array]",fF="[object Int32Array]",pF="[object Float32Array]",gF="[object Float64Array]";function mF(r,e){return ol(r,void 0,r,new Map,e)}function ol(r,e,t,n=new Map,s=void 0){const i=s==null?void 0:s(r,e,t,n);if(i!=null)return i;if(Vb(r))return r;if(n.has(r))return n.get(r);if(Array.isArray(r)){const o=new Array(r.length);n.set(r,o);for(let a=0;a<r.length;a++)o[a]=ol(r[a],a,t,n,s);return Object.hasOwn(r,"index")&&(o.index=r.index),Object.hasOwn(r,"input")&&(o.input=r.input),o}if(r instanceof Date)return new Date(r.getTime());if(r instanceof RegExp){const o=new RegExp(r.source,r.flags);return o.lastIndex=r.lastIndex,o}if(r instanceof Map){const o=new Map;n.set(r,o);for(const[a,c]of r)o.set(a,ol(c,a,t,n,s));return o}if(r instanceof Set){const o=new Set;n.set(r,o);for(const a of r)o.add(ol(a,void 0,t,n,s));return o}if(typeof Buffer<"u"&&Buffer.isBuffer(r))return r.subarray();if(Wb(r)){const o=new(Object.getPrototypeOf(r)).constructor(r.length);n.set(r,o);for(let a=0;a<r.length;a++)o[a]=ol(r[a],a,t,n,s);return o}if(r instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&r instanceof SharedArrayBuffer)return r.slice(0);if(r instanceof DataView){const o=new DataView(r.buffer.slice(0),r.byteOffset,r.byteLength);return n.set(r,o),ca(o,r,t,n,s),o}if(typeof File<"u"&&r instanceof File){const o=new File([r],r.name,{type:r.type});return n.set(r,o),ca(o,r,t,n,s),o}if(r instanceof Blob){const o=new Blob([r],{type:r.type});return n.set(r,o),ca(o,r,t,n,s),o}if(r instanceof Error){const o=new r.constructor;return n.set(r,o),o.message=r.message,o.name=r.name,o.stack=r.stack,o.cause=r.cause,ca(o,r,t,n,s),o}if(typeof r=="object"&&yF(r)){const o=Object.create(Object.getPrototypeOf(r));return n.set(r,o),ca(o,r,t,n,s),o}return r}function ca(r,e,t=r,n,s){const i=[...Object.keys(e),...cI(e)];for(let o=0;o<i.length;o++){const a=i[o],c=Object.getOwnPropertyDescriptor(r,a);(c==null||c.writable)&&(r[a]=ol(e[a],a,t,n,s))}}function yF(r){switch(lI(r)){case fI:case nF:case sF:case oF:case dI:case eF:case pF:case gF:case hF:case dF:case fF:case tF:case hI:case iF:case Z6:case rF:case uI:case X6:case aF:case cF:case lF:case uF:return!0;default:return!1}}function wF(r,e){return mF(r,(t,n,s,i)=>{if(typeof r=="object")switch(Object.prototype.toString.call(r)){case hI:case uI:case dI:{const o=new r.constructor(r==null?void 0:r.valueOf());return ca(o,r),o}case fI:{const o={};return ca(o,r),o.length=r.length,o[Symbol.iterator]=r[Symbol.iterator],o}default:return}})}function NA(r){return wF(r)}function IA(r){return r!==null&&typeof r=="object"&&lI(r)==="[object Arguments]"}function bF(r){return Wb(r)}function EF(r){var t;if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const n=r[Symbol.toStringTag];return n==null||!((t=Object.getOwnPropertyDescriptor(r,Symbol.toStringTag))!=null&&t.writable)?!1:r.toString()===`[object ${n}]`}let e=r;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(r)===e}function vF(r,...e){const t=e.slice(0,-1),n=e[e.length-1];let s=r;for(let i=0;i<t.length;i++){const o=t[i];s=Nw(s,o,n,new Map)}return s}function Nw(r,e,t,n){if(Vb(r)&&(r=Object(r)),e==null||typeof e!="object")return r;if(n.has(e))return Q6(n.get(e));if(n.set(e,r),Array.isArray(e)){e=e.slice();for(let i=0;i<e.length;i++)e[i]=e[i]??void 0}const s=[...Object.keys(e),...cI(e)];for(let i=0;i<s.length;i++){const o=s[i];let a=e[o],c=r[o];if(IA(a)&&(a={...a}),IA(c)&&(c={...c}),typeof Buffer<"u"&&Buffer.isBuffer(a)&&(a=NA(a)),Array.isArray(a))if(typeof c=="object"&&c!=null){const u=[],h=Reflect.ownKeys(c);for(let d=0;d<h.length;d++){const f=h[d];u[f]=c[f]}c=u}else c=[];const l=t(c,a,o,r,e,n);l!=null?r[o]=l:Array.isArray(a)||_A(c)&&_A(a)?r[o]=Nw(c,a,t,n):c==null&&EF(a)?r[o]=Nw({},a,t,n):c==null&&bF(a)?r[o]=NA(a):(c===void 0||a!==void 0)&&(r[o]=a)}return r}function AF(r,...e){return vF(r,...e,Y6)}var CF=Object.defineProperty,_F=Object.defineProperties,NF=Object.getOwnPropertyDescriptors,SA=Object.getOwnPropertySymbols,IF=Object.prototype.hasOwnProperty,SF=Object.prototype.propertyIsEnumerable,xA=(r,e,t)=>e in r?CF(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Gf=(r,e)=>{for(var t in e||(e={}))IF.call(e,t)&&xA(r,t,e[t]);if(SA)for(var t of SA(e))SF.call(e,t)&&xA(r,t,e[t]);return r},xF=(r,e)=>_F(r,NF(e));function bn(r,e,t){var n;const s=fl(r);return((n=e.rpcMap)==null?void 0:n[s.reference])||`${aI}?chainId=${s.namespace}:${s.reference}&projectId=${t}`}function Ec(r){return r.includes(":")?r.split(":")[1]:r}function pI(r){return r.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function TF(r,e){const t=Object.keys(e.namespaces).filter(s=>s.includes(r));if(!t.length)return[];const n=[];return t.forEach(s=>{const i=e.namespaces[s].accounts;n.push(...i)}),n}function ny(r={},e={}){const t=TA(r),n=TA(e);return AF(t,n)}function TA(r){var e,t,n,s;const i={};if(!Qh(r))return i;for(const[o,a]of Object.entries(r)){const c=Fb(o)?[o]:a.chains,l=a.methods||[],u=a.events||[],h=a.rpcMap||{},d=vh(o);i[d]=xF(Gf(Gf({},i[d]),a),{chains:gp(c,(e=i[d])==null?void 0:e.chains),methods:gp(l,(t=i[d])==null?void 0:t.methods),events:gp(u,(n=i[d])==null?void 0:n.events),rpcMap:Gf(Gf({},h),(s=i[d])==null?void 0:s.rpcMap)})}return i}function PA(r){return r.includes(":")?r.split(":")[2]:r}function OA(r){const e={};for(const[t,n]of Object.entries(r)){const s=n.methods||[],i=n.events||[],o=n.accounts||[],a=Fb(t)?[t]:n.chains?n.chains:pI(n.accounts);e[t]={chains:a,methods:s,events:i,accounts:o}}return e}function sy(r){return typeof r=="number"?r:r.includes("0x")?parseInt(r,16):(r=r.includes(":")?r.split(":")[1]:r,isNaN(Number(r))?r:Number(r))}const gI={},Ye=r=>gI[r],iy=(r,e)=>{gI[r]=e};var PF=Object.defineProperty,OF=(r,e,t)=>e in r?PF(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Bc=(r,e,t)=>OF(r,typeof e!="symbol"?e+"":e,t);class RF{constructor(e){Bc(this,"name","polkadot"),Bc(this,"client"),Bc(this,"httpProviders"),Bc(this,"events"),Bc(this,"namespace"),Bc(this,"chainId"),this.namespace=e.namespace,this.events=Ye("events"),this.client=Ye("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(jn.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var n;const s=Ec(t);e[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||bn(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Fn(new ps(n,Ye("disableProviderPing")))}}var DF=Object.defineProperty,kF=Object.defineProperties,UF=Object.getOwnPropertyDescriptors,RA=Object.getOwnPropertySymbols,BF=Object.prototype.hasOwnProperty,LF=Object.prototype.propertyIsEnumerable,Iw=(r,e,t)=>e in r?DF(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,DA=(r,e)=>{for(var t in e||(e={}))BF.call(e,t)&&Iw(r,t,e[t]);if(RA)for(var t of RA(e))LF.call(e,t)&&Iw(r,t,e[t]);return r},kA=(r,e)=>kF(r,UF(e)),Lc=(r,e,t)=>Iw(r,typeof e!="symbol"?e+"":e,t);class $F{constructor(e){Lc(this,"name","eip155"),Lc(this,"client"),Lc(this,"chainId"),Lc(this,"namespace"),Lc(this,"httpProviders"),Lc(this,"events"),this.namespace=e.namespace,this.events=Ye("events"),this.client=Ye("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain());case"wallet_getCapabilities":return await this.getCapabilities(e);case"wallet_getCallsStatus":return await this.getCallStatus(e)}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(parseInt(e),t),this.chainId=parseInt(e),this.events.emit(jn.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,t){const n=t||bn(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Fn(new ps(n,Ye("disableProviderPing")))}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var n;const s=parseInt(Ec(t));e[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[t])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}getHttpProvider(){const e=this.chainId,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}async handleSwitchChain(e){var t,n;let s=e.request.params?(t=e.request.params[0])==null?void 0:t.chainId:"0x0";s=s.startsWith("0x")?s:`0x${s}`;const i=parseInt(s,16);if(this.isChainApproved(i))this.setDefaultChain(`${i}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:s}]},chainId:(n=this.namespace.chains)==null?void 0:n[0]}),this.setDefaultChain(`${i}`);else throw new Error(`Failed to switch to chain 'eip155:${i}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}async getCapabilities(e){var t,n,s;const i=(n=(t=e.request)==null?void 0:t.params)==null?void 0:n[0];if(!i)throw new Error("Missing address parameter in `wallet_getCapabilities` request");const o=this.client.session.get(e.topic),a=((s=o==null?void 0:o.sessionProperties)==null?void 0:s.capabilities)||{};if(a!=null&&a[i])return a==null?void 0:a[i];const c=await this.client.request(e);try{await this.client.session.update(e.topic,{sessionProperties:kA(DA({},o.sessionProperties||{}),{capabilities:kA(DA({},a||{}),{[i]:c})})})}catch(l){console.warn("Failed to update session with capabilities",l)}return c}async getCallStatus(e){var t,n;const s=this.client.session.get(e.topic),i=(t=s.sessionProperties)==null?void 0:t.bundler_name;if(i){const a=this.getBundlerUrl(e.chainId,i);try{return await this.getUserOperationReceipt(a,e)}catch(c){console.warn("Failed to fetch call status from bundler",c,a)}}const o=(n=s.sessionProperties)==null?void 0:n.bundler_url;if(o)try{return await this.getUserOperationReceipt(o,e)}catch(a){console.warn("Failed to fetch call status from custom bundler",a,o)}if(this.namespace.methods.includes(e.request.method))return await this.client.request(e);throw new Error("Fetching call status not approved by the wallet.")}async getUserOperationReceipt(e,t){var n;const s=new URL(e),i=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(So("eth_getUserOperationReceipt",[(n=t.request.params)==null?void 0:n[0]]))});if(!i.ok)throw new Error(`Failed to fetch user operation receipt - ${i.status}`);return await i.json()}getBundlerUrl(e,t){return`${J6}?projectId=${this.client.core.projectId}&chainId=${e}&bundler=${t}`}}var MF=Object.defineProperty,FF=(r,e,t)=>e in r?MF(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,$c=(r,e,t)=>FF(r,typeof e!="symbol"?e+"":e,t);class jF{constructor(e){$c(this,"name","solana"),$c(this,"client"),$c(this,"httpProviders"),$c(this,"events"),$c(this,"namespace"),$c(this,"chainId"),this.namespace=e.namespace,this.events=Ye("events"),this.client=Ye("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(jn.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var n;const s=Ec(t);e[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||bn(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Fn(new ps(n,Ye("disableProviderPing")))}}var HF=Object.defineProperty,zF=(r,e,t)=>e in r?HF(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Mc=(r,e,t)=>zF(r,typeof e!="symbol"?e+"":e,t);class qF{constructor(e){Mc(this,"name","cosmos"),Mc(this,"client"),Mc(this,"httpProviders"),Mc(this,"events"),Mc(this,"namespace"),Mc(this,"chainId"),this.namespace=e.namespace,this.events=Ye("events"),this.client=Ye("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(jn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var n;const s=Ec(t);e[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||bn(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Fn(new ps(n,Ye("disableProviderPing")))}}var VF=Object.defineProperty,WF=(r,e,t)=>e in r?VF(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Fc=(r,e,t)=>WF(r,typeof e!="symbol"?e+"":e,t);class GF{constructor(e){Fc(this,"name","algorand"),Fc(this,"client"),Fc(this,"httpProviders"),Fc(this,"events"),Fc(this,"namespace"),Fc(this,"chainId"),this.namespace=e.namespace,this.events=Ye("events"),this.client=Ye("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(!this.httpProviders[e]){const n=t||bn(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,n)}this.chainId=e,this.events.emit(jn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var n;e[t]=this.createHttpProvider(t,(n=this.namespace.rpcMap)==null?void 0:n[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||bn(e,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new Fn(new ps(n,Ye("disableProviderPing")))}}var KF=Object.defineProperty,JF=(r,e,t)=>e in r?KF(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,jc=(r,e,t)=>JF(r,typeof e!="symbol"?e+"":e,t);class YF{constructor(e){jc(this,"name","cip34"),jc(this,"client"),jc(this,"httpProviders"),jc(this,"events"),jc(this,"namespace"),jc(this,"chainId"),this.namespace=e.namespace,this.events=Ye("events"),this.client=Ye("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(jn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{const n=this.getCardanoRPCUrl(t),s=Ec(t);e[s]=this.createHttpProvider(s,n)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}getCardanoRPCUrl(e){const t=this.namespace.rpcMap;if(t)return t[e]}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||this.getCardanoRPCUrl(e);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Fn(new ps(n,Ye("disableProviderPing")))}}var QF=Object.defineProperty,ZF=(r,e,t)=>e in r?QF(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Hc=(r,e,t)=>ZF(r,typeof e!="symbol"?e+"":e,t);class XF{constructor(e){Hc(this,"name","elrond"),Hc(this,"client"),Hc(this,"httpProviders"),Hc(this,"events"),Hc(this,"namespace"),Hc(this,"chainId"),this.namespace=e.namespace,this.events=Ye("events"),this.client=Ye("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(jn.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var n;const s=Ec(t);e[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||bn(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Fn(new ps(n,Ye("disableProviderPing")))}}var ej=Object.defineProperty,tj=(r,e,t)=>e in r?ej(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,zc=(r,e,t)=>tj(r,typeof e!="symbol"?e+"":e,t);class rj{constructor(e){zc(this,"name","multiversx"),zc(this,"client"),zc(this,"httpProviders"),zc(this,"events"),zc(this,"namespace"),zc(this,"chainId"),this.namespace=e.namespace,this.events=Ye("events"),this.client=Ye("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(jn.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var n;const s=Ec(t);e[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||bn(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Fn(new ps(n,Ye("disableProviderPing")))}}var nj=Object.defineProperty,sj=(r,e,t)=>e in r?nj(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,qc=(r,e,t)=>sj(r,typeof e!="symbol"?e+"":e,t);class ij{constructor(e){qc(this,"name","near"),qc(this,"client"),qc(this,"httpProviders"),qc(this,"events"),qc(this,"namespace"),qc(this,"chainId"),this.namespace=e.namespace,this.events=Ye("events"),this.client=Ye("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const n=t||bn(`${this.name}:${e}`,this.namespace);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,n)}this.events.emit(jn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var n;e[t]=this.createHttpProvider(t,(n=this.namespace.rpcMap)==null?void 0:n[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||bn(e,this.namespace);return typeof n>"u"?void 0:new Fn(new ps(n,Ye("disableProviderPing")))}}var oj=Object.defineProperty,aj=(r,e,t)=>e in r?oj(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Vc=(r,e,t)=>aj(r,typeof e!="symbol"?e+"":e,t);class cj{constructor(e){Vc(this,"name","tezos"),Vc(this,"client"),Vc(this,"httpProviders"),Vc(this,"events"),Vc(this,"namespace"),Vc(this,"chainId"),this.namespace=e.namespace,this.events=Ye("events"),this.client=Ye("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const n=t||bn(`${this.name}:${e}`,this.namespace);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,n)}this.events.emit(jn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{e[t]=this.createHttpProvider(t)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||bn(e,this.namespace);return typeof n>"u"?void 0:new Fn(new ps(n))}}var lj=Object.defineProperty,uj=(r,e,t)=>e in r?lj(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Wc=(r,e,t)=>uj(r,typeof e!="symbol"?e+"":e,t);class hj{constructor(e){Wc(this,"name",Zc),Wc(this,"client"),Wc(this,"httpProviders"),Wc(this,"events"),Wc(this,"namespace"),Wc(this,"chainId"),this.namespace=e.namespace,this.events=Ye("events"),this.client=Ye("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace.chains=[...new Set((this.namespace.chains||[]).concat(e.chains||[]))],this.namespace.accounts=[...new Set((this.namespace.accounts||[]).concat(e.accounts||[]))],this.namespace.methods=[...new Set((this.namespace.methods||[]).concat(e.methods||[]))],this.namespace.events=[...new Set((this.namespace.events||[]).concat(e.events||[]))],this.httpProviders=this.createHttpProviders()}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider(e.chainId).request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(jn.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){var e,t;const n={};return(t=(e=this.namespace)==null?void 0:e.accounts)==null||t.forEach(s=>{const i=fl(s);n[`${i.namespace}:${i.reference}`]=this.createHttpProvider(s)}),n}getHttpProvider(e){const t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const n=this.createHttpProvider(e,t);n&&(this.httpProviders[e]=n)}createHttpProvider(e,t){const n=t||bn(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Fn(new ps(n,Ye("disableProviderPing")))}}var dj=Object.defineProperty,fj=Object.defineProperties,pj=Object.getOwnPropertyDescriptors,UA=Object.getOwnPropertySymbols,gj=Object.prototype.hasOwnProperty,mj=Object.prototype.propertyIsEnumerable,Sw=(r,e,t)=>e in r?dj(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Kf=(r,e)=>{for(var t in e||(e={}))gj.call(e,t)&&Sw(r,t,e[t]);if(UA)for(var t of UA(e))mj.call(e,t)&&Sw(r,t,e[t]);return r},oy=(r,e)=>fj(r,pj(e)),_n=(r,e,t)=>Sw(r,typeof e!="symbol"?e+"":e,t);let yj=class mI{constructor(e){_n(this,"client"),_n(this,"namespaces"),_n(this,"optionalNamespaces"),_n(this,"sessionProperties"),_n(this,"scopedProperties"),_n(this,"events",new vb),_n(this,"rpcProviders",{}),_n(this,"session"),_n(this,"providerOpts"),_n(this,"logger"),_n(this,"uri"),_n(this,"disableProviderPing",!1),this.providerOpts=e,this.logger=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:of(Bu({level:(e==null?void 0:e.logger)||CA})),this.disableProviderPing=(e==null?void 0:e.disableProviderPing)||!1}static async init(e){const t=new mI(e);return await t.initialize(),t}async request(e,t,n){const[s,i]=this.validateChain(t);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:Kf({},e),chainId:`${s}:${i}`,topic:this.session.topic,expiry:n})}sendAsync(e,t,n,s){const i=new Date().getTime();this.request(e,n,s).then(o=>t(null,jg(i,o))).catch(o=>t(o,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:at("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}async authenticate(e,t){if(!this.client)throw new Error("Sign Client not initialized");this.setNamespaces(e),await this.cleanupPendingPairings();const{uri:n,response:s}=await this.client.authenticate(e,t);n&&(this.uri=n,this.events.emit("display_uri",n));const i=await s();if(this.session=i.session,this.session){const o=OA(this.session.namespaces);this.namespaces=ny(this.namespaces,o),await this.persist("namespaces",this.namespaces),this.onConnect()}return i}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}removeListener(e,t){this.events.removeListener(e,t)}off(e,t){this.events.off(e,t)}get isWalletConnect(){return!0}async pair(e){const{uri:t,approval:n}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties});t&&(this.uri=t,this.events.emit("display_uri",t));const s=await n();this.session=s;const i=OA(s.namespaces);return this.namespaces=ny(this.namespaces,i),await this.persist("namespaces",this.namespaces),await this.persist("optionalNamespaces",this.optionalNamespaces),this.onConnect(),this.session}setDefaultChain(e,t){try{if(!this.session)return;const[n,s]=this.validateChain(e),i=this.getProvider(n);i.name===Zc?i.setDefaultChain(`${n}:${s}`,t):i.setDefaultChain(s,t)}catch(n){if(!/Please call connect/.test(n.message))throw n}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");const t=this.client.pairing.getAll();if(To(t)){for(const n of t)e.deletePairings?this.client.core.expirer.set(n.topic,0):await this.client.core.relayer.subscriber.unsubscribe(n.topic);this.logger.info(`Inactive pairings cleared: ${t.length}`)}}abortPairingAttempt(){this.logger.warn("abortPairingAttempt is deprecated. This is now a no-op.")}async checkStorage(){this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.session&&this.createProviders()}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){var e,t;if(this.client=this.providerOpts.client||await L6.init({core:this.providerOpts.core,logger:this.providerOpts.logger||CA,relayUrl:this.providerOpts.relayUrl||W6,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name,customStoragePrefix:this.providerOpts.customStoragePrefix,telemetryEnabled:this.providerOpts.telemetryEnabled}),this.providerOpts.session)try{this.session=this.client.session.get(this.providerOpts.session.topic)}catch(n){throw this.logger.error("Failed to get session",n),new Error(`The provided session: ${(t=(e=this.providerOpts)==null?void 0:e.session)==null?void 0:t.topic} doesn't exist in the Sign client`)}else{const n=this.client.session.getAll();this.session=n[0]}this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map(t=>vh(t)))];iy("client",this.client),iy("events",this.events),iy("disableProviderPing",this.disableProviderPing),e.forEach(t=>{if(!this.session)return;const n=TF(t,this.session),s=pI(n),i=ny(this.namespaces,this.optionalNamespaces),o=oy(Kf({},i[t]),{accounts:n,chains:s});switch(t){case"eip155":this.rpcProviders[t]=new $F({namespace:o});break;case"algorand":this.rpcProviders[t]=new GF({namespace:o});break;case"solana":this.rpcProviders[t]=new jF({namespace:o});break;case"cosmos":this.rpcProviders[t]=new qF({namespace:o});break;case"polkadot":this.rpcProviders[t]=new RF({namespace:o});break;case"cip34":this.rpcProviders[t]=new YF({namespace:o});break;case"elrond":this.rpcProviders[t]=new XF({namespace:o});break;case"multiversx":this.rpcProviders[t]=new rj({namespace:o});break;case"near":this.rpcProviders[t]=new ij({namespace:o});break;case"tezos":this.rpcProviders[t]=new cj({namespace:o});break;default:this.rpcProviders[Zc]?this.rpcProviders[Zc].updateNamespace(o):this.rpcProviders[Zc]=new hj({namespace:o})}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{var t;const{topic:n}=e;n===((t=this.session)==null?void 0:t.topic)&&this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{var t;const{params:n,topic:s}=e;if(s!==((t=this.session)==null?void 0:t.topic))return;const{event:i}=n;if(i.name==="accountsChanged"){const o=i.data;o&&To(o)&&this.events.emit("accountsChanged",o.map(PA))}else if(i.name==="chainChanged"){const o=n.chainId,a=n.event.data,c=vh(o),l=sy(o)!==sy(a)?`${c}:${sy(a)}`:o;this.onChainChanged(l)}else this.events.emit(i.name,i.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:t})=>{var n,s;if(e!==((n=this.session)==null?void 0:n.topic))return;const{namespaces:i}=t,o=(s=this.client)==null?void 0:s.session.get(e);this.session=oy(Kf({},o),{namespaces:i}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:t})}),this.client.on("session_delete",async e=>{var t;e.topic===((t=this.session)==null?void 0:t.topic)&&(await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",oy(Kf({},at("USER_DISCONNECTED")),{data:e.topic})))}),this.on(jn.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){return this.rpcProviders[e]||this.rpcProviders[Zc]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var t;this.getProvider(e).updateNamespace((t=this.session)==null?void 0:t.namespaces[e])})}setNamespaces(e){const{namespaces:t,optionalNamespaces:n,sessionProperties:s,scopedProperties:i}=e;t&&Object.keys(t).length&&(this.namespaces=t),n&&Object.keys(n).length&&(this.optionalNamespaces=n),this.sessionProperties=s,this.scopedProperties=i}validateChain(e){const[t,n]=(e==null?void 0:e.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[t,n];if(t&&!Object.keys(this.namespaces||{}).map(o=>vh(o)).includes(t))throw new Error(`Namespace '${t}' is not configured. Please call connect() first with namespace config.`);if(t&&n)return[t,n];const s=vh(Object.keys(this.namespaces)[0]),i=this.rpcProviders[s].getDefaultChain();return[s,i]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}async onChainChanged(e,t=!1){if(!this.namespaces)return;const[n,s]=this.validateChain(e);if(!s)return;this.updateNamespaceChain(n,s),this.events.emit("chainChanged",s);const i=this.getProvider(n).getDefaultChain();t||this.getProvider(n).setDefaultChain(s),this.emitAccountsChangedOnChainChange({namespace:n,previousChainId:i,newChainId:e}),await this.persist("namespaces",this.namespaces)}emitAccountsChangedOnChainChange({namespace:e,previousChainId:t,newChainId:n}){var s,i;try{if(t===n)return;const o=(i=(s=this.session)==null?void 0:s.namespaces[e])==null?void 0:i.accounts;if(!o)return;const a=o.filter(c=>c.includes(`${n}:`)).map(PA);if(!To(a))return;this.events.emit("accountsChanged",a)}catch(o){this.logger.warn("Failed to emit accountsChanged on chain change",o)}}updateNamespaceChain(e,t){if(!this.namespaces)return;const n=this.namespaces[e]?e:`${e}:${t}`,s={chains:[],methods:[],events:[],defaultChain:t};this.namespaces[n]?this.namespaces[n]&&(this.namespaces[n].defaultChain=t):this.namespaces[n]=s}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,await this.deleteFromStore("namespaces"),await this.deleteFromStore("optionalNamespaces"),await this.deleteFromStore("sessionProperties"),this.session=void 0,await this.cleanupPendingPairings({deletePairings:!0}),await this.cleanupStorage()}async persist(e,t){var n;const s=((n=this.session)==null?void 0:n.topic)||"";await this.client.core.storage.setItem(`${Wf}/${e}${s}`,t)}async getFromStore(e){var t;const n=((t=this.session)==null?void 0:t.topic)||"";return await this.client.core.storage.getItem(`${Wf}/${e}${n}`)}async deleteFromStore(e){var t;const n=((t=this.session)==null?void 0:t.topic)||"";await this.client.core.storage.removeItem(`${Wf}/${e}${n}`)}async cleanupStorage(){var e;try{if(((e=this.client)==null?void 0:e.session.length)>0)return;const t=await this.client.core.storage.getKeys();for(const n of t)n.startsWith(Wf)&&await this.client.core.storage.removeItem(n)}catch(t){this.logger.warn("Failed to cleanup storage",t)}}};var yu={};const wj="https://secure.walletconnect.org/sdk",bj=(typeof process<"u"&&typeof yu<"u"?yu.NEXT_PUBLIC_SECURE_SITE_SDK_URL:void 0)||wj,Ej=(typeof process<"u"&&typeof yu<"u"?yu.NEXT_PUBLIC_DEFAULT_LOG_LEVEL:void 0)||"error",vj=(typeof process<"u"&&typeof yu<"u"?yu.NEXT_PUBLIC_SECURE_SITE_SDK_VERSION:void 0)||"4",fe={APP_EVENT_KEY:"@w3m-app/",FRAME_EVENT_KEY:"@w3m-frame/",RPC_METHOD_KEY:"RPC_",STORAGE_KEY:"@appkit-wallet/",SESSION_TOKEN_KEY:"SESSION_TOKEN_KEY",EMAIL_LOGIN_USED_KEY:"EMAIL_LOGIN_USED_KEY",LAST_USED_CHAIN_KEY:"LAST_USED_CHAIN_KEY",LAST_EMAIL_LOGIN_TIME:"LAST_EMAIL_LOGIN_TIME",EMAIL:"EMAIL",PREFERRED_ACCOUNT_TYPE:"PREFERRED_ACCOUNT_TYPE",SMART_ACCOUNT_ENABLED:"SMART_ACCOUNT_ENABLED",SMART_ACCOUNT_ENABLED_NETWORKS:"SMART_ACCOUNT_ENABLED_NETWORKS",SOCIAL_USERNAME:"SOCIAL_USERNAME",APP_SWITCH_NETWORK:"@w3m-app/SWITCH_NETWORK",APP_CONNECT_EMAIL:"@w3m-app/CONNECT_EMAIL",APP_CONNECT_DEVICE:"@w3m-app/CONNECT_DEVICE",APP_CONNECT_OTP:"@w3m-app/CONNECT_OTP",APP_CONNECT_SOCIAL:"@w3m-app/CONNECT_SOCIAL",APP_GET_SOCIAL_REDIRECT_URI:"@w3m-app/GET_SOCIAL_REDIRECT_URI",APP_GET_USER:"@w3m-app/GET_USER",APP_SIGN_OUT:"@w3m-app/SIGN_OUT",APP_IS_CONNECTED:"@w3m-app/IS_CONNECTED",APP_GET_CHAIN_ID:"@w3m-app/GET_CHAIN_ID",APP_RPC_REQUEST:"@w3m-app/RPC_REQUEST",APP_UPDATE_EMAIL:"@w3m-app/UPDATE_EMAIL",APP_UPDATE_EMAIL_PRIMARY_OTP:"@w3m-app/UPDATE_EMAIL_PRIMARY_OTP",APP_UPDATE_EMAIL_SECONDARY_OTP:"@w3m-app/UPDATE_EMAIL_SECONDARY_OTP",APP_AWAIT_UPDATE_EMAIL:"@w3m-app/AWAIT_UPDATE_EMAIL",APP_SYNC_THEME:"@w3m-app/SYNC_THEME",APP_SYNC_DAPP_DATA:"@w3m-app/SYNC_DAPP_DATA",APP_GET_SMART_ACCOUNT_ENABLED_NETWORKS:"@w3m-app/GET_SMART_ACCOUNT_ENABLED_NETWORKS",APP_INIT_SMART_ACCOUNT:"@w3m-app/INIT_SMART_ACCOUNT",APP_SET_PREFERRED_ACCOUNT:"@w3m-app/SET_PREFERRED_ACCOUNT",APP_CONNECT_FARCASTER:"@w3m-app/CONNECT_FARCASTER",APP_GET_FARCASTER_URI:"@w3m-app/GET_FARCASTER_URI",APP_RELOAD:"@w3m-app/RELOAD",FRAME_SWITCH_NETWORK_ERROR:"@w3m-frame/SWITCH_NETWORK_ERROR",FRAME_SWITCH_NETWORK_SUCCESS:"@w3m-frame/SWITCH_NETWORK_SUCCESS",FRAME_CONNECT_EMAIL_ERROR:"@w3m-frame/CONNECT_EMAIL_ERROR",FRAME_CONNECT_EMAIL_SUCCESS:"@w3m-frame/CONNECT_EMAIL_SUCCESS",FRAME_CONNECT_DEVICE_ERROR:"@w3m-frame/CONNECT_DEVICE_ERROR",FRAME_CONNECT_DEVICE_SUCCESS:"@w3m-frame/CONNECT_DEVICE_SUCCESS",FRAME_CONNECT_OTP_SUCCESS:"@w3m-frame/CONNECT_OTP_SUCCESS",FRAME_CONNECT_OTP_ERROR:"@w3m-frame/CONNECT_OTP_ERROR",FRAME_CONNECT_SOCIAL_SUCCESS:"@w3m-frame/CONNECT_SOCIAL_SUCCESS",FRAME_CONNECT_SOCIAL_ERROR:"@w3m-frame/CONNECT_SOCIAL_ERROR",FRAME_CONNECT_FARCASTER_SUCCESS:"@w3m-frame/CONNECT_FARCASTER_SUCCESS",FRAME_CONNECT_FARCASTER_ERROR:"@w3m-frame/CONNECT_FARCASTER_ERROR",FRAME_GET_FARCASTER_URI_SUCCESS:"@w3m-frame/GET_FARCASTER_URI_SUCCESS",FRAME_GET_FARCASTER_URI_ERROR:"@w3m-frame/GET_FARCASTER_URI_ERROR",FRAME_GET_SOCIAL_REDIRECT_URI_SUCCESS:"@w3m-frame/GET_SOCIAL_REDIRECT_URI_SUCCESS",FRAME_GET_SOCIAL_REDIRECT_URI_ERROR:"@w3m-frame/GET_SOCIAL_REDIRECT_URI_ERROR",FRAME_GET_USER_SUCCESS:"@w3m-frame/GET_USER_SUCCESS",FRAME_GET_USER_ERROR:"@w3m-frame/GET_USER_ERROR",FRAME_SIGN_OUT_SUCCESS:"@w3m-frame/SIGN_OUT_SUCCESS",FRAME_SIGN_OUT_ERROR:"@w3m-frame/SIGN_OUT_ERROR",FRAME_IS_CONNECTED_SUCCESS:"@w3m-frame/IS_CONNECTED_SUCCESS",FRAME_IS_CONNECTED_ERROR:"@w3m-frame/IS_CONNECTED_ERROR",FRAME_GET_CHAIN_ID_SUCCESS:"@w3m-frame/GET_CHAIN_ID_SUCCESS",FRAME_GET_CHAIN_ID_ERROR:"@w3m-frame/GET_CHAIN_ID_ERROR",FRAME_RPC_REQUEST_SUCCESS:"@w3m-frame/RPC_REQUEST_SUCCESS",FRAME_RPC_REQUEST_ERROR:"@w3m-frame/RPC_REQUEST_ERROR",FRAME_SESSION_UPDATE:"@w3m-frame/SESSION_UPDATE",FRAME_UPDATE_EMAIL_SUCCESS:"@w3m-frame/UPDATE_EMAIL_SUCCESS",FRAME_UPDATE_EMAIL_ERROR:"@w3m-frame/UPDATE_EMAIL_ERROR",FRAME_UPDATE_EMAIL_PRIMARY_OTP_SUCCESS:"@w3m-frame/UPDATE_EMAIL_PRIMARY_OTP_SUCCESS",FRAME_UPDATE_EMAIL_PRIMARY_OTP_ERROR:"@w3m-frame/UPDATE_EMAIL_PRIMARY_OTP_ERROR",FRAME_UPDATE_EMAIL_SECONDARY_OTP_SUCCESS:"@w3m-frame/UPDATE_EMAIL_SECONDARY_OTP_SUCCESS",FRAME_UPDATE_EMAIL_SECONDARY_OTP_ERROR:"@w3m-frame/UPDATE_EMAIL_SECONDARY_OTP_ERROR",FRAME_SYNC_THEME_SUCCESS:"@w3m-frame/SYNC_THEME_SUCCESS",FRAME_SYNC_THEME_ERROR:"@w3m-frame/SYNC_THEME_ERROR",FRAME_SYNC_DAPP_DATA_SUCCESS:"@w3m-frame/SYNC_DAPP_DATA_SUCCESS",FRAME_SYNC_DAPP_DATA_ERROR:"@w3m-frame/SYNC_DAPP_DATA_ERROR",FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS:"@w3m-frame/GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS",FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR:"@w3m-frame/GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR",FRAME_INIT_SMART_ACCOUNT_SUCCESS:"@w3m-frame/INIT_SMART_ACCOUNT_SUCCESS",FRAME_INIT_SMART_ACCOUNT_ERROR:"@w3m-frame/INIT_SMART_ACCOUNT_ERROR",FRAME_SET_PREFERRED_ACCOUNT_SUCCESS:"@w3m-frame/SET_PREFERRED_ACCOUNT_SUCCESS",FRAME_SET_PREFERRED_ACCOUNT_ERROR:"@w3m-frame/SET_PREFERRED_ACCOUNT_ERROR",FRAME_READY:"@w3m-frame/READY",FRAME_RELOAD_SUCCESS:"@w3m-frame/RELOAD_SUCCESS",FRAME_RELOAD_ERROR:"@w3m-frame/RELOAD_ERROR",RPC_RESPONSE_TYPE_ERROR:"RPC_RESPONSE_ERROR",RPC_RESPONSE_TYPE_TX:"RPC_RESPONSE_TRANSACTION_HASH",RPC_RESPONSE_TYPE_OBJECT:"RPC_RESPONSE_OBJECT"},dr={SAFE_RPC_METHODS:["eth_accounts","eth_blockNumber","eth_call","eth_chainId","eth_estimateGas","eth_feeHistory","eth_gasPrice","eth_getAccount","eth_getBalance","eth_getBlockByHash","eth_getBlockByNumber","eth_getBlockReceipts","eth_getBlockTransactionCountByHash","eth_getBlockTransactionCountByNumber","eth_getCode","eth_getFilterChanges","eth_getFilterLogs","eth_getLogs","eth_getProof","eth_getStorageAt","eth_getTransactionByBlockHashAndIndex","eth_getTransactionByBlockNumberAndIndex","eth_getTransactionByHash","eth_getTransactionCount","eth_getTransactionReceipt","eth_getUncleCountByBlockHash","eth_getUncleCountByBlockNumber","eth_maxPriorityFeePerGas","eth_newBlockFilter","eth_newFilter","eth_newPendingTransactionFilter","eth_sendRawTransaction","eth_syncing","eth_uninstallFilter","wallet_getCapabilities","wallet_getCallsStatus","eth_getUserOperationReceipt","eth_estimateUserOperationGas","eth_getUserOperationByHash","eth_supportedEntryPoints","wallet_getAssets"],NOT_SAFE_RPC_METHODS:["personal_sign","eth_signTypedData_v4","eth_sendTransaction","solana_signMessage","solana_signTransaction","solana_signAllTransactions","solana_signAndSendTransaction","wallet_sendCalls","wallet_grantPermissions","wallet_revokePermissions","eth_sendUserOperation"],GET_CHAIN_ID:"eth_chainId",RPC_METHOD_NOT_ALLOWED_MESSAGE:"Requested RPC call is not allowed",RPC_METHOD_NOT_ALLOWED_UI_MESSAGE:"Action not allowed",ACCOUNT_TYPES:{EOA:"eoa",SMART_ACCOUNT:"smartAccount"}},ra=Object.freeze({message:"",variant:"success",svg:void 0,open:!1,autoClose:!0}),jt=St({...ra}),os={state:jt,subscribeKey(r,e){return Zr(jt,r,e)},showLoading(r,e={}){this._showMessage({message:r,variant:"loading",...e})},showSuccess(r){this._showMessage({message:r,variant:"success"})},showSvg(r,e){this._showMessage({message:r,svg:e})},showError(r){const e=Ee.parseError(r);this._showMessage({message:e,variant:"error"})},hide(){jt.message=ra.message,jt.variant=ra.variant,jt.svg=ra.svg,jt.open=ra.open,jt.autoClose=ra.autoClose},_showMessage({message:r,svg:e,variant:t="success",autoClose:n=ra.autoClose}){jt.open?(jt.open=!1,setTimeout(()=>{jt.message=r,jt.variant=t,jt.svg=e,jt.open=!0,jt.autoClose=n},150)):(jt.message=r,jt.variant=t,jt.svg=e,jt.open=!0,jt.autoClose=n)}},kh={getSIWX(){return K.state.siwx},async initializeIfEnabled(){var i;const r=K.state.siwx,e=S.getActiveCaipAddress();if(!(r&&e))return;const[t,n,s]=e.split(":");if(S.checkIfSupportedNetwork(t))try{if((await r.getSessions(`${t}:${n}`,s)).length)return;await Ut.open({view:"SIWXSignMessage"})}catch(o){console.error("SIWXUtil:initializeIfEnabled",o),At.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:this.getSIWXEventProperties()}),await((i=Et._getClient())==null?void 0:i.disconnect().catch(console.error)),tt.reset("Connect"),os.showError("A problem occurred while trying initialize authentication")}},async requestSignMessage(){const r=K.state.siwx,e=Ee.getPlainAddress(S.getActiveCaipAddress()),t=S.getActiveCaipNetwork(),n=Et._getClient();if(!r)throw new Error("SIWX is not enabled");if(!e)throw new Error("No ActiveCaipAddress found");if(!t)throw new Error("No ActiveCaipNetwork or client found");if(!n)throw new Error("No ConnectionController client found");try{const s=await r.createMessage({chainId:t.caipNetworkId,accountAddress:e}),i=s.toString();_e.getConnectorId(t.chainNamespace)===ee.CONNECTOR_ID.AUTH&&tt.pushTransactionStack({view:null,goBack:!1,replace:!0});const a=await n.signMessage(i);await r.addSession({data:s,message:i,signature:a}),Ut.close(),At.sendEvent({type:"track",event:"SIWX_AUTH_SUCCESS",properties:this.getSIWXEventProperties()})}catch(s){const i=this.getSIWXEventProperties();(!Ut.state.open||tt.state.view==="ApproveTransaction")&&await Ut.open({view:"SIWXSignMessage"}),i.isSmartAccount?os.showError("This application might not support Smart Accounts"):os.showError("Signature declined"),At.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:i}),console.error("SWIXUtil:requestSignMessage",s)}},async cancelSignMessage(){var r;try{const e=this.getSIWX();((r=e==null?void 0:e.getRequired)==null?void 0:r.call(e))?await Et.disconnect():Ut.close(),tt.reset("Connect"),At.sendEvent({event:"CLICK_CANCEL_SIWX",type:"track",properties:this.getSIWXEventProperties()})}catch(e){console.error("SIWXUtil:cancelSignMessage",e)}},async getSessions(){const r=K.state.siwx,e=Ee.getPlainAddress(S.getActiveCaipAddress()),t=S.getActiveCaipNetwork();return r&&e&&t?r.getSessions(t.caipNetworkId,e):[]},async isSIWXCloseDisabled(){var e;const r=this.getSIWX();if(r){const t=tt.state.view==="ApproveTransaction",n=tt.state.view==="SIWXSignMessage";if(t||n)return((e=r.getRequired)==null?void 0:e.call(r))&&(await this.getSessions()).length===0}return!1},async universalProviderAuthenticate({universalProvider:r,chains:e,methods:t}){var a,c,l;const n=kh.getSIWX(),s=new Set(e.map(u=>u.split(":")[0]));if(!n||s.size!==1||!s.has("eip155"))return!1;const i=await n.createMessage({chainId:((a=S.getActiveCaipNetwork())==null?void 0:a.caipNetworkId)||"",accountAddress:""}),o=await r.authenticate({nonce:i.nonce,domain:i.domain,uri:i.uri,exp:i.expirationTime,iat:i.issuedAt,nbf:i.notBefore,requestId:i.requestId,version:i.version,resources:i.resources,statement:i.statement,chainId:i.chainId,methods:t,chains:[i.chainId,...e.filter(u=>u!==i.chainId)]});if(os.showLoading("Authenticating...",{autoClose:!1}),he.setConnectedWalletInfo({...o.session.peer.metadata,name:o.session.peer.metadata.name,icon:(c=o.session.peer.metadata.icons)==null?void 0:c[0],type:"WALLET_CONNECT"},Array.from(s)[0]),(l=o==null?void 0:o.auths)!=null&&l.length){const u=o.auths.map(h=>{const d=r.client.formatAuthMessage({request:h.p,iss:h.p.iss});return{data:{...h.p,accountAddress:h.p.iss.split(":").slice(-1).join(""),chainId:h.p.iss.split(":").slice(2,4).join(":"),uri:h.p.aud,version:h.p.version||i.version,expirationTime:h.p.exp,issuedAt:h.p.iat,notBefore:h.p.nbf},message:d,signature:h.s.s,cacao:h}});try{await n.setSessions(u),At.sendEvent({type:"track",event:"SIWX_AUTH_SUCCESS",properties:kh.getSIWXEventProperties()})}catch(h){throw console.error("SIWX:universalProviderAuth - failed to set sessions",h),At.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:kh.getSIWXEventProperties()}),await r.disconnect().catch(console.error),h}finally{os.hide()}}return!0},getSIWXEventProperties(){var e,t;const r=S.state.activeChain;return{network:((e=S.state.activeCaipNetwork)==null?void 0:e.caipNetworkId)||"",isSmartAccount:((t=he.state.preferredAccountTypes)==null?void 0:t[r])===dr.ACCOUNT_TYPES.SMART_ACCOUNT}},async clearSessions(){const r=this.getSIWX();r&&await r.setSessions([])}},yt=St({transactions:[],coinbaseTransactions:{},transactionsByYear:{},lastNetworkInView:void 0,loading:!1,empty:!1,next:void 0}),Aj={state:yt,subscribe(r){return _r(yt,()=>r(yt))},setLastNetworkInView(r){yt.lastNetworkInView=r},async fetchTransactions(r,e){var t,n;if(!r)throw new Error("Transactions can't be fetched without an accountAddress");yt.loading=!0;try{const s=await Ae.fetchTransactions({account:r,cursor:yt.next,onramp:e,cache:e==="coinbase"?"no-cache":void 0,chainId:(t=S.state.activeCaipNetwork)==null?void 0:t.caipNetworkId}),i=this.filterSpamTransactions(s.data),o=this.filterByConnectedChain(i),a=[...yt.transactions,...o];yt.loading=!1,e==="coinbase"?yt.coinbaseTransactions=this.groupTransactionsByYearAndMonth(yt.coinbaseTransactions,s.data):(yt.transactions=a,yt.transactionsByYear=this.groupTransactionsByYearAndMonth(yt.transactionsByYear,o)),yt.empty=a.length===0,yt.next=s.next?s.next:void 0}catch{const i=S.state.activeChain;At.sendEvent({type:"track",event:"ERROR_FETCH_TRANSACTIONS",properties:{address:r,projectId:K.state.projectId,cursor:yt.next,isSmartAccount:((n=he.state.preferredAccountTypes)==null?void 0:n[i])===dr.ACCOUNT_TYPES.SMART_ACCOUNT}}),os.showError("Failed to fetch transactions"),yt.loading=!1,yt.empty=!0,yt.next=void 0}},groupTransactionsByYearAndMonth(r={},e=[]){const t=r;return e.forEach(n=>{const s=new Date(n.metadata.minedAt).getFullYear(),i=new Date(n.metadata.minedAt).getMonth(),o=t[s]??{},c=(o[i]??[]).filter(l=>l.id!==n.id);t[s]={...o,[i]:[...c,n].sort((l,u)=>new Date(u.metadata.minedAt).getTime()-new Date(l.metadata.minedAt).getTime())}}),t},filterSpamTransactions(r){return r.filter(e=>!e.transfers.every(n=>{var s;return((s=n.nft_info)==null?void 0:s.flags.is_spam)===!0}))},filterByConnectedChain(r){var n;const e=(n=S.state.activeCaipNetwork)==null?void 0:n.caipNetworkId;return r.filter(s=>s.metadata.chain===e)},clearCursor(){yt.next=void 0},resetTransactions(){yt.transactions=[],yt.transactionsByYear={},yt.lastNetworkInView=void 0,yt.loading=!1,yt.empty=!1,yt.next=void 0}},wt=St({wcError:!1,buffering:!1,status:"disconnected"});let Yo;const Et={state:wt,subscribeKey(r,e){return Zr(wt,r,e)},_getClient(){return wt._client},setClient(r){wt._client=Xa(r)},async connectWalletConnect(){var r,e,t,n;if(Ee.isTelegram()||Ee.isSafari()&&Ee.isIos()){if(Yo){await Yo,Yo=void 0;return}if(!Ee.isPairingExpired(wt==null?void 0:wt.wcPairingExpiry)){const s=wt.wcUri;wt.wcUri=s;return}Yo=(e=(r=this._getClient())==null?void 0:r.connectWalletConnect)==null?void 0:e.call(r).catch(()=>{}),this.state.status="connecting",await Yo,Yo=void 0,wt.wcPairingExpiry=void 0,this.state.status="connected"}else await((n=(t=this._getClient())==null?void 0:t.connectWalletConnect)==null?void 0:n.call(t))},async connectExternal(r,e,t=!0){var n,s;await((s=(n=this._getClient())==null?void 0:n.connectExternal)==null?void 0:s.call(n,r)),t&&S.setActiveNamespace(e)},async reconnectExternal(r){var t,n;await((n=(t=this._getClient())==null?void 0:t.reconnectExternal)==null?void 0:n.call(t,r));const e=r.chain||S.state.activeChain;e&&_e.setConnectorId(r.id,e)},async setPreferredAccountType(r,e){var n;Ut.setLoading(!0,S.state.activeChain);const t=_e.getAuthConnector();t&&(he.setPreferredAccountType(r,e),await t.provider.setPreferredAccount(r),se.setPreferredAccountTypes(he.state.preferredAccountTypes??{[e]:r}),await this.reconnectExternal(t),Ut.setLoading(!1,S.state.activeChain),At.sendEvent({type:"track",event:"SET_PREFERRED_ACCOUNT_TYPE",properties:{accountType:r,network:((n=S.state.activeCaipNetwork)==null?void 0:n.caipNetworkId)||""}}))},async signMessage(r){var e;return(e=this._getClient())==null?void 0:e.signMessage(r)},parseUnits(r,e){var t;return(t=this._getClient())==null?void 0:t.parseUnits(r,e)},formatUnits(r,e){var t;return(t=this._getClient())==null?void 0:t.formatUnits(r,e)},async sendTransaction(r){var e;return(e=this._getClient())==null?void 0:e.sendTransaction(r)},async getCapabilities(r){var e;return(e=this._getClient())==null?void 0:e.getCapabilities(r)},async grantPermissions(r){var e;return(e=this._getClient())==null?void 0:e.grantPermissions(r)},async walletGetAssets(r){var e;return((e=this._getClient())==null?void 0:e.walletGetAssets(r))??{}},async estimateGas(r){var e;return(e=this._getClient())==null?void 0:e.estimateGas(r)},async writeContract(r){var e;return(e=this._getClient())==null?void 0:e.writeContract(r)},async getEnsAddress(r){var e;return(e=this._getClient())==null?void 0:e.getEnsAddress(r)},async getEnsAvatar(r){var e;return(e=this._getClient())==null?void 0:e.getEnsAvatar(r)},checkInstalled(r){var e,t;return((t=(e=this._getClient())==null?void 0:e.checkInstalled)==null?void 0:t.call(e,r))||!1},resetWcConnection(){wt.wcUri=void 0,wt.wcPairingExpiry=void 0,wt.wcLinking=void 0,wt.recentWallet=void 0,wt.status="disconnected",Aj.resetTransactions(),se.deleteWalletConnectDeepLink()},resetUri(){wt.wcUri=void 0,wt.wcPairingExpiry=void 0,Yo=void 0},finalizeWcConnection(){var t,n;const{wcLinking:r,recentWallet:e}=Et.state;r&&se.setWalletConnectDeepLink(r),e&&se.setAppKitRecent(e),At.sendEvent({type:"track",event:"CONNECT_SUCCESS",properties:{method:r?"mobile":"qrcode",name:((n=(t=tt.state.data)==null?void 0:t.wallet)==null?void 0:n.name)||"Unknown"}})},setWcBasic(r){wt.wcBasic=r},setUri(r){wt.wcUri=r,wt.wcPairingExpiry=Ee.getPairingExpiry()},setWcLinking(r){wt.wcLinking=r},setWcError(r){wt.wcError=r,wt.buffering=!1},setRecentWallet(r){wt.recentWallet=r},setBuffering(r){wt.buffering=r},setStatus(r){wt.status=r},async disconnect(r){try{Ut.setLoading(!0,r),await kh.clearSessions(),await S.disconnect(r),Ut.setLoading(!1,r),_e.setFilterByNamespace(void 0)}catch{throw new Error("Failed to disconnect")}}},Gc=St({loading:!1,open:!1,selectedNetworkId:void 0,activeChain:void 0,initialized:!1}),Vs={state:Gc,subscribe(r){return _r(Gc,()=>r(Gc))},subscribeOpen(r){return Zr(Gc,"open",r)},set(r){Object.assign(Gc,{...Gc,...r})}};function Cj(r,{strict:e=!0}={}){return!r||typeof r!="string"?!1:e?/^0x[0-9a-fA-F]*$/.test(r):r.startsWith("0x")}function BA(r){return Cj(r,{strict:!1})?Math.ceil((r.length-2)/2):r.length}const yI="2.29.2";let dh={getDocsUrl:({docsBaseUrl:r,docsPath:e="",docsSlug:t})=>e?`${r??"https://viem.sh"}${e}${t?`#${t}`:""}`:void 0,version:`viem@${yI}`};class En extends Error{constructor(e,t={}){var a;const n=(()=>{var c;return t.cause instanceof En?t.cause.details:(c=t.cause)!=null&&c.message?t.cause.message:t.details})(),s=t.cause instanceof En&&t.cause.docsPath||t.docsPath,i=(a=dh.getDocsUrl)==null?void 0:a.call(dh,{...t,docsPath:s}),o=[e||"An error occurred.","",...t.metaMessages?[...t.metaMessages,""]:[],...i?[`Docs: ${i}`]:[],...n?[`Details: ${n}`]:[],...dh.version?[`Version: ${dh.version}`]:[]].join(`
`);super(o,t.cause?{cause:t.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=n,this.docsPath=s,this.metaMessages=t.metaMessages,this.name=t.name??this.name,this.shortMessage=e,this.version=yI}walk(e){return wI(this,e)}}function wI(r,e){return e!=null&&e(r)?r:r&&typeof r=="object"&&"cause"in r&&r.cause!==void 0?wI(r.cause,e):e?null:r}class bI extends En{constructor({size:e,targetSize:t,type:n}){super(`${n.charAt(0).toUpperCase()}${n.slice(1).toLowerCase()} size (${e}) exceeds padding size (${t}).`,{name:"SizeExceedsPaddingSizeError"})}}function Gb(r,{dir:e,size:t=32}={}){return typeof r=="string"?_j(r,{dir:e,size:t}):Nj(r,{dir:e,size:t})}function _j(r,{dir:e,size:t=32}={}){if(t===null)return r;const n=r.replace("0x","");if(n.length>t*2)throw new bI({size:Math.ceil(n.length/2),targetSize:t,type:"hex"});return`0x${n[e==="right"?"padEnd":"padStart"](t*2,"0")}`}function Nj(r,{dir:e,size:t=32}={}){if(t===null)return r;if(r.length>t)throw new bI({size:r.length,targetSize:t,type:"bytes"});const n=new Uint8Array(t);for(let s=0;s<t;s++){const i=e==="right";n[i?s:t-s-1]=r[i?s:r.length-s-1]}return n}class Ij extends En{constructor({max:e,min:t,signed:n,size:s,value:i}){super(`Number "${i}" is not in safe ${s?`${s*8}-bit ${n?"signed":"unsigned"} `:""}integer range ${e?`(${t} to ${e})`:`(above ${t})`}`,{name:"IntegerOutOfRangeError"})}}class Sj extends En{constructor({givenSize:e,maxSize:t}){super(`Size cannot exceed ${t} bytes. Given size: ${e} bytes.`,{name:"SizeOverflowError"})}}function EI(r,{size:e}){if(BA(r)>e)throw new Sj({givenSize:BA(r),maxSize:e})}const xj=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));function LA(r,e={}){return typeof r=="number"||typeof r=="bigint"?Pj(r,e):typeof r=="string"?AI(r,e):typeof r=="boolean"?Tj(r,e):vI(r,e)}function Tj(r,e={}){const t=`0x${Number(r)}`;return typeof e.size=="number"?(EI(t,{size:e.size}),Gb(t,{size:e.size})):t}function vI(r,e={}){let t="";for(let s=0;s<r.length;s++)t+=xj[r[s]];const n=`0x${t}`;return typeof e.size=="number"?(EI(n,{size:e.size}),Gb(n,{dir:"right",size:e.size})):n}function Pj(r,e={}){const{signed:t,size:n}=e,s=BigInt(r);let i;n?t?i=(1n<<BigInt(n)*8n-1n)-1n:i=2n**(BigInt(n)*8n)-1n:typeof r=="number"&&(i=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof i=="bigint"&&t?-i-1n:0;if(i&&s>i||s<o){const c=typeof r=="bigint"?"n":"";throw new Ij({max:i?`${i}${c}`:void 0,min:`${o}${c}`,signed:t,size:n,value:`${r}${c}`})}const a=`0x${(t&&s<0?(1n<<BigInt(n*8))+BigInt(s):s).toString(16)}`;return n?Gb(a,{size:n}):a}const Oj=new TextEncoder;function AI(r,e={}){const t=Oj.encode(r);return vI(t,e)}class Rj extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const t=super.get(e);return super.has(e)&&t!==void 0&&(this.delete(e),super.set(e,t)),t}set(e,t){if(super.set(e,t),this.maxSize&&this.size>this.maxSize){const n=this.keys().next().value;n&&this.delete(n)}return this}}const za=(r,e,t)=>JSON.stringify(r,(n,s)=>typeof s=="bigint"?s.toString():s,t);function Dj(r,e){let t=r.toString();const n=t.startsWith("-");n&&(t=t.slice(1)),t=t.padStart(e,"0");let[s,i]=[t.slice(0,t.length-e),t.slice(t.length-e)];return i=i.replace(/(0+)$/,""),`${n?"-":""}${s||"0"}${i?`.${i}`:""}`}const Kb=r=>r;class Uh extends En{constructor({body:e,cause:t,details:n,headers:s,status:i,url:o}){super("HTTP request failed.",{cause:t,details:n,metaMessages:[i&&`Status: ${i}`,`URL: ${Kb(o)}`,e&&`Request body: ${za(e)}`].filter(Boolean),name:"HttpRequestError"}),Object.defineProperty(this,"body",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"headers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"url",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.body=e,this.headers=s,this.status=i,this.url=o}}class CI extends En{constructor({body:e,error:t,url:n}){super("RPC Request failed.",{cause:t,details:t.message,metaMessages:[`URL: ${Kb(n)}`,`Request body: ${za(e)}`],name:"RpcRequestError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.code=t.code,this.data=t.data}}class $A extends En{constructor({body:e,url:t}){super("The request took too long to respond.",{details:"The request timed out.",metaMessages:[`URL: ${Kb(t)}`,`Request body: ${za(e)}`],name:"TimeoutError"})}}const kj=-1;class en extends En{constructor(e,{code:t,docsPath:n,metaMessages:s,name:i,shortMessage:o}){super(o,{cause:e,docsPath:n,metaMessages:s||(e==null?void 0:e.metaMessages),name:i||"RpcError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=i||e.name,this.code=e instanceof CI?e.code:t??kj}}class vn extends en{constructor(e,t){super(e,t),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=t.data}}class Xh extends en{constructor(e){super(e,{code:Xh.code,name:"ParseRpcError",shortMessage:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."})}}Object.defineProperty(Xh,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32700});class ed extends en{constructor(e){super(e,{code:ed.code,name:"InvalidRequestRpcError",shortMessage:"JSON is not a valid request object."})}}Object.defineProperty(ed,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32600});class td extends en{constructor(e,{method:t}={}){super(e,{code:td.code,name:"MethodNotFoundRpcError",shortMessage:`The method${t?` "${t}"`:""} does not exist / is not available.`})}}Object.defineProperty(td,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32601});class rd extends en{constructor(e){super(e,{code:rd.code,name:"InvalidParamsRpcError",shortMessage:["Invalid parameters were provided to the RPC method.","Double check you have provided the correct parameters."].join(`
`)})}}Object.defineProperty(rd,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32602});class wu extends en{constructor(e){super(e,{code:wu.code,name:"InternalRpcError",shortMessage:"An internal error was received."})}}Object.defineProperty(wu,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32603});class nd extends en{constructor(e){super(e,{code:nd.code,name:"InvalidInputRpcError",shortMessage:["Missing or invalid parameters.","Double check you have provided the correct parameters."].join(`
`)})}}Object.defineProperty(nd,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32e3});class sd extends en{constructor(e){super(e,{code:sd.code,name:"ResourceNotFoundRpcError",shortMessage:"Requested resource not found."}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ResourceNotFoundRpcError"})}}Object.defineProperty(sd,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32001});class id extends en{constructor(e){super(e,{code:id.code,name:"ResourceUnavailableRpcError",shortMessage:"Requested resource not available."})}}Object.defineProperty(id,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32002});class bu extends en{constructor(e){super(e,{code:bu.code,name:"TransactionRejectedRpcError",shortMessage:"Transaction creation failed."})}}Object.defineProperty(bu,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32003});class ma extends en{constructor(e,{method:t}={}){super(e,{code:ma.code,name:"MethodNotSupportedRpcError",shortMessage:`Method${t?` "${t}"`:""} is not supported.`})}}Object.defineProperty(ma,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32004});class Eu extends en{constructor(e){super(e,{code:Eu.code,name:"LimitExceededRpcError",shortMessage:"Request exceeds defined limit."})}}Object.defineProperty(Eu,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32005});class od extends en{constructor(e){super(e,{code:od.code,name:"JsonRpcVersionUnsupportedError",shortMessage:"Version of JSON-RPC protocol is not supported."})}}Object.defineProperty(od,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32006});class qa extends vn{constructor(e){super(e,{code:qa.code,name:"UserRejectedRequestError",shortMessage:"User rejected the request."})}}Object.defineProperty(qa,"code",{enumerable:!0,configurable:!0,writable:!0,value:4001});class ad extends vn{constructor(e){super(e,{code:ad.code,name:"UnauthorizedProviderError",shortMessage:"The requested method and/or account has not been authorized by the user."})}}Object.defineProperty(ad,"code",{enumerable:!0,configurable:!0,writable:!0,value:4100});class cd extends vn{constructor(e,{method:t}={}){super(e,{code:cd.code,name:"UnsupportedProviderMethodError",shortMessage:`The Provider does not support the requested method${t?` " ${t}"`:""}.`})}}Object.defineProperty(cd,"code",{enumerable:!0,configurable:!0,writable:!0,value:4200});class ld extends vn{constructor(e){super(e,{code:ld.code,name:"ProviderDisconnectedError",shortMessage:"The Provider is disconnected from all chains."})}}Object.defineProperty(ld,"code",{enumerable:!0,configurable:!0,writable:!0,value:4900});class ud extends vn{constructor(e){super(e,{code:ud.code,name:"ChainDisconnectedError",shortMessage:"The Provider is not connected to the requested chain."})}}Object.defineProperty(ud,"code",{enumerable:!0,configurable:!0,writable:!0,value:4901});class hd extends vn{constructor(e){super(e,{code:hd.code,name:"SwitchChainError",shortMessage:"An error occurred when attempting to switch chain."})}}Object.defineProperty(hd,"code",{enumerable:!0,configurable:!0,writable:!0,value:4902});class dd extends vn{constructor(e){super(e,{code:dd.code,name:"UnsupportedNonOptionalCapabilityError",shortMessage:"This Wallet does not support a capability that was not marked as optional."})}}Object.defineProperty(dd,"code",{enumerable:!0,configurable:!0,writable:!0,value:5700});class fd extends vn{constructor(e){super(e,{code:fd.code,name:"UnsupportedChainIdError",shortMessage:"This Wallet does not support the requested chain ID."})}}Object.defineProperty(fd,"code",{enumerable:!0,configurable:!0,writable:!0,value:5710});class pd extends vn{constructor(e){super(e,{code:pd.code,name:"DuplicateIdError",shortMessage:"There is already a bundle submitted with this ID."})}}Object.defineProperty(pd,"code",{enumerable:!0,configurable:!0,writable:!0,value:5720});class gd extends vn{constructor(e){super(e,{code:gd.code,name:"UnknownBundleIdError",shortMessage:"This bundle id is unknown / has not been submitted"})}}Object.defineProperty(gd,"code",{enumerable:!0,configurable:!0,writable:!0,value:5730});class md extends vn{constructor(e){super(e,{code:md.code,name:"BundleTooLargeError",shortMessage:"The call bundle is too large for the Wallet to process."})}}Object.defineProperty(md,"code",{enumerable:!0,configurable:!0,writable:!0,value:5740});class yd extends vn{constructor(e){super(e,{code:yd.code,name:"AtomicReadyWalletRejectedUpgradeError",shortMessage:"The Wallet can support atomicity after an upgrade, but the user rejected the upgrade."})}}Object.defineProperty(yd,"code",{enumerable:!0,configurable:!0,writable:!0,value:5750});class wd extends vn{constructor(e){super(e,{code:wd.code,name:"AtomicityNotSupportedError",shortMessage:"The wallet does not support atomic execution but the request requires it."})}}Object.defineProperty(wd,"code",{enumerable:!0,configurable:!0,writable:!0,value:5760});class Uj extends en{constructor(e){super(e,{name:"UnknownRpcError",shortMessage:"An unknown RPC error occurred."})}}class Jb extends En{constructor({cause:e,message:t}={}){var s;const n=(s=t==null?void 0:t.replace("execution reverted: ",""))==null?void 0:s.replace("execution reverted","");super(`Execution reverted ${n?`with reason: ${n}`:"for an unknown reason"}.`,{cause:e,name:"ExecutionRevertedError"})}}Object.defineProperty(Jb,"code",{enumerable:!0,configurable:!0,writable:!0,value:3});Object.defineProperty(Jb,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/execution reverted/});function Bj(){let r=()=>{},e=()=>{};return{promise:new Promise((n,s)=>{r=n,e=s}),resolve:r,reject:e}}const ay=new Map;function Lj({fn:r,id:e,shouldSplitBatch:t,wait:n=0,sort:s}){const i=async()=>{const u=c();o();const h=u.map(({args:d})=>d);h.length!==0&&r(h).then(d=>{s&&Array.isArray(d)&&d.sort(s);for(let f=0;f<u.length;f++){const{resolve:g}=u[f];g==null||g([d[f],d])}}).catch(d=>{for(let f=0;f<u.length;f++){const{reject:g}=u[f];g==null||g(d)}})},o=()=>ay.delete(e),a=()=>c().map(({args:u})=>u),c=()=>ay.get(e)||[],l=u=>ay.set(e,[...c(),u]);return{flush:o,async schedule(u){const{promise:h,resolve:d,reject:f}=Bj();return(t==null?void 0:t([...a(),u]))&&i(),c().length>0?(l({args:u,resolve:d,reject:f}),h):(l({args:u,resolve:d,reject:f}),setTimeout(i,n),h)}}}async function _I(r){return new Promise(e=>setTimeout(e,r))}const xw=256;let Jf=xw,Yf;function $j(r=11){if(!Yf||Jf+r>xw*2){Yf="",Jf=0;for(let e=0;e<xw;e++)Yf+=(256+Math.random()*256|0).toString(16).substring(1)}return Yf.substring(Jf,Jf+++r)}const Qf=new Rj(8192);function Mj(r,{enabled:e=!0,id:t}){if(!e||!t)return r();if(Qf.get(t))return Qf.get(t);const n=r().finally(()=>Qf.delete(t));return Qf.set(t,n),n}function Fj(r,{delay:e=100,retryCount:t=2,shouldRetry:n=()=>!0}={}){return new Promise((s,i)=>{const o=async({count:a=0}={})=>{const c=async({error:l})=>{const u=typeof e=="function"?e({count:a,error:l}):e;u&&await _I(u),o({count:a+1})};try{const l=await r();s(l)}catch(l){if(a<t&&await n({count:a,error:l}))return c({error:l});i(l)}};o()})}function jj(r,e={}){return async(t,n={})=>{var h;const{dedupe:s=!1,methods:i,retryDelay:o=150,retryCount:a=3,uid:c}={...e,...n},{method:l}=t;if((h=i==null?void 0:i.exclude)!=null&&h.includes(l))throw new ma(new Error("method not supported"),{method:l});if(i!=null&&i.include&&!i.include.includes(l))throw new ma(new Error("method not supported"),{method:l});const u=s?AI(`${c}.${za(t)}`):void 0;return Mj(()=>Fj(async()=>{try{return await r(t)}catch(d){const f=d;switch(f.code){case Xh.code:throw new Xh(f);case ed.code:throw new ed(f);case td.code:throw new td(f,{method:t.method});case rd.code:throw new rd(f);case wu.code:throw new wu(f);case nd.code:throw new nd(f);case sd.code:throw new sd(f);case id.code:throw new id(f);case bu.code:throw new bu(f);case ma.code:throw new ma(f,{method:t.method});case Eu.code:throw new Eu(f);case od.code:throw new od(f);case qa.code:throw new qa(f);case ad.code:throw new ad(f);case cd.code:throw new cd(f);case ld.code:throw new ld(f);case ud.code:throw new ud(f);case hd.code:throw new hd(f);case dd.code:throw new dd(f);case fd.code:throw new fd(f);case pd.code:throw new pd(f);case gd.code:throw new gd(f);case md.code:throw new md(f);case yd.code:throw new yd(f);case wd.code:throw new wd(f);case 5e3:throw new qa(f);default:throw d instanceof En?d:new Uj(f)}}},{delay:({count:d,error:f})=>{var g;if(f&&f instanceof Uh){const p=(g=f==null?void 0:f.headers)==null?void 0:g.get("Retry-After");if(p!=null&&p.match(/\d/))return Number.parseInt(p)*1e3}return~~(1<<d)*o},retryCount:a,shouldRetry:({error:d})=>Hj(d)}),{enabled:s,id:u})}}function Hj(r){return"code"in r&&typeof r.code=="number"?r.code===-1||r.code===Eu.code||r.code===wu.code:r instanceof Uh&&r.status?r.status===403||r.status===408||r.status===413||r.status===429||r.status===500||r.status===502||r.status===503||r.status===504:!0}function NI({key:r,methods:e,name:t,request:n,retryCount:s=3,retryDelay:i=150,timeout:o,type:a},c){const l=$j();return{config:{key:r,methods:e,name:t,request:n,retryCount:s,retryDelay:i,timeout:o,type:a},request:jj(n,{methods:e,retryCount:s,retryDelay:i,uid:l}),value:c}}function MA(r,e={}){const{key:t="fallback",name:n="Fallback",rank:s=!1,shouldThrow:i=zj,retryCount:o,retryDelay:a}=e;return({chain:c,pollingInterval:l=4e3,timeout:u,...h})=>{let d=r,f=()=>{};const g=NI({key:t,name:n,async request({method:p,params:m}){let w;const A=async(v=0)=>{const N=d[v]({...h,chain:c,retryCount:0,timeout:u});try{const T=await N.request({method:p,params:m});return f({method:p,params:m,response:T,transport:N,status:"success"}),T}catch(T){if(f({error:T,method:p,params:m,transport:N,status:"error"}),i(T)||v===d.length-1||(w??(w=d.slice(v+1).some(P=>{const{include:D,exclude:U}=P({chain:c}).config.methods||{};return D?D.includes(p):U?!U.includes(p):!0})),!w))throw T;return A(v+1)}};return A()},retryCount:o,retryDelay:a,type:"fallback"},{onResponse:p=>f=p,transports:d.map(p=>p({chain:c,retryCount:0}))});if(s){const p=typeof s=="object"?s:{};qj({chain:c,interval:p.interval??l,onTransports:m=>d=m,ping:p.ping,sampleCount:p.sampleCount,timeout:p.timeout,transports:d,weights:p.weights})}return g}}function zj(r){return!!("code"in r&&typeof r.code=="number"&&(r.code===bu.code||r.code===qa.code||Jb.nodeMessage.test(r.message)||r.code===5e3))}function qj({chain:r,interval:e=4e3,onTransports:t,ping:n,sampleCount:s=10,timeout:i=1e3,transports:o,weights:a={}}){const{stability:c=.7,latency:l=.3}=a,u=[],h=async()=>{const d=await Promise.all(o.map(async p=>{const m=p({chain:r,retryCount:0,timeout:i}),w=Date.now();let A,v;try{await(n?n({transport:m}):m.request({method:"net_listening"})),v=1}catch{v=0}finally{A=Date.now()}return{latency:A-w,success:v}}));u.push(d),u.length>s&&u.shift();const f=Math.max(...u.map(p=>Math.max(...p.map(({latency:m})=>m)))),g=o.map((p,m)=>{const w=u.map(P=>P[m].latency),v=1-w.reduce((P,D)=>P+D,0)/w.length/f,N=u.map(P=>P[m].success),T=N.reduce((P,D)=>P+D,0)/N.length;return T===0?[0,m]:[l*v+c*T,m]}).sort((p,m)=>m[0]-p[0]);t(g.map(([,p])=>o[p])),await _I(e),h()};h()}class Vj extends En{constructor(){super("No URL was provided to the Transport. Please provide a valid RPC URL to the Transport.",{docsPath:"/docs/clients/intro",name:"UrlRequiredError"})}}function Wj(r,{errorInstance:e=new Error("timed out"),timeout:t,signal:n}){return new Promise((s,i)=>{(async()=>{let o;try{const a=new AbortController;t>0&&(o=setTimeout(()=>{n&&a.abort()},t)),s(await r({signal:(a==null?void 0:a.signal)||null}))}catch(a){(a==null?void 0:a.name)==="AbortError"&&i(e),i(a)}finally{clearTimeout(o)}})()})}function Gj(){return{current:0,take(){return this.current++},reset(){this.current=0}}}const FA=Gj();function Kj(r,e={}){return{async request(t){var h;const{body:n,onRequest:s=e.onRequest,onResponse:i=e.onResponse,timeout:o=e.timeout??1e4}=t,a={...e.fetchOptions??{},...t.fetchOptions??{}},{headers:c,method:l,signal:u}=a;try{const d=await Wj(async({signal:g})=>{const p={...a,body:Array.isArray(n)?za(n.map(v=>({jsonrpc:"2.0",id:v.id??FA.take(),...v}))):za({jsonrpc:"2.0",id:n.id??FA.take(),...n}),headers:{"Content-Type":"application/json",...c},method:l||"POST",signal:u||(o>0?g:null)},m=new Request(r,p),w=await(s==null?void 0:s(m,p))??{...p,url:r};return await fetch(w.url??r,w)},{errorInstance:new $A({body:n,url:r}),timeout:o,signal:!0});i&&await i(d);let f;if((h=d.headers.get("Content-Type"))!=null&&h.startsWith("application/json"))f=await d.json();else{f=await d.text();try{f=JSON.parse(f||"{}")}catch(g){if(d.ok)throw g;f={error:f}}}if(!d.ok)throw new Uh({body:n,details:za(f.error)||d.statusText,headers:d.headers,status:d.status,url:r});return f}catch(d){throw d instanceof Uh||d instanceof $A?d:new Uh({body:n,cause:d,url:r})}}}}function Zf(r,e={}){const{batch:t,fetchOptions:n,key:s="http",methods:i,name:o="HTTP JSON-RPC",onFetchRequest:a,onFetchResponse:c,retryDelay:l,raw:u}=e;return({chain:h,retryCount:d,timeout:f})=>{const{batchSize:g=1e3,wait:p=0}=typeof t=="object"?t:{},m=e.retryCount??d,w=f??e.timeout??1e4,A=r||(h==null?void 0:h.rpcUrls.default.http[0]);if(!A)throw new Vj;const v=Kj(A,{fetchOptions:n,onRequest:a,onResponse:c,timeout:w});return NI({key:s,methods:i,name:o,async request({method:N,params:T}){const P={method:N,params:T},{schedule:D}=Lj({id:A,wait:p,shouldSplitBatch($){return $.length>g},fn:$=>v.request({body:$}),sort:($,H)=>$.id-H.id}),U=async $=>t?D($):[await v.request({body:$})],[{error:x,result:j}]=await U(P);if(u)return{error:x,result:j};if(x)throw new CI({body:P,error:x,url:A});return j},retryCount:m,retryDelay:l,timeout:w,type:"http"},{fetchOptions:n,url:A})}}function Yb(r){return{formatters:void 0,fees:void 0,serializers:void 0,...r}}const cy={createBalance(r,e){const t={name:r.metadata.name||"",symbol:r.metadata.symbol||"",decimals:r.metadata.decimals||0,value:r.metadata.value||0,price:r.metadata.price||0,iconUrl:r.metadata.iconUrl||""};return{name:t.name,symbol:t.symbol,chainId:e,address:r.address==="native"?void 0:this.convertAddressToCAIP10Address(r.address,e),value:t.value,price:t.price,quantity:{decimals:t.decimals.toString(),numeric:this.convertHexToBalance({hex:r.balance,decimals:t.decimals})},iconUrl:t.iconUrl}},convertHexToBalance({hex:r,decimals:e}){return Dj(BigInt(r),e)},convertAddressToCAIP10Address(r,e){return`${e}:${r}`},createCAIP2ChainId(r,e){return`${e}:${parseInt(r,16)}`},getChainIdHexFromCAIP2ChainId(r){const e=r.split(":");if(e.length<2||!e[1])return"0x0";const t=e[1],n=parseInt(t,10);return isNaN(n)?"0x0":`0x${n.toString(16)}`},isWalletGetAssetsResponse(r){return typeof r!="object"||r===null?!1:Object.values(r).every(e=>Array.isArray(e)&&e.every(t=>this.isValidAsset(t)))},isValidAsset(r){return typeof r=="object"&&r!==null&&typeof r.address=="string"&&typeof r.balance=="string"&&(r.type==="ERC20"||r.type==="NATIVE")&&typeof r.metadata=="object"&&r.metadata!==null&&typeof r.metadata.name=="string"&&typeof r.metadata.symbol=="string"&&typeof r.metadata.decimals=="number"&&typeof r.metadata.price=="number"&&typeof r.metadata.iconUrl=="string"}},jA={async getMyTokensWithBalance(r){const e=he.state.address,t=S.state.activeCaipNetwork;if(!e||!t)return[];if(t.chainNamespace==="eip155"){const s=await this.getEIP155Balances(e,t);if(s)return this.filterLowQualityTokens(s)}const n=await Ae.getBalance(e,t.caipNetworkId,r);return this.filterLowQualityTokens(n.balances)},async getEIP155Balances(r,e){var t,n;try{const s=cy.getChainIdHexFromCAIP2ChainId(e.caipNetworkId),i=await Et.getCapabilities(r);if(!((n=(t=i==null?void 0:i[s])==null?void 0:t.assetDiscovery)!=null&&n.supported))return null;const o=await Et.walletGetAssets({account:r,chainFilter:[s]});return cy.isWalletGetAssetsResponse(o)?(o[s]||[]).map(c=>cy.createBalance(c,e.caipNetworkId)):null}catch{return null}},filterLowQualityTokens(r){return r.filter(e=>e.quantity.decimals!=="0")},mapBalancesToSwapTokens(r){return(r==null?void 0:r.map(e=>({...e,address:e!=null&&e.address?e.address:S.getActiveNetworkTokenAddress(),decimals:parseInt(e.quantity.decimals,10),logoUri:e.iconUrl,eip2612:!1})))||[]}},st=St({tokenBalances:[],loading:!1}),HA={state:st,subscribe(r){return _r(st,()=>r(st))},subscribeKey(r,e){return Zr(st,r,e)},setToken(r){r&&(st.token=Xa(r))},setTokenAmount(r){st.sendTokenAmount=r},setReceiverAddress(r){st.receiverAddress=r},setReceiverProfileImageUrl(r){st.receiverProfileImageUrl=r},setReceiverProfileName(r){st.receiverProfileName=r},setNetworkBalanceInUsd(r){st.networkBalanceInUSD=r},setLoading(r){st.loading=r},async sendToken(){var r;try{switch(this.setLoading(!0),(r=S.state.activeCaipNetwork)==null?void 0:r.chainNamespace){case"eip155":await this.sendEvmToken();return;case"solana":await this.sendSolanaToken();return;default:throw new Error("Unsupported chain")}}finally{this.setLoading(!1)}},async sendEvmToken(){var t,n,s,i;const r=S.state.activeChain,e=(t=he.state.preferredAccountTypes)==null?void 0:t[r];if(!this.state.sendTokenAmount||!this.state.receiverAddress)throw new Error("An amount and receiver address are required");if(!this.state.token)throw new Error("A token is required");(n=this.state.token)!=null&&n.address?(At.sendEvent({type:"track",event:"SEND_INITIATED",properties:{isSmartAccount:e===dr.ACCOUNT_TYPES.SMART_ACCOUNT,token:this.state.token.address,amount:this.state.sendTokenAmount,network:((s=S.state.activeCaipNetwork)==null?void 0:s.caipNetworkId)||""}}),await this.sendERC20Token({receiverAddress:this.state.receiverAddress,tokenAddress:this.state.token.address,sendTokenAmount:this.state.sendTokenAmount,decimals:this.state.token.quantity.decimals})):(At.sendEvent({type:"track",event:"SEND_INITIATED",properties:{isSmartAccount:e===dr.ACCOUNT_TYPES.SMART_ACCOUNT,token:this.state.token.symbol||"",amount:this.state.sendTokenAmount,network:((i=S.state.activeCaipNetwork)==null?void 0:i.caipNetworkId)||""}}),await this.sendNativeToken({receiverAddress:this.state.receiverAddress,sendTokenAmount:this.state.sendTokenAmount,decimals:this.state.token.quantity.decimals}))},async fetchTokenBalance(r){var i,o;st.loading=!0;const e=(i=S.state.activeCaipNetwork)==null?void 0:i.caipNetworkId,t=(o=S.state.activeCaipNetwork)==null?void 0:o.chainNamespace,n=S.state.activeCaipAddress,s=n?Ee.getPlainAddress(n):void 0;if(st.lastRetry&&!Ee.isAllowedRetry(st.lastRetry,30*ur.ONE_SEC_MS))return st.loading=!1,[];try{if(s&&e&&t){const a=await jA.getMyTokensWithBalance();return st.tokenBalances=a,st.lastRetry=void 0,a}}catch(a){st.lastRetry=Date.now(),r==null||r(a),os.showError("Token Balance Unavailable")}finally{st.loading=!1}return[]},fetchNetworkBalance(){if(st.tokenBalances.length===0)return;const r=jA.mapBalancesToSwapTokens(st.tokenBalances);if(!r)return;const e=r.find(t=>t.address===S.getActiveNetworkTokenAddress());e&&(st.networkBalanceInUSD=e?OT.multiply(e.quantity.numeric,e.price).toString():"0")},async sendNativeToken(r){var o,a,c;const e=S.state.activeChain;tt.pushTransactionStack({view:null,goBack:!1});const t=r.receiverAddress,n=he.state.address,s=Et.parseUnits(r.sendTokenAmount.toString(),Number(r.decimals));await Et.sendTransaction({chainNamespace:"eip155",to:t,address:n,data:"0x",value:s??BigInt(0)}),At.sendEvent({type:"track",event:"SEND_SUCCESS",properties:{isSmartAccount:((o=he.state.preferredAccountTypes)==null?void 0:o[e])===dr.ACCOUNT_TYPES.SMART_ACCOUNT,token:((a=this.state.token)==null?void 0:a.symbol)||"",amount:r.sendTokenAmount,network:((c=S.state.activeCaipNetwork)==null?void 0:c.caipNetworkId)||""}}),this.resetSend()},async sendERC20Token(r){tt.pushTransactionStack({view:"Account",goBack:!1});const e=Et.parseUnits(r.sendTokenAmount.toString(),Number(r.decimals));if(he.state.address&&r.sendTokenAmount&&r.receiverAddress&&r.tokenAddress){const t=Ee.getPlainAddress(r.tokenAddress);await Et.writeContract({fromAddress:he.state.address,tokenAddress:t,args:[r.receiverAddress,e??BigInt(0)],method:"transfer",abi:UT.getERC20Abi(t),chainNamespace:"eip155"}),this.resetSend()}},async sendSolanaToken(){if(!this.state.sendTokenAmount||!this.state.receiverAddress)throw new Error("An amount and receiver address are required");tt.pushTransactionStack({view:"Account",goBack:!1}),await Et.sendTransaction({chainNamespace:"solana",to:this.state.receiverAddress,value:this.state.sendTokenAmount}),this.resetSend(),he.fetchTokenBalance()},resetSend(){st.token=void 0,st.sendTokenAmount=void 0,st.receiverAddress=void 0,st.receiverProfileImageUrl=void 0,st.receiverProfileName=void 0,st.loading=!1,st.tokenBalances=[]}},ly={currentTab:0,tokenBalance:[],smartAccountDeployed:!1,addressLabels:new Map,allAccounts:[],user:void 0},Xf={caipNetwork:void 0,supportsAllNetworks:!0,smartAccountEnabledNetworks:[]},ne=St({chains:vT(),activeCaipAddress:void 0,activeChain:void 0,activeCaipNetwork:void 0,noAdapters:!1,universalAdapter:{networkControllerClient:void 0,connectionControllerClient:void 0},isSwitchingNamespace:!1}),S={state:ne,subscribe(r){return _r(ne,()=>{r(ne)})},subscribeKey(r,e){return Zr(ne,r,e)},subscribeChainProp(r,e,t){let n;return _r(ne.chains,()=>{var i;const s=t||ne.activeChain;if(s){const o=(i=ne.chains.get(s))==null?void 0:i[r];n!==o&&(n=o,e(o))}})},initialize(r,e,t){const{chainId:n,namespace:s}=se.getActiveNetworkProps(),i=e==null?void 0:e.find(u=>u.id.toString()===(n==null?void 0:n.toString())),a=r.find(u=>(u==null?void 0:u.namespace)===s)||(r==null?void 0:r[0]),c=r.map(u=>u.namespace).filter(u=>u!==void 0),l=K.state.enableEmbedded?new Set([...c]):new Set([...(e==null?void 0:e.map(u=>u.chainNamespace))??[]]);((r==null?void 0:r.length)===0||!a)&&(ne.noAdapters=!0),ne.noAdapters||(ne.activeChain=a==null?void 0:a.namespace,ne.activeCaipNetwork=i,this.setChainNetworkData(a==null?void 0:a.namespace,{caipNetwork:i}),ne.activeChain&&Vs.set({activeChain:a==null?void 0:a.namespace})),l.forEach(u=>{const h=e==null?void 0:e.filter(d=>d.chainNamespace===u);S.state.chains.set(u,{namespace:u,networkState:St({...Xf,caipNetwork:h==null?void 0:h[0]}),accountState:St(ly),caipNetworks:h??[],...t}),this.setRequestedCaipNetworks(h??[],u)})},removeAdapter(r){var e,t;if(ne.activeChain===r){const n=Array.from(ne.chains.entries()).find(([s])=>s!==r);if(n){const s=(t=(e=n[1])==null?void 0:e.caipNetworks)==null?void 0:t[0];s&&this.setActiveCaipNetwork(s)}}ne.chains.delete(r)},addAdapter(r,{networkControllerClient:e,connectionControllerClient:t},n){ne.chains.set(r.namespace,{namespace:r.namespace,networkState:{...Xf,caipNetwork:n[0]},accountState:ly,caipNetworks:n,connectionControllerClient:t,networkControllerClient:e}),this.setRequestedCaipNetworks((n==null?void 0:n.filter(s=>s.chainNamespace===r.namespace))??[],r.namespace)},addNetwork(r){var t;const e=ne.chains.get(r.chainNamespace);if(e){const n=[...e.caipNetworks||[]];(t=e.caipNetworks)!=null&&t.find(s=>s.id===r.id)||n.push(r),ne.chains.set(r.chainNamespace,{...e,caipNetworks:n}),this.setRequestedCaipNetworks(n,r.chainNamespace),_e.filterByNamespace(r.chainNamespace,!0)}},removeNetwork(r,e){var n,s,i;const t=ne.chains.get(r);if(t){const o=((n=ne.activeCaipNetwork)==null?void 0:n.id)===e,a=[...((s=t.caipNetworks)==null?void 0:s.filter(c=>c.id!==e))||[]];o&&((i=t==null?void 0:t.caipNetworks)!=null&&i[0])&&this.setActiveCaipNetwork(t.caipNetworks[0]),ne.chains.set(r,{...t,caipNetworks:a}),this.setRequestedCaipNetworks(a||[],r),a.length===0&&_e.filterByNamespace(r,!1)}},setAdapterNetworkState(r,e){const t=ne.chains.get(r);t&&(t.networkState={...t.networkState||Xf,...e},ne.chains.set(r,t))},setChainAccountData(r,e,t=!0){if(!r)throw new Error("Chain is required to update chain account data");const n=ne.chains.get(r);if(n){const s={...n.accountState||ly,...e};ne.chains.set(r,{...n,accountState:s}),(ne.chains.size===1||ne.activeChain===r)&&(e.caipAddress&&(ne.activeCaipAddress=e.caipAddress),he.replaceState(s))}},setChainNetworkData(r,e){if(!r)return;const t=ne.chains.get(r);if(t){const n={...t.networkState||Xf,...e};ne.chains.set(r,{...t,networkState:n})}},setAccountProp(r,e,t,n=!0){this.setChainAccountData(t,{[r]:e},n),r==="status"&&e==="disconnected"&&t&&_e.removeConnectorId(t)},setActiveNamespace(r){var n,s;ne.activeChain=r;const e=r?ne.chains.get(r):void 0,t=(n=e==null?void 0:e.networkState)==null?void 0:n.caipNetwork;t!=null&&t.id&&r&&(ne.activeCaipAddress=(s=e==null?void 0:e.accountState)==null?void 0:s.caipAddress,ne.activeCaipNetwork=t,this.setChainNetworkData(r,{caipNetwork:t}),se.setActiveCaipNetworkId(t==null?void 0:t.caipNetworkId),Vs.set({activeChain:r,selectedNetworkId:t==null?void 0:t.caipNetworkId}))},setActiveCaipNetwork(r){var n,s,i;if(!r)return;ne.activeChain!==r.chainNamespace&&this.setIsSwitchingNamespace(!0);const e=ne.chains.get(r.chainNamespace);ne.activeChain=r.chainNamespace,ne.activeCaipNetwork=r,this.setChainNetworkData(r.chainNamespace,{caipNetwork:r}),(n=e==null?void 0:e.accountState)!=null&&n.address?ne.activeCaipAddress=`${r.chainNamespace}:${r.id}:${(s=e==null?void 0:e.accountState)==null?void 0:s.address}`:ne.activeCaipAddress=void 0,this.setAccountProp("caipAddress",ne.activeCaipAddress,r.chainNamespace),e&&he.replaceState(e.accountState),HA.resetSend(),Vs.set({activeChain:ne.activeChain,selectedNetworkId:(i=ne.activeCaipNetwork)==null?void 0:i.caipNetworkId}),se.setActiveCaipNetworkId(r.caipNetworkId),!this.checkIfSupportedNetwork(r.chainNamespace)&&K.state.enableNetworkSwitch&&!K.state.allowUnsupportedChain&&!Et.state.wcBasic&&this.showUnsupportedChainUI()},addCaipNetwork(r){var t;if(!r)return;const e=ne.chains.get(r.chainNamespace);e&&((t=e==null?void 0:e.caipNetworks)==null||t.push(r))},async switchActiveNamespace(r){var s;if(!r)return;const e=r!==S.state.activeChain,t=(s=S.getNetworkData(r))==null?void 0:s.caipNetwork,n=S.getCaipNetworkByNamespace(r,t==null?void 0:t.id);e&&n&&await S.switchActiveNetwork(n)},async switchActiveNetwork(r){var s;const e=S.state.chains.get(S.state.activeChain);!((s=e==null?void 0:e.caipNetworks)!=null&&s.some(i=>{var o;return i.id===((o=ne.activeCaipNetwork)==null?void 0:o.id)}))&&tt.goBack();const n=this.getNetworkControllerClient(r.chainNamespace);n&&(await n.switchCaipNetwork(r),At.sendEvent({type:"track",event:"SWITCH_NETWORK",properties:{network:r.caipNetworkId}}))},getNetworkControllerClient(r){const e=r||ne.activeChain,t=ne.chains.get(e);if(!t)throw new Error("Chain adapter not found");if(!t.networkControllerClient)throw new Error("NetworkController client not set");return t.networkControllerClient},getConnectionControllerClient(r){const e=r||ne.activeChain;if(!e)throw new Error("Chain is required to get connection controller client");const t=ne.chains.get(e);if(!(t!=null&&t.connectionControllerClient))throw new Error("ConnectionController client not set");return t.connectionControllerClient},getAccountProp(r,e){var s;let t=ne.activeChain;if(e&&(t=e),!t)return;const n=(s=ne.chains.get(t))==null?void 0:s.accountState;if(n)return n[r]},getNetworkProp(r,e){var n;const t=(n=ne.chains.get(e))==null?void 0:n.networkState;if(t)return t[r]},getRequestedCaipNetworks(r){const e=ne.chains.get(r),{approvedCaipNetworkIds:t=[],requestedCaipNetworks:n=[]}=(e==null?void 0:e.networkState)||{};return Ee.sortRequestedNetworks(t,n)},getAllRequestedCaipNetworks(){const r=[];return ne.chains.forEach(e=>{const t=this.getRequestedCaipNetworks(e.namespace);r.push(...t)}),r},setRequestedCaipNetworks(r,e){this.setAdapterNetworkState(e,{requestedCaipNetworks:r});const n=this.getAllRequestedCaipNetworks().map(i=>i.chainNamespace),s=Array.from(new Set(n));_e.filterByNamespaces(s)},getAllApprovedCaipNetworkIds(){const r=[];return ne.chains.forEach(e=>{const t=this.getApprovedCaipNetworkIds(e.namespace);r.push(...t)}),r},getActiveCaipNetwork(){return ne.activeCaipNetwork},getActiveCaipAddress(){return ne.activeCaipAddress},getApprovedCaipNetworkIds(r){var n;const e=ne.chains.get(r);return((n=e==null?void 0:e.networkState)==null?void 0:n.approvedCaipNetworkIds)||[]},async setApprovedCaipNetworksData(r){const e=this.getNetworkControllerClient(),t=await(e==null?void 0:e.getApprovedCaipNetworksData());this.setAdapterNetworkState(r,{approvedCaipNetworkIds:t==null?void 0:t.approvedCaipNetworkIds,supportsAllNetworks:t==null?void 0:t.supportsAllNetworks})},checkIfSupportedNetwork(r,e){const t=e||ne.activeCaipNetwork,n=this.getRequestedCaipNetworks(r);return n.length?n==null?void 0:n.some(s=>s.id===(t==null?void 0:t.id)):!0},checkIfSupportedChainId(r){if(!ne.activeChain)return!0;const e=this.getRequestedCaipNetworks(ne.activeChain);return e==null?void 0:e.some(t=>t.id===r)},setSmartAccountEnabledNetworks(r,e){this.setAdapterNetworkState(e,{smartAccountEnabledNetworks:r})},checkIfSmartAccountEnabled(){var n;const r=RC.caipNetworkIdToNumber((n=ne.activeCaipNetwork)==null?void 0:n.caipNetworkId),e=ne.activeChain;if(!e||!r)return!1;const t=this.getNetworkProp("smartAccountEnabledNetworks",e);return!!(t!=null&&t.includes(Number(r)))},getActiveNetworkTokenAddress(){var n,s;const r=((n=ne.activeCaipNetwork)==null?void 0:n.chainNamespace)||"eip155",e=((s=ne.activeCaipNetwork)==null?void 0:s.id)||1,t=ur.NATIVE_TOKEN_ADDRESS[r];return`${r}:${e}:${t}`},showUnsupportedChainUI(){Ut.open({view:"UnsupportedChain"})},checkIfNamesSupported(){const r=ne.activeCaipNetwork;return!!(r!=null&&r.chainNamespace&&ur.NAMES_SUPPORTED_CHAIN_NAMESPACES.includes(r.chainNamespace))},resetNetwork(r){this.setAdapterNetworkState(r,{approvedCaipNetworkIds:void 0,supportsAllNetworks:!0,smartAccountEnabledNetworks:[]})},resetAccount(r){const e=r;if(!e)throw new Error("Chain is required to set account prop");ne.activeCaipAddress=void 0,this.setChainAccountData(e,{smartAccountDeployed:!1,currentTab:0,caipAddress:void 0,address:void 0,balance:void 0,balanceSymbol:void 0,profileName:void 0,profileImage:void 0,addressExplorerUrl:void 0,tokenBalance:[],connectedWalletInfo:void 0,preferredAccountTypes:void 0,socialProvider:void 0,socialWindow:void 0,farcasterUrl:void 0,allAccounts:[],user:void 0,status:"disconnected"}),_e.removeConnectorId(e)},async disconnect(r){const e=WT(r);try{HA.resetSend();const t=await Promise.allSettled(e.map(async([s,i])=>{var o;try{const{caipAddress:a}=this.getAccountData(s)||{};a&&((o=i.connectionControllerClient)!=null&&o.disconnect)&&await i.connectionControllerClient.disconnect(s),this.resetAccount(s),this.resetNetwork(s)}catch(a){throw new Error(`Failed to disconnect chain ${s}: ${a.message}`)}}));Et.resetWcConnection();const n=t.filter(s=>s.status==="rejected");if(n.length>0)throw new Error(n.map(s=>s.reason.message).join(", "));se.deleteConnectedSocialProvider(),r?_e.removeConnectorId(r):_e.resetConnectorIds(),At.sendEvent({type:"track",event:"DISCONNECT_SUCCESS",properties:{namespace:r||"all"}})}catch(t){console.error(t.message||"Failed to disconnect chains"),At.sendEvent({type:"track",event:"DISCONNECT_ERROR",properties:{message:t.message||"Failed to disconnect chains"}})}},setIsSwitchingNamespace(r){ne.isSwitchingNamespace=r},getFirstCaipNetworkSupportsAuthConnector(){var t,n;const r=[];let e;if(ne.chains.forEach(s=>{ee.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(i=>i===s.namespace)&&s.namespace&&r.push(s.namespace)}),r.length>0){const s=r[0];return e=s?(n=(t=ne.chains.get(s))==null?void 0:t.caipNetworks)==null?void 0:n[0]:void 0,e}},getAccountData(r){var e;return r?(e=S.state.chains.get(r))==null?void 0:e.accountState:he.state},getNetworkData(r){var t;const e=r||ne.activeChain;if(e)return(t=S.state.chains.get(e))==null?void 0:t.networkState},getCaipNetworkByNamespace(r,e){var s,i,o;if(!r)return;const t=S.state.chains.get(r),n=(s=t==null?void 0:t.caipNetworks)==null?void 0:s.find(a=>a.id===e);return n||((i=t==null?void 0:t.networkState)==null?void 0:i.caipNetwork)||((o=t==null?void 0:t.caipNetworks)==null?void 0:o[0])},getRequestedCaipNetworkIds(){const r=_e.state.filterByNamespace;return(r?[ne.chains.get(r)]:Array.from(ne.chains.values())).flatMap(t=>(t==null?void 0:t.caipNetworks)||[]).map(t=>t.caipNetworkId)},getCaipNetworks(r){return r?S.getRequestedCaipNetworks(r):S.getAllRequestedCaipNetworks()}},Jj={purchaseCurrencies:[{id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"USD Coin",symbol:"USDC",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]},{id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"Ether",symbol:"ETH",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]}],paymentCurrencies:[{id:"USD",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]},{id:"EUR",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]}]},II=Ee.getBlockchainApiUrl(),on=St({clientId:null,api:new Ig({baseUrl:II,clientId:null}),supportedChains:{http:[],ws:[]}}),Ae={state:on,async get(r){const{st:e,sv:t}=Ae.getSdkProperties(),n=K.state.projectId,s={...r.params||{},st:e,sv:t,projectId:n};return on.api.get({...r,params:s})},getSdkProperties(){const{sdkType:r,sdkVersion:e}=K.state;return{st:r||"unknown",sv:e||"unknown"}},async isNetworkSupported(r){if(!r)return!1;try{on.supportedChains.http.length||await Ae.getSupportedNetworks()}catch{return!1}return on.supportedChains.http.includes(r)},async getSupportedNetworks(){const r=await Ae.get({path:"v1/supported-chains"});return on.supportedChains=r,r},async fetchIdentity({address:r,caipNetworkId:e}){if(!await Ae.isNetworkSupported(e))return{avatar:"",name:""};const n=se.getIdentityFromCacheForAddress(r);if(n)return n;const s=await Ae.get({path:`/v1/identity/${r}`,params:{sender:S.state.activeCaipAddress?Ee.getPlainAddress(S.state.activeCaipAddress):void 0}});return se.updateIdentityCache({address:r,identity:s,timestamp:Date.now()}),s},async fetchTransactions({account:r,cursor:e,onramp:t,signal:n,cache:s,chainId:i}){var a;return await Ae.isNetworkSupported((a=S.state.activeCaipNetwork)==null?void 0:a.caipNetworkId)?Ae.get({path:`/v1/account/${r}/history`,params:{cursor:e,onramp:t,chainId:i},signal:n,cache:s}):{data:[],next:void 0}},async fetchSwapQuote({amount:r,userAddress:e,from:t,to:n,gasPrice:s}){var o;return await Ae.isNetworkSupported((o=S.state.activeCaipNetwork)==null?void 0:o.caipNetworkId)?Ae.get({path:"/v1/convert/quotes",headers:{"Content-Type":"application/json"},params:{amount:r,userAddress:e,from:t,to:n,gasPrice:s}}):{quotes:[]}},async fetchSwapTokens({chainId:r}){var t;return await Ae.isNetworkSupported((t=S.state.activeCaipNetwork)==null?void 0:t.caipNetworkId)?Ae.get({path:"/v1/convert/tokens",params:{chainId:r}}):{tokens:[]}},async fetchTokenPrice({addresses:r}){var t;return await Ae.isNetworkSupported((t=S.state.activeCaipNetwork)==null?void 0:t.caipNetworkId)?on.api.post({path:"/v1/fungible/price",body:{currency:"usd",addresses:r,projectId:K.state.projectId},headers:{"Content-Type":"application/json"}}):{fungibles:[]}},async fetchSwapAllowance({tokenAddress:r,userAddress:e}){var n;return await Ae.isNetworkSupported((n=S.state.activeCaipNetwork)==null?void 0:n.caipNetworkId)?Ae.get({path:"/v1/convert/allowance",params:{tokenAddress:r,userAddress:e},headers:{"Content-Type":"application/json"}}):{allowance:"0"}},async fetchGasPrice({chainId:r}){var s;const{st:e,sv:t}=Ae.getSdkProperties();if(!await Ae.isNetworkSupported((s=S.state.activeCaipNetwork)==null?void 0:s.caipNetworkId))throw new Error("Network not supported for Gas Price");return Ae.get({path:"/v1/convert/gas-price",headers:{"Content-Type":"application/json"},params:{chainId:r,st:e,sv:t}})},async generateSwapCalldata({amount:r,from:e,to:t,userAddress:n,disableEstimate:s}){var o;if(!await Ae.isNetworkSupported((o=S.state.activeCaipNetwork)==null?void 0:o.caipNetworkId))throw new Error("Network not supported for Swaps");return on.api.post({path:"/v1/convert/build-transaction",headers:{"Content-Type":"application/json"},body:{amount:r,eip155:{slippage:ur.CONVERT_SLIPPAGE_TOLERANCE},projectId:K.state.projectId,from:e,to:t,userAddress:n,disableEstimate:s}})},async generateApproveCalldata({from:r,to:e,userAddress:t}){var o;const{st:n,sv:s}=Ae.getSdkProperties();if(!await Ae.isNetworkSupported((o=S.state.activeCaipNetwork)==null?void 0:o.caipNetworkId))throw new Error("Network not supported for Swaps");return Ae.get({path:"/v1/convert/build-approve",headers:{"Content-Type":"application/json"},params:{userAddress:t,from:r,to:e,st:n,sv:s}})},async getBalance(r,e,t){var l;const{st:n,sv:s}=Ae.getSdkProperties();if(!await Ae.isNetworkSupported((l=S.state.activeCaipNetwork)==null?void 0:l.caipNetworkId))return os.showError("Token Balance Unavailable"),{balances:[]};const o=`${e}:${r}`,a=se.getBalanceCacheForCaipAddress(o);if(a)return a;const c=await Ae.get({path:`/v1/account/${r}/balance`,params:{currency:"usd",chainId:e,forceUpdate:t,st:n,sv:s}});return se.updateBalanceCache({caipAddress:o,balance:c,timestamp:Date.now()}),c},async lookupEnsName(r){var t;return await Ae.isNetworkSupported((t=S.state.activeCaipNetwork)==null?void 0:t.caipNetworkId)?Ae.get({path:`/v1/profile/account/${r}`,params:{apiVersion:"2"}}):{addresses:{},attributes:[]}},async reverseLookupEnsName({address:r}){var t;return await Ae.isNetworkSupported((t=S.state.activeCaipNetwork)==null?void 0:t.caipNetworkId)?Ae.get({path:`/v1/profile/reverse/${r}`,params:{sender:he.state.address,apiVersion:"2"}}):[]},async getEnsNameSuggestions(r){var t;return await Ae.isNetworkSupported((t=S.state.activeCaipNetwork)==null?void 0:t.caipNetworkId)?Ae.get({path:`/v1/profile/suggestions/${r}`,params:{zone:"reown.id"}}):{suggestions:[]}},async registerEnsName({coinType:r,address:e,message:t,signature:n}){var i;return await Ae.isNetworkSupported((i=S.state.activeCaipNetwork)==null?void 0:i.caipNetworkId)?on.api.post({path:"/v1/profile/account",body:{coin_type:r,address:e,message:t,signature:n},headers:{"Content-Type":"application/json"}}):{success:!1}},async generateOnRampURL({destinationWallets:r,partnerUserId:e,defaultNetwork:t,purchaseAmount:n,paymentAmount:s}){var a;return await Ae.isNetworkSupported((a=S.state.activeCaipNetwork)==null?void 0:a.caipNetworkId)?(await on.api.post({path:"/v1/generators/onrampurl",params:{projectId:K.state.projectId},body:{destinationWallets:r,defaultNetwork:t,partnerUserId:e,defaultExperience:"buy",presetCryptoAmount:n,presetFiatAmount:s}})).url:""},async getOnrampOptions(){var e;if(!await Ae.isNetworkSupported((e=S.state.activeCaipNetwork)==null?void 0:e.caipNetworkId))return{paymentCurrencies:[],purchaseCurrencies:[]};try{return await Ae.get({path:"/v1/onramp/options"})}catch{return Jj}},async getOnrampQuote({purchaseCurrency:r,paymentCurrency:e,amount:t,network:n}){var s;try{return await Ae.isNetworkSupported((s=S.state.activeCaipNetwork)==null?void 0:s.caipNetworkId)?await on.api.post({path:"/v1/onramp/quote",params:{projectId:K.state.projectId},body:{purchaseCurrency:r,paymentCurrency:e,amount:t,network:n}}):null}catch{return{coinbaseFee:{amount:t,currency:e.id},networkFee:{amount:t,currency:e.id},paymentSubtotal:{amount:t,currency:e.id},paymentTotal:{amount:t,currency:e.id},purchaseAmount:{amount:t,currency:e.id},quoteId:"mocked-quote-id"}}},async getSmartSessions(r){var t;return await Ae.isNetworkSupported((t=S.state.activeCaipNetwork)==null?void 0:t.caipNetworkId)?Ae.get({path:`/v1/sessions/${r}`}):[]},async revokeSmartSession(r,e,t){var s;return await Ae.isNetworkSupported((s=S.state.activeCaipNetwork)==null?void 0:s.caipNetworkId)?on.api.post({path:`/v1/sessions/${r}/revoke`,params:{projectId:K.state.projectId},body:{pci:e,signature:t}}):{success:!1}},setClientId(r){on.clientId=r,on.api=new Ig({baseUrl:II,clientId:r})}},Nn=St({currentTab:0,tokenBalance:[],smartAccountDeployed:!1,addressLabels:new Map,allAccounts:[]}),he={state:Nn,replaceState(r){r&&Object.assign(Nn,Xa(r))},subscribe(r){return S.subscribeChainProp("accountState",e=>{if(e)return r(e)})},subscribeKey(r,e,t){let n;return S.subscribeChainProp("accountState",s=>{if(s){const i=s[r];n!==i&&(n=i,e(i))}},t)},setStatus(r,e){S.setAccountProp("status",r,e)},getCaipAddress(r){return S.getAccountProp("caipAddress",r)},setCaipAddress(r,e){const t=r?Ee.getPlainAddress(r):void 0;e===S.state.activeChain&&(S.state.activeCaipAddress=r),S.setAccountProp("caipAddress",r,e),S.setAccountProp("address",t,e)},setBalance(r,e,t){S.setAccountProp("balance",r,t),S.setAccountProp("balanceSymbol",e,t)},setProfileName(r,e){S.setAccountProp("profileName",r,e)},setProfileImage(r,e){S.setAccountProp("profileImage",r,e)},setUser(r,e){S.setAccountProp("user",r,e)},setAddressExplorerUrl(r,e){S.setAccountProp("addressExplorerUrl",r,e)},setSmartAccountDeployed(r,e){S.setAccountProp("smartAccountDeployed",r,e)},setCurrentTab(r){S.setAccountProp("currentTab",r,S.state.activeChain)},setTokenBalance(r,e){r&&S.setAccountProp("tokenBalance",r,e)},setShouldUpdateToAddress(r,e){S.setAccountProp("shouldUpdateToAddress",r,e)},setAllAccounts(r,e){S.setAccountProp("allAccounts",r,e)},addAddressLabel(r,e,t){const n=S.getAccountProp("addressLabels",t)||new Map;n.set(r,e),S.setAccountProp("addressLabels",n,t)},removeAddressLabel(r,e){const t=S.getAccountProp("addressLabels",e)||new Map;t.delete(r),S.setAccountProp("addressLabels",t,e)},setConnectedWalletInfo(r,e){S.setAccountProp("connectedWalletInfo",r,e,!1)},setPreferredAccountType(r,e){S.setAccountProp("preferredAccountTypes",{...Nn.preferredAccountTypes,[e]:r},e)},setPreferredAccountTypes(r){Nn.preferredAccountTypes=r},setSocialProvider(r,e){r&&S.setAccountProp("socialProvider",r,e)},setSocialWindow(r,e){S.setAccountProp("socialWindow",r?Xa(r):void 0,e)},setFarcasterUrl(r,e){S.setAccountProp("farcasterUrl",r,e)},async fetchTokenBalance(r){var i,o;Nn.balanceLoading=!0;const e=(i=S.state.activeCaipNetwork)==null?void 0:i.caipNetworkId,t=(o=S.state.activeCaipNetwork)==null?void 0:o.chainNamespace,n=S.state.activeCaipAddress,s=n?Ee.getPlainAddress(n):void 0;if(Nn.lastRetry&&!Ee.isAllowedRetry(Nn.lastRetry,30*ur.ONE_SEC_MS))return Nn.balanceLoading=!1,[];try{if(s&&e&&t){const c=(await Ae.getBalance(s,e)).balances.filter(l=>l.quantity.decimals!=="0");return this.setTokenBalance(c,t),Nn.lastRetry=void 0,Nn.balanceLoading=!1,c}}catch(a){Nn.lastRetry=Date.now(),r==null||r(a),os.showError("Token Balance Unavailable")}finally{Nn.balanceLoading=!1}return[]},resetAccount(r){S.resetAccount(r)}},Fr=St({loading:!1,loadingNamespaceMap:new Map,open:!1,shake:!1,namespace:void 0}),Ut={state:Fr,subscribe(r){return _r(Fr,()=>r(Fr))},subscribeKey(r,e){return Zr(Fr,r,e)},async open(r){var s;const e=he.state.status==="connected";Et.state.wcBasic?be.prefetch({fetchNetworkImages:!1,fetchConnectorImages:!1}):await be.prefetch({fetchConnectorImages:!e,fetchFeaturedWallets:!e,fetchRecommendedWallets:!e}),r!=null&&r.namespace?(await S.switchActiveNamespace(r.namespace),Ut.setLoading(!0,r.namespace)):Ut.setLoading(!0),_e.setFilterByNamespace(r==null?void 0:r.namespace);const t=(s=S.getAccountData(r==null?void 0:r.namespace))==null?void 0:s.caipAddress,n=S.state.noAdapters;K.state.manualWCControl||n&&!t?Ee.isMobile()?tt.reset("AllWallets"):tt.reset("ConnectingWalletConnectBasic"):r!=null&&r.view?tt.reset(r.view,r.data):t?tt.reset("Account"):tt.reset("Connect"),Fr.open=!0,Vs.set({open:!0}),At.sendEvent({type:"track",event:"MODAL_OPEN",properties:{connected:!!t}})},close(r=!1){if(r||tt.state.view!=="ApproveTransaction"){const e=K.state.enableEmbedded,t=!!S.state.activeCaipAddress;Fr.open&&At.sendEvent({type:"track",event:"MODAL_CLOSE",properties:{connected:t}}),Fr.open=!1,Ut.clearLoading(),e?t?tt.replace("Account"):tt.push("Connect"):Vs.set({open:!1})}Et.resetUri()},setLoading(r,e){e&&Fr.loadingNamespaceMap.set(e,r),Fr.loading=r,Vs.set({loading:r})},clearLoading(){Fr.loadingNamespaceMap.clear(),Fr.loading=!1},shake(){Fr.shake||(Fr.shake=!0,setTimeout(()=>{Fr.shake=!1},500))}},zA=2147483648,Yj={convertEVMChainIdToCoinType(r){if(r>=zA)throw new Error("Invalid chainId");return(zA|r)>>>0}},In=St({suggestions:[],loading:!1}),SI={state:In,subscribe(r){return _r(In,()=>r(In))},subscribeKey(r,e){return Zr(In,r,e)},async resolveName(r){var e,t;try{return await Ae.lookupEnsName(r)}catch(n){const s=n;throw new Error(((t=(e=s==null?void 0:s.reasons)==null?void 0:e[0])==null?void 0:t.description)||"Error resolving name")}},async isNameRegistered(r){try{return await Ae.lookupEnsName(r),!0}catch{return!1}},async getSuggestions(r){try{In.loading=!0,In.suggestions=[];const e=await Ae.getEnsNameSuggestions(r);return In.suggestions=e.suggestions.map(t=>({...t,name:t.name}))||[],In.suggestions}catch(e){const t=this.parseEnsApiError(e,"Error fetching name suggestions");throw new Error(t)}finally{In.loading=!1}},async getNamesForAddress(r){try{if(!S.state.activeCaipNetwork)return[];const t=se.getEnsFromCacheForAddress(r);if(t)return t;const n=await Ae.reverseLookupEnsName({address:r});return se.updateEnsCache({address:r,ens:n,timestamp:Date.now()}),n}catch(e){const t=this.parseEnsApiError(e,"Error fetching names for address");throw new Error(t)}},async registerName(r){const e=S.state.activeCaipNetwork;if(!e)throw new Error("Network not found");const t=he.state.address,n=_e.getAuthConnector();if(!t||!n)throw new Error("Address or auth connector not found");In.loading=!0;try{const s=JSON.stringify({name:r,attributes:{},timestamp:Math.floor(Date.now()/1e3)});tt.pushTransactionStack({view:"RegisterAccountNameSuccess",goBack:!1,replace:!0,onCancel(){In.loading=!1}});const i=await Et.signMessage(s),o=e.id;if(!o)throw new Error("Network not found");const a=Yj.convertEVMChainIdToCoinType(Number(o));await Ae.registerEnsName({coinType:a,address:t,signature:i,message:s}),he.setProfileName(r,e.chainNamespace),tt.replace("RegisterAccountNameSuccess")}catch(s){const i=this.parseEnsApiError(s,`Error registering name ${r}`);throw tt.replace("RegisterAccountName"),new Error(i)}finally{In.loading=!1}},validateName(r){return/^[a-zA-Z0-9-]{4,}$/u.test(r)},parseEnsApiError(r,e){var n,s;const t=r;return((s=(n=t==null?void 0:t.reasons)==null?void 0:n[0])==null?void 0:s.description)||e}};var xI={exports:{}},TI={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vu=Ce;function Qj(r,e){return r===e&&(r!==0||1/r===1/e)||r!==r&&e!==e}var Zj=typeof Object.is=="function"?Object.is:Qj,Xj=vu.useState,e9=vu.useEffect,t9=vu.useLayoutEffect,r9=vu.useDebugValue;function n9(r,e){var t=e(),n=Xj({inst:{value:t,getSnapshot:e}}),s=n[0].inst,i=n[1];return t9(function(){s.value=t,s.getSnapshot=e,uy(s)&&i({inst:s})},[r,t,e]),e9(function(){return uy(s)&&i({inst:s}),r(function(){uy(s)&&i({inst:s})})},[r]),r9(t),t}function uy(r){var e=r.getSnapshot;r=r.value;try{var t=e();return!Zj(r,t)}catch{return!0}}function s9(r,e){return e()}var i9=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?s9:n9;TI.useSyncExternalStore=vu.useSyncExternalStore!==void 0?vu.useSyncExternalStore:i9;xI.exports=TI;var o9=xI.exports;const a9=_g(o9),c9={},{use:qA}=Zx,{useSyncExternalStore:l9}=a9,u9=(r,e)=>{const t=Ce.useRef();Ce.useEffect(()=>{t.current=wT(r,e)}),Ce.useDebugValue(t.current)},h9=new WeakMap;function Qb(r,e){const n=Ce.useRef(),s=Ce.useRef();let i=!0;const o=l9(Ce.useCallback(l=>{const u=_r(r,l);return l(),u},[r,void 0]),()=>{const l=Za(r,qA);try{if(!i&&n.current&&s.current&&!OC(n.current,l,s.current,new WeakMap))return n.current}catch{}return l},()=>Za(r,qA));i=!1;const a=new WeakMap;Ce.useEffect(()=>{n.current=o,s.current=a}),(c9?"production":void 0)!=="production"&&u9(o,a);const c=Ce.useMemo(()=>new WeakMap,[]);return PC(o,a,c,h9)}function d9(){const{activeCaipNetwork:r}=Qb(S.state);return{caipNetwork:r,chainId:r==null?void 0:r.id,caipNetworkId:r==null?void 0:r.caipNetworkId}}function f9(r){var o,a;const e=Qb(S.state),t=e.activeChain;if(!t)return{allAccounts:[],address:void 0,caipAddress:void 0,status:void 0,isConnected:!1,embeddedWalletInfo:void 0};const n=(o=e.chains.get(t))==null?void 0:o.accountState,s=_e.getAuthConnector(t),i=se.getConnectedConnectorId(t);return{allAccounts:(n==null?void 0:n.allAccounts)||[],caipAddress:n==null?void 0:n.caipAddress,address:Ee.getPlainAddress(n==null?void 0:n.caipAddress),isConnected:!!(n!=null&&n.caipAddress),status:n==null?void 0:n.status,embeddedWalletInfo:s&&i===ee.CONNECTOR_ID.AUTH?{user:n!=null&&n.user?{...n.user,username:se.getConnectedSocialUsername()}:void 0,authProvider:(n==null?void 0:n.socialProvider)||"email",accountType:(a=n==null?void 0:n.preferredAccountTypes)==null?void 0:a[t],isSmartAccountDeployed:!!(n!=null&&n.smartAccountDeployed)}:void 0}}const ft={METMASK_CONNECTOR_NAME:"MetaMask",TRUST_CONNECTOR_NAME:"Trust Wallet",SOLFLARE_CONNECTOR_NAME:"Solflare",PHANTOM_CONNECTOR_NAME:"Phantom",COIN98_CONNECTOR_NAME:"Coin98",MAGIC_EDEN_CONNECTOR_NAME:"Magic Eden",BACKPACK_CONNECTOR_NAME:"Backpack",BITGET_CONNECTOR_NAME:"Bitget Wallet",FRONTIER_CONNECTOR_NAME:"Frontier",XVERSE_CONNECTOR_NAME:"Xverse Wallet",LEATHER_CONNECTOR_NAME:"Leather",EIP155:"eip155",ADD_CHAIN_METHOD:"wallet_addEthereumChain",EIP6963_ANNOUNCE_EVENT:"eip6963:announceProvider",EIP6963_REQUEST_EVENT:"eip6963:requestProvider",CONNECTOR_RDNS_MAP:{coinbaseWallet:"com.coinbase.wallet",coinbaseWalletSDK:"com.coinbase.wallet"},CONNECTOR_TYPE_EXTERNAL:"EXTERNAL",CONNECTOR_TYPE_WALLET_CONNECT:"WALLET_CONNECT",CONNECTOR_TYPE_INJECTED:"INJECTED",CONNECTOR_TYPE_ANNOUNCED:"ANNOUNCED",CONNECTOR_TYPE_AUTH:"AUTH",CONNECTOR_TYPE_MULTI_CHAIN:"MULTI_CHAIN",CONNECTOR_TYPE_W3M_AUTH:"ID_AUTH"},Ms={ConnectorExplorerIds:{[ee.CONNECTOR_ID.COINBASE]:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",[ee.CONNECTOR_ID.COINBASE_SDK]:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",[ee.CONNECTOR_ID.SAFE]:"225affb176778569276e484e1b92637ad061b01e13a048b35a9d280c3b58970f",[ee.CONNECTOR_ID.LEDGER]:"19177a98252e07ddfc9af2083ba8e07ef627cb6103467ffebb3f8f4205fd7927",[ee.CONNECTOR_ID.OKX]:"971e689d0a5be527bac79629b4ee9b925e82208e5168b733496a09c0faed0709",[ft.METMASK_CONNECTOR_NAME]:"c57ca95b47569778a828d19178114f4db188b89b763c899ba0be274e97267d96",[ft.TRUST_CONNECTOR_NAME]:"4622a2b2d6af1c9844944291e5e7351a6aa24cd7b23099efac1b2fd875da31a0",[ft.SOLFLARE_CONNECTOR_NAME]:"1ca0bdd4747578705b1939af023d120677c64fe6ca76add81fda36e350605e79",[ft.PHANTOM_CONNECTOR_NAME]:"a797aa35c0fadbfc1a53e7f675162ed5226968b44a19ee3d24385c64d1d3c393",[ft.COIN98_CONNECTOR_NAME]:"2a3c89040ac3b723a1972a33a125b1db11e258a6975d3a61252cd64e6ea5ea01",[ft.MAGIC_EDEN_CONNECTOR_NAME]:"8b830a2b724a9c3fbab63af6f55ed29c9dfa8a55e732dc88c80a196a2ba136c6",[ft.BACKPACK_CONNECTOR_NAME]:"2bd8c14e035c2d48f184aaa168559e86b0e3433228d3c4075900a221785019b0",[ft.BITGET_CONNECTOR_NAME]:"38f5d18bd8522c244bdd70cb4a68e0e718865155811c043f052fb9f1c51de662",[ft.FRONTIER_CONNECTOR_NAME]:"85db431492aa2e8672e93f4ea7acf10c88b97b867b0d373107af63dc4880f041",[ft.XVERSE_CONNECTOR_NAME]:"2a87d74ae02e10bdd1f51f7ce6c4e1cc53cd5f2c0b6b5ad0d7b3007d2b13de7b",[ft.LEATHER_CONNECTOR_NAME]:"483afe1df1df63daf313109971ff3ef8356ddf1cc4e45877d205eee0b7893a13"},NetworkImageIds:{1:"ba0ba0cd-17c6-4806-ad93-f9d174f17900",42161:"3bff954d-5cb0-47a0-9a23-d20192e74600",43114:"30c46e53-e989-45fb-4549-be3bd4eb3b00",56:"93564157-2e8e-4ce7-81df-b264dbee9b00",250:"06b26297-fe0c-4733-5d6b-ffa5498aac00",10:"ab9c186a-c52f-464b-2906-ca59d760a400",137:"41d04d42-da3b-4453-8506-668cc0727900",5e3:"e86fae9b-b770-4eea-e520-150e12c81100",295:"6a97d510-cac8-4e58-c7ce-e8681b044c00",11155111:"e909ea0a-f92a-4512-c8fc-748044ea6800",84532:"a18a7ecd-e307-4360-4746-283182228e00",1301:"4eeea7ef-0014-4649-5d1d-07271a80f600",130:"2257980a-3463-48c6-cbac-a42d2a956e00",10143:"0a728e83-bacb-46db-7844-948f05434900",100:"02b53f6a-e3d4-479e-1cb4-21178987d100",9001:"f926ff41-260d-4028-635e-91913fc28e00",324:"b310f07f-4ef7-49f3-7073-2a0a39685800",314:"5a73b3dd-af74-424e-cae0-0de859ee9400",4689:"34e68754-e536-40da-c153-6ef2e7188a00",1088:"3897a66d-40b9-4833-162f-a2c90531c900",1284:"161038da-44ae-4ec7-1208-0ea569454b00",1285:"f1d73bb6-5450-4e18-38f7-fb6484264a00",7777777:"845c60df-d429-4991-e687-91ae45791600",42220:"ab781bbc-ccc6-418d-d32d-789b15da1f00",8453:"7289c336-3981-4081-c5f4-efc26ac64a00",1313161554:"3ff73439-a619-4894-9262-4470c773a100",2020:"b8101fc0-9c19-4b6f-ec65-f6dfff106e00",2021:"b8101fc0-9c19-4b6f-ec65-f6dfff106e00",80094:"e329c2c9-59b0-4a02-83e4-212ff3779900",2741:"fc2427d1-5af9-4a9c-8da5-6f94627cd900","5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp":"a1b58899-f671-4276-6a5e-56ca5bd59700","4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z":"a1b58899-f671-4276-6a5e-56ca5bd59700",EtWTRABZaYq6iMfeYKouRu166VU2xqa1:"a1b58899-f671-4276-6a5e-56ca5bd59700","000000000019d6689c085ae165831e93":"0b4838db-0161-4ffe-022d-532bf03dba00","000000000933ea01ad0ee984209779ba":"39354064-d79b-420b-065d-f980c4b78200"},ConnectorImageIds:{[ee.CONNECTOR_ID.COINBASE]:"0c2840c3-5b04-4c44-9661-fbd4b49e1800",[ee.CONNECTOR_ID.COINBASE_SDK]:"0c2840c3-5b04-4c44-9661-fbd4b49e1800",[ee.CONNECTOR_ID.SAFE]:"461db637-8616-43ce-035a-d89b8a1d5800",[ee.CONNECTOR_ID.LEDGER]:"54a1aa77-d202-4f8d-0fb2-5d2bb6db0300",[ee.CONNECTOR_ID.WALLET_CONNECT]:"ef1a1fcf-7fe8-4d69-bd6d-fda1345b4400",[ee.CONNECTOR_ID.INJECTED]:"07ba87ed-43aa-4adf-4540-9e6a2b9cae00"},ConnectorNamesMap:{[ee.CONNECTOR_ID.INJECTED]:"Browser Wallet",[ee.CONNECTOR_ID.WALLET_CONNECT]:"WalletConnect",[ee.CONNECTOR_ID.COINBASE]:"Coinbase",[ee.CONNECTOR_ID.COINBASE_SDK]:"Coinbase",[ee.CONNECTOR_ID.LEDGER]:"Ledger",[ee.CONNECTOR_ID.SAFE]:"Safe"},ConnectorTypesMap:{[ee.CONNECTOR_ID.INJECTED]:"INJECTED",[ee.CONNECTOR_ID.WALLET_CONNECT]:"WALLET_CONNECT",[ee.CONNECTOR_ID.EIP6963]:"ANNOUNCED",[ee.CONNECTOR_ID.AUTH]:"AUTH"}},Wg={getCaipTokens(r){if(!r)return;const e={};return Object.entries(r).forEach(([t,n])=>{e[`${ft.EIP155}:${t}`]=n}),e},isLowerCaseMatch(r,e){return(r==null?void 0:r.toLowerCase())===(e==null?void 0:e.toLowerCase())}},p9=new AbortController,$s={EmbeddedWalletAbortController:p9,UniversalProviderErrors:{UNAUTHORIZED_DOMAIN_NOT_ALLOWED:{message:"Unauthorized: origin not allowed",alertErrorKey:"INVALID_APP_CONFIGURATION"},JWT_VALIDATION_ERROR:{message:"JWT validation error: JWT Token is not yet valid",alertErrorKey:"JWT_TOKEN_NOT_VALID"},INVALID_KEY:{message:"Unauthorized: invalid key",alertErrorKey:"INVALID_PROJECT_ID"}},ALERT_ERRORS:{SWITCH_NETWORK_NOT_FOUND:{shortMessage:"Network Not Found",longMessage:"Network not found - please make sure it is included in 'networks' array in createAppKit function"},INVALID_APP_CONFIGURATION:{shortMessage:"Invalid App Configuration",longMessage:()=>`Origin ${g9()?window.origin:"unknown"} not found on Allowlist - update configuration on cloud.reown.com`},IFRAME_LOAD_FAILED:{shortMessage:"Network Error - Could not load embedded wallet",longMessage:()=>"There was an issue loading the embedded wallet. Please try again later."},IFRAME_REQUEST_TIMEOUT:{shortMessage:"Embedded Wallet Request Timed Out",longMessage:()=>"There was an issue doing the request to the embedded wallet. Please try again later."},UNVERIFIED_DOMAIN:{shortMessage:"Invalid App Configuration",longMessage:()=>"There was an issue loading the embedded wallet. Please verify that your domain is allowed at cloud.reown.com"},JWT_TOKEN_NOT_VALID:{shortMessage:"Session Expired",longMessage:"Invalid session found on UniversalProvider - please check your time settings and connect again"},INVALID_PROJECT_ID:{shortMessage:"Invalid App Configuration",longMessage:"Invalid Project ID - update configuration"},PROJECT_ID_NOT_CONFIGURED:{shortMessage:"Project ID Not Configured",longMessage:"Project ID Not Configured - update configuration on cloud.reown.com"}}};function g9(){return typeof window<"u"}const m9={createLogger(r,e="error"){const t=Bu({level:e}),{logger:n}=Cb({opts:t});return n.error=(...s)=>{for(const i of s)if(i instanceof Error){r(i,...s);return}r(void 0,...s)},n}},y9="rpc.walletconnect.org";function VA(r,e){const t=new URL("https://rpc.walletconnect.org/v1/");return t.searchParams.set("chainId",r),t.searchParams.set("projectId",e),t.toString()}const hy=["near:mainnet","solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","eip155:1101","eip155:56","eip155:42161","eip155:7777777","eip155:59144","eip155:324","solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1","eip155:5000","solana:4sgjmw1sunhzsxgspuhpqldx6wiyjntz","eip155:80084","eip155:5003","eip155:100","eip155:8453","eip155:42220","eip155:1313161555","eip155:17000","eip155:1","eip155:300","eip155:1313161554","eip155:1329","eip155:84532","eip155:421614","eip155:11155111","eip155:8217","eip155:43114","solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","eip155:999999999","eip155:11155420","eip155:80002","eip155:97","eip155:43113","eip155:137","eip155:10","eip155:1301","bip122:000000000019d6689c085ae165831e93","bip122:000000000933ea01ad0ee984209779ba"],Xc={extendRpcUrlWithProjectId(r,e){let t=!1;try{t=new URL(r).host===y9}catch{t=!1}if(t){const n=new URL(r);return n.searchParams.has("projectId")||n.searchParams.set("projectId",e),n.toString()}return r},isCaipNetwork(r){return"chainNamespace"in r&&"caipNetworkId"in r},getChainNamespace(r){return this.isCaipNetwork(r)?r.chainNamespace:ee.CHAIN.EVM},getCaipNetworkId(r){return this.isCaipNetwork(r)?r.caipNetworkId:`${ee.CHAIN.EVM}:${r.id}`},getDefaultRpcUrl(r,e,t){var s,i,o;const n=(o=(i=(s=r.rpcUrls)==null?void 0:s.default)==null?void 0:i.http)==null?void 0:o[0];return hy.includes(e)?VA(e,t):n||""},extendCaipNetwork(r,{customNetworkImageUrls:e,projectId:t,customRpcUrls:n}){var d,f,g,p,m;const s=this.getChainNamespace(r),i=this.getCaipNetworkId(r),o=(d=r.rpcUrls.default.http)==null?void 0:d[0],a=this.getDefaultRpcUrl(r,i,t),c=((p=(g=(f=r==null?void 0:r.rpcUrls)==null?void 0:f.chainDefault)==null?void 0:g.http)==null?void 0:p[0])||o,l=((m=n==null?void 0:n[i])==null?void 0:m.map(w=>w.url))||[],u=[...l,a],h=[...l];return c&&!h.includes(c)&&h.push(c),{...r,chainNamespace:s,caipNetworkId:i,assets:{imageId:Ms.NetworkImageIds[r.id],imageUrl:e==null?void 0:e[r.id]},rpcUrls:{...r.rpcUrls,default:{http:u},chainDefault:{http:h}}}},extendCaipNetworks(r,{customNetworkImageUrls:e,projectId:t,customRpcUrls:n}){return r.map(s=>Xc.extendCaipNetwork(s,{customNetworkImageUrls:e,customRpcUrls:n,projectId:t}))},getViemTransport(r,e,t){var s,i,o;const n=[];return t==null||t.forEach(a=>{n.push(Zf(a.url,a.config))}),hy.includes(r.caipNetworkId)&&n.push(Zf(VA(r.caipNetworkId,e),{fetchOptions:{headers:{"Content-Type":"text/plain"}}})),(o=(i=(s=r==null?void 0:r.rpcUrls)==null?void 0:s.default)==null?void 0:i.http)==null||o.forEach(a=>{n.push(Zf(a))}),MA(n)},extendWagmiTransports(r,e,t){if(hy.includes(r.caipNetworkId)){const n=this.getDefaultRpcUrl(r,r.caipNetworkId,e);return MA([t,Zf(n)])}return t},getUnsupportedNetwork(r){return{id:r.split(":")[1],caipNetworkId:r,name:ee.UNSUPPORTED_NETWORK_NAME,chainNamespace:r.split(":")[0],nativeCurrency:{name:"",decimals:0,symbol:""},rpcUrls:{default:{http:[]}}}},getCaipNetworkFromStorage(r){var c;const e=se.getActiveCaipNetworkId(),t=S.getAllRequestedCaipNetworks(),n=Array.from(((c=S.state.chains)==null?void 0:c.keys())||[]),s=e==null?void 0:e.split(":")[0],i=s?n.includes(s):!1,o=t==null?void 0:t.find(l=>l.caipNetworkId===e);return i&&!o&&e?this.getUnsupportedNetwork(e):o||r||(t==null?void 0:t[0])}},Wp={eip155:void 0,solana:void 0,polkadot:void 0,bip122:void 0,cosmos:void 0},jr=St({providers:{...Wp},providerIds:{...Wp}}),qe={state:jr,subscribeKey(r,e){return Zr(jr,r,e)},subscribe(r){return _r(jr,()=>{r(jr)})},subscribeProviders(r){return _r(jr.providers,()=>r(jr.providers))},setProvider(r,e){e&&(jr.providers[r]=Xa(e))},getProvider(r){return jr.providers[r]},setProviderId(r,e){e&&(jr.providerIds[r]=e)},getProviderId(r){if(r)return jr.providerIds[r]},reset(){jr.providers={...Wp},jr.providerIds={...Wp}},resetChain(r){jr.providers[r]=void 0,jr.providerIds[r]=void 0}},WA={transactionHash:/^0x(?:[A-Fa-f0-9]{64})$/u,signedMessage:/^0x(?:[a-fA-F0-9]{62,})$/u},ir={set(r,e){yn.isClient&&localStorage.setItem(`${fe.STORAGE_KEY}${r}`,e)},get(r){return yn.isClient?localStorage.getItem(`${fe.STORAGE_KEY}${r}`):null},delete(r,e){yn.isClient&&(e?localStorage.removeItem(r):localStorage.removeItem(`${fe.STORAGE_KEY}${r}`))}},ep=30*1e3,yn={checkIfAllowedToTriggerEmail(){const r=ir.get(fe.LAST_EMAIL_LOGIN_TIME);if(r){const e=Date.now()-Number(r);if(e<ep){const t=Math.ceil((ep-e)/1e3);throw new Error(`Please try again after ${t} seconds`)}}},getTimeToNextEmailLogin(){const r=ir.get(fe.LAST_EMAIL_LOGIN_TIME);if(r){const e=Date.now()-Number(r);if(e<ep)return Math.ceil((ep-e)/1e3)}return 0},checkIfRequestExists(r){return dr.NOT_SAFE_RPC_METHODS.includes(r.method)||dr.SAFE_RPC_METHODS.includes(r.method)},getResponseType(r){return typeof r=="string"&&((r==null?void 0:r.match(WA.transactionHash))||(r==null?void 0:r.match(WA.signedMessage)))?fe.RPC_RESPONSE_TYPE_TX:fe.RPC_RESPONSE_TYPE_OBJECT},checkIfRequestIsSafe(r){return dr.SAFE_RPC_METHODS.includes(r.method)},isClient:typeof window<"u"};var Je;(function(r){r.assertEqual=s=>s;function e(s){}r.assertIs=e;function t(s){throw new Error}r.assertNever=t,r.arrayToEnum=s=>{const i={};for(const o of s)i[o]=o;return i},r.getValidEnumValues=s=>{const i=r.objectKeys(s).filter(a=>typeof s[s[a]]!="number"),o={};for(const a of i)o[a]=s[a];return r.objectValues(o)},r.objectValues=s=>r.objectKeys(s).map(function(i){return s[i]}),r.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const i=[];for(const o in s)Object.prototype.hasOwnProperty.call(s,o)&&i.push(o);return i},r.find=(s,i)=>{for(const o of s)if(i(o))return o},r.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&isFinite(s)&&Math.floor(s)===s;function n(s,i=" | "){return s.map(o=>typeof o=="string"?`'${o}'`:o).join(i)}r.joinValues=n,r.jsonStringifyReplacer=(s,i)=>typeof i=="bigint"?i.toString():i})(Je||(Je={}));var Tw;(function(r){r.mergeShapes=(e,t)=>({...e,...t})})(Tw||(Tw={}));const ie=Je.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),oo=r=>{switch(typeof r){case"undefined":return ie.undefined;case"string":return ie.string;case"number":return isNaN(r)?ie.nan:ie.number;case"boolean":return ie.boolean;case"function":return ie.function;case"bigint":return ie.bigint;case"symbol":return ie.symbol;case"object":return Array.isArray(r)?ie.array:r===null?ie.null:r.then&&typeof r.then=="function"&&r.catch&&typeof r.catch=="function"?ie.promise:typeof Map<"u"&&r instanceof Map?ie.map:typeof Set<"u"&&r instanceof Set?ie.set:typeof Date<"u"&&r instanceof Date?ie.date:ie.object;default:return ie.unknown}},Y=Je.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),w9=r=>JSON.stringify(r,null,2).replace(/"([^"]+)":/g,"$1:");class us extends Error{constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const t=e||function(i){return i.message},n={_errors:[]},s=i=>{for(const o of i.issues)if(o.code==="invalid_union")o.unionErrors.map(s);else if(o.code==="invalid_return_type")s(o.returnTypeError);else if(o.code==="invalid_arguments")s(o.argumentsError);else if(o.path.length===0)n._errors.push(t(o));else{let a=n,c=0;for(;c<o.path.length;){const l=o.path[c];c===o.path.length-1?(a[l]=a[l]||{_errors:[]},a[l]._errors.push(t(o))):a[l]=a[l]||{_errors:[]},a=a[l],c++}}};return s(this),n}toString(){return this.message}get message(){return JSON.stringify(this.issues,Je.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){const t={},n=[];for(const s of this.issues)s.path.length>0?(t[s.path[0]]=t[s.path[0]]||[],t[s.path[0]].push(e(s))):n.push(e(s));return{formErrors:n,fieldErrors:t}}get formErrors(){return this.flatten()}}us.create=r=>new us(r);const bd=(r,e)=>{let t;switch(r.code){case Y.invalid_type:r.received===ie.undefined?t="Required":t=`Expected ${r.expected}, received ${r.received}`;break;case Y.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(r.expected,Je.jsonStringifyReplacer)}`;break;case Y.unrecognized_keys:t=`Unrecognized key(s) in object: ${Je.joinValues(r.keys,", ")}`;break;case Y.invalid_union:t="Invalid input";break;case Y.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${Je.joinValues(r.options)}`;break;case Y.invalid_enum_value:t=`Invalid enum value. Expected ${Je.joinValues(r.options)}, received '${r.received}'`;break;case Y.invalid_arguments:t="Invalid function arguments";break;case Y.invalid_return_type:t="Invalid function return type";break;case Y.invalid_date:t="Invalid date";break;case Y.invalid_string:typeof r.validation=="object"?"includes"in r.validation?(t=`Invalid input: must include "${r.validation.includes}"`,typeof r.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${r.validation.position}`)):"startsWith"in r.validation?t=`Invalid input: must start with "${r.validation.startsWith}"`:"endsWith"in r.validation?t=`Invalid input: must end with "${r.validation.endsWith}"`:Je.assertNever(r.validation):r.validation!=="regex"?t=`Invalid ${r.validation}`:t="Invalid";break;case Y.too_small:r.type==="array"?t=`Array must contain ${r.exact?"exactly":r.inclusive?"at least":"more than"} ${r.minimum} element(s)`:r.type==="string"?t=`String must contain ${r.exact?"exactly":r.inclusive?"at least":"over"} ${r.minimum} character(s)`:r.type==="number"?t=`Number must be ${r.exact?"exactly equal to ":r.inclusive?"greater than or equal to ":"greater than "}${r.minimum}`:r.type==="date"?t=`Date must be ${r.exact?"exactly equal to ":r.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(r.minimum))}`:t="Invalid input";break;case Y.too_big:r.type==="array"?t=`Array must contain ${r.exact?"exactly":r.inclusive?"at most":"less than"} ${r.maximum} element(s)`:r.type==="string"?t=`String must contain ${r.exact?"exactly":r.inclusive?"at most":"under"} ${r.maximum} character(s)`:r.type==="number"?t=`Number must be ${r.exact?"exactly":r.inclusive?"less than or equal to":"less than"} ${r.maximum}`:r.type==="bigint"?t=`BigInt must be ${r.exact?"exactly":r.inclusive?"less than or equal to":"less than"} ${r.maximum}`:r.type==="date"?t=`Date must be ${r.exact?"exactly":r.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(r.maximum))}`:t="Invalid input";break;case Y.custom:t="Invalid input";break;case Y.invalid_intersection_types:t="Intersection results could not be merged";break;case Y.not_multiple_of:t=`Number must be a multiple of ${r.multipleOf}`;break;case Y.not_finite:t="Number must be finite";break;default:t=e.defaultError,Je.assertNever(r)}return{message:t}};let PI=bd;function b9(r){PI=r}function Gp(){return PI}const Kp=r=>{const{data:e,path:t,errorMaps:n,issueData:s}=r,i=[...t,...s.path||[]],o={...s,path:i};let a="";const c=n.filter(l=>!!l).slice().reverse();for(const l of c)a=l(o,{data:e,defaultError:a}).message;return{...s,path:i,message:s.message||a}},E9=[];function le(r,e){const t=Kp({issueData:e,data:r.data,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,Gp(),bd].filter(n=>!!n)});r.common.issues.push(t)}class Nr{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){const n=[];for(const s of t){if(s.status==="aborted")return Ie;s.status==="dirty"&&e.dirty(),n.push(s.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,t){const n=[];for(const s of t)n.push({key:await s.key,value:await s.value});return Nr.mergeObjectSync(e,n)}static mergeObjectSync(e,t){const n={};for(const s of t){const{key:i,value:o}=s;if(i.status==="aborted"||o.status==="aborted")return Ie;i.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof o.value<"u"||s.alwaysSet)&&(n[i.value]=o.value)}return{status:e.value,value:n}}}const Ie=Object.freeze({status:"aborted"}),OI=r=>({status:"dirty",value:r}),Br=r=>({status:"valid",value:r}),Pw=r=>r.status==="aborted",Ow=r=>r.status==="dirty",Ed=r=>r.status==="valid",Jp=r=>typeof Promise<"u"&&r instanceof Promise;var me;(function(r){r.errToObj=e=>typeof e=="string"?{message:e}:e||{},r.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(me||(me={}));class Js{constructor(e,t,n,s){this._cachedPath=[],this.parent=e,this.data=t,this._path=n,this._key=s}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const GA=(r,e)=>{if(Ed(e))return{success:!0,data:e.value};if(!r.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new us(r.common.issues);return this._error=t,this._error}}};function Te(r){if(!r)return{};const{errorMap:e,invalid_type_error:t,required_error:n,description:s}=r;if(e&&(t||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:s}:{errorMap:(o,a)=>o.code!=="invalid_type"?{message:a.defaultError}:typeof a.data>"u"?{message:n??a.defaultError}:{message:t??a.defaultError},description:s}}class Be{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return oo(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:oo(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Nr,ctx:{common:e.parent.common,data:e.data,parsedType:oo(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(Jp(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const n=this.safeParse(e,t);if(n.success)return n.data;throw n.error}safeParse(e,t){var n;const s={common:{issues:[],async:(n=t==null?void 0:t.async)!==null&&n!==void 0?n:!1,contextualErrorMap:t==null?void 0:t.errorMap},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:oo(e)},i=this._parseSync({data:e,path:s.path,parent:s});return GA(s,i)}async parseAsync(e,t){const n=await this.safeParseAsync(e,t);if(n.success)return n.data;throw n.error}async safeParseAsync(e,t){const n={common:{issues:[],contextualErrorMap:t==null?void 0:t.errorMap,async:!0},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:oo(e)},s=this._parse({data:e,path:n.path,parent:n}),i=await(Jp(s)?s:Promise.resolve(s));return GA(n,i)}refine(e,t){const n=s=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(s):t;return this._refinement((s,i)=>{const o=e(s),a=()=>i.addIssue({code:Y.custom,...n(s)});return typeof Promise<"u"&&o instanceof Promise?o.then(c=>c?!0:(a(),!1)):o?!0:(a(),!1)})}refinement(e,t){return this._refinement((n,s)=>e(n)?!0:(s.addIssue(typeof t=="function"?t(n,s):t),!1))}_refinement(e){return new ds({schema:this,typeName:ve.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return ki.create(this,this._def)}nullable(){return oc.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return hs.create(this,this._def)}promise(){return Cu.create(this,this._def)}or(e){return _d.create([this,e],this._def)}and(e){return Nd.create(this,e,this._def)}transform(e){return new ds({...Te(this._def),schema:this,typeName:ve.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t=typeof e=="function"?e:()=>e;return new Pd({...Te(this._def),innerType:this,defaultValue:t,typeName:ve.ZodDefault})}brand(){return new DI({typeName:ve.ZodBranded,type:this,...Te(this._def)})}catch(e){const t=typeof e=="function"?e:()=>e;return new Xp({...Te(this._def),innerType:this,catchValue:t,typeName:ve.ZodCatch})}describe(e){const t=this.constructor;return new t({...this._def,description:e})}pipe(e){return bf.create(this,e)}readonly(){return tg.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const v9=/^c[^\s-]{8,}$/i,A9=/^[a-z][a-z0-9]*$/,C9=/^[0-9A-HJKMNP-TV-Z]{26}$/,_9=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,N9=/^(?!\.)(?!.*\.\.)([A-Z0-9_+-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,I9="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let dy;const S9=/^(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))$/,x9=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,T9=r=>r.precision?r.offset?new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${r.precision}}(([+-]\\d{2}(:?\\d{2})?)|Z)$`):new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${r.precision}}Z$`):r.precision===0?r.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z$"):r.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?Z$");function P9(r,e){return!!((e==="v4"||!e)&&S9.test(r)||(e==="v6"||!e)&&x9.test(r))}class ls extends Be{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==ie.string){const i=this._getOrReturnCtx(e);return le(i,{code:Y.invalid_type,expected:ie.string,received:i.parsedType}),Ie}const n=new Nr;let s;for(const i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(s=this._getOrReturnCtx(e,s),le(s,{code:Y.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="max")e.data.length>i.value&&(s=this._getOrReturnCtx(e,s),le(s,{code:Y.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="length"){const o=e.data.length>i.value,a=e.data.length<i.value;(o||a)&&(s=this._getOrReturnCtx(e,s),o?le(s,{code:Y.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):a&&le(s,{code:Y.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),n.dirty())}else if(i.kind==="email")N9.test(e.data)||(s=this._getOrReturnCtx(e,s),le(s,{validation:"email",code:Y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="emoji")dy||(dy=new RegExp(I9,"u")),dy.test(e.data)||(s=this._getOrReturnCtx(e,s),le(s,{validation:"emoji",code:Y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="uuid")_9.test(e.data)||(s=this._getOrReturnCtx(e,s),le(s,{validation:"uuid",code:Y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid")v9.test(e.data)||(s=this._getOrReturnCtx(e,s),le(s,{validation:"cuid",code:Y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid2")A9.test(e.data)||(s=this._getOrReturnCtx(e,s),le(s,{validation:"cuid2",code:Y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="ulid")C9.test(e.data)||(s=this._getOrReturnCtx(e,s),le(s,{validation:"ulid",code:Y.invalid_string,message:i.message}),n.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),le(s,{validation:"url",code:Y.invalid_string,message:i.message}),n.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),le(s,{validation:"regex",code:Y.invalid_string,message:i.message}),n.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(s=this._getOrReturnCtx(e,s),le(s,{code:Y.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),n.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(s=this._getOrReturnCtx(e,s),le(s,{code:Y.invalid_string,validation:{startsWith:i.value},message:i.message}),n.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(s=this._getOrReturnCtx(e,s),le(s,{code:Y.invalid_string,validation:{endsWith:i.value},message:i.message}),n.dirty()):i.kind==="datetime"?T9(i).test(e.data)||(s=this._getOrReturnCtx(e,s),le(s,{code:Y.invalid_string,validation:"datetime",message:i.message}),n.dirty()):i.kind==="ip"?P9(e.data,i.version)||(s=this._getOrReturnCtx(e,s),le(s,{validation:"ip",code:Y.invalid_string,message:i.message}),n.dirty()):Je.assertNever(i);return{status:n.value,value:e.data}}_regex(e,t,n){return this.refinement(s=>e.test(s),{validation:t,code:Y.invalid_string,...me.errToObj(n)})}_addCheck(e){return new ls({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...me.errToObj(e)})}url(e){return this._addCheck({kind:"url",...me.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...me.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...me.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...me.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...me.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...me.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...me.errToObj(e)})}datetime(e){var t;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(t=e==null?void 0:e.offset)!==null&&t!==void 0?t:!1,...me.errToObj(e==null?void 0:e.message)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...me.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t==null?void 0:t.position,...me.errToObj(t==null?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...me.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...me.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...me.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...me.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...me.errToObj(t)})}nonempty(e){return this.min(1,me.errToObj(e))}trim(){return new ls({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new ls({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new ls({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get minLength(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}ls.create=r=>{var e;return new ls({checks:[],typeName:ve.ZodString,coerce:(e=r==null?void 0:r.coerce)!==null&&e!==void 0?e:!1,...Te(r)})};function O9(r,e){const t=(r.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,s=t>n?t:n,i=parseInt(r.toFixed(s).replace(".","")),o=parseInt(e.toFixed(s).replace(".",""));return i%o/Math.pow(10,s)}class ko extends Be{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==ie.number){const i=this._getOrReturnCtx(e);return le(i,{code:Y.invalid_type,expected:ie.number,received:i.parsedType}),Ie}let n;const s=new Nr;for(const i of this._def.checks)i.kind==="int"?Je.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),le(n,{code:Y.invalid_type,expected:"integer",received:"float",message:i.message}),s.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(n=this._getOrReturnCtx(e,n),le(n,{code:Y.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(n=this._getOrReturnCtx(e,n),le(n,{code:Y.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="multipleOf"?O9(e.data,i.value)!==0&&(n=this._getOrReturnCtx(e,n),le(n,{code:Y.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),le(n,{code:Y.not_finite,message:i.message}),s.dirty()):Je.assertNever(i);return{status:s.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,me.toString(t))}gt(e,t){return this.setLimit("min",e,!1,me.toString(t))}lte(e,t){return this.setLimit("max",e,!0,me.toString(t))}lt(e,t){return this.setLimit("max",e,!1,me.toString(t))}setLimit(e,t,n,s){return new ko({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:me.toString(s)}]})}_addCheck(e){return new ko({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:me.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:me.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:me.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:me.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:me.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:me.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:me.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:me.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:me.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Je.isInteger(e.value))}get isFinite(){let e=null,t=null;for(const n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(t===null||n.value>t)&&(t=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(t)&&Number.isFinite(e)}}ko.create=r=>new ko({checks:[],typeName:ve.ZodNumber,coerce:(r==null?void 0:r.coerce)||!1,...Te(r)});class Uo extends Be{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==ie.bigint){const i=this._getOrReturnCtx(e);return le(i,{code:Y.invalid_type,expected:ie.bigint,received:i.parsedType}),Ie}let n;const s=new Nr;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(n=this._getOrReturnCtx(e,n),le(n,{code:Y.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(n=this._getOrReturnCtx(e,n),le(n,{code:Y.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),le(n,{code:Y.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):Je.assertNever(i);return{status:s.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,me.toString(t))}gt(e,t){return this.setLimit("min",e,!1,me.toString(t))}lte(e,t){return this.setLimit("max",e,!0,me.toString(t))}lt(e,t){return this.setLimit("max",e,!1,me.toString(t))}setLimit(e,t,n,s){return new Uo({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:me.toString(s)}]})}_addCheck(e){return new Uo({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:me.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:me.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:me.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:me.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:me.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}Uo.create=r=>{var e;return new Uo({checks:[],typeName:ve.ZodBigInt,coerce:(e=r==null?void 0:r.coerce)!==null&&e!==void 0?e:!1,...Te(r)})};class vd extends Be{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==ie.boolean){const n=this._getOrReturnCtx(e);return le(n,{code:Y.invalid_type,expected:ie.boolean,received:n.parsedType}),Ie}return Br(e.data)}}vd.create=r=>new vd({typeName:ve.ZodBoolean,coerce:(r==null?void 0:r.coerce)||!1,...Te(r)});class sc extends Be{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==ie.date){const i=this._getOrReturnCtx(e);return le(i,{code:Y.invalid_type,expected:ie.date,received:i.parsedType}),Ie}if(isNaN(e.data.getTime())){const i=this._getOrReturnCtx(e);return le(i,{code:Y.invalid_date}),Ie}const n=new Nr;let s;for(const i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(s=this._getOrReturnCtx(e,s),le(s,{code:Y.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),n.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(s=this._getOrReturnCtx(e,s),le(s,{code:Y.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),n.dirty()):Je.assertNever(i);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new sc({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:me.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:me.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}}sc.create=r=>new sc({checks:[],coerce:(r==null?void 0:r.coerce)||!1,typeName:ve.ZodDate,...Te(r)});class Yp extends Be{_parse(e){if(this._getType(e)!==ie.symbol){const n=this._getOrReturnCtx(e);return le(n,{code:Y.invalid_type,expected:ie.symbol,received:n.parsedType}),Ie}return Br(e.data)}}Yp.create=r=>new Yp({typeName:ve.ZodSymbol,...Te(r)});class Ad extends Be{_parse(e){if(this._getType(e)!==ie.undefined){const n=this._getOrReturnCtx(e);return le(n,{code:Y.invalid_type,expected:ie.undefined,received:n.parsedType}),Ie}return Br(e.data)}}Ad.create=r=>new Ad({typeName:ve.ZodUndefined,...Te(r)});class Cd extends Be{_parse(e){if(this._getType(e)!==ie.null){const n=this._getOrReturnCtx(e);return le(n,{code:Y.invalid_type,expected:ie.null,received:n.parsedType}),Ie}return Br(e.data)}}Cd.create=r=>new Cd({typeName:ve.ZodNull,...Te(r)});class Au extends Be{constructor(){super(...arguments),this._any=!0}_parse(e){return Br(e.data)}}Au.create=r=>new Au({typeName:ve.ZodAny,...Te(r)});class Va extends Be{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Br(e.data)}}Va.create=r=>new Va({typeName:ve.ZodUnknown,...Te(r)});class Li extends Be{_parse(e){const t=this._getOrReturnCtx(e);return le(t,{code:Y.invalid_type,expected:ie.never,received:t.parsedType}),Ie}}Li.create=r=>new Li({typeName:ve.ZodNever,...Te(r)});class Qp extends Be{_parse(e){if(this._getType(e)!==ie.undefined){const n=this._getOrReturnCtx(e);return le(n,{code:Y.invalid_type,expected:ie.void,received:n.parsedType}),Ie}return Br(e.data)}}Qp.create=r=>new Qp({typeName:ve.ZodVoid,...Te(r)});class hs extends Be{_parse(e){const{ctx:t,status:n}=this._processInputParams(e),s=this._def;if(t.parsedType!==ie.array)return le(t,{code:Y.invalid_type,expected:ie.array,received:t.parsedType}),Ie;if(s.exactLength!==null){const o=t.data.length>s.exactLength.value,a=t.data.length<s.exactLength.value;(o||a)&&(le(t,{code:o?Y.too_big:Y.too_small,minimum:a?s.exactLength.value:void 0,maximum:o?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),n.dirty())}if(s.minLength!==null&&t.data.length<s.minLength.value&&(le(t,{code:Y.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),n.dirty()),s.maxLength!==null&&t.data.length>s.maxLength.value&&(le(t,{code:Y.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),n.dirty()),t.common.async)return Promise.all([...t.data].map((o,a)=>s.type._parseAsync(new Js(t,o,t.path,a)))).then(o=>Nr.mergeArray(n,o));const i=[...t.data].map((o,a)=>s.type._parseSync(new Js(t,o,t.path,a)));return Nr.mergeArray(n,i)}get element(){return this._def.type}min(e,t){return new hs({...this._def,minLength:{value:e,message:me.toString(t)}})}max(e,t){return new hs({...this._def,maxLength:{value:e,message:me.toString(t)}})}length(e,t){return new hs({...this._def,exactLength:{value:e,message:me.toString(t)}})}nonempty(e){return this.min(1,e)}}hs.create=(r,e)=>new hs({type:r,minLength:null,maxLength:null,exactLength:null,typeName:ve.ZodArray,...Te(e)});function el(r){if(r instanceof Nt){const e={};for(const t in r.shape){const n=r.shape[t];e[t]=ki.create(el(n))}return new Nt({...r._def,shape:()=>e})}else return r instanceof hs?new hs({...r._def,type:el(r.element)}):r instanceof ki?ki.create(el(r.unwrap())):r instanceof oc?oc.create(el(r.unwrap())):r instanceof Ys?Ys.create(r.items.map(e=>el(e))):r}class Nt extends Be{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),t=Je.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==ie.object){const l=this._getOrReturnCtx(e);return le(l,{code:Y.invalid_type,expected:ie.object,received:l.parsedType}),Ie}const{status:n,ctx:s}=this._processInputParams(e),{shape:i,keys:o}=this._getCached(),a=[];if(!(this._def.catchall instanceof Li&&this._def.unknownKeys==="strip"))for(const l in s.data)o.includes(l)||a.push(l);const c=[];for(const l of o){const u=i[l],h=s.data[l];c.push({key:{status:"valid",value:l},value:u._parse(new Js(s,h,s.path,l)),alwaysSet:l in s.data})}if(this._def.catchall instanceof Li){const l=this._def.unknownKeys;if(l==="passthrough")for(const u of a)c.push({key:{status:"valid",value:u},value:{status:"valid",value:s.data[u]}});else if(l==="strict")a.length>0&&(le(s,{code:Y.unrecognized_keys,keys:a}),n.dirty());else if(l!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const l=this._def.catchall;for(const u of a){const h=s.data[u];c.push({key:{status:"valid",value:u},value:l._parse(new Js(s,h,s.path,u)),alwaysSet:u in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const l=[];for(const u of c){const h=await u.key;l.push({key:h,value:await u.value,alwaysSet:u.alwaysSet})}return l}).then(l=>Nr.mergeObjectSync(n,l)):Nr.mergeObjectSync(n,c)}get shape(){return this._def.shape()}strict(e){return me.errToObj,new Nt({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,n)=>{var s,i,o,a;const c=(o=(i=(s=this._def).errorMap)===null||i===void 0?void 0:i.call(s,t,n).message)!==null&&o!==void 0?o:n.defaultError;return t.code==="unrecognized_keys"?{message:(a=me.errToObj(e).message)!==null&&a!==void 0?a:c}:{message:c}}}:{}})}strip(){return new Nt({...this._def,unknownKeys:"strip"})}passthrough(){return new Nt({...this._def,unknownKeys:"passthrough"})}extend(e){return new Nt({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new Nt({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:ve.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new Nt({...this._def,catchall:e})}pick(e){const t={};return Je.objectKeys(e).forEach(n=>{e[n]&&this.shape[n]&&(t[n]=this.shape[n])}),new Nt({...this._def,shape:()=>t})}omit(e){const t={};return Je.objectKeys(this.shape).forEach(n=>{e[n]||(t[n]=this.shape[n])}),new Nt({...this._def,shape:()=>t})}deepPartial(){return el(this)}partial(e){const t={};return Je.objectKeys(this.shape).forEach(n=>{const s=this.shape[n];e&&!e[n]?t[n]=s:t[n]=s.optional()}),new Nt({...this._def,shape:()=>t})}required(e){const t={};return Je.objectKeys(this.shape).forEach(n=>{if(e&&!e[n])t[n]=this.shape[n];else{let i=this.shape[n];for(;i instanceof ki;)i=i._def.innerType;t[n]=i}}),new Nt({...this._def,shape:()=>t})}keyof(){return RI(Je.objectKeys(this.shape))}}Nt.create=(r,e)=>new Nt({shape:()=>r,unknownKeys:"strip",catchall:Li.create(),typeName:ve.ZodObject,...Te(e)});Nt.strictCreate=(r,e)=>new Nt({shape:()=>r,unknownKeys:"strict",catchall:Li.create(),typeName:ve.ZodObject,...Te(e)});Nt.lazycreate=(r,e)=>new Nt({shape:r,unknownKeys:"strip",catchall:Li.create(),typeName:ve.ZodObject,...Te(e)});class _d extends Be{_parse(e){const{ctx:t}=this._processInputParams(e),n=this._def.options;function s(i){for(const a of i)if(a.result.status==="valid")return a.result;for(const a of i)if(a.result.status==="dirty")return t.common.issues.push(...a.ctx.common.issues),a.result;const o=i.map(a=>new us(a.ctx.common.issues));return le(t,{code:Y.invalid_union,unionErrors:o}),Ie}if(t.common.async)return Promise.all(n.map(async i=>{const o={...t,common:{...t.common,issues:[]},parent:null};return{result:await i._parseAsync({data:t.data,path:t.path,parent:o}),ctx:o}})).then(s);{let i;const o=[];for(const c of n){const l={...t,common:{...t.common,issues:[]},parent:null},u=c._parseSync({data:t.data,path:t.path,parent:l});if(u.status==="valid")return u;u.status==="dirty"&&!i&&(i={result:u,ctx:l}),l.common.issues.length&&o.push(l.common.issues)}if(i)return t.common.issues.push(...i.ctx.common.issues),i.result;const a=o.map(c=>new us(c));return le(t,{code:Y.invalid_union,unionErrors:a}),Ie}}get options(){return this._def.options}}_d.create=(r,e)=>new _d({options:r,typeName:ve.ZodUnion,...Te(e)});const Ep=r=>r instanceof Sd?Ep(r.schema):r instanceof ds?Ep(r.innerType()):r instanceof xd?[r.value]:r instanceof Bo?r.options:r instanceof Td?Object.keys(r.enum):r instanceof Pd?Ep(r._def.innerType):r instanceof Ad?[void 0]:r instanceof Cd?[null]:null;class Gg extends Be{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==ie.object)return le(t,{code:Y.invalid_type,expected:ie.object,received:t.parsedType}),Ie;const n=this.discriminator,s=t.data[n],i=this.optionsMap.get(s);return i?t.common.async?i._parseAsync({data:t.data,path:t.path,parent:t}):i._parseSync({data:t.data,path:t.path,parent:t}):(le(t,{code:Y.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),Ie)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,n){const s=new Map;for(const i of t){const o=Ep(i.shape[e]);if(!o)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const a of o){if(s.has(a))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);s.set(a,i)}}return new Gg({typeName:ve.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:s,...Te(n)})}}function Rw(r,e){const t=oo(r),n=oo(e);if(r===e)return{valid:!0,data:r};if(t===ie.object&&n===ie.object){const s=Je.objectKeys(e),i=Je.objectKeys(r).filter(a=>s.indexOf(a)!==-1),o={...r,...e};for(const a of i){const c=Rw(r[a],e[a]);if(!c.valid)return{valid:!1};o[a]=c.data}return{valid:!0,data:o}}else if(t===ie.array&&n===ie.array){if(r.length!==e.length)return{valid:!1};const s=[];for(let i=0;i<r.length;i++){const o=r[i],a=e[i],c=Rw(o,a);if(!c.valid)return{valid:!1};s.push(c.data)}return{valid:!0,data:s}}else return t===ie.date&&n===ie.date&&+r==+e?{valid:!0,data:r}:{valid:!1}}class Nd extends Be{_parse(e){const{status:t,ctx:n}=this._processInputParams(e),s=(i,o)=>{if(Pw(i)||Pw(o))return Ie;const a=Rw(i.value,o.value);return a.valid?((Ow(i)||Ow(o))&&t.dirty(),{status:t.value,value:a.data}):(le(n,{code:Y.invalid_intersection_types}),Ie)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([i,o])=>s(i,o)):s(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}Nd.create=(r,e,t)=>new Nd({left:r,right:e,typeName:ve.ZodIntersection,...Te(t)});class Ys extends Be{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==ie.array)return le(n,{code:Y.invalid_type,expected:ie.array,received:n.parsedType}),Ie;if(n.data.length<this._def.items.length)return le(n,{code:Y.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Ie;!this._def.rest&&n.data.length>this._def.items.length&&(le(n,{code:Y.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const i=[...n.data].map((o,a)=>{const c=this._def.items[a]||this._def.rest;return c?c._parse(new Js(n,o,n.path,a)):null}).filter(o=>!!o);return n.common.async?Promise.all(i).then(o=>Nr.mergeArray(t,o)):Nr.mergeArray(t,i)}get items(){return this._def.items}rest(e){return new Ys({...this._def,rest:e})}}Ys.create=(r,e)=>{if(!Array.isArray(r))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Ys({items:r,typeName:ve.ZodTuple,rest:null,...Te(e)})};class Id extends Be{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==ie.object)return le(n,{code:Y.invalid_type,expected:ie.object,received:n.parsedType}),Ie;const s=[],i=this._def.keyType,o=this._def.valueType;for(const a in n.data)s.push({key:i._parse(new Js(n,a,n.path,a)),value:o._parse(new Js(n,n.data[a],n.path,a))});return n.common.async?Nr.mergeObjectAsync(t,s):Nr.mergeObjectSync(t,s)}get element(){return this._def.valueType}static create(e,t,n){return t instanceof Be?new Id({keyType:e,valueType:t,typeName:ve.ZodRecord,...Te(n)}):new Id({keyType:ls.create(),valueType:e,typeName:ve.ZodRecord,...Te(t)})}}class Zp extends Be{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==ie.map)return le(n,{code:Y.invalid_type,expected:ie.map,received:n.parsedType}),Ie;const s=this._def.keyType,i=this._def.valueType,o=[...n.data.entries()].map(([a,c],l)=>({key:s._parse(new Js(n,a,n.path,[l,"key"])),value:i._parse(new Js(n,c,n.path,[l,"value"]))}));if(n.common.async){const a=new Map;return Promise.resolve().then(async()=>{for(const c of o){const l=await c.key,u=await c.value;if(l.status==="aborted"||u.status==="aborted")return Ie;(l.status==="dirty"||u.status==="dirty")&&t.dirty(),a.set(l.value,u.value)}return{status:t.value,value:a}})}else{const a=new Map;for(const c of o){const l=c.key,u=c.value;if(l.status==="aborted"||u.status==="aborted")return Ie;(l.status==="dirty"||u.status==="dirty")&&t.dirty(),a.set(l.value,u.value)}return{status:t.value,value:a}}}}Zp.create=(r,e,t)=>new Zp({valueType:e,keyType:r,typeName:ve.ZodMap,...Te(t)});class ic extends Be{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==ie.set)return le(n,{code:Y.invalid_type,expected:ie.set,received:n.parsedType}),Ie;const s=this._def;s.minSize!==null&&n.data.size<s.minSize.value&&(le(n,{code:Y.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),t.dirty()),s.maxSize!==null&&n.data.size>s.maxSize.value&&(le(n,{code:Y.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),t.dirty());const i=this._def.valueType;function o(c){const l=new Set;for(const u of c){if(u.status==="aborted")return Ie;u.status==="dirty"&&t.dirty(),l.add(u.value)}return{status:t.value,value:l}}const a=[...n.data.values()].map((c,l)=>i._parse(new Js(n,c,n.path,l)));return n.common.async?Promise.all(a).then(c=>o(c)):o(a)}min(e,t){return new ic({...this._def,minSize:{value:e,message:me.toString(t)}})}max(e,t){return new ic({...this._def,maxSize:{value:e,message:me.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}ic.create=(r,e)=>new ic({valueType:r,minSize:null,maxSize:null,typeName:ve.ZodSet,...Te(e)});class pl extends Be{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==ie.function)return le(t,{code:Y.invalid_type,expected:ie.function,received:t.parsedType}),Ie;function n(a,c){return Kp({data:a,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Gp(),bd].filter(l=>!!l),issueData:{code:Y.invalid_arguments,argumentsError:c}})}function s(a,c){return Kp({data:a,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Gp(),bd].filter(l=>!!l),issueData:{code:Y.invalid_return_type,returnTypeError:c}})}const i={errorMap:t.common.contextualErrorMap},o=t.data;if(this._def.returns instanceof Cu){const a=this;return Br(async function(...c){const l=new us([]),u=await a._def.args.parseAsync(c,i).catch(f=>{throw l.addIssue(n(c,f)),l}),h=await Reflect.apply(o,this,u);return await a._def.returns._def.type.parseAsync(h,i).catch(f=>{throw l.addIssue(s(h,f)),l})})}else{const a=this;return Br(function(...c){const l=a._def.args.safeParse(c,i);if(!l.success)throw new us([n(c,l.error)]);const u=Reflect.apply(o,this,l.data),h=a._def.returns.safeParse(u,i);if(!h.success)throw new us([s(u,h.error)]);return h.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new pl({...this._def,args:Ys.create(e).rest(Va.create())})}returns(e){return new pl({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,n){return new pl({args:e||Ys.create([]).rest(Va.create()),returns:t||Va.create(),typeName:ve.ZodFunction,...Te(n)})}}class Sd extends Be{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}Sd.create=(r,e)=>new Sd({getter:r,typeName:ve.ZodLazy,...Te(e)});class xd extends Be{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return le(t,{received:t.data,code:Y.invalid_literal,expected:this._def.value}),Ie}return{status:"valid",value:e.data}}get value(){return this._def.value}}xd.create=(r,e)=>new xd({value:r,typeName:ve.ZodLiteral,...Te(e)});function RI(r,e){return new Bo({values:r,typeName:ve.ZodEnum,...Te(e)})}class Bo extends Be{_parse(e){if(typeof e.data!="string"){const t=this._getOrReturnCtx(e),n=this._def.values;return le(t,{expected:Je.joinValues(n),received:t.parsedType,code:Y.invalid_type}),Ie}if(this._def.values.indexOf(e.data)===-1){const t=this._getOrReturnCtx(e),n=this._def.values;return le(t,{received:t.data,code:Y.invalid_enum_value,options:n}),Ie}return Br(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e){return Bo.create(e)}exclude(e){return Bo.create(this.options.filter(t=>!e.includes(t)))}}Bo.create=RI;class Td extends Be{_parse(e){const t=Je.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==ie.string&&n.parsedType!==ie.number){const s=Je.objectValues(t);return le(n,{expected:Je.joinValues(s),received:n.parsedType,code:Y.invalid_type}),Ie}if(t.indexOf(e.data)===-1){const s=Je.objectValues(t);return le(n,{received:n.data,code:Y.invalid_enum_value,options:s}),Ie}return Br(e.data)}get enum(){return this._def.values}}Td.create=(r,e)=>new Td({values:r,typeName:ve.ZodNativeEnum,...Te(e)});class Cu extends Be{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==ie.promise&&t.common.async===!1)return le(t,{code:Y.invalid_type,expected:ie.promise,received:t.parsedType}),Ie;const n=t.parsedType===ie.promise?t.data:Promise.resolve(t.data);return Br(n.then(s=>this._def.type.parseAsync(s,{path:t.path,errorMap:t.common.contextualErrorMap})))}}Cu.create=(r,e)=>new Cu({type:r,typeName:ve.ZodPromise,...Te(e)});class ds extends Be{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===ve.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:n}=this._processInputParams(e),s=this._def.effect||null,i={addIssue:o=>{le(n,o),o.fatal?t.abort():t.dirty()},get path(){return n.path}};if(i.addIssue=i.addIssue.bind(i),s.type==="preprocess"){const o=s.transform(n.data,i);return n.common.issues.length?{status:"dirty",value:n.data}:n.common.async?Promise.resolve(o).then(a=>this._def.schema._parseAsync({data:a,path:n.path,parent:n})):this._def.schema._parseSync({data:o,path:n.path,parent:n})}if(s.type==="refinement"){const o=a=>{const c=s.refinement(a,i);if(n.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(n.common.async===!1){const a=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return a.status==="aborted"?Ie:(a.status==="dirty"&&t.dirty(),o(a.value),{status:t.value,value:a.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(a=>a.status==="aborted"?Ie:(a.status==="dirty"&&t.dirty(),o(a.value).then(()=>({status:t.value,value:a.value}))))}if(s.type==="transform")if(n.common.async===!1){const o=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!Ed(o))return o;const a=s.transform(o.value,i);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:a}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(o=>Ed(o)?Promise.resolve(s.transform(o.value,i)).then(a=>({status:t.value,value:a})):o);Je.assertNever(s)}}ds.create=(r,e,t)=>new ds({schema:r,typeName:ve.ZodEffects,effect:e,...Te(t)});ds.createWithPreprocess=(r,e,t)=>new ds({schema:e,effect:{type:"preprocess",transform:r},typeName:ve.ZodEffects,...Te(t)});class ki extends Be{_parse(e){return this._getType(e)===ie.undefined?Br(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}ki.create=(r,e)=>new ki({innerType:r,typeName:ve.ZodOptional,...Te(e)});class oc extends Be{_parse(e){return this._getType(e)===ie.null?Br(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}oc.create=(r,e)=>new oc({innerType:r,typeName:ve.ZodNullable,...Te(e)});class Pd extends Be{_parse(e){const{ctx:t}=this._processInputParams(e);let n=t.data;return t.parsedType===ie.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}Pd.create=(r,e)=>new Pd({innerType:r,typeName:ve.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Te(e)});class Xp extends Be{_parse(e){const{ctx:t}=this._processInputParams(e),n={...t,common:{...t.common,issues:[]}},s=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return Jp(s)?s.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new us(n.common.issues)},input:n.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new us(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}Xp.create=(r,e)=>new Xp({innerType:r,typeName:ve.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Te(e)});class eg extends Be{_parse(e){if(this._getType(e)!==ie.nan){const n=this._getOrReturnCtx(e);return le(n,{code:Y.invalid_type,expected:ie.nan,received:n.parsedType}),Ie}return{status:"valid",value:e.data}}}eg.create=r=>new eg({typeName:ve.ZodNaN,...Te(r)});const R9=Symbol("zod_brand");class DI extends Be{_parse(e){const{ctx:t}=this._processInputParams(e),n=t.data;return this._def.type._parse({data:n,path:t.path,parent:t})}unwrap(){return this._def.type}}class bf extends Be{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return i.status==="aborted"?Ie:i.status==="dirty"?(t.dirty(),OI(i.value)):this._def.out._parseAsync({data:i.value,path:n.path,parent:n})})();{const s=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return s.status==="aborted"?Ie:s.status==="dirty"?(t.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:n.path,parent:n})}}static create(e,t){return new bf({in:e,out:t,typeName:ve.ZodPipeline})}}class tg extends Be{_parse(e){const t=this._def.innerType._parse(e);return Ed(t)&&(t.value=Object.freeze(t.value)),t}}tg.create=(r,e)=>new tg({innerType:r,typeName:ve.ZodReadonly,...Te(e)});const kI=(r,e={},t)=>r?Au.create().superRefine((n,s)=>{var i,o;if(!r(n)){const a=typeof e=="function"?e(n):typeof e=="string"?{message:e}:e,c=(o=(i=a.fatal)!==null&&i!==void 0?i:t)!==null&&o!==void 0?o:!0,l=typeof a=="string"?{message:a}:a;s.addIssue({code:"custom",...l,fatal:c})}}):Au.create(),D9={object:Nt.lazycreate};var ve;(function(r){r.ZodString="ZodString",r.ZodNumber="ZodNumber",r.ZodNaN="ZodNaN",r.ZodBigInt="ZodBigInt",r.ZodBoolean="ZodBoolean",r.ZodDate="ZodDate",r.ZodSymbol="ZodSymbol",r.ZodUndefined="ZodUndefined",r.ZodNull="ZodNull",r.ZodAny="ZodAny",r.ZodUnknown="ZodUnknown",r.ZodNever="ZodNever",r.ZodVoid="ZodVoid",r.ZodArray="ZodArray",r.ZodObject="ZodObject",r.ZodUnion="ZodUnion",r.ZodDiscriminatedUnion="ZodDiscriminatedUnion",r.ZodIntersection="ZodIntersection",r.ZodTuple="ZodTuple",r.ZodRecord="ZodRecord",r.ZodMap="ZodMap",r.ZodSet="ZodSet",r.ZodFunction="ZodFunction",r.ZodLazy="ZodLazy",r.ZodLiteral="ZodLiteral",r.ZodEnum="ZodEnum",r.ZodEffects="ZodEffects",r.ZodNativeEnum="ZodNativeEnum",r.ZodOptional="ZodOptional",r.ZodNullable="ZodNullable",r.ZodDefault="ZodDefault",r.ZodCatch="ZodCatch",r.ZodPromise="ZodPromise",r.ZodBranded="ZodBranded",r.ZodPipeline="ZodPipeline",r.ZodReadonly="ZodReadonly"})(ve||(ve={}));const k9=(r,e={message:`Input not instance of ${r.name}`})=>kI(t=>t instanceof r,e),UI=ls.create,BI=ko.create,U9=eg.create,B9=Uo.create,LI=vd.create,L9=sc.create,$9=Yp.create,M9=Ad.create,F9=Cd.create,j9=Au.create,H9=Va.create,z9=Li.create,q9=Qp.create,V9=hs.create,W9=Nt.create,G9=Nt.strictCreate,K9=_d.create,J9=Gg.create,Y9=Nd.create,Q9=Ys.create,Z9=Id.create,X9=Zp.create,e7=ic.create,t7=pl.create,r7=Sd.create,n7=xd.create,s7=Bo.create,i7=Td.create,o7=Cu.create,KA=ds.create,a7=ki.create,c7=oc.create,l7=ds.createWithPreprocess,u7=bf.create,h7=()=>UI().optional(),d7=()=>BI().optional(),f7=()=>LI().optional(),p7={string:r=>ls.create({...r,coerce:!0}),number:r=>ko.create({...r,coerce:!0}),boolean:r=>vd.create({...r,coerce:!0}),bigint:r=>Uo.create({...r,coerce:!0}),date:r=>sc.create({...r,coerce:!0})},g7=Ie;var C=Object.freeze({__proto__:null,defaultErrorMap:bd,setErrorMap:b9,getErrorMap:Gp,makeIssue:Kp,EMPTY_PATH:E9,addIssueToContext:le,ParseStatus:Nr,INVALID:Ie,DIRTY:OI,OK:Br,isAborted:Pw,isDirty:Ow,isValid:Ed,isAsync:Jp,get util(){return Je},get objectUtil(){return Tw},ZodParsedType:ie,getParsedType:oo,ZodType:Be,ZodString:ls,ZodNumber:ko,ZodBigInt:Uo,ZodBoolean:vd,ZodDate:sc,ZodSymbol:Yp,ZodUndefined:Ad,ZodNull:Cd,ZodAny:Au,ZodUnknown:Va,ZodNever:Li,ZodVoid:Qp,ZodArray:hs,ZodObject:Nt,ZodUnion:_d,ZodDiscriminatedUnion:Gg,ZodIntersection:Nd,ZodTuple:Ys,ZodRecord:Id,ZodMap:Zp,ZodSet:ic,ZodFunction:pl,ZodLazy:Sd,ZodLiteral:xd,ZodEnum:Bo,ZodNativeEnum:Td,ZodPromise:Cu,ZodEffects:ds,ZodTransformer:ds,ZodOptional:ki,ZodNullable:oc,ZodDefault:Pd,ZodCatch:Xp,ZodNaN:eg,BRAND:R9,ZodBranded:DI,ZodPipeline:bf,ZodReadonly:tg,custom:kI,Schema:Be,ZodSchema:Be,late:D9,get ZodFirstPartyTypeKind(){return ve},coerce:p7,any:j9,array:V9,bigint:B9,boolean:LI,date:L9,discriminatedUnion:J9,effect:KA,enum:s7,function:t7,instanceof:k9,intersection:Y9,lazy:r7,literal:n7,map:X9,nan:U9,nativeEnum:i7,never:z9,null:F9,nullable:c7,number:BI,object:W9,oboolean:f7,onumber:d7,optional:a7,ostring:h7,pipeline:u7,preprocess:l7,promise:o7,record:Z9,set:e7,strictObject:G9,string:UI,symbol:$9,transformer:KA,tuple:Q9,undefined:M9,union:K9,unknown:H9,void:q9,NEVER:g7,ZodIssueCode:Y,quotelessJson:w9,ZodError:us});const xt=C.object({message:C.string()});function ae(r){return C.literal(fe[r])}C.object({accessList:C.array(C.string()),blockHash:C.string().nullable(),blockNumber:C.string().nullable(),chainId:C.string().or(C.number()),from:C.string(),gas:C.string(),hash:C.string(),input:C.string().nullable(),maxFeePerGas:C.string(),maxPriorityFeePerGas:C.string(),nonce:C.string(),r:C.string(),s:C.string(),to:C.string(),transactionIndex:C.string().nullable(),type:C.string(),v:C.string(),value:C.string()});const m7=C.object({chainId:C.string().or(C.number())}),y7=C.object({email:C.string().email()}),w7=C.object({otp:C.string()}),b7=C.object({uri:C.string()}),E7=C.object({chainId:C.optional(C.string().or(C.number())),preferredAccountType:C.optional(C.string())}),v7=C.object({provider:C.enum(["google","github","apple","facebook","x","discord"])}),A7=C.object({email:C.string().email()}),C7=C.object({otp:C.string()}),_7=C.object({otp:C.string()}),N7=C.object({themeMode:C.optional(C.enum(["light","dark"])),themeVariables:C.optional(C.record(C.string(),C.string().or(C.number()))),w3mThemeVariables:C.optional(C.record(C.string(),C.string()))}),I7=C.object({metadata:C.object({name:C.string(),description:C.string(),url:C.string(),icons:C.array(C.string())}).optional(),sdkVersion:C.string().optional(),sdkType:C.string().optional(),projectId:C.string()}),S7=C.object({type:C.string()}),x7=C.object({action:C.enum(["VERIFY_DEVICE","VERIFY_OTP","CONNECT"])}),T7=C.object({url:C.string()}),P7=C.object({userName:C.string()}),O7=C.object({email:C.string().optional().nullable(),address:C.string(),chainId:C.string().or(C.number()),accounts:C.array(C.object({address:C.string(),type:C.enum([dr.ACCOUNT_TYPES.EOA,dr.ACCOUNT_TYPES.SMART_ACCOUNT])})).optional(),userName:C.string().optional().nullable()}),R7=C.object({action:C.enum(["VERIFY_PRIMARY_OTP","VERIFY_SECONDARY_OTP"])}),D7=C.object({email:C.string().email().optional().nullable(),address:C.string(),chainId:C.string().or(C.number()),smartAccountDeployed:C.optional(C.boolean()),accounts:C.array(C.object({address:C.string(),type:C.enum([dr.ACCOUNT_TYPES.EOA,dr.ACCOUNT_TYPES.SMART_ACCOUNT])})).optional(),preferredAccountType:C.optional(C.string())}),k7=C.object({uri:C.string()}),U7=C.object({isConnected:C.boolean()}),B7=C.object({chainId:C.string().or(C.number())}),L7=C.object({chainId:C.string().or(C.number())}),$7=C.object({newEmail:C.string().email()}),M7=C.object({smartAccountEnabledNetworks:C.array(C.number())});C.object({address:C.string(),isDeployed:C.boolean()});const F7=C.object({version:C.string().optional()}),j7=C.object({type:C.string(),address:C.string()}),H7=C.any(),z7=C.object({method:C.literal("eth_accounts")}),q7=C.object({method:C.literal("eth_blockNumber")}),V7=C.object({method:C.literal("eth_call"),params:C.array(C.any())}),W7=C.object({method:C.literal("eth_chainId")}),G7=C.object({method:C.literal("eth_estimateGas"),params:C.array(C.any())}),K7=C.object({method:C.literal("eth_feeHistory"),params:C.array(C.any())}),J7=C.object({method:C.literal("eth_gasPrice")}),Y7=C.object({method:C.literal("eth_getAccount"),params:C.array(C.any())}),Q7=C.object({method:C.literal("eth_getBalance"),params:C.array(C.any())}),Z7=C.object({method:C.literal("eth_getBlockByHash"),params:C.array(C.any())}),X7=C.object({method:C.literal("eth_getBlockByNumber"),params:C.array(C.any())}),eH=C.object({method:C.literal("eth_getBlockReceipts"),params:C.array(C.any())}),tH=C.object({method:C.literal("eth_getBlockTransactionCountByHash"),params:C.array(C.any())}),rH=C.object({method:C.literal("eth_getBlockTransactionCountByNumber"),params:C.array(C.any())}),nH=C.object({method:C.literal("eth_getCode"),params:C.array(C.any())}),sH=C.object({method:C.literal("eth_getFilterChanges"),params:C.array(C.any())}),iH=C.object({method:C.literal("eth_getFilterLogs"),params:C.array(C.any())}),oH=C.object({method:C.literal("eth_getLogs"),params:C.array(C.any())}),aH=C.object({method:C.literal("eth_getProof"),params:C.array(C.any())}),cH=C.object({method:C.literal("eth_getStorageAt"),params:C.array(C.any())}),lH=C.object({method:C.literal("eth_getTransactionByBlockHashAndIndex"),params:C.array(C.any())}),uH=C.object({method:C.literal("eth_getTransactionByBlockNumberAndIndex"),params:C.array(C.any())}),hH=C.object({method:C.literal("eth_getTransactionByHash"),params:C.array(C.any())}),dH=C.object({method:C.literal("eth_getTransactionCount"),params:C.array(C.any())}),fH=C.object({method:C.literal("eth_getTransactionReceipt"),params:C.array(C.any())}),pH=C.object({method:C.literal("eth_getUncleCountByBlockHash"),params:C.array(C.any())}),gH=C.object({method:C.literal("eth_getUncleCountByBlockNumber"),params:C.array(C.any())}),mH=C.object({method:C.literal("eth_maxPriorityFeePerGas")}),yH=C.object({method:C.literal("eth_newBlockFilter")}),wH=C.object({method:C.literal("eth_newFilter"),params:C.array(C.any())}),bH=C.object({method:C.literal("eth_newPendingTransactionFilter")}),EH=C.object({method:C.literal("eth_sendRawTransaction"),params:C.array(C.any())}),vH=C.object({method:C.literal("eth_syncing"),params:C.array(C.any())}),AH=C.object({method:C.literal("eth_uninstallFilter"),params:C.array(C.any())}),JA=C.object({method:C.literal("personal_sign"),params:C.array(C.any())}),CH=C.object({method:C.literal("eth_signTypedData_v4"),params:C.array(C.any())}),_H=C.object({method:C.literal("eth_sendTransaction"),params:C.array(C.any())}),NH=C.object({method:C.literal("solana_signMessage"),params:C.object({message:C.string(),pubkey:C.string()})}),IH=C.object({method:C.literal("solana_signTransaction"),params:C.object({transaction:C.string()})}),SH=C.object({method:C.literal("solana_signAllTransactions"),params:C.object({transactions:C.array(C.string())})}),xH=C.object({method:C.literal("solana_signAndSendTransaction"),params:C.object({transaction:C.string(),options:C.object({skipPreflight:C.boolean().optional(),preflightCommitment:C.enum(["processed","confirmed","finalized","recent","single","singleGossip","root","max"]).optional(),maxRetries:C.number().optional(),minContextSlot:C.number().optional()}).optional()})}),TH=C.object({method:C.literal("wallet_sendCalls"),params:C.array(C.object({chainId:C.string().or(C.number()).optional(),from:C.string().optional(),version:C.string().optional(),capabilities:C.any().optional(),calls:C.array(C.object({to:C.string().startsWith("0x"),data:C.string().startsWith("0x").optional(),value:C.string().optional()}))}))}),PH=C.object({method:C.literal("wallet_getCallsStatus"),params:C.array(C.string())}),OH=C.object({method:C.literal("wallet_getCapabilities")}),RH=C.object({method:C.literal("wallet_grantPermissions"),params:C.array(C.any())}),DH=C.object({method:C.literal("wallet_revokePermissions"),params:C.any()}),kH=C.object({method:C.literal("wallet_getAssets"),params:C.any()}),YA=C.object({token:C.string()}),ce=C.object({id:C.string().optional()}),fh={appEvent:ce.extend({type:ae("APP_SWITCH_NETWORK"),payload:m7}).or(ce.extend({type:ae("APP_CONNECT_EMAIL"),payload:y7})).or(ce.extend({type:ae("APP_CONNECT_DEVICE")})).or(ce.extend({type:ae("APP_CONNECT_OTP"),payload:w7})).or(ce.extend({type:ae("APP_CONNECT_SOCIAL"),payload:b7})).or(ce.extend({type:ae("APP_GET_FARCASTER_URI")})).or(ce.extend({type:ae("APP_CONNECT_FARCASTER")})).or(ce.extend({type:ae("APP_GET_USER"),payload:C.optional(E7)})).or(ce.extend({type:ae("APP_GET_SOCIAL_REDIRECT_URI"),payload:v7})).or(ce.extend({type:ae("APP_SIGN_OUT")})).or(ce.extend({type:ae("APP_IS_CONNECTED"),payload:C.optional(YA)})).or(ce.extend({type:ae("APP_GET_CHAIN_ID")})).or(ce.extend({type:ae("APP_GET_SMART_ACCOUNT_ENABLED_NETWORKS")})).or(ce.extend({type:ae("APP_INIT_SMART_ACCOUNT")})).or(ce.extend({type:ae("APP_SET_PREFERRED_ACCOUNT"),payload:S7})).or(ce.extend({type:ae("APP_RPC_REQUEST"),payload:JA.or(kH).or(z7).or(q7).or(V7).or(W7).or(G7).or(K7).or(J7).or(Y7).or(Q7).or(Z7).or(X7).or(eH).or(tH).or(rH).or(nH).or(sH).or(iH).or(oH).or(aH).or(cH).or(lH).or(uH).or(hH).or(dH).or(fH).or(pH).or(gH).or(mH).or(yH).or(wH).or(bH).or(EH).or(vH).or(AH).or(JA).or(CH).or(_H).or(NH).or(IH).or(SH).or(xH).or(PH).or(TH).or(OH).or(RH).or(DH)})).or(ce.extend({type:ae("APP_UPDATE_EMAIL"),payload:A7})).or(ce.extend({type:ae("APP_UPDATE_EMAIL_PRIMARY_OTP"),payload:C7})).or(ce.extend({type:ae("APP_UPDATE_EMAIL_SECONDARY_OTP"),payload:_7})).or(ce.extend({type:ae("APP_SYNC_THEME"),payload:N7})).or(ce.extend({type:ae("APP_SYNC_DAPP_DATA"),payload:I7})).or(ce.extend({type:ae("APP_RELOAD")})),frameEvent:ce.extend({type:ae("FRAME_SWITCH_NETWORK_ERROR"),payload:xt}).or(ce.extend({type:ae("FRAME_SWITCH_NETWORK_SUCCESS"),payload:L7})).or(ce.extend({type:ae("FRAME_CONNECT_EMAIL_SUCCESS"),payload:x7})).or(ce.extend({type:ae("FRAME_CONNECT_EMAIL_ERROR"),payload:xt})).or(ce.extend({type:ae("FRAME_GET_FARCASTER_URI_SUCCESS"),payload:T7})).or(ce.extend({type:ae("FRAME_GET_FARCASTER_URI_ERROR"),payload:xt})).or(ce.extend({type:ae("FRAME_CONNECT_FARCASTER_SUCCESS"),payload:P7})).or(ce.extend({type:ae("FRAME_CONNECT_FARCASTER_ERROR"),payload:xt})).or(ce.extend({type:ae("FRAME_CONNECT_OTP_ERROR"),payload:xt})).or(ce.extend({type:ae("FRAME_CONNECT_OTP_SUCCESS")})).or(ce.extend({type:ae("FRAME_CONNECT_DEVICE_ERROR"),payload:xt})).or(ce.extend({type:ae("FRAME_CONNECT_DEVICE_SUCCESS")})).or(ce.extend({type:ae("FRAME_CONNECT_SOCIAL_SUCCESS"),payload:O7})).or(ce.extend({type:ae("FRAME_CONNECT_SOCIAL_ERROR"),payload:xt})).or(ce.extend({type:ae("FRAME_GET_USER_ERROR"),payload:xt})).or(ce.extend({type:ae("FRAME_GET_USER_SUCCESS"),payload:D7})).or(ce.extend({type:ae("FRAME_GET_SOCIAL_REDIRECT_URI_ERROR"),payload:xt})).or(ce.extend({type:ae("FRAME_GET_SOCIAL_REDIRECT_URI_SUCCESS"),payload:k7})).or(ce.extend({type:ae("FRAME_SIGN_OUT_ERROR"),payload:xt})).or(ce.extend({type:ae("FRAME_SIGN_OUT_SUCCESS")})).or(ce.extend({type:ae("FRAME_IS_CONNECTED_ERROR"),payload:xt})).or(ce.extend({type:ae("FRAME_IS_CONNECTED_SUCCESS"),payload:U7})).or(ce.extend({type:ae("FRAME_GET_CHAIN_ID_ERROR"),payload:xt})).or(ce.extend({type:ae("FRAME_GET_CHAIN_ID_SUCCESS"),payload:B7})).or(ce.extend({type:ae("FRAME_RPC_REQUEST_ERROR"),payload:xt})).or(ce.extend({type:ae("FRAME_RPC_REQUEST_SUCCESS"),payload:H7})).or(ce.extend({type:ae("FRAME_SESSION_UPDATE"),payload:YA})).or(ce.extend({type:ae("FRAME_UPDATE_EMAIL_ERROR"),payload:xt})).or(ce.extend({type:ae("FRAME_UPDATE_EMAIL_SUCCESS"),payload:R7})).or(ce.extend({type:ae("FRAME_UPDATE_EMAIL_PRIMARY_OTP_ERROR"),payload:xt})).or(ce.extend({type:ae("FRAME_UPDATE_EMAIL_PRIMARY_OTP_SUCCESS")})).or(ce.extend({type:ae("FRAME_UPDATE_EMAIL_SECONDARY_OTP_ERROR"),payload:xt})).or(ce.extend({type:ae("FRAME_UPDATE_EMAIL_SECONDARY_OTP_SUCCESS"),payload:$7})).or(ce.extend({type:ae("FRAME_SYNC_THEME_ERROR"),payload:xt})).or(ce.extend({type:ae("FRAME_SYNC_THEME_SUCCESS")})).or(ce.extend({type:ae("FRAME_SYNC_DAPP_DATA_ERROR"),payload:xt})).or(ce.extend({type:ae("FRAME_SYNC_DAPP_DATA_SUCCESS")})).or(ce.extend({type:ae("FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS"),payload:M7})).or(ce.extend({type:ae("FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR"),payload:xt})).or(ce.extend({type:ae("FRAME_INIT_SMART_ACCOUNT_ERROR"),payload:xt})).or(ce.extend({type:ae("FRAME_SET_PREFERRED_ACCOUNT_SUCCESS"),payload:j7})).or(ce.extend({type:ae("FRAME_SET_PREFERRED_ACCOUNT_ERROR"),payload:xt})).or(ce.extend({type:ae("FRAME_READY"),payload:F7})).or(ce.extend({type:ae("FRAME_RELOAD_ERROR"),payload:xt})).or(ce.extend({type:ae("FRAME_RELOAD_SUCCESS")}))};function fy(r,e={}){var t;return typeof(e==null?void 0:e.type)=="string"&&((t=e==null?void 0:e.type)==null?void 0:t.includes(r))}class UH{constructor({projectId:e,isAppClient:t=!1,chainId:n="eip155:1",enableLogger:s=!0}){if(this.iframe=null,this.iframeIsReady=!1,this.rpcUrl=ee.BLOCKCHAIN_API_RPC_URL,this.initFrame=()=>{const i=document.getElementById("w3m-iframe");this.iframe&&!i&&document.body.appendChild(this.iframe)},this.events={registerFrameEventHandler:(i,o,a)=>{function c({data:l}){if(!fy(fe.FRAME_EVENT_KEY,l))return;const u=fh.frameEvent.parse(l);u.id===i&&(o(u),window.removeEventListener("message",c))}yn.isClient&&(window.addEventListener("message",c),a.addEventListener("abort",()=>{window.removeEventListener("message",c)}))},onFrameEvent:i=>{yn.isClient&&window.addEventListener("message",({data:o})=>{if(!fy(fe.FRAME_EVENT_KEY,o))return;const a=fh.frameEvent.parse(o);i(a)})},onAppEvent:i=>{yn.isClient&&window.addEventListener("message",({data:o})=>{if(!fy(fe.APP_EVENT_KEY,o))return;const a=fh.appEvent.parse(o);i(a)})},postAppEvent:i=>{var o;if(yn.isClient){if(!((o=this.iframe)!=null&&o.contentWindow))throw new Error("W3mFrame: iframe is not set");fh.appEvent.parse(i),this.iframe.contentWindow.postMessage(i,"*")}},postFrameEvent:i=>{if(yn.isClient){if(!parent)throw new Error("W3mFrame: parent is not set");fh.frameEvent.parse(i),parent.postMessage(i,"*")}}},this.projectId=e,this.frameLoadPromise=new Promise((i,o)=>{this.frameLoadPromiseResolver={resolve:i,reject:o}}),t&&(this.frameLoadPromise=new Promise((i,o)=>{this.frameLoadPromiseResolver={resolve:i,reject:o}}),yn.isClient)){const i=document.createElement("iframe");i.id="w3m-iframe",i.src=`${bj}?projectId=${e}&chainId=${n}&version=${vj}&enableLogger=${s}`,i.name="w3m-secure-iframe",i.style.position="fixed",i.style.zIndex="999999",i.style.display="none",i.style.border="none",i.style.animationDelay="0s, 50ms",i.style.borderBottomLeftRadius="clamp(0px, var(--wui-border-radius-l), 44px)",i.style.borderBottomRightRadius="clamp(0px, var(--wui-border-radius-l), 44px)",this.iframe=i,this.iframe.onerror=()=>{var o;(o=this.frameLoadPromiseResolver)==null||o.reject("Unable to load email login dependency")},this.events.onFrameEvent(o=>{var a;o.type==="@w3m-frame/READY"&&(this.iframeIsReady=!0,(a=this.frameLoadPromiseResolver)==null||a.resolve(void 0))})}}get networks(){const e=["eip155:1","eip155:5","eip155:11155111","eip155:10","eip155:420","eip155:42161","eip155:421613","eip155:137","eip155:80001","eip155:42220","eip155:1313161554","eip155:1313161555","eip155:56","eip155:97","eip155:43114","eip155:43113","eip155:324","eip155:280","eip155:100","eip155:8453","eip155:84531","eip155:84532","eip155:7777777","eip155:999","solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1"].map(t=>({[t]:{rpcUrl:`${this.rpcUrl}/v1/?chainId=${t}&projectId=${this.projectId}`,chainId:t}}));return Object.assign({},...e)}}class BH{constructor(e){var i;const t=Bu({level:Ej}),{logger:n,chunkLoggerController:s}=Cb({opts:t});this.logger=Ir(n,this.constructor.name),this.chunkLoggerController=s,typeof window<"u"&&((i=this.chunkLoggerController)!=null&&i.downloadLogsBlobInBrowser)&&(window.downloadAppKitLogsBlob||(window.downloadAppKitLogsBlob={}),window.downloadAppKitLogsBlob.sdk=()=>{var o;(o=this.chunkLoggerController)!=null&&o.downloadLogsBlobInBrowser&&this.chunkLoggerController.downloadLogsBlobInBrowser({projectId:e})})}}class LH{constructor({projectId:e,chainId:t,enableLogger:n=!0,onTimeout:s,abortController:i}){this.openRpcRequests=[],n&&(this.w3mLogger=new BH(e)),this.abortController=i,this.w3mFrame=new UH({projectId:e,isAppClient:!0,chainId:t,enableLogger:n}),this.onTimeout=s,this.getLoginEmailUsed()&&this.w3mFrame.initFrame(),this.initPromise=new Promise(o=>{this.w3mFrame.events.onFrameEvent(async a=>{a.type===fe.FRAME_READY&&(this.initPromise=void 0,await new Promise(c=>{setTimeout(c,500)}),o())})})}async init(){this.w3mFrame.initFrame(),this.initPromise&&await this.initPromise}getLoginEmailUsed(){return!!ir.get(fe.EMAIL_LOGIN_USED_KEY)}getEmail(){return ir.get(fe.EMAIL)}getUsername(){return ir.get(fe.SOCIAL_USERNAME)}async reload(){var e;try{this.w3mFrame.initFrame(),await this.appEvent({type:fe.APP_RELOAD})}catch(t){throw(e=this.w3mLogger)==null||e.logger.error({error:t},"Error reloading iframe"),t}}async connectEmail(e){var t;try{yn.checkIfAllowedToTriggerEmail(),this.w3mFrame.initFrame();const n=await this.appEvent({type:fe.APP_CONNECT_EMAIL,payload:e});return this.setNewLastEmailLoginTime(),n}catch(n){throw(t=this.w3mLogger)==null||t.logger.error({error:n},"Error connecting email"),n}}async connectDevice(){var e;try{return this.appEvent({type:fe.APP_CONNECT_DEVICE})}catch(t){throw(e=this.w3mLogger)==null||e.logger.error({error:t},"Error connecting device"),t}}async connectOtp(e){var t;try{return this.appEvent({type:fe.APP_CONNECT_OTP,payload:e})}catch(n){throw(t=this.w3mLogger)==null||t.logger.error({error:n},"Error connecting otp"),n}}async isConnected(){var e;try{if(!this.getLoginEmailUsed())return{isConnected:!1};const t=await this.appEvent({type:fe.APP_IS_CONNECTED});return t!=null&&t.isConnected||this.deleteAuthLoginCache(),t}catch(t){throw this.deleteAuthLoginCache(),(e=this.w3mLogger)==null||e.logger.error({error:t},"Error checking connection"),t}}async getChainId(){var e;try{const t=await this.appEvent({type:fe.APP_GET_CHAIN_ID});return this.setLastUsedChainId(t.chainId),t}catch(t){throw(e=this.w3mLogger)==null||e.logger.error({error:t},"Error getting chain id"),t}}async getSocialRedirectUri(e){var t;try{return this.w3mFrame.initFrame(),this.appEvent({type:fe.APP_GET_SOCIAL_REDIRECT_URI,payload:e})}catch(n){throw(t=this.w3mLogger)==null||t.logger.error({error:n},"Error getting social redirect uri"),n}}async updateEmail(e){var t;try{const n=await this.appEvent({type:fe.APP_UPDATE_EMAIL,payload:e});return this.setNewLastEmailLoginTime(),n}catch(n){throw(t=this.w3mLogger)==null||t.logger.error({error:n},"Error updating email"),n}}async updateEmailPrimaryOtp(e){var t;try{return this.appEvent({type:fe.APP_UPDATE_EMAIL_PRIMARY_OTP,payload:e})}catch(n){throw(t=this.w3mLogger)==null||t.logger.error({error:n},"Error updating email primary otp"),n}}async updateEmailSecondaryOtp(e){var t;try{const n=await this.appEvent({type:fe.APP_UPDATE_EMAIL_SECONDARY_OTP,payload:e});return this.setLoginSuccess(n.newEmail),n}catch(n){throw(t=this.w3mLogger)==null||t.logger.error({error:n},"Error updating email secondary otp"),n}}async syncTheme(e){var t;try{return this.appEvent({type:fe.APP_SYNC_THEME,payload:e})}catch(n){throw(t=this.w3mLogger)==null||t.logger.error({error:n},"Error syncing theme"),n}}async syncDappData(e){var t;try{return this.appEvent({type:fe.APP_SYNC_DAPP_DATA,payload:e})}catch(n){throw(t=this.w3mLogger)==null||t.logger.error({error:n},"Error syncing dapp data"),n}}async getSmartAccountEnabledNetworks(){var e;try{const t=await this.appEvent({type:fe.APP_GET_SMART_ACCOUNT_ENABLED_NETWORKS});return this.persistSmartAccountEnabledNetworks(t.smartAccountEnabledNetworks),t}catch(t){throw this.persistSmartAccountEnabledNetworks([]),(e=this.w3mLogger)==null||e.logger.error({error:t},"Error getting smart account enabled networks"),t}}async setPreferredAccount(e){var t;try{return this.appEvent({type:fe.APP_SET_PREFERRED_ACCOUNT,payload:{type:e}})}catch(n){throw(t=this.w3mLogger)==null||t.logger.error({error:n},"Error setting preferred account"),n}}async connect(e){var t;try{const n=(e==null?void 0:e.chainId)||this.getLastUsedChainId()||1,s=await this.getUser({chainId:n,preferredAccountType:e==null?void 0:e.preferredAccountType});return this.setLoginSuccess(s.email),this.setLastUsedChainId(s.chainId),this.user=s,s}catch(n){throw(t=this.w3mLogger)==null||t.logger.error({error:n},"Error connecting"),n}}async getUser(e){var t;try{const n=(e==null?void 0:e.chainId)||this.getLastUsedChainId()||1,s=await this.appEvent({type:fe.APP_GET_USER,payload:{...e,chainId:n}});return this.user=s,s}catch(n){throw(t=this.w3mLogger)==null||t.logger.error({error:n},"Error connecting"),n}}async connectSocial(e){var t;try{this.w3mFrame.initFrame();const n=await this.appEvent({type:fe.APP_CONNECT_SOCIAL,payload:{uri:e}});return n.userName&&this.setSocialLoginSuccess(n.userName),n}catch(n){throw(t=this.w3mLogger)==null||t.logger.error({error:n},"Error connecting social"),n}}async getFarcasterUri(){var e;try{return this.w3mFrame.initFrame(),await this.appEvent({type:fe.APP_GET_FARCASTER_URI})}catch(t){throw(e=this.w3mLogger)==null||e.logger.error({error:t},"Error getting farcaster uri"),t}}async connectFarcaster(){var e;try{const t=await this.appEvent({type:fe.APP_CONNECT_FARCASTER});return t.userName&&this.setSocialLoginSuccess(t.userName),t}catch(t){throw(e=this.w3mLogger)==null||e.logger.error({error:t},"Error connecting farcaster"),t}}async switchNetwork(e){var t;try{const n=await this.appEvent({type:fe.APP_SWITCH_NETWORK,payload:{chainId:e}});return this.setLastUsedChainId(n.chainId),n}catch(n){throw(t=this.w3mLogger)==null||t.logger.error({error:n},"Error switching network"),n}}async disconnect(){var e;try{const t=await this.appEvent({type:fe.APP_SIGN_OUT});return this.deleteAuthLoginCache(),t}catch(t){throw(e=this.w3mLogger)==null||e.logger.error({error:t},"Error disconnecting"),t}}async request(e){var t,n,s,i;try{if(dr.GET_CHAIN_ID===e.method)return this.getLastUsedChainId();(t=this.rpcRequestHandler)==null||t.call(this,e);const o=await this.appEvent({type:fe.APP_RPC_REQUEST,payload:e});return(n=this.rpcSuccessHandler)==null||n.call(this,o,e),o}catch(o){throw(s=this.rpcErrorHandler)==null||s.call(this,o,e),(i=this.w3mLogger)==null||i.logger.error({error:o},"Error requesting"),o}}onRpcRequest(e){this.rpcRequestHandler=e}onRpcSuccess(e){this.rpcSuccessHandler=e}onRpcError(e){this.rpcErrorHandler=e}onIsConnected(e){this.w3mFrame.events.onFrameEvent(t=>{t.type===fe.FRAME_IS_CONNECTED_SUCCESS&&t.payload.isConnected&&e()})}onNotConnected(e){this.w3mFrame.events.onFrameEvent(t=>{t.type===fe.FRAME_IS_CONNECTED_ERROR&&e(),t.type===fe.FRAME_IS_CONNECTED_SUCCESS&&!t.payload.isConnected&&e()})}onConnect(e){this.w3mFrame.events.onFrameEvent(t=>{t.type===fe.FRAME_GET_USER_SUCCESS&&e(t.payload)})}onSocialConnected(e){this.w3mFrame.events.onFrameEvent(t=>{t.type===fe.FRAME_CONNECT_SOCIAL_SUCCESS&&e(t.payload)})}async getCapabilities(){try{return await this.request({method:"wallet_getCapabilities"})||{}}catch{return{}}}onSetPreferredAccount(e){this.w3mFrame.events.onFrameEvent(t=>{t.type===fe.FRAME_SET_PREFERRED_ACCOUNT_SUCCESS?e(t.payload):t.type===fe.FRAME_SET_PREFERRED_ACCOUNT_ERROR&&e({type:dr.ACCOUNT_TYPES.EOA})})}onGetSmartAccountEnabledNetworks(e){this.w3mFrame.events.onFrameEvent(t=>{t.type===fe.FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS?e(t.payload.smartAccountEnabledNetworks):t.type===fe.FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR&&e([])})}getAvailableChainIds(){return Object.keys(this.w3mFrame.networks)}rejectRpcRequests(){var e;try{this.openRpcRequests.forEach(({abortController:t,method:n})=>{dr.SAFE_RPC_METHODS.includes(n)||t.abort()}),this.openRpcRequests=[]}catch(t){(e=this.w3mLogger)==null||e.logger.error({error:t},"Error aborting RPC request")}}async appEvent(e){let t,n;function s(c){return c.replace("@w3m-app/","")}const i=[fe.APP_SYNC_DAPP_DATA,fe.APP_SYNC_THEME,fe.APP_SET_PREFERRED_ACCOUNT],o=s(e.type);return!this.w3mFrame.iframeIsReady&&!i.includes(e.type)&&(n=setTimeout(()=>{var c;(c=this.onTimeout)==null||c.call(this,"iframe_load_failed"),this.abortController.abort()},2e4)),await this.w3mFrame.frameLoadPromise,clearTimeout(n),[fe.APP_CONNECT_EMAIL,fe.APP_CONNECT_DEVICE,fe.APP_CONNECT_OTP,fe.APP_CONNECT_SOCIAL,fe.APP_GET_SOCIAL_REDIRECT_URI].map(s).includes(o)&&(t=setTimeout(()=>{var c;(c=this.onTimeout)==null||c.call(this,"iframe_request_timeout"),this.abortController.abort()},3e4)),new Promise((c,l)=>{var f,g,p;const u=Math.random().toString(36).substring(7);(p=(f=this.w3mLogger)==null?void 0:(g=f.logger).info)==null||p.call(g,{event:e,id:u},"Sending app event"),this.w3mFrame.events.postAppEvent({...e,id:u});const h=new AbortController;if(o==="RPC_REQUEST"){const m=e;this.openRpcRequests=[...this.openRpcRequests,{...m.payload,abortController:h}]}h.signal.addEventListener("abort",()=>{o==="RPC_REQUEST"?l(new Error("Request was aborted")):o!=="GET_FARCASTER_URI"&&l(new Error("Something went wrong"))});function d(m,w){var A,v,N;m.id===u&&((v=w==null?void 0:(A=w.logger).info)==null||v.call(A,{framEvent:m,id:u},"Received frame response"),m.type===`@w3m-frame/${o}_SUCCESS`?(t&&clearTimeout(t),n&&clearTimeout(n),"payload"in m&&c(m.payload),c(void 0)):m.type===`@w3m-frame/${o}_ERROR`&&(t&&clearTimeout(t),n&&clearTimeout(n),"payload"in m&&l(new Error(((N=m.payload)==null?void 0:N.message)||"An error occurred")),l(new Error("An error occurred"))))}this.w3mFrame.events.registerFrameEventHandler(u,m=>d(m,this.w3mLogger),this.abortController.signal)})}setNewLastEmailLoginTime(){ir.set(fe.LAST_EMAIL_LOGIN_TIME,Date.now().toString())}setSocialLoginSuccess(e){ir.set(fe.SOCIAL_USERNAME,e)}setLoginSuccess(e){e&&ir.set(fe.EMAIL,e),ir.set(fe.EMAIL_LOGIN_USED_KEY,"true"),ir.delete(fe.LAST_EMAIL_LOGIN_TIME)}deleteAuthLoginCache(){ir.delete(fe.EMAIL_LOGIN_USED_KEY),ir.delete(fe.EMAIL),ir.delete(fe.LAST_USED_CHAIN_KEY),ir.delete(fe.SOCIAL_USERNAME)}setLastUsedChainId(e){e&&ir.set(fe.LAST_USED_CHAIN_KEY,String(e))}getLastUsedChainId(){const e=ir.get(fe.LAST_USED_CHAIN_KEY)??void 0,t=Number(e);return isNaN(t)?e:t}persistSmartAccountEnabledNetworks(e){ir.set(fe.SMART_ACCOUNT_ENABLED_NETWORKS,e.join(","))}}class Bh{constructor(){}static getInstance({projectId:e,chainId:t,enableLogger:n,onTimeout:s,abortController:i}){return Bh.instance||(Bh.instance=new LH({projectId:e,chainId:t,enableLogger:n,onTimeout:s,abortController:i})),Bh.instance}}var QA={};const $H={ACCOUNT_TABS:[{label:"Tokens"},{label:"NFTs"},{label:"Activity"}],SECURE_SITE_ORIGIN:(typeof process<"u"&&typeof QA<"u"?QA.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org",VIEW_DIRECTION:{Next:"next",Prev:"prev"},DEFAULT_CONNECT_METHOD_ORDER:["email","social","wallet"],ANIMATION_DURATIONS:{HeaderText:120,ModalHeight:150,ViewTransition:150}},Dw={filterOutDuplicatesByRDNS(r){const e=K.state.enableEIP6963?_e.state.connectors:[],t=se.getRecentWallets(),n=e.map(a=>{var c;return(c=a.info)==null?void 0:c.rdns}).filter(Boolean),s=t.map(a=>a.rdns).filter(Boolean),i=n.concat(s);if(i.includes("io.metamask.mobile")&&Ee.isMobile()){const a=i.indexOf("io.metamask.mobile");i[a]="io.metamask"}return r.filter(a=>!i.includes(String(a==null?void 0:a.rdns)))},filterOutDuplicatesByIds(r){const e=_e.state.connectors.filter(a=>a.type==="ANNOUNCED"||a.type==="INJECTED"),t=se.getRecentWallets(),n=e.map(a=>a.explorerId),s=t.map(a=>a.id),i=n.concat(s);return r.filter(a=>!i.includes(a==null?void 0:a.id))},filterOutDuplicateWallets(r){const e=this.filterOutDuplicatesByRDNS(r);return this.filterOutDuplicatesByIds(e)},markWalletsAsInstalled(r){const{connectors:e}=_e.state,t=e.filter(i=>i.type==="ANNOUNCED").reduce((i,o)=>{var a;return(a=o.info)!=null&&a.rdns&&(i[o.info.rdns]=!0),i},{});return r.map(i=>({...i,installed:!!i.rdns&&!!t[i.rdns??""]})).sort((i,o)=>Number(o.installed)-Number(i.installed))},getConnectOrderMethod(r,e){var c;const t=(r==null?void 0:r.connectMethodsOrder)||((c=K.state.features)==null?void 0:c.connectMethodsOrder),n=e||_e.state.connectors;if(t)return t;const{injected:s,announced:i}=vp.getConnectorsByType(n,be.state.recommended,be.state.featured),o=s.filter(vp.showConnector),a=i.filter(vp.showConnector);return o.length||a.length?["wallet","email","social"]:$H.DEFAULT_CONNECT_METHOD_ORDER},isExcluded(r){const e=!!r.rdns&&be.state.excludedWallets.some(n=>n.rdns===r.rdns),t=!!r.name&&be.state.excludedWallets.some(n=>Wg.isLowerCaseMatch(n.name,r.name));return e||t}},vp={getConnectorsByType(r,e,t){const{customWallets:n}=K.state,s=se.getRecentWallets(),i=Dw.filterOutDuplicateWallets(e),o=Dw.filterOutDuplicateWallets(t),a=r.filter(h=>h.type==="MULTI_CHAIN"),c=r.filter(h=>h.type==="ANNOUNCED"),l=r.filter(h=>h.type==="INJECTED"),u=r.filter(h=>h.type==="EXTERNAL");return{custom:n,recent:s,external:u,multiChain:a,announced:c,injected:l,recommended:i,featured:o}},showConnector(r){var s;const e=(s=r.info)==null?void 0:s.rdns,t=!!e&&be.state.excludedWallets.some(i=>!!i.rdns&&i.rdns===e),n=!!r.name&&be.state.excludedWallets.some(i=>Wg.isLowerCaseMatch(i.name,r.name));return!(r.type==="INJECTED"&&(r.name==="Browser Wallet"&&(!Ee.isMobile()||Ee.isMobile()&&!e&&!Et.checkInstalled())||t||n)||(r.type==="ANNOUNCED"||r.type==="EXTERNAL")&&(t||n))},getIsConnectedWithWC(){return Array.from(S.state.chains.values()).some(t=>_e.getConnectorId(t.namespace)===ee.CONNECTOR_ID.WALLET_CONNECT)},getConnectorTypeOrder({recommended:r,featured:e,custom:t,recent:n,announced:s,injected:i,multiChain:o,external:a,overriddenConnectors:c=(l=>(l=K.state.features)==null?void 0:l.connectorTypeOrder)()??[]}){const u=vp.getIsConnectedWithWC(),f=[{type:"walletConnect",isEnabled:K.state.enableWalletConnect&&!u},{type:"recent",isEnabled:n.length>0},{type:"injected",isEnabled:[...i,...s,...o].length>0},{type:"featured",isEnabled:e.length>0},{type:"custom",isEnabled:t&&t.length>0},{type:"external",isEnabled:a.length>0},{type:"recommended",isEnabled:r.length>0}].filter(w=>w.isEnabled),g=new Set(f.map(w=>w.type)),p=c.filter(w=>g.has(w)).map(w=>({type:w,isEnabled:!0})),m=f.filter(({type:w})=>!p.some(({type:v})=>v===w));return Array.from(new Set([...p,...m].map(({type:w})=>w)))}};/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Ap=globalThis,Zb=Ap.ShadowRoot&&(Ap.ShadyCSS===void 0||Ap.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,Xb=Symbol(),ZA=new WeakMap;let $I=class{constructor(e,t,n){if(this._$cssResult$=!0,n!==Xb)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=t}get styleSheet(){let e=this.o;const t=this.t;if(Zb&&e===void 0){const n=t!==void 0&&t.length===1;n&&(e=ZA.get(t)),e===void 0&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),n&&ZA.set(t,e))}return e}toString(){return this.cssText}};const xn=r=>new $I(typeof r=="string"?r:r+"",void 0,Xb),gl=(r,...e)=>{const t=r.length===1?r[0]:e.reduce((n,s,i)=>n+(o=>{if(o._$cssResult$===!0)return o.cssText;if(typeof o=="number")return o;throw Error("Value passed to 'css' function must be a 'css' function result: "+o+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(s)+r[i+1],r[0]);return new $I(t,r,Xb)},MH=(r,e)=>{if(Zb)r.adoptedStyleSheets=e.map(t=>t instanceof CSSStyleSheet?t:t.styleSheet);else for(const t of e){const n=document.createElement("style"),s=Ap.litNonce;s!==void 0&&n.setAttribute("nonce",s),n.textContent=t.cssText,r.appendChild(n)}},XA=Zb?r=>r:r=>r instanceof CSSStyleSheet?(e=>{let t="";for(const n of e.cssRules)t+=n.cssText;return xn(t)})(r):r;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const{is:FH,defineProperty:jH,getOwnPropertyDescriptor:HH,getOwnPropertyNames:zH,getOwnPropertySymbols:qH,getPrototypeOf:VH}=Object,Po=globalThis,e1=Po.trustedTypes,WH=e1?e1.emptyScript:"",py=Po.reactiveElementPolyfillSupport,Lh=(r,e)=>r,kw={toAttribute(r,e){switch(e){case Boolean:r=r?WH:null;break;case Object:case Array:r=r==null?r:JSON.stringify(r)}return r},fromAttribute(r,e){let t=r;switch(e){case Boolean:t=r!==null;break;case Number:t=r===null?null:Number(r);break;case Object:case Array:try{t=JSON.parse(r)}catch{t=null}}return t}},MI=(r,e)=>!FH(r,e),t1={attribute:!0,type:String,converter:kw,reflect:!1,useDefault:!1,hasChanged:MI};Symbol.metadata??(Symbol.metadata=Symbol("metadata")),Po.litPropertyMetadata??(Po.litPropertyMetadata=new WeakMap);let tl=class extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??(this.l=[])).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,t=t1){if(t.state&&(t.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(e)&&((t=Object.create(t)).wrapped=!0),this.elementProperties.set(e,t),!t.noAccessor){const n=Symbol(),s=this.getPropertyDescriptor(e,n,t);s!==void 0&&jH(this.prototype,e,s)}}static getPropertyDescriptor(e,t,n){const{get:s,set:i}=HH(this.prototype,e)??{get(){return this[t]},set(o){this[t]=o}};return{get:s,set(o){const a=s==null?void 0:s.call(this);i==null||i.call(this,o),this.requestUpdate(e,a,n)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??t1}static _$Ei(){if(this.hasOwnProperty(Lh("elementProperties")))return;const e=VH(this);e.finalize(),e.l!==void 0&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(Lh("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(Lh("properties"))){const t=this.properties,n=[...zH(t),...qH(t)];for(const s of n)this.createProperty(s,t[s])}const e=this[Symbol.metadata];if(e!==null){const t=litPropertyMetadata.get(e);if(t!==void 0)for(const[n,s]of t)this.elementProperties.set(n,s)}this._$Eh=new Map;for(const[t,n]of this.elementProperties){const s=this._$Eu(t,n);s!==void 0&&this._$Eh.set(s,t)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){const t=[];if(Array.isArray(e)){const n=new Set(e.flat(1/0).reverse());for(const s of n)t.unshift(XA(s))}else e!==void 0&&t.push(XA(e));return t}static _$Eu(e,t){const n=t.attribute;return n===!1?void 0:typeof n=="string"?n:typeof e=="string"?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){var e;this._$ES=new Promise(t=>this.enableUpdating=t),this._$AL=new Map,this._$E_(),this.requestUpdate(),(e=this.constructor.l)==null||e.forEach(t=>t(this))}addController(e){var t;(this._$EO??(this._$EO=new Set)).add(e),this.renderRoot!==void 0&&this.isConnected&&((t=e.hostConnected)==null||t.call(e))}removeController(e){var t;(t=this._$EO)==null||t.delete(e)}_$E_(){const e=new Map,t=this.constructor.elementProperties;for(const n of t.keys())this.hasOwnProperty(n)&&(e.set(n,this[n]),delete this[n]);e.size>0&&(this._$Ep=e)}createRenderRoot(){const e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return MH(e,this.constructor.elementStyles),e}connectedCallback(){var e;this.renderRoot??(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),(e=this._$EO)==null||e.forEach(t=>{var n;return(n=t.hostConnected)==null?void 0:n.call(t)})}enableUpdating(e){}disconnectedCallback(){var e;(e=this._$EO)==null||e.forEach(t=>{var n;return(n=t.hostDisconnected)==null?void 0:n.call(t)})}attributeChangedCallback(e,t,n){this._$AK(e,n)}_$ET(e,t){var i;const n=this.constructor.elementProperties.get(e),s=this.constructor._$Eu(e,n);if(s!==void 0&&n.reflect===!0){const o=(((i=n.converter)==null?void 0:i.toAttribute)!==void 0?n.converter:kw).toAttribute(t,n.type);this._$Em=e,o==null?this.removeAttribute(s):this.setAttribute(s,o),this._$Em=null}}_$AK(e,t){var i,o;const n=this.constructor,s=n._$Eh.get(e);if(s!==void 0&&this._$Em!==s){const a=n.getPropertyOptions(s),c=typeof a.converter=="function"?{fromAttribute:a.converter}:((i=a.converter)==null?void 0:i.fromAttribute)!==void 0?a.converter:kw;this._$Em=s,this[s]=c.fromAttribute(t,a.type)??((o=this._$Ej)==null?void 0:o.get(s))??null,this._$Em=null}}requestUpdate(e,t,n){var s;if(e!==void 0){const i=this.constructor,o=this[e];if(n??(n=i.getPropertyOptions(e)),!((n.hasChanged??MI)(o,t)||n.useDefault&&n.reflect&&o===((s=this._$Ej)==null?void 0:s.get(e))&&!this.hasAttribute(i._$Eu(e,n))))return;this.C(e,t,n)}this.isUpdatePending===!1&&(this._$ES=this._$EP())}C(e,t,{useDefault:n,reflect:s,wrapped:i},o){n&&!(this._$Ej??(this._$Ej=new Map)).has(e)&&(this._$Ej.set(e,o??t??this[e]),i!==!0||o!==void 0)||(this._$AL.has(e)||(this.hasUpdated||n||(t=void 0),this._$AL.set(e,t)),s===!0&&this._$Em!==e&&(this._$Eq??(this._$Eq=new Set)).add(e))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(t){Promise.reject(t)}const e=this.scheduleUpdate();return e!=null&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var n;if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??(this.renderRoot=this.createRenderRoot()),this._$Ep){for(const[i,o]of this._$Ep)this[i]=o;this._$Ep=void 0}const s=this.constructor.elementProperties;if(s.size>0)for(const[i,o]of s){const{wrapped:a}=o,c=this[i];a!==!0||this._$AL.has(i)||c===void 0||this.C(i,void 0,o,c)}}let e=!1;const t=this._$AL;try{e=this.shouldUpdate(t),e?(this.willUpdate(t),(n=this._$EO)==null||n.forEach(s=>{var i;return(i=s.hostUpdate)==null?void 0:i.call(s)}),this.update(t)):this._$EM()}catch(s){throw e=!1,this._$EM(),s}e&&this._$AE(t)}willUpdate(e){}_$AE(e){var t;(t=this._$EO)==null||t.forEach(n=>{var s;return(s=n.hostUpdated)==null?void 0:s.call(n)}),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(e){return!0}update(e){this._$Eq&&(this._$Eq=this._$Eq.forEach(t=>this._$ET(t,this[t]))),this._$EM()}updated(e){}firstUpdated(e){}};tl.elementStyles=[],tl.shadowRootOptions={mode:"open"},tl[Lh("elementProperties")]=new Map,tl[Lh("finalized")]=new Map,py==null||py({ReactiveElement:tl}),(Po.reactiveElementVersions??(Po.reactiveElementVersions=[])).push("2.1.0");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const $h=globalThis,rg=$h.trustedTypes,r1=rg?rg.createPolicy("lit-html",{createHTML:r=>r}):void 0,FI="$lit$",ao=`lit$${Math.random().toFixed(9).slice(2)}$`,jI="?"+ao,GH=`<${jI}>`,ac=document,Od=()=>ac.createComment(""),Rd=r=>r===null||typeof r!="object"&&typeof r!="function",e0=Array.isArray,KH=r=>e0(r)||typeof(r==null?void 0:r[Symbol.iterator])=="function",gy=`[ 	
\f\r]`,ph=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,n1=/-->/g,s1=/>/g,Qo=RegExp(`>|${gy}(?:([^\\s"'>=/]+)(${gy}*=${gy}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),i1=/'/g,o1=/"/g,HI=/^(?:script|style|textarea|title)$/i,zI=r=>(e,...t)=>({_$litType$:r,strings:e,values:t}),dJ=zI(1),fJ=zI(2),_u=Symbol.for("lit-noChange"),Zt=Symbol.for("lit-nothing"),a1=new WeakMap,ya=ac.createTreeWalker(ac,129);function qI(r,e){if(!e0(r)||!r.hasOwnProperty("raw"))throw Error("invalid template strings array");return r1!==void 0?r1.createHTML(e):e}const JH=(r,e)=>{const t=r.length-1,n=[];let s,i=e===2?"<svg>":e===3?"<math>":"",o=ph;for(let a=0;a<t;a++){const c=r[a];let l,u,h=-1,d=0;for(;d<c.length&&(o.lastIndex=d,u=o.exec(c),u!==null);)d=o.lastIndex,o===ph?u[1]==="!--"?o=n1:u[1]!==void 0?o=s1:u[2]!==void 0?(HI.test(u[2])&&(s=RegExp("</"+u[2],"g")),o=Qo):u[3]!==void 0&&(o=Qo):o===Qo?u[0]===">"?(o=s??ph,h=-1):u[1]===void 0?h=-2:(h=o.lastIndex-u[2].length,l=u[1],o=u[3]===void 0?Qo:u[3]==='"'?o1:i1):o===o1||o===i1?o=Qo:o===n1||o===s1?o=ph:(o=Qo,s=void 0);const f=o===Qo&&r[a+1].startsWith("/>")?" ":"";i+=o===ph?c+GH:h>=0?(n.push(l),c.slice(0,h)+FI+c.slice(h)+ao+f):c+ao+(h===-2?a:f)}return[qI(r,i+(r[t]||"<?>")+(e===2?"</svg>":e===3?"</math>":"")),n]};class Dd{constructor({strings:e,_$litType$:t},n){let s;this.parts=[];let i=0,o=0;const a=e.length-1,c=this.parts,[l,u]=JH(e,t);if(this.el=Dd.createElement(l,n),ya.currentNode=this.el.content,t===2||t===3){const h=this.el.content.firstChild;h.replaceWith(...h.childNodes)}for(;(s=ya.nextNode())!==null&&c.length<a;){if(s.nodeType===1){if(s.hasAttributes())for(const h of s.getAttributeNames())if(h.endsWith(FI)){const d=u[o++],f=s.getAttribute(h).split(ao),g=/([.?@])?(.*)/.exec(d);c.push({type:1,index:i,name:g[2],strings:f,ctor:g[1]==="."?QH:g[1]==="?"?ZH:g[1]==="@"?XH:Kg}),s.removeAttribute(h)}else h.startsWith(ao)&&(c.push({type:6,index:i}),s.removeAttribute(h));if(HI.test(s.tagName)){const h=s.textContent.split(ao),d=h.length-1;if(d>0){s.textContent=rg?rg.emptyScript:"";for(let f=0;f<d;f++)s.append(h[f],Od()),ya.nextNode(),c.push({type:2,index:++i});s.append(h[d],Od())}}}else if(s.nodeType===8)if(s.data===jI)c.push({type:2,index:i});else{let h=-1;for(;(h=s.data.indexOf(ao,h+1))!==-1;)c.push({type:7,index:i}),h+=ao.length-1}i++}}static createElement(e,t){const n=ac.createElement("template");return n.innerHTML=e,n}}function Nu(r,e,t=r,n){var o,a;if(e===_u)return e;let s=n!==void 0?(o=t._$Co)==null?void 0:o[n]:t._$Cl;const i=Rd(e)?void 0:e._$litDirective$;return(s==null?void 0:s.constructor)!==i&&((a=s==null?void 0:s._$AO)==null||a.call(s,!1),i===void 0?s=void 0:(s=new i(r),s._$AT(r,t,n)),n!==void 0?(t._$Co??(t._$Co=[]))[n]=s:t._$Cl=s),s!==void 0&&(e=Nu(r,s._$AS(r,e.values),s,n)),e}class YH{constructor(e,t){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=t}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){const{el:{content:t},parts:n}=this._$AD,s=((e==null?void 0:e.creationScope)??ac).importNode(t,!0);ya.currentNode=s;let i=ya.nextNode(),o=0,a=0,c=n[0];for(;c!==void 0;){if(o===c.index){let l;c.type===2?l=new Ef(i,i.nextSibling,this,e):c.type===1?l=new c.ctor(i,c.name,c.strings,this,e):c.type===6&&(l=new ez(i,this,e)),this._$AV.push(l),c=n[++a]}o!==(c==null?void 0:c.index)&&(i=ya.nextNode(),o++)}return ya.currentNode=ac,s}p(e){let t=0;for(const n of this._$AV)n!==void 0&&(n.strings!==void 0?(n._$AI(e,n,t),t+=n.strings.length-2):n._$AI(e[t])),t++}}class Ef{get _$AU(){var e;return((e=this._$AM)==null?void 0:e._$AU)??this._$Cv}constructor(e,t,n,s){this.type=2,this._$AH=Zt,this._$AN=void 0,this._$AA=e,this._$AB=t,this._$AM=n,this.options=s,this._$Cv=(s==null?void 0:s.isConnected)??!0}get parentNode(){let e=this._$AA.parentNode;const t=this._$AM;return t!==void 0&&(e==null?void 0:e.nodeType)===11&&(e=t.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,t=this){e=Nu(this,e,t),Rd(e)?e===Zt||e==null||e===""?(this._$AH!==Zt&&this._$AR(),this._$AH=Zt):e!==this._$AH&&e!==_u&&this._(e):e._$litType$!==void 0?this.$(e):e.nodeType!==void 0?this.T(e):KH(e)?this.k(e):this._(e)}O(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.O(e))}_(e){this._$AH!==Zt&&Rd(this._$AH)?this._$AA.nextSibling.data=e:this.T(ac.createTextNode(e)),this._$AH=e}$(e){var i;const{values:t,_$litType$:n}=e,s=typeof n=="number"?this._$AC(e):(n.el===void 0&&(n.el=Dd.createElement(qI(n.h,n.h[0]),this.options)),n);if(((i=this._$AH)==null?void 0:i._$AD)===s)this._$AH.p(t);else{const o=new YH(s,this),a=o.u(this.options);o.p(t),this.T(a),this._$AH=o}}_$AC(e){let t=a1.get(e.strings);return t===void 0&&a1.set(e.strings,t=new Dd(e)),t}k(e){e0(this._$AH)||(this._$AH=[],this._$AR());const t=this._$AH;let n,s=0;for(const i of e)s===t.length?t.push(n=new Ef(this.O(Od()),this.O(Od()),this,this.options)):n=t[s],n._$AI(i),s++;s<t.length&&(this._$AR(n&&n._$AB.nextSibling,s),t.length=s)}_$AR(e=this._$AA.nextSibling,t){var n;for((n=this._$AP)==null?void 0:n.call(this,!1,!0,t);e&&e!==this._$AB;){const s=e.nextSibling;e.remove(),e=s}}setConnected(e){var t;this._$AM===void 0&&(this._$Cv=e,(t=this._$AP)==null||t.call(this,e))}}class Kg{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,t,n,s,i){this.type=1,this._$AH=Zt,this._$AN=void 0,this.element=e,this.name=t,this._$AM=s,this.options=i,n.length>2||n[0]!==""||n[1]!==""?(this._$AH=Array(n.length-1).fill(new String),this.strings=n):this._$AH=Zt}_$AI(e,t=this,n,s){const i=this.strings;let o=!1;if(i===void 0)e=Nu(this,e,t,0),o=!Rd(e)||e!==this._$AH&&e!==_u,o&&(this._$AH=e);else{const a=e;let c,l;for(e=i[0],c=0;c<i.length-1;c++)l=Nu(this,a[n+c],t,c),l===_u&&(l=this._$AH[c]),o||(o=!Rd(l)||l!==this._$AH[c]),l===Zt?e=Zt:e!==Zt&&(e+=(l??"")+i[c+1]),this._$AH[c]=l}o&&!s&&this.j(e)}j(e){e===Zt?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}}class QH extends Kg{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===Zt?void 0:e}}class ZH extends Kg{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==Zt)}}class XH extends Kg{constructor(e,t,n,s,i){super(e,t,n,s,i),this.type=5}_$AI(e,t=this){if((e=Nu(this,e,t,0)??Zt)===_u)return;const n=this._$AH,s=e===Zt&&n!==Zt||e.capture!==n.capture||e.once!==n.once||e.passive!==n.passive,i=e!==Zt&&(n===Zt||s);s&&this.element.removeEventListener(this.name,this,n),i&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){var t;typeof this._$AH=="function"?this._$AH.call(((t=this.options)==null?void 0:t.host)??this.element,e):this._$AH.handleEvent(e)}}class ez{constructor(e,t,n){this.element=e,this.type=6,this._$AN=void 0,this._$AM=t,this.options=n}get _$AU(){return this._$AM._$AU}_$AI(e){Nu(this,e)}}const my=$h.litHtmlPolyfillSupport;my==null||my(Dd,Ef),($h.litHtmlVersions??($h.litHtmlVersions=[])).push("3.3.0");const tz=(r,e,t)=>{const n=(t==null?void 0:t.renderBefore)??e;let s=n._$litPart$;if(s===void 0){const i=(t==null?void 0:t.renderBefore)??null;n._$litPart$=s=new Ef(e.insertBefore(Od(),i),i,void 0,t??{})}return s._$AI(r),s};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Wa=globalThis;class Cp extends tl{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var t;const e=super.createRenderRoot();return(t=this.renderOptions).renderBefore??(t.renderBefore=e.firstChild),e}update(e){const t=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=tz(t,this.renderRoot,this.renderOptions)}connectedCallback(){var e;super.connectedCallback(),(e=this._$Do)==null||e.setConnected(!0)}disconnectedCallback(){var e;super.disconnectedCallback(),(e=this._$Do)==null||e.setConnected(!1)}render(){return _u}}var NC;Cp._$litElement$=!0,Cp.finalized=!0,(NC=Wa.litElementHydrateSupport)==null||NC.call(Wa,{LitElement:Cp});const yy=Wa.litElementPolyfillSupport;yy==null||yy({LitElement:Cp});(Wa.litElementVersions??(Wa.litElementVersions=[])).push("4.2.0");let Mh,Oo,Ro;function pJ(r,e){Mh=document.createElement("style"),Oo=document.createElement("style"),Ro=document.createElement("style"),Mh.textContent=ml(r).core.cssText,Oo.textContent=ml(r).dark.cssText,Ro.textContent=ml(r).light.cssText,document.head.appendChild(Mh),document.head.appendChild(Oo),document.head.appendChild(Ro),VI(e)}function VI(r){Oo&&Ro&&(r==="light"?(Oo.removeAttribute("media"),Ro.media="enabled"):(Ro.removeAttribute("media"),Oo.media="enabled"))}function rz(r){Mh&&Oo&&Ro&&(Mh.textContent=ml(r).core.cssText,Oo.textContent=ml(r).dark.cssText,Ro.textContent=ml(r).light.cssText)}function ml(r){return{core:gl`
      @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
      @keyframes w3m-shake {
        0% {
          transform: scale(1) rotate(0deg);
        }
        20% {
          transform: scale(1) rotate(-1deg);
        }
        40% {
          transform: scale(1) rotate(1.5deg);
        }
        60% {
          transform: scale(1) rotate(-1.5deg);
        }
        80% {
          transform: scale(1) rotate(1deg);
        }
        100% {
          transform: scale(1) rotate(0deg);
        }
      }
      @keyframes w3m-iframe-fade-out {
        0% {
          opacity: 1;
        }
        100% {
          opacity: 0;
        }
      }
      @keyframes w3m-iframe-zoom-in {
        0% {
          transform: translateY(50px);
          opacity: 0;
        }
        100% {
          transform: translateY(0px);
          opacity: 1;
        }
      }
      @keyframes w3m-iframe-zoom-in-mobile {
        0% {
          transform: scale(0.95);
          opacity: 0;
        }
        100% {
          transform: scale(1);
          opacity: 1;
        }
      }
      :root {
        --w3m-modal-width: 360px;
        --w3m-color-mix-strength: ${xn(r!=null&&r["--w3m-color-mix-strength"]?`${r["--w3m-color-mix-strength"]}%`:"0%")};
        --w3m-font-family: ${xn((r==null?void 0:r["--w3m-font-family"])||"Inter, Segoe UI, Roboto, Oxygen, Ubuntu, Cantarell, Fira Sans, Droid Sans, Helvetica Neue, sans-serif;")};
        --w3m-font-size-master: ${xn((r==null?void 0:r["--w3m-font-size-master"])||"10px")};
        --w3m-border-radius-master: ${xn((r==null?void 0:r["--w3m-border-radius-master"])||"4px")};
        --w3m-z-index: ${xn((r==null?void 0:r["--w3m-z-index"])||999)};

        --wui-font-family: var(--w3m-font-family);

        --wui-font-size-mini: calc(var(--w3m-font-size-master) * 0.8);
        --wui-font-size-micro: var(--w3m-font-size-master);
        --wui-font-size-tiny: calc(var(--w3m-font-size-master) * 1.2);
        --wui-font-size-small: calc(var(--w3m-font-size-master) * 1.4);
        --wui-font-size-paragraph: calc(var(--w3m-font-size-master) * 1.6);
        --wui-font-size-medium: calc(var(--w3m-font-size-master) * 1.8);
        --wui-font-size-large: calc(var(--w3m-font-size-master) * 2);
        --wui-font-size-title-6: calc(var(--w3m-font-size-master) * 2.2);
        --wui-font-size-medium-title: calc(var(--w3m-font-size-master) * 2.4);
        --wui-font-size-2xl: calc(var(--w3m-font-size-master) * 4);

        --wui-border-radius-5xs: var(--w3m-border-radius-master);
        --wui-border-radius-4xs: calc(var(--w3m-border-radius-master) * 1.5);
        --wui-border-radius-3xs: calc(var(--w3m-border-radius-master) * 2);
        --wui-border-radius-xxs: calc(var(--w3m-border-radius-master) * 3);
        --wui-border-radius-xs: calc(var(--w3m-border-radius-master) * 4);
        --wui-border-radius-s: calc(var(--w3m-border-radius-master) * 5);
        --wui-border-radius-m: calc(var(--w3m-border-radius-master) * 7);
        --wui-border-radius-l: calc(var(--w3m-border-radius-master) * 9);
        --wui-border-radius-3xl: calc(var(--w3m-border-radius-master) * 20);

        --wui-font-weight-light: 400;
        --wui-font-weight-regular: 500;
        --wui-font-weight-medium: 600;
        --wui-font-weight-bold: 700;

        --wui-letter-spacing-2xl: -1.6px;
        --wui-letter-spacing-medium-title: -0.96px;
        --wui-letter-spacing-title-6: -0.88px;
        --wui-letter-spacing-large: -0.8px;
        --wui-letter-spacing-medium: -0.72px;
        --wui-letter-spacing-paragraph: -0.64px;
        --wui-letter-spacing-small: -0.56px;
        --wui-letter-spacing-tiny: -0.48px;
        --wui-letter-spacing-micro: -0.2px;
        --wui-letter-spacing-mini: -0.16px;

        --wui-spacing-0: 0px;
        --wui-spacing-4xs: 2px;
        --wui-spacing-3xs: 4px;
        --wui-spacing-xxs: 6px;
        --wui-spacing-2xs: 7px;
        --wui-spacing-xs: 8px;
        --wui-spacing-1xs: 10px;
        --wui-spacing-s: 12px;
        --wui-spacing-m: 14px;
        --wui-spacing-l: 16px;
        --wui-spacing-2l: 18px;
        --wui-spacing-xl: 20px;
        --wui-spacing-xxl: 24px;
        --wui-spacing-2xl: 32px;
        --wui-spacing-3xl: 40px;
        --wui-spacing-4xl: 90px;
        --wui-spacing-5xl: 95px;

        --wui-icon-box-size-xxs: 14px;
        --wui-icon-box-size-xs: 20px;
        --wui-icon-box-size-sm: 24px;
        --wui-icon-box-size-md: 32px;
        --wui-icon-box-size-mdl: 36px;
        --wui-icon-box-size-lg: 40px;
        --wui-icon-box-size-2lg: 48px;
        --wui-icon-box-size-xl: 64px;

        --wui-icon-size-inherit: inherit;
        --wui-icon-size-xxs: 10px;
        --wui-icon-size-xs: 12px;
        --wui-icon-size-sm: 14px;
        --wui-icon-size-md: 16px;
        --wui-icon-size-mdl: 18px;
        --wui-icon-size-lg: 20px;
        --wui-icon-size-xl: 24px;
        --wui-icon-size-xxl: 28px;

        --wui-wallet-image-size-inherit: inherit;
        --wui-wallet-image-size-sm: 40px;
        --wui-wallet-image-size-md: 56px;
        --wui-wallet-image-size-lg: 80px;

        --wui-visual-size-size-inherit: inherit;
        --wui-visual-size-sm: 40px;
        --wui-visual-size-md: 55px;
        --wui-visual-size-lg: 80px;

        --wui-box-size-md: 100px;
        --wui-box-size-lg: 120px;

        --wui-ease-out-power-2: cubic-bezier(0, 0, 0.22, 1);
        --wui-ease-out-power-1: cubic-bezier(0, 0, 0.55, 1);

        --wui-ease-in-power-3: cubic-bezier(0.66, 0, 1, 1);
        --wui-ease-in-power-2: cubic-bezier(0.45, 0, 1, 1);
        --wui-ease-in-power-1: cubic-bezier(0.3, 0, 1, 1);

        --wui-ease-inout-power-1: cubic-bezier(0.45, 0, 0.55, 1);

        --wui-duration-lg: 200ms;
        --wui-duration-md: 125ms;
        --wui-duration-sm: 75ms;

        --wui-path-network-sm: path(
          'M15.4 2.1a5.21 5.21 0 0 1 5.2 0l11.61 6.7a5.21 5.21 0 0 1 2.61 4.52v13.4c0 1.87-1 3.59-2.6 4.52l-11.61 6.7c-1.62.93-3.6.93-5.22 0l-11.6-6.7a5.21 5.21 0 0 1-2.61-4.51v-13.4c0-1.87 1-3.6 2.6-4.52L15.4 2.1Z'
        );

        --wui-path-network-md: path(
          'M43.4605 10.7248L28.0485 1.61089C25.5438 0.129705 22.4562 0.129705 19.9515 1.61088L4.53951 10.7248C2.03626 12.2051 0.5 14.9365 0.5 17.886V36.1139C0.5 39.0635 2.03626 41.7949 4.53951 43.2752L19.9515 52.3891C22.4562 53.8703 25.5438 53.8703 28.0485 52.3891L43.4605 43.2752C45.9637 41.7949 47.5 39.0635 47.5 36.114V17.8861C47.5 14.9365 45.9637 12.2051 43.4605 10.7248Z'
        );

        --wui-path-network-lg: path(
          'M78.3244 18.926L50.1808 2.45078C45.7376 -0.150261 40.2624 -0.150262 35.8192 2.45078L7.6756 18.926C3.23322 21.5266 0.5 26.3301 0.5 31.5248V64.4752C0.5 69.6699 3.23322 74.4734 7.6756 77.074L35.8192 93.5492C40.2624 96.1503 45.7376 96.1503 50.1808 93.5492L78.3244 77.074C82.7668 74.4734 85.5 69.6699 85.5 64.4752V31.5248C85.5 26.3301 82.7668 21.5266 78.3244 18.926Z'
        );

        --wui-width-network-sm: 36px;
        --wui-width-network-md: 48px;
        --wui-width-network-lg: 86px;

        --wui-height-network-sm: 40px;
        --wui-height-network-md: 54px;
        --wui-height-network-lg: 96px;

        --wui-icon-size-network-xs: 12px;
        --wui-icon-size-network-sm: 16px;
        --wui-icon-size-network-md: 24px;
        --wui-icon-size-network-lg: 42px;

        --wui-color-inherit: inherit;

        --wui-color-inverse-100: #fff;
        --wui-color-inverse-000: #000;

        --wui-cover: rgba(20, 20, 20, 0.8);

        --wui-color-modal-bg: var(--wui-color-modal-bg-base);

        --wui-color-accent-100: var(--wui-color-accent-base-100);
        --wui-color-accent-090: var(--wui-color-accent-base-090);
        --wui-color-accent-080: var(--wui-color-accent-base-080);

        --wui-color-success-100: var(--wui-color-success-base-100);
        --wui-color-success-125: var(--wui-color-success-base-125);

        --wui-color-warning-100: var(--wui-color-warning-base-100);

        --wui-color-error-100: var(--wui-color-error-base-100);
        --wui-color-error-125: var(--wui-color-error-base-125);

        --wui-color-blue-100: var(--wui-color-blue-base-100);
        --wui-color-blue-90: var(--wui-color-blue-base-90);

        --wui-icon-box-bg-error-100: var(--wui-icon-box-bg-error-base-100);
        --wui-icon-box-bg-blue-100: var(--wui-icon-box-bg-blue-base-100);
        --wui-icon-box-bg-success-100: var(--wui-icon-box-bg-success-base-100);
        --wui-icon-box-bg-inverse-100: var(--wui-icon-box-bg-inverse-base-100);

        --wui-all-wallets-bg-100: var(--wui-all-wallets-bg-100);

        --wui-avatar-border: var(--wui-avatar-border-base);

        --wui-thumbnail-border: var(--wui-thumbnail-border-base);

        --wui-wallet-button-bg: var(--wui-wallet-button-bg-base);

        --wui-box-shadow-blue: var(--wui-color-accent-glass-020);
      }

      @supports (background: color-mix(in srgb, white 50%, black)) {
        :root {
          --wui-color-modal-bg: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-modal-bg-base)
          );

          --wui-box-shadow-blue: color-mix(in srgb, var(--wui-color-accent-100) 20%, transparent);

          --wui-color-accent-100: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 100%,
            transparent
          );
          --wui-color-accent-090: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 90%,
            transparent
          );
          --wui-color-accent-080: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 80%,
            transparent
          );
          --wui-color-accent-glass-090: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 90%,
            transparent
          );
          --wui-color-accent-glass-080: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 80%,
            transparent
          );
          --wui-color-accent-glass-020: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 20%,
            transparent
          );
          --wui-color-accent-glass-015: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 15%,
            transparent
          );
          --wui-color-accent-glass-010: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 10%,
            transparent
          );
          --wui-color-accent-glass-005: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 5%,
            transparent
          );
          --wui-color-accent-002: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 2%,
            transparent
          );

          --wui-color-fg-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-100)
          );
          --wui-color-fg-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-125)
          );
          --wui-color-fg-150: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-150)
          );
          --wui-color-fg-175: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-175)
          );
          --wui-color-fg-200: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-200)
          );
          --wui-color-fg-225: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-225)
          );
          --wui-color-fg-250: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-250)
          );
          --wui-color-fg-275: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-275)
          );
          --wui-color-fg-300: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-300)
          );
          --wui-color-fg-325: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-325)
          );
          --wui-color-fg-350: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-350)
          );

          --wui-color-bg-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-100)
          );
          --wui-color-bg-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-125)
          );
          --wui-color-bg-150: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-150)
          );
          --wui-color-bg-175: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-175)
          );
          --wui-color-bg-200: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-200)
          );
          --wui-color-bg-225: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-225)
          );
          --wui-color-bg-250: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-250)
          );
          --wui-color-bg-275: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-275)
          );
          --wui-color-bg-300: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-300)
          );
          --wui-color-bg-325: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-325)
          );
          --wui-color-bg-350: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-350)
          );

          --wui-color-success-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-success-base-100)
          );
          --wui-color-success-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-success-base-125)
          );

          --wui-color-warning-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-warning-base-100)
          );

          --wui-color-error-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-error-base-100)
          );
          --wui-color-blue-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-blue-base-100)
          );
          --wui-color-blue-90: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-blue-base-90)
          );
          --wui-color-error-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-error-base-125)
          );

          --wui-icon-box-bg-error-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-error-base-100)
          );
          --wui-icon-box-bg-accent-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-blue-base-100)
          );
          --wui-icon-box-bg-success-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-success-base-100)
          );
          --wui-icon-box-bg-inverse-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-inverse-base-100)
          );

          --wui-all-wallets-bg-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-all-wallets-bg-100)
          );

          --wui-avatar-border: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-avatar-border-base)
          );

          --wui-thumbnail-border: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-thumbnail-border-base)
          );

          --wui-wallet-button-bg: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-wallet-button-bg-base)
          );
        }
      }
    `,light:gl`
      :root {
        --w3m-color-mix: ${xn((r==null?void 0:r["--w3m-color-mix"])||"#fff")};
        --w3m-accent: ${xn(xi(r,"dark")["--w3m-accent"])};
        --w3m-default: #fff;

        --wui-color-modal-bg-base: ${xn(xi(r,"dark")["--w3m-background"])};
        --wui-color-accent-base-100: var(--w3m-accent);

        --wui-color-blueberry-100: hsla(230, 100%, 67%, 1);
        --wui-color-blueberry-090: hsla(231, 76%, 61%, 1);
        --wui-color-blueberry-080: hsla(230, 59%, 55%, 1);
        --wui-color-blueberry-050: hsla(231, 100%, 70%, 0.1);

        --wui-color-fg-100: #e4e7e7;
        --wui-color-fg-125: #d0d5d5;
        --wui-color-fg-150: #a8b1b1;
        --wui-color-fg-175: #a8b0b0;
        --wui-color-fg-200: #949e9e;
        --wui-color-fg-225: #868f8f;
        --wui-color-fg-250: #788080;
        --wui-color-fg-275: #788181;
        --wui-color-fg-300: #6e7777;
        --wui-color-fg-325: #9a9a9a;
        --wui-color-fg-350: #363636;

        --wui-color-bg-100: #141414;
        --wui-color-bg-125: #191a1a;
        --wui-color-bg-150: #1e1f1f;
        --wui-color-bg-175: #222525;
        --wui-color-bg-200: #272a2a;
        --wui-color-bg-225: #2c3030;
        --wui-color-bg-250: #313535;
        --wui-color-bg-275: #363b3b;
        --wui-color-bg-300: #3b4040;
        --wui-color-bg-325: #252525;
        --wui-color-bg-350: #ffffff;

        --wui-color-success-base-100: #26d962;
        --wui-color-success-base-125: #30a46b;

        --wui-color-warning-base-100: #f3a13f;

        --wui-color-error-base-100: #f25a67;
        --wui-color-error-base-125: #df4a34;

        --wui-color-blue-base-100: rgba(102, 125, 255, 1);
        --wui-color-blue-base-90: rgba(102, 125, 255, 0.9);

        --wui-color-success-glass-001: rgba(38, 217, 98, 0.01);
        --wui-color-success-glass-002: rgba(38, 217, 98, 0.02);
        --wui-color-success-glass-005: rgba(38, 217, 98, 0.05);
        --wui-color-success-glass-010: rgba(38, 217, 98, 0.1);
        --wui-color-success-glass-015: rgba(38, 217, 98, 0.15);
        --wui-color-success-glass-020: rgba(38, 217, 98, 0.2);
        --wui-color-success-glass-025: rgba(38, 217, 98, 0.25);
        --wui-color-success-glass-030: rgba(38, 217, 98, 0.3);
        --wui-color-success-glass-060: rgba(38, 217, 98, 0.6);
        --wui-color-success-glass-080: rgba(38, 217, 98, 0.8);

        --wui-color-success-glass-reown-020: rgba(48, 164, 107, 0.2);

        --wui-color-warning-glass-reown-020: rgba(243, 161, 63, 0.2);

        --wui-color-error-glass-001: rgba(242, 90, 103, 0.01);
        --wui-color-error-glass-002: rgba(242, 90, 103, 0.02);
        --wui-color-error-glass-005: rgba(242, 90, 103, 0.05);
        --wui-color-error-glass-010: rgba(242, 90, 103, 0.1);
        --wui-color-error-glass-015: rgba(242, 90, 103, 0.15);
        --wui-color-error-glass-020: rgba(242, 90, 103, 0.2);
        --wui-color-error-glass-025: rgba(242, 90, 103, 0.25);
        --wui-color-error-glass-030: rgba(242, 90, 103, 0.3);
        --wui-color-error-glass-060: rgba(242, 90, 103, 0.6);
        --wui-color-error-glass-080: rgba(242, 90, 103, 0.8);

        --wui-color-error-glass-reown-020: rgba(223, 74, 52, 0.2);

        --wui-color-gray-glass-001: rgba(255, 255, 255, 0.01);
        --wui-color-gray-glass-002: rgba(255, 255, 255, 0.02);
        --wui-color-gray-glass-005: rgba(255, 255, 255, 0.05);
        --wui-color-gray-glass-010: rgba(255, 255, 255, 0.1);
        --wui-color-gray-glass-015: rgba(255, 255, 255, 0.15);
        --wui-color-gray-glass-020: rgba(255, 255, 255, 0.2);
        --wui-color-gray-glass-025: rgba(255, 255, 255, 0.25);
        --wui-color-gray-glass-030: rgba(255, 255, 255, 0.3);
        --wui-color-gray-glass-060: rgba(255, 255, 255, 0.6);
        --wui-color-gray-glass-080: rgba(255, 255, 255, 0.8);
        --wui-color-gray-glass-090: rgba(255, 255, 255, 0.9);

        --wui-color-dark-glass-100: rgba(42, 42, 42, 1);

        --wui-icon-box-bg-error-base-100: #3c2426;
        --wui-icon-box-bg-blue-base-100: #20303f;
        --wui-icon-box-bg-success-base-100: #1f3a28;
        --wui-icon-box-bg-inverse-base-100: #243240;

        --wui-all-wallets-bg-100: #222b35;

        --wui-avatar-border-base: #252525;

        --wui-thumbnail-border-base: #252525;

        --wui-wallet-button-bg-base: var(--wui-color-bg-125);

        --w3m-card-embedded-shadow-color: rgb(17 17 18 / 25%);
      }
    `,dark:gl`
      :root {
        --w3m-color-mix: ${xn((r==null?void 0:r["--w3m-color-mix"])||"#000")};
        --w3m-accent: ${xn(xi(r,"light")["--w3m-accent"])};
        --w3m-default: #000;

        --wui-color-modal-bg-base: ${xn(xi(r,"light")["--w3m-background"])};
        --wui-color-accent-base-100: var(--w3m-accent);

        --wui-color-blueberry-100: hsla(231, 100%, 70%, 1);
        --wui-color-blueberry-090: hsla(231, 97%, 72%, 1);
        --wui-color-blueberry-080: hsla(231, 92%, 74%, 1);

        --wui-color-fg-100: #141414;
        --wui-color-fg-125: #2d3131;
        --wui-color-fg-150: #474d4d;
        --wui-color-fg-175: #636d6d;
        --wui-color-fg-200: #798686;
        --wui-color-fg-225: #828f8f;
        --wui-color-fg-250: #8b9797;
        --wui-color-fg-275: #95a0a0;
        --wui-color-fg-300: #9ea9a9;
        --wui-color-fg-325: #9a9a9a;
        --wui-color-fg-350: #d0d0d0;

        --wui-color-bg-100: #ffffff;
        --wui-color-bg-125: #f5fafa;
        --wui-color-bg-150: #f3f8f8;
        --wui-color-bg-175: #eef4f4;
        --wui-color-bg-200: #eaf1f1;
        --wui-color-bg-225: #e5eded;
        --wui-color-bg-250: #e1e9e9;
        --wui-color-bg-275: #dce7e7;
        --wui-color-bg-300: #d8e3e3;
        --wui-color-bg-325: #f3f3f3;
        --wui-color-bg-350: #202020;

        --wui-color-success-base-100: #26b562;
        --wui-color-success-base-125: #30a46b;

        --wui-color-warning-base-100: #f3a13f;

        --wui-color-error-base-100: #f05142;
        --wui-color-error-base-125: #df4a34;

        --wui-color-blue-base-100: rgba(102, 125, 255, 1);
        --wui-color-blue-base-90: rgba(102, 125, 255, 0.9);

        --wui-color-success-glass-001: rgba(38, 181, 98, 0.01);
        --wui-color-success-glass-002: rgba(38, 181, 98, 0.02);
        --wui-color-success-glass-005: rgba(38, 181, 98, 0.05);
        --wui-color-success-glass-010: rgba(38, 181, 98, 0.1);
        --wui-color-success-glass-015: rgba(38, 181, 98, 0.15);
        --wui-color-success-glass-020: rgba(38, 181, 98, 0.2);
        --wui-color-success-glass-025: rgba(38, 181, 98, 0.25);
        --wui-color-success-glass-030: rgba(38, 181, 98, 0.3);
        --wui-color-success-glass-060: rgba(38, 181, 98, 0.6);
        --wui-color-success-glass-080: rgba(38, 181, 98, 0.8);

        --wui-color-success-glass-reown-020: rgba(48, 164, 107, 0.2);

        --wui-color-warning-glass-reown-020: rgba(243, 161, 63, 0.2);

        --wui-color-error-glass-001: rgba(240, 81, 66, 0.01);
        --wui-color-error-glass-002: rgba(240, 81, 66, 0.02);
        --wui-color-error-glass-005: rgba(240, 81, 66, 0.05);
        --wui-color-error-glass-010: rgba(240, 81, 66, 0.1);
        --wui-color-error-glass-015: rgba(240, 81, 66, 0.15);
        --wui-color-error-glass-020: rgba(240, 81, 66, 0.2);
        --wui-color-error-glass-025: rgba(240, 81, 66, 0.25);
        --wui-color-error-glass-030: rgba(240, 81, 66, 0.3);
        --wui-color-error-glass-060: rgba(240, 81, 66, 0.6);
        --wui-color-error-glass-080: rgba(240, 81, 66, 0.8);

        --wui-color-error-glass-reown-020: rgba(223, 74, 52, 0.2);

        --wui-icon-box-bg-error-base-100: #f4dfdd;
        --wui-icon-box-bg-blue-base-100: #d9ecfb;
        --wui-icon-box-bg-success-base-100: #daf0e4;
        --wui-icon-box-bg-inverse-base-100: #dcecfc;

        --wui-all-wallets-bg-100: #e8f1fa;

        --wui-avatar-border-base: #f3f4f4;

        --wui-thumbnail-border-base: #eaefef;

        --wui-wallet-button-bg-base: var(--wui-color-bg-125);

        --wui-color-gray-glass-001: rgba(0, 0, 0, 0.01);
        --wui-color-gray-glass-002: rgba(0, 0, 0, 0.02);
        --wui-color-gray-glass-005: rgba(0, 0, 0, 0.05);
        --wui-color-gray-glass-010: rgba(0, 0, 0, 0.1);
        --wui-color-gray-glass-015: rgba(0, 0, 0, 0.15);
        --wui-color-gray-glass-020: rgba(0, 0, 0, 0.2);
        --wui-color-gray-glass-025: rgba(0, 0, 0, 0.25);
        --wui-color-gray-glass-030: rgba(0, 0, 0, 0.3);
        --wui-color-gray-glass-060: rgba(0, 0, 0, 0.6);
        --wui-color-gray-glass-080: rgba(0, 0, 0, 0.8);
        --wui-color-gray-glass-090: rgba(0, 0, 0, 0.9);

        --wui-color-dark-glass-100: rgba(233, 233, 233, 1);

        --w3m-card-embedded-shadow-color: rgb(224 225 233 / 25%);
      }
    `}}const gJ=gl`
  *,
  *::after,
  *::before,
  :host {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-style: normal;
    text-rendering: optimizeSpeed;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    -webkit-tap-highlight-color: transparent;
    font-family: var(--wui-font-family);
    backface-visibility: hidden;
  }
`,mJ=gl`
  button,
  a {
    cursor: pointer;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
    transition:
      color var(--wui-duration-lg) var(--wui-ease-out-power-1),
      background-color var(--wui-duration-lg) var(--wui-ease-out-power-1),
      border var(--wui-duration-lg) var(--wui-ease-out-power-1),
      border-radius var(--wui-duration-lg) var(--wui-ease-out-power-1),
      box-shadow var(--wui-duration-lg) var(--wui-ease-out-power-1);
    will-change: background-color, color, border, box-shadow, border-radius;
    outline: none;
    border: none;
    column-gap: var(--wui-spacing-3xs);
    background-color: transparent;
    text-decoration: none;
  }

  wui-flex {
    transition: border-radius var(--wui-duration-lg) var(--wui-ease-out-power-1);
    will-change: border-radius;
  }

  button:disabled > wui-wallet-image,
  button:disabled > wui-all-wallets-image,
  button:disabled > wui-network-image,
  button:disabled > wui-image,
  button:disabled > wui-transaction-visual,
  button:disabled > wui-logo {
    filter: grayscale(1);
  }

  @media (hover: hover) and (pointer: fine) {
    button:hover:enabled {
      background-color: var(--wui-color-gray-glass-005);
    }

    button:active:enabled {
      background-color: var(--wui-color-gray-glass-010);
    }
  }

  button:disabled > wui-icon-box {
    opacity: 0.5;
  }

  input {
    border: none;
    outline: none;
    appearance: none;
  }
`,yJ=gl`
  .wui-color-inherit {
    color: var(--wui-color-inherit);
  }

  .wui-color-accent-100 {
    color: var(--wui-color-accent-100);
  }

  .wui-color-error-100 {
    color: var(--wui-color-error-100);
  }

  .wui-color-blue-100 {
    color: var(--wui-color-blue-100);
  }

  .wui-color-blue-90 {
    color: var(--wui-color-blue-90);
  }

  .wui-color-error-125 {
    color: var(--wui-color-error-125);
  }

  .wui-color-success-100 {
    color: var(--wui-color-success-100);
  }

  .wui-color-success-125 {
    color: var(--wui-color-success-125);
  }

  .wui-color-inverse-100 {
    color: var(--wui-color-inverse-100);
  }

  .wui-color-inverse-000 {
    color: var(--wui-color-inverse-000);
  }

  .wui-color-fg-100 {
    color: var(--wui-color-fg-100);
  }

  .wui-color-fg-200 {
    color: var(--wui-color-fg-200);
  }

  .wui-color-fg-300 {
    color: var(--wui-color-fg-300);
  }

  .wui-color-fg-325 {
    color: var(--wui-color-fg-325);
  }

  .wui-color-fg-350 {
    color: var(--wui-color-fg-350);
  }

  .wui-bg-color-inherit {
    background-color: var(--wui-color-inherit);
  }

  .wui-bg-color-blue-100 {
    background-color: var(--wui-color-accent-100);
  }

  .wui-bg-color-error-100 {
    background-color: var(--wui-color-error-100);
  }

  .wui-bg-color-error-125 {
    background-color: var(--wui-color-error-125);
  }

  .wui-bg-color-success-100 {
    background-color: var(--wui-color-success-100);
  }

  .wui-bg-color-success-125 {
    background-color: var(--wui-color-success-100);
  }

  .wui-bg-color-inverse-100 {
    background-color: var(--wui-color-inverse-100);
  }

  .wui-bg-color-inverse-000 {
    background-color: var(--wui-color-inverse-000);
  }

  .wui-bg-color-fg-100 {
    background-color: var(--wui-color-fg-100);
  }

  .wui-bg-color-fg-200 {
    background-color: var(--wui-color-fg-200);
  }

  .wui-bg-color-fg-300 {
    background-color: var(--wui-color-fg-300);
  }

  .wui-color-fg-325 {
    background-color: var(--wui-color-fg-325);
  }

  .wui-color-fg-350 {
    background-color: var(--wui-color-fg-350);
  }
`,Ti={ERROR_CODE_UNRECOGNIZED_CHAIN_ID:4902,ERROR_CODE_DEFAULT:5e3,ERROR_INVALID_CHAIN_ID:32603,DEFAULT_ALLOWED_ANCESTORS:["http://localhost:*","https://*.pages.dev","https://*.vercel.app","https://*.ngrok-free.app","https://secure-mobile.walletconnect.com","https://secure-mobile.walletconnect.org"]},nz=Yb({id:42161,name:"Arbitrum One",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://arb1.arbitrum.io/rpc"]}},blockExplorers:{default:{name:"Arbiscan",url:"https://arbiscan.io",apiUrl:"https://api.arbiscan.io/api"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:7654707}}}),sz=Yb({id:1,name:"Ethereum",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://eth.merkle.io"]}},blockExplorers:{default:{name:"Etherscan",url:"https://etherscan.io",apiUrl:"https://api.etherscan.io/api"}},contracts:{ensRegistry:{address:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e"},ensUniversalResolver:{address:"0xce01f8eee7E479C928F8919abD53E553a36CeF67",blockCreated:19258213},multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:14353601}}}),iz=Yb({id:11155111,name:"Sepolia",nativeCurrency:{name:"Sepolia Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://sepolia.drpc.org"]}},blockExplorers:{default:{name:"Etherscan",url:"https://sepolia.etherscan.io",apiUrl:"https://api-sepolia.etherscan.io/api"}},contracts:{multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:751532},ensRegistry:{address:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e"},ensUniversalResolver:{address:"0xc8Af999e38273D658BE1b921b88A9Ddf005769cC",blockCreated:5317080}},testnet:!0});function vf(r){return{formatters:void 0,fees:void 0,serializers:void 0,...r}}const c1=vf({id:"5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",name:"Solana",network:"solana-mainnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!1,chainNamespace:"solana",caipNetworkId:"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",deprecatedCaipNetworkId:"solana:4sGjMW1sUnHzSxGspuhpqLDx6wiyjNtZ"}),l1=vf({id:"EtWTRABZaYq6iMfeYKouRu166VU2xqa1",name:"Solana Devnet",network:"solana-devnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!0,chainNamespace:"solana",caipNetworkId:"solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1",deprecatedCaipNetworkId:"solana:8E9rvCKLFQia2Y35HXjjpWzj8weVo44K"});vf({id:"4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z",name:"Solana Testnet",network:"solana-testnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!0,chainNamespace:"solana",caipNetworkId:"solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z"});vf({id:"000000000019d6689c085ae165831e93",caipNetworkId:"bip122:000000000019d6689c085ae165831e93",chainNamespace:"bip122",name:"Bitcoin",nativeCurrency:{name:"Bitcoin",symbol:"BTC",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}}});vf({id:"000000000933ea01ad0ee984209779ba",caipNetworkId:"bip122:000000000933ea01ad0ee984209779ba",chainNamespace:"bip122",name:"Bitcoin Testnet",nativeCurrency:{name:"Bitcoin",symbol:"BTC",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},testnet:!0});const oz={solana:["solana_signMessage","solana_signTransaction","solana_requestAccounts","solana_getAccounts","solana_signAllTransactions","solana_signAndSendTransaction"],eip155:["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_showCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"],bip122:["sendTransfer","signMessage","signPsbt","getAccountAddresses"]},_p={getMethodsByChainNamespace(r){return oz[r]||[]},createDefaultNamespace(r){return{methods:this.getMethodsByChainNamespace(r),events:["accountsChanged","chainChanged"],chains:[],rpcMap:{}}},applyNamespaceOverrides(r,e){if(!e)return{...r};const t={...r},n=new Set;if(e.methods&&Object.keys(e.methods).forEach(s=>n.add(s)),e.chains&&Object.keys(e.chains).forEach(s=>n.add(s)),e.events&&Object.keys(e.events).forEach(s=>n.add(s)),e.rpcMap&&Object.keys(e.rpcMap).forEach(s=>{const[i]=s.split(":");i&&n.add(i)}),n.forEach(s=>{t[s]||(t[s]=this.createDefaultNamespace(s))}),e.methods&&Object.entries(e.methods).forEach(([s,i])=>{t[s]&&(t[s].methods=i)}),e.chains&&Object.entries(e.chains).forEach(([s,i])=>{t[s]&&(t[s].chains=i)}),e.events&&Object.entries(e.events).forEach(([s,i])=>{t[s]&&(t[s].events=i)}),e.rpcMap){const s=new Set;Object.entries(e.rpcMap).forEach(([i,o])=>{const[a,c]=i.split(":");!a||!c||!t[a]||(t[a].rpcMap||(t[a].rpcMap={}),s.has(a)||(t[a].rpcMap={},s.add(a)),t[a].rpcMap[c]=o)})}return t},createNamespaces(r,e){const t=r.reduce((n,s)=>{const{id:i,chainNamespace:o,rpcUrls:a}=s,c=a.default.http[0];n[o]||(n[o]=this.createDefaultNamespace(o));const l=`${o}:${i}`,u=n[o];switch(u.chains.push(l),l){case c1.caipNetworkId:u.chains.push(c1.deprecatedCaipNetworkId);break;case l1.caipNetworkId:u.chains.push(l1.deprecatedCaipNetworkId);break}return u!=null&&u.rpcMap&&c&&(u.rpcMap[i]=c),n},{});return this.applyNamespaceOverrides(t,e)},resolveReownName:async r=>{var n;const e=await SI.resolveName(r);return((n=(Object.values(e==null?void 0:e.addresses)||[])[0])==null?void 0:n.address)||!1},getChainsFromNamespaces(r={}){return Object.values(r).flatMap(e=>{const t=e.chains||[],n=e.accounts.map(s=>{const[i,o]=s.split(":");return`${i}:${o}`});return Array.from(new Set([...t,...n]))})},isSessionEventData(r){return typeof r=="object"&&r!==null&&"id"in r&&"topic"in r&&"params"in r&&typeof r.params=="object"&&r.params!==null&&"chainId"in r.params&&"event"in r.params&&typeof r.params.event=="object"&&r.params.event!==null},isOriginAllowed(r,e,t){for(const n of[...e,...t])if(n.includes("*")){const i=`^${n.replace(/[.*+?^${}()|[\]\\]/gu,"\\$&").replace(/\\\*/gu,".*")}$`;if(new RegExp(i,"u").test(r))return!0}else if(n===r)return!0;return!1}};class t0{constructor({provider:e,namespace:t}){this.id=ee.CONNECTOR_ID.WALLET_CONNECT,this.name=Ms.ConnectorNamesMap[ee.CONNECTOR_ID.WALLET_CONNECT],this.type="WALLET_CONNECT",this.imageId=Ms.ConnectorImageIds[ee.CONNECTOR_ID.WALLET_CONNECT],this.getCaipNetworks=S.getCaipNetworks.bind(S),this.caipNetworks=this.getCaipNetworks(),this.provider=e,this.chain=t}get chains(){return this.getCaipNetworks()}async connectWalletConnect(){if(!await this.authenticate()){const t=this.getCaipNetworks(),n=K.state.universalProviderConfigOverride,s=_p.createNamespaces(t,n);await this.provider.connect({optionalNamespaces:s})}return{clientId:await this.provider.client.core.crypto.getClientId(),session:this.provider.session}}async disconnect(){await this.provider.disconnect()}async authenticate(){const e=this.chains.map(t=>t.caipNetworkId);return kh.universalProviderAuthenticate({universalProvider:this.provider,chains:e,methods:az})}}const az=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"];class WI{constructor(e){this.availableConnectors=[],this.eventListeners=new Map,this.getCaipNetworks=t=>S.getCaipNetworks(t),e&&this.construct(e)}construct(e){this.projectId=e.projectId,this.namespace=e.namespace,this.adapterType=e.adapterType}get connectors(){return this.availableConnectors}get networks(){return this.getCaipNetworks(this.namespace)}setAuthProvider(e){this.addConnector({id:ee.CONNECTOR_ID.AUTH,type:"AUTH",name:ee.CONNECTOR_NAMES.AUTH,provider:e,imageId:Ms.ConnectorImageIds[ee.CONNECTOR_ID.AUTH],chain:this.namespace,chains:[]})}addConnector(...e){const t=new Set;this.availableConnectors=[...e,...this.availableConnectors].filter(n=>t.has(n.id)?!1:(t.add(n.id),!0)),this.emit("connectors",this.availableConnectors)}setStatus(e,t){he.setStatus(e,t)}on(e,t){var n;this.eventListeners.has(e)||this.eventListeners.set(e,new Set),(n=this.eventListeners.get(e))==null||n.add(t)}off(e,t){const n=this.eventListeners.get(e);n&&n.delete(t)}removeAllEventListeners(){this.eventListeners.forEach(e=>{e.clear()})}emit(e,t){const n=this.eventListeners.get(e);n&&n.forEach(s=>s(t))}async connectWalletConnect(e){return{clientId:(await this.getWalletConnectConnector().connectWalletConnect()).clientId}}async switchNetwork(e){var i;const{caipNetwork:t,providerType:n}=e;if(!e.provider)return;const s="provider"in e.provider?e.provider.provider:e.provider;if(n==="WALLET_CONNECT"){s.setDefaultChain(t.caipNetworkId);return}if(s&&n==="AUTH"){const o=s,a=(i=he.state.preferredAccountTypes)==null?void 0:i[t.chainNamespace];await o.switchNetwork(t.caipNetworkId);const c=await o.getUser({chainId:t.caipNetworkId,preferredAccountType:a});this.emit("switchNetwork",c)}}getWalletConnectConnector(){const e=this.connectors.find(t=>t instanceof t0);if(!e)throw new Error("WalletConnectConnector not found");return e}}class cz extends WI{setUniversalProvider(e){this.addConnector(new t0({provider:e,caipNetworks:this.getCaipNetworks(),namespace:this.namespace}))}async connect(e){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:Number(e.chainId),provider:this.provider,address:""})}async disconnect(){try{await this.getWalletConnectConnector().disconnect()}catch(e){console.warn("UniversalAdapter:disconnect - error",e)}}async getAccounts({namespace:e}){var s,i,o,a;const t=this.provider,n=((a=(o=(i=(s=t==null?void 0:t.session)==null?void 0:s.namespaces)==null?void 0:i[e])==null?void 0:o.accounts)==null?void 0:a.map(c=>{const[,,l]=c.split(":");return l}).filter((c,l,u)=>u.indexOf(c)===l))||[];return Promise.resolve({accounts:n.map(c=>Ee.createAccount(e,c,e==="bip122"?"payment":"eoa"))})}async syncConnectors(){return Promise.resolve()}async getBalance(e){var i,o,a,c,l;if(!(e.caipNetwork&&ur.BALANCE_SUPPORTED_CHAINS.includes((i=e.caipNetwork)==null?void 0:i.chainNamespace))||(o=e.caipNetwork)!=null&&o.testnet)return{balance:"0.00",symbol:((a=e.caipNetwork)==null?void 0:a.nativeCurrency.symbol)||""};if(he.state.balanceLoading&&e.chainId===((c=S.state.activeCaipNetwork)==null?void 0:c.id))return{balance:he.state.balance||"0.00",symbol:he.state.balanceSymbol||""};const s=(await he.fetchTokenBalance()).find(u=>{var h,d;return u.chainId===`${(h=e.caipNetwork)==null?void 0:h.chainNamespace}:${e.chainId}`&&u.symbol===((d=e.caipNetwork)==null?void 0:d.nativeCurrency.symbol)});return{balance:(s==null?void 0:s.quantity.numeric)||"0.00",symbol:(s==null?void 0:s.symbol)||((l=e.caipNetwork)==null?void 0:l.nativeCurrency.symbol)||""}}async signMessage(e){var o,a,c;const{provider:t,message:n,address:s}=e;if(!t)throw new Error("UniversalAdapter:signMessage - provider is undefined");let i="";return((o=S.state.activeCaipNetwork)==null?void 0:o.chainNamespace)===ee.CHAIN.SOLANA?i=(await t.request({method:"solana_signMessage",params:{message:H_.encode(new TextEncoder().encode(n)),pubkey:s}},(a=S.state.activeCaipNetwork)==null?void 0:a.caipNetworkId)).signature:i=await t.request({method:"personal_sign",params:[n,s]},(c=S.state.activeCaipNetwork)==null?void 0:c.caipNetworkId),{signature:i}}async estimateGas(){return Promise.resolve({gas:BigInt(0)})}async sendTransaction(){return Promise.resolve({hash:""})}walletGetAssets(e){return Promise.resolve({})}async writeContract(){return Promise.resolve({hash:""})}parseUnits(){return 0n}formatUnits(){return"0"}async getCapabilities(){return Promise.resolve({})}async grantPermissions(){return Promise.resolve({})}async revokePermissions(){return Promise.resolve("0x")}async syncConnection(){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:1,provider:this.provider,address:""})}async switchNetwork(e){var s,i,o,a,c,l;const{caipNetwork:t}=e,n=this.getWalletConnectConnector();if(t.chainNamespace===ee.CHAIN.EVM)try{await((s=n.provider)==null?void 0:s.request({method:"wallet_switchEthereumChain",params:[{chainId:LA(t.id)}]}))}catch(u){if(u.code===Ti.ERROR_CODE_UNRECOGNIZED_CHAIN_ID||u.code===Ti.ERROR_INVALID_CHAIN_ID||u.code===Ti.ERROR_CODE_DEFAULT||((o=(i=u==null?void 0:u.data)==null?void 0:i.originalError)==null?void 0:o.code)===Ti.ERROR_CODE_UNRECOGNIZED_CHAIN_ID)try{await((l=n.provider)==null?void 0:l.request({method:"wallet_addEthereumChain",params:[{chainId:LA(t.id),rpcUrls:[(a=t==null?void 0:t.rpcUrls.chainDefault)==null?void 0:a.http],chainName:t.name,nativeCurrency:t.nativeCurrency,blockExplorerUrls:[(c=t.blockExplorers)==null?void 0:c.default.url]}]}))}catch{throw new Error("Chain is not supported")}}n.provider.setDefaultChain(t.caipNetworkId)}getWalletConnectProvider(){const e=this.connectors.find(n=>n.type==="WALLET_CONNECT");return e==null?void 0:e.provider}}class lz{constructor(e){this.chainNamespaces=[],this.reportedAlertErrors={},this.getCaipNetwork=(t,n)=>{var s,i,o,a;if(t){const c=(i=(s=S.getNetworkData(t))==null?void 0:s.requestedCaipNetworks)==null?void 0:i.find(u=>u.id===n);if(c)return c;const l=(o=S.getNetworkData(t))==null?void 0:o.caipNetwork;return l||((a=S.getRequestedCaipNetworks(t).filter(u=>u.chainNamespace===t))==null?void 0:a[0])}return S.state.activeCaipNetwork||this.defaultCaipNetwork},this.getCaipNetworkId=()=>{const t=this.getCaipNetwork();if(t)return t.id},this.getCaipNetworks=t=>S.getCaipNetworks(t),this.getActiveChainNamespace=()=>S.state.activeChain,this.setRequestedCaipNetworks=(t,n)=>{S.setRequestedCaipNetworks(t,n)},this.getApprovedCaipNetworkIds=()=>S.getAllApprovedCaipNetworkIds(),this.getCaipAddress=t=>S.state.activeChain===t||!t?S.state.activeCaipAddress:S.getAccountProp("caipAddress",t),this.setClientId=t=>{Ae.setClientId(t)},this.getProvider=t=>qe.getProvider(t),this.getProviderType=t=>qe.getProviderId(t),this.getPreferredAccountType=t=>{var n;return(n=he.state.preferredAccountTypes)==null?void 0:n[t]},this.setCaipAddress=(t,n)=>{he.setCaipAddress(t,n)},this.setBalance=(t,n,s)=>{he.setBalance(t,n,s)},this.setProfileName=(t,n)=>{he.setProfileName(t,n)},this.setProfileImage=(t,n)=>{he.setProfileImage(t,n)},this.setUser=(t,n)=>{he.setUser(t,n),K.state.enableEmbedded&&Ut.close()},this.resetAccount=t=>{he.resetAccount(t)},this.setCaipNetwork=t=>{S.setActiveCaipNetwork(t)},this.setCaipNetworkOfNamespace=(t,n)=>{S.setChainNetworkData(n,{caipNetwork:t})},this.setAllAccounts=(t,n)=>{he.setAllAccounts(t,n),K.setHasMultipleAddresses((t==null?void 0:t.length)>1)},this.setStatus=(t,n)=>{he.setStatus(t,n),_e.isConnected()?se.setConnectionStatus("connected"):se.setConnectionStatus("disconnected")},this.getAddressByChainNamespace=t=>S.getAccountProp("address",t),this.setConnectors=t=>{const n=[..._e.state.allConnectors,...t];_e.setConnectors(n)},this.fetchIdentity=t=>Ae.fetchIdentity(t),this.getReownName=t=>SI.getNamesForAddress(t),this.getConnectors=()=>_e.getConnectors(),this.getConnectorImage=t=>UC.getConnectorImage(t),this.setConnectedWalletInfo=(t,n)=>{const s=qe.getProviderId(n),i=t?{...t,type:s}:void 0;he.setConnectedWalletInfo(i,n)},this.getIsConnectedState=()=>!!S.state.activeCaipAddress,this.addAddressLabel=(t,n,s)=>{he.addAddressLabel(t,n,s)},this.removeAddressLabel=(t,n)=>{he.removeAddressLabel(t,n)},this.getAddress=t=>S.state.activeChain===t||!t?he.state.address:S.getAccountProp("address",t),this.setApprovedCaipNetworksData=t=>S.setApprovedCaipNetworksData(t),this.resetNetwork=t=>{S.resetNetwork(t)},this.addConnector=t=>{_e.addConnector(t)},this.resetWcConnection=()=>{Et.resetWcConnection()},this.setAddressExplorerUrl=(t,n)=>{he.setAddressExplorerUrl(t,n)},this.setSmartAccountDeployed=(t,n)=>{he.setSmartAccountDeployed(t,n)},this.setSmartAccountEnabledNetworks=(t,n)=>{S.setSmartAccountEnabledNetworks(t,n)},this.setPreferredAccountType=(t,n)=>{he.setPreferredAccountType(t,n)},this.setEIP6963Enabled=t=>{K.setEIP6963Enabled(t)},this.handleUnsafeRPCRequest=()=>{if(this.isOpen()){if(this.isTransactionStackEmpty())return;this.redirect("ApproveTransaction")}else this.open({view:"ApproveTransaction"})},this.options=e,this.version=e.sdkVersion,this.caipNetworks=this.extendCaipNetworks(e),this.chainNamespaces=this.getChainNamespacesSet(e.adapters,this.caipNetworks),this.defaultCaipNetwork=this.extendDefaultCaipNetwork(e),this.chainAdapters=this.createAdapters(e.adapters),this.initialize(e)}getChainNamespacesSet(e,t){const n=e==null?void 0:e.map(i=>i.namespace).filter(i=>!!i);if(n!=null&&n.length)return[...new Set(n)];const s=t==null?void 0:t.map(i=>i.chainNamespace);return[...new Set(s)]}async initialize(e){var t,n,s;this.initControllers(e),await this.initChainAdapters(),await this.injectModalUi(),this.sendInitializeEvent(e),Vs.set({initialized:!0}),await this.syncExistingConnection(),((t=K.state.features)!=null&&t.email||Array.isArray((n=K.state.features)==null?void 0:n.socials)&&((s=K.state.features)==null?void 0:s.socials.length)>0)&&await this.checkAllowedOrigins()}async checkAllowedOrigins(){const e=await be.fetchAllowedOrigins();if(e&&Ee.isClient()){const t=window.location.origin;_p.isOriginAllowed(t,e,Ti.DEFAULT_ALLOWED_ANCESTORS)||Ni.open($s.ALERT_ERRORS.INVALID_APP_CONFIGURATION,"error")}else Ni.open($s.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error")}sendInitializeEvent(e){var n;const{...t}=e;delete t.adapters,delete t.universalProvider,At.sendEvent({type:"track",event:"INITIALIZE",properties:{...t,networks:e.networks.map(s=>s.id),siweConfig:{options:((n=e.siweConfig)==null?void 0:n.options)||{}}}})}initControllers(e){this.initializeOptionsController(e),this.initializeChainController(e),this.initializeThemeController(e),this.initializeConnectionController(e),this.initializeConnectorController()}initializeThemeController(e){e.themeMode&&Ar.setThemeMode(e.themeMode),e.themeVariables&&Ar.setThemeVariables(e.themeVariables)}initializeChainController(e){if(!this.connectionControllerClient||!this.networkControllerClient)throw new Error("ConnectionControllerClient and NetworkControllerClient must be set");S.initialize(e.adapters??[],this.caipNetworks,{connectionControllerClient:this.connectionControllerClient,networkControllerClient:this.networkControllerClient});const t=this.getDefaultNetwork();t&&S.setActiveCaipNetwork(t)}initializeConnectionController(e){Et.setWcBasic(e.basic??!1)}initializeConnectorController(){_e.initialize(this.chainNamespaces)}initializeOptionsController(e){var o;K.setDebug(e.debug!==!1),K.setEnableWalletConnect(e.enableWalletConnect!==!1),K.setEnableWalletGuide(e.enableWalletGuide!==!1),K.setEnableWallets(e.enableWallets!==!1),K.setEIP6963Enabled(e.enableEIP6963!==!1),K.setEnableNetworkSwitch(e.enableNetworkSwitch!==!1),K.setEnableAuthLogger(e.enableAuthLogger!==!1),K.setCustomRpcUrls(e.customRpcUrls),K.setSdkVersion(e.sdkVersion),K.setProjectId(e.projectId),K.setEnableEmbedded(e.enableEmbedded),K.setAllWallets(e.allWallets),K.setIncludeWalletIds(e.includeWalletIds),K.setExcludeWalletIds(e.excludeWalletIds),K.setFeaturedWalletIds(e.featuredWalletIds),K.setTokens(e.tokens),K.setTermsConditionsUrl(e.termsConditionsUrl),K.setPrivacyPolicyUrl(e.privacyPolicyUrl),K.setCustomWallets(e.customWallets),K.setFeatures(e.features),K.setAllowUnsupportedChain(e.allowUnsupportedChain),K.setUniversalProviderConfigOverride(e.universalProviderConfigOverride),K.setDefaultAccountTypes(e.defaultAccountTypes);const t=se.getPreferredAccountTypes(),n={...K.state.defaultAccountTypes,...t};he.setPreferredAccountTypes(n);const s=this.getDefaultMetaData();if(!e.metadata&&s&&(e.metadata=s),K.setMetadata(e.metadata),K.setDisableAppend(e.disableAppend),K.setEnableEmbedded(e.enableEmbedded),K.setSIWX(e.siwx),!e.projectId){Ni.open($s.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error");return}if(((o=e.adapters)==null?void 0:o.find(a=>a.namespace===ee.CHAIN.EVM))&&e.siweConfig){if(e.siwx)throw new Error("Cannot set both `siweConfig` and `siwx` options");K.setSIWX(e.siweConfig.mapToSIWX())}}getDefaultMetaData(){var e,t,n,s;return typeof window<"u"&&typeof document<"u"?{name:((t=(e=document.getElementsByTagName("title"))==null?void 0:e[0])==null?void 0:t.textContent)||"",description:((n=document.querySelector('meta[property="og:description"]'))==null?void 0:n.content)||"",url:window.location.origin,icons:[((s=document.querySelector('link[rel~="icon"]'))==null?void 0:s.href)||""]}:null}setUnsupportedNetwork(e){const t=this.getActiveChainNamespace();if(t){const n=Xc.getUnsupportedNetwork(`${t}:${e}`);S.setActiveCaipNetwork(n)}}getDefaultNetwork(){return Xc.getCaipNetworkFromStorage(this.defaultCaipNetwork)}extendCaipNetwork(e,t){return Xc.extendCaipNetwork(e,{customNetworkImageUrls:t.chainImages,projectId:t.projectId})}extendCaipNetworks(e){return Xc.extendCaipNetworks(e.networks,{customNetworkImageUrls:e.chainImages,customRpcUrls:e.customRpcUrls,projectId:e.projectId})}extendDefaultCaipNetwork(e){const t=e.networks.find(s=>{var i;return s.id===((i=e.defaultNetwork)==null?void 0:i.id)});return t?Xc.extendCaipNetwork(t,{customNetworkImageUrls:e.chainImages,customRpcUrls:e.customRpcUrls,projectId:e.projectId}):void 0}createClients(){this.connectionControllerClient={connectWalletConnect:async()=>{var i;const e=S.state.activeChain,t=this.getAdapter(e),n=(i=this.getCaipNetwork(e))==null?void 0:i.id;if(!t)throw new Error("Adapter not found");const s=await t.connectWalletConnect(n);this.close(),this.setClientId((s==null?void 0:s.clientId)||null),se.setConnectedNamespaces([...S.state.chains.keys()]),this.chainNamespaces.forEach(o=>{_e.setConnectorId(ft.CONNECTOR_TYPE_WALLET_CONNECT,o)}),await this.syncWalletConnectAccount()},connectExternal:async({id:e,info:t,type:n,provider:s,chain:i,caipNetwork:o})=>{var f,g,p,m,w,A;const a=S.state.activeChain,c=i||a,l=this.getAdapter(c);if(i&&i!==a&&!o){const v=this.getCaipNetworks().find(N=>N.chainNamespace===i);v&&this.setCaipNetwork(v)}if(!l)throw new Error("Adapter not found");const u=this.getCaipNetwork(c),h=await l.connect({id:e,info:t,type:n,provider:s,chainId:(o==null?void 0:o.id)||(u==null?void 0:u.id),rpcUrl:((p=(g=(f=o==null?void 0:o.rpcUrls)==null?void 0:f.default)==null?void 0:g.http)==null?void 0:p[0])||((A=(w=(m=u==null?void 0:u.rpcUrls)==null?void 0:m.default)==null?void 0:w.http)==null?void 0:A[0])});if(!h)return;se.addConnectedNamespace(c),this.syncProvider({...h,chainNamespace:c});const{accounts:d}=await l.getAccounts({namespace:c,id:e});this.setAllAccounts(d,c),this.setStatus("connected",c),this.syncConnectedWalletInfo(c)},reconnectExternal:async({id:e,info:t,type:n,provider:s})=>{var a;const i=S.state.activeChain,o=this.getAdapter(i);o!=null&&o.reconnect&&(await(o==null?void 0:o.reconnect({id:e,info:t,type:n,provider:s,chainId:(a=this.getCaipNetwork())==null?void 0:a.id})),se.addConnectedNamespace(i),this.syncConnectedWalletInfo(i))},disconnect:async e=>{const t=e||S.state.activeChain,n=this.getAdapter(t),s=qe.getProvider(t),i=qe.getProviderId(t);await(n==null?void 0:n.disconnect({provider:s,providerType:i})),se.removeConnectedNamespace(t),qe.resetChain(t),this.setUser(void 0,t),this.setStatus("disconnected",t),this.setConnectedWalletInfo(void 0,t)},checkInstalled:e=>e?e.some(t=>{var n;return!!((n=window.ethereum)!=null&&n[String(t)])}):!!window.ethereum,signMessage:async e=>{const t=this.getAdapter(S.state.activeChain),n=await(t==null?void 0:t.signMessage({message:e,address:he.state.address,provider:qe.getProvider(S.state.activeChain)}));return(n==null?void 0:n.signature)||""},sendTransaction:async e=>{const t=e.chainNamespace;if(ur.SEND_SUPPORTED_NAMESPACES.includes(t)){const n=this.getAdapter(S.state.activeChain),s=qe.getProvider(t),i=await(n==null?void 0:n.sendTransaction({...e,caipNetwork:this.getCaipNetwork(),provider:s}));return(i==null?void 0:i.hash)||""}return""},estimateGas:async e=>{if(e.chainNamespace===ee.CHAIN.EVM){const t=this.getAdapter(S.state.activeChain),n=qe.getProvider(S.state.activeChain),s=this.getCaipNetwork();if(!s)throw new Error("CaipNetwork is undefined");const i=await(t==null?void 0:t.estimateGas({...e,provider:n,caipNetwork:s}));return(i==null?void 0:i.gas)||0n}return 0n},getEnsAvatar:async()=>{var e;return await this.syncIdentity({address:he.state.address,chainId:Number((e=this.getCaipNetwork())==null?void 0:e.id),chainNamespace:S.state.activeChain}),he.state.profileImage||!1},getEnsAddress:async e=>await _p.resolveReownName(e),writeContract:async e=>{const t=this.getAdapter(S.state.activeChain),n=this.getCaipNetwork(),s=this.getCaipAddress(),i=qe.getProvider(S.state.activeChain);if(!n||!s)throw new Error("CaipNetwork or CaipAddress is undefined");const o=await(t==null?void 0:t.writeContract({...e,caipNetwork:n,provider:i,caipAddress:s}));return o==null?void 0:o.hash},parseUnits:(e,t)=>{const n=this.getAdapter(S.state.activeChain);return(n==null?void 0:n.parseUnits({value:e,decimals:t}))??0n},formatUnits:(e,t)=>{const n=this.getAdapter(S.state.activeChain);return(n==null?void 0:n.formatUnits({value:e,decimals:t}))??"0"},getCapabilities:async e=>{const t=this.getAdapter(S.state.activeChain);return await(t==null?void 0:t.getCapabilities(e))},grantPermissions:async e=>{const t=this.getAdapter(S.state.activeChain);return await(t==null?void 0:t.grantPermissions(e))},revokePermissions:async e=>{const t=this.getAdapter(S.state.activeChain);return t!=null&&t.revokePermissions?await t.revokePermissions(e):"0x"},walletGetAssets:async e=>{const t=this.getAdapter(S.state.activeChain);return await(t==null?void 0:t.walletGetAssets(e))??{}}},this.networkControllerClient={switchCaipNetwork:async e=>await this.switchCaipNetwork(e),getApprovedCaipNetworksData:async()=>this.getApprovedCaipNetworksData()},Et.setClient(this.connectionControllerClient)}getApprovedCaipNetworksData(){var t,n,s,i,o;if(qe.getProviderId(S.state.activeChain)===ft.CONNECTOR_TYPE_WALLET_CONNECT){const a=(n=(t=this.universalProvider)==null?void 0:t.session)==null?void 0:n.namespaces;return{supportsAllNetworks:((o=(i=(s=this.universalProvider)==null?void 0:s.session)==null?void 0:i.peer)==null?void 0:o.metadata.name)==="MetaMask Wallet",approvedCaipNetworkIds:this.getChainsFromNamespaces(a)}}return{supportsAllNetworks:!0,approvedCaipNetworkIds:[]}}async switchCaipNetwork(e){if(!e)return;const t=e.chainNamespace;if(this.getAddressByChainNamespace(e.chainNamespace)){const s=qe.getProvider(t),i=qe.getProviderId(t);if(e.chainNamespace===S.state.activeChain){const o=this.getAdapter(t);await(o==null?void 0:o.switchNetwork({caipNetwork:e,provider:s,providerType:i}))}else if(this.setCaipNetwork(e),i===ft.CONNECTOR_TYPE_WALLET_CONNECT)this.syncWalletConnectAccount();else{const o=this.getAddressByChainNamespace(t);o&&this.syncAccount({address:o,chainId:e.id,chainNamespace:t})}}else this.setCaipNetwork(e)}getChainsFromNamespaces(e={}){return Object.values(e).flatMap(t=>{const n=t.chains||[],s=t.accounts.map(i=>{const{chainId:o,chainNamespace:a}=ai.parseCaipAddress(i);return`${a}:${o}`});return Array.from(new Set([...n,...s]))})}createAdapters(e){return this.createClients(),this.chainNamespaces.reduce((t,n)=>{var i;const s=e==null?void 0:e.find(o=>o.namespace===n);return s?(s.construct({namespace:n,projectId:(i=this.options)==null?void 0:i.projectId,networks:this.getCaipNetworks()}),t[n]=s):t[n]=new cz({namespace:n,networks:this.getCaipNetworks()}),t},{})}async initChainAdapter(e){var t;this.onConnectors(e),this.listenAdapter(e),(t=this.chainAdapters)==null||t[e].syncConnectors(this.options,this),await this.createUniversalProviderForAdapter(e)}async initChainAdapters(){await Promise.all(this.chainNamespaces.map(async e=>{await this.initChainAdapter(e)}))}onConnectors(e){const t=this.getAdapter(e);t==null||t.on("connectors",this.setConnectors.bind(this))}listenAdapter(e){const t=this.getAdapter(e);if(!t)return;const n=se.getConnectionStatus();n==="connected"?this.setStatus("connecting",e):n==="disconnected"?(se.clearAddressCache(),this.setStatus(n,e)):this.setStatus(n,e),t.on("switchNetwork",({address:s,chainId:i})=>{const o=this.getCaipNetworks().find(l=>l.id===i||l.caipNetworkId===i),a=S.state.activeChain===e,c=S.getAccountProp("address",e);if(o){const l=a&&s?s:c;l&&this.syncAccount({address:l,chainId:o.id,chainNamespace:e})}else this.setUnsupportedNetwork(i)}),t.on("disconnect",this.disconnect.bind(this,e)),t.on("pendingTransactions",()=>{const s=he.state.address,i=S.state.activeCaipNetwork;!s||!(i!=null&&i.id)||this.updateNativeBalance(s,i.id,i.chainNamespace)}),t.on("accountChanged",({address:s,chainId:i})=>{var a,c;const o=S.state.activeChain===e;o&&i?this.syncAccount({address:s,chainId:i,chainNamespace:e}):o&&((a=S.state.activeCaipNetwork)!=null&&a.id)?this.syncAccount({address:s,chainId:(c=S.state.activeCaipNetwork)==null?void 0:c.id,chainNamespace:e}):this.syncAccountInfo(s,i,e),this.syncAllAccounts(e)})}async createUniversalProviderForAdapter(e){var t,n,s;await this.getUniversalProvider(),this.universalProvider&&((s=(n=(t=this.chainAdapters)==null?void 0:t[e])==null?void 0:n.setUniversalProvider)==null||s.call(n,this.universalProvider))}async syncExistingConnection(){await Promise.allSettled(this.chainNamespaces.map(e=>this.syncNamespaceConnection(e)))}async syncNamespaceConnection(e){try{const t=_e.getConnectorId(e);switch(this.setStatus("connecting",e),t){case ee.CONNECTOR_ID.WALLET_CONNECT:await this.syncWalletConnectAccount();break;case ee.CONNECTOR_ID.AUTH:break;default:await this.syncAdapterConnection(e)}}catch(t){console.warn("AppKit couldn't sync existing connection",t),this.setStatus("disconnected",e)}}async syncAdapterConnection(e){var o,a,c;const t=this.getAdapter(e),n=_e.getConnectorId(e),s=this.getCaipNetwork(e),i=_e.getConnectors(e).find(l=>l.id===n);try{if(!t||!i)throw new Error(`Adapter or connector not found for namespace ${e}`);if(!(s!=null&&s.id))throw new Error("CaipNetwork not found");const l=await(t==null?void 0:t.syncConnection({namespace:e,id:i.id,chainId:s.id,rpcUrl:(c=(a=(o=s==null?void 0:s.rpcUrls)==null?void 0:o.default)==null?void 0:a.http)==null?void 0:c[0]}));if(l){const u=await(t==null?void 0:t.getAccounts({namespace:e,id:i.id}));u&&u.accounts.length>0?this.setAllAccounts(u.accounts,e):this.setAllAccounts([Ee.createAccount(e,l.address,"eoa")],e),this.syncProvider({...l,chainNamespace:e}),await this.syncAccount({...l,chainNamespace:e}),this.setStatus("connected",e)}else this.setStatus("disconnected",e)}catch{this.setStatus("disconnected",e)}}async syncWalletConnectAccount(){const e=this.chainNamespaces.map(async t=>{var a,c,l,u,h;const n=this.getAdapter(t),s=((u=(l=(c=(a=this.universalProvider)==null?void 0:a.session)==null?void 0:c.namespaces)==null?void 0:l[t])==null?void 0:u.accounts)||[],i=(h=S.state.activeCaipNetwork)==null?void 0:h.id,o=s.find(d=>{const{chainId:f}=ai.parseCaipAddress(d);return f===(i==null?void 0:i.toString())})||s[0];if(o){const d=ai.validateCaipAddress(o),{chainId:f,address:g}=ai.parseCaipAddress(d);if(qe.setProviderId(t,ft.CONNECTOR_TYPE_WALLET_CONNECT),this.caipNetworks&&S.state.activeCaipNetwork&&(n==null?void 0:n.namespace)!==ee.CHAIN.EVM){const p=n==null?void 0:n.getWalletConnectProvider({caipNetworks:this.getCaipNetworks(),provider:this.universalProvider,activeCaipNetwork:S.state.activeCaipNetwork});qe.setProvider(t,p)}else qe.setProvider(t,this.universalProvider);_e.setConnectorId(ee.CONNECTOR_ID.WALLET_CONNECT,t),se.addConnectedNamespace(t),this.syncWalletConnectAccounts(t),await this.syncAccount({address:g,chainId:f,chainNamespace:t})}else this.setStatus("disconnected",t);this.syncConnectedWalletInfo(t),await S.setApprovedCaipNetworksData(t)});await Promise.all(e)}syncWalletConnectAccounts(e){var n,s,i,o,a;const t=(a=(o=(i=(s=(n=this.universalProvider)==null?void 0:n.session)==null?void 0:s.namespaces)==null?void 0:i[e])==null?void 0:o.accounts)==null?void 0:a.map(c=>{const{address:l}=ai.parseCaipAddress(c);return l}).filter((c,l,u)=>u.indexOf(c)===l);t&&this.setAllAccounts(t.map(c=>Ee.createAccount(e,c,e==="bip122"?"payment":"eoa")),e)}syncProvider({type:e,provider:t,id:n,chainNamespace:s}){qe.setProviderId(s,e),qe.setProvider(s,t),_e.setConnectorId(n,s)}async syncAllAccounts(e){const t=_e.getConnectorId(e);if(!t)return;const n=this.getAdapter(e),s=await(n==null?void 0:n.getAccounts({namespace:e,id:t}));s&&s.accounts.length>0&&this.setAllAccounts(s.accounts,e)}async syncAccount(e){var h,d;const t=e.chainNamespace===S.state.activeChain,n=S.getCaipNetworkByNamespace(e.chainNamespace,e.chainId),{address:s,chainId:i,chainNamespace:o}=e,{chainId:a}=se.getActiveNetworkProps(),c=i||a,l=((h=S.state.activeCaipNetwork)==null?void 0:h.name)===ee.UNSUPPORTED_NETWORK_NAME,u=S.getNetworkProp("supportsAllNetworks",o);if(this.setStatus("connected",o),!(l&&!u)&&c){let f=this.getCaipNetworks().find(m=>m.id.toString()===c.toString()),g=this.getCaipNetworks().find(m=>m.chainNamespace===o);if(!u&&!f&&!g){const m=this.getApprovedCaipNetworkIds()||[],w=m.find(v=>{var N;return((N=ai.parseCaipNetworkId(v))==null?void 0:N.chainId)===c.toString()}),A=m.find(v=>{var N;return((N=ai.parseCaipNetworkId(v))==null?void 0:N.chainNamespace)===o});f=this.getCaipNetworks().find(v=>v.caipNetworkId===w),g=this.getCaipNetworks().find(v=>v.caipNetworkId===A||"deprecatedCaipNetworkId"in v&&v.deprecatedCaipNetworkId===A)}const p=f||g;(p==null?void 0:p.chainNamespace)===S.state.activeChain?K.state.enableNetworkSwitch&&!K.state.allowUnsupportedChain&&((d=S.state.activeCaipNetwork)==null?void 0:d.name)===ee.UNSUPPORTED_NETWORK_NAME?S.showUnsupportedChainUI():this.setCaipNetwork(p):t||n&&this.setCaipNetworkOfNamespace(n,o),this.syncConnectedWalletInfo(o),Wg.isLowerCaseMatch(s,he.state.address)||this.syncAccountInfo(s,p==null?void 0:p.id,o),t?await this.syncBalance({address:s,chainId:p==null?void 0:p.id,chainNamespace:o}):await this.syncBalance({address:s,chainId:n==null?void 0:n.id,chainNamespace:o})}}async syncAccountInfo(e,t,n){const s=this.getCaipAddress(n),i=t||(s==null?void 0:s.split(":")[1]);if(!i)return;const o=`${n}:${i}:${e}`;this.setCaipAddress(o,n),await this.syncIdentity({address:e,chainId:i,chainNamespace:n})}async syncReownName(e,t){try{const n=await this.getReownName(e);if(n[0]){const s=n[0];this.setProfileName(s.name,t)}else this.setProfileName(null,t)}catch{this.setProfileName(null,t)}}syncConnectedWalletInfo(e){var s;const t=_e.getConnectorId(e),n=qe.getProviderId(e);if(n===ft.CONNECTOR_TYPE_ANNOUNCED||n===ft.CONNECTOR_TYPE_INJECTED){if(t){const i=this.getConnectors().find(o=>o.id===t);if(i){const{info:o,name:a,imageUrl:c}=i,l=c||this.getConnectorImage(i);this.setConnectedWalletInfo({name:a,icon:l,...o},e)}}}else if(n===ft.CONNECTOR_TYPE_WALLET_CONNECT){const i=qe.getProvider(e);i!=null&&i.session&&this.setConnectedWalletInfo({...i.session.peer.metadata,name:i.session.peer.metadata.name,icon:(s=i.session.peer.metadata.icons)==null?void 0:s[0]},e)}else if(t)if(t===ee.CONNECTOR_ID.COINBASE){const i=this.getConnectors().find(o=>o.id===ee.CONNECTOR_ID.COINBASE);this.setConnectedWalletInfo({name:"Coinbase Wallet",icon:this.getConnectorImage(i)},e)}else this.setConnectedWalletInfo({name:t},e)}async syncBalance(e){!RC.getNetworksByNamespace(this.getCaipNetworks(),e.chainNamespace).find(n=>{var s;return n.id.toString()===((s=e.chainId)==null?void 0:s.toString())})||!e.chainId||await this.updateNativeBalance(e.address,e.chainId,e.chainNamespace)}async updateNativeBalance(e,t,n){const s=this.getAdapter(n),i=S.getCaipNetworkByNamespace(n,t);if(s){const o=await s.getBalance({address:e,chainId:t,caipNetwork:i,tokens:this.options.tokens});this.setBalance(o.balance,o.symbol,n)}}async initializeUniversalAdapter(){var n,s,i,o,a,c,l,u,h,d;const e=m9.createLogger((f,...g)=>{f&&this.handleAlertError(f),console.error(...g)}),t={projectId:(n=this.options)==null?void 0:n.projectId,metadata:{name:(s=this.options)!=null&&s.metadata?(i=this.options)==null?void 0:i.metadata.name:"",description:(o=this.options)!=null&&o.metadata?(a=this.options)==null?void 0:a.metadata.description:"",url:(c=this.options)!=null&&c.metadata?(l=this.options)==null?void 0:l.metadata.url:"",icons:(u=this.options)!=null&&u.metadata?(h=this.options)==null?void 0:h.metadata.icons:[""]},logger:e};K.setManualWCControl(!!((d=this.options)!=null&&d.manualWCControl)),this.universalProvider=this.options.universalProvider??await yj.init(t),this.listenWalletConnect()}listenWalletConnect(){this.universalProvider&&(this.universalProvider.on("display_uri",e=>{Et.setUri(e)}),this.universalProvider.on("connect",Et.finalizeWcConnection),this.universalProvider.on("disconnect",()=>{this.chainNamespaces.forEach(e=>{this.resetAccount(e)}),Et.resetWcConnection()}),this.universalProvider.on("chainChanged",e=>{const t=this.getCaipNetworks().find(s=>s.id==e),n=this.getCaipNetwork();if(!t){this.setUnsupportedNetwork(e);return}(n==null?void 0:n.id)!==(t==null?void 0:t.id)&&this.setCaipNetwork(t)}),this.universalProvider.on("session_event",e=>{if(_p.isSessionEventData(e)){const{name:t,data:n}=e.params.event;t==="accountsChanged"&&Array.isArray(n)&&Ee.isCaipAddress(n[0])&&this.syncAccount(ai.parseCaipAddress(n[0]))}}))}createUniversalProvider(){var e;return!this.universalProviderInitPromise&&Ee.isClient()&&((e=this.options)!=null&&e.projectId)&&(this.universalProviderInitPromise=this.initializeUniversalAdapter()),this.universalProviderInitPromise}async getUniversalProvider(){if(!this.universalProvider)try{await this.createUniversalProvider()}catch(e){At.sendEvent({type:"error",event:"INTERNAL_SDK_ERROR",properties:{errorType:"UniversalProviderInitError",errorMessage:e instanceof Error?e.message:"Unknown",uncaught:!1}}),console.error("AppKit:getUniversalProvider - Cannot create provider",e)}return this.universalProvider}handleAlertError(e){const t=Object.entries($s.UniversalProviderErrors).find(([,{message:a}])=>e.message.includes(a)),[n,s]=t??[],{message:i,alertErrorKey:o}=s??{};if(n&&i&&!this.reportedAlertErrors[n]){const a=$s.ALERT_ERRORS[o];a&&(Ni.open(a,"error"),this.reportedAlertErrors[n]=!0)}}getAdapter(e){var t;if(e)return(t=this.chainAdapters)==null?void 0:t[e]}createAdapter(e){var s;if(!e)return;const t=e.namespace;if(!t)return;this.createClients();const n=e;n.namespace=t,n.construct({namespace:t,projectId:(s=this.options)==null?void 0:s.projectId,networks:this.getCaipNetworks()}),this.chainNamespaces.includes(t)||this.chainNamespaces.push(t),this.chainAdapters&&(this.chainAdapters[t]=n)}async open(e){if(await this.injectModalUi(),e!=null&&e.uri&&Et.setUri(e.uri),e!=null&&e.arguments)switch(e==null?void 0:e.view){case"Swap":return Ut.open({...e,data:{swap:e.arguments}})}return Ut.open(e)}async close(e=!1){await this.injectModalUi(),Ut.close(e)}setLoading(e,t){Ut.setLoading(e,t)}async disconnect(e){await Et.disconnect(e)}getSIWX(){return K.state.siwx}getError(){return""}getChainId(){var e;return(e=S.state.activeCaipNetwork)==null?void 0:e.id}async switchNetwork(e){const t=this.getCaipNetworks().find(n=>n.id===e.id);if(!t){Ni.open($s.ALERT_ERRORS.SWITCH_NETWORK_NOT_FOUND,"error");return}await S.switchActiveNetwork(t)}getWalletProvider(){return S.state.activeChain?qe.state.providers[S.state.activeChain]:null}getWalletProviderType(){return qe.getProviderId(S.state.activeChain)}subscribeProviders(e){return qe.subscribeProviders(e)}getThemeMode(){return Ar.state.themeMode}getThemeVariables(){return Ar.state.themeVariables}setThemeMode(e){Ar.setThemeMode(e),VI(Ar.state.themeMode)}setTermsConditionsUrl(e){K.setTermsConditionsUrl(e)}setPrivacyPolicyUrl(e){K.setPrivacyPolicyUrl(e)}setThemeVariables(e){Ar.setThemeVariables(e),rz(Ar.state.themeVariables)}subscribeTheme(e){return Ar.subscribe(e)}getWalletInfo(){return he.state.connectedWalletInfo}getAccount(e){var o;const t=_e.getAuthConnector(e),n=S.getAccountData(e),s=S.state.activeChain,i=se.getConnectedConnectorId(e);if(n)return{allAccounts:n.allAccounts,caipAddress:n.caipAddress,address:Ee.getPlainAddress(n.caipAddress),isConnected:!!n.caipAddress,status:n.status,embeddedWalletInfo:t&&i===ee.CONNECTOR_ID.AUTH?{user:n.user?{...n.user,username:se.getConnectedSocialUsername()}:void 0,authProvider:n.socialProvider||"email",accountType:(o=n.preferredAccountTypes)==null?void 0:o[e||s],isSmartAccountDeployed:!!n.smartAccountDeployed}:void 0}}subscribeAccount(e,t){const n=()=>{const s=this.getAccount(t);s&&e(s)};t?S.subscribeChainProp("accountState",n,t):S.subscribe(n),_e.subscribe(n)}subscribeNetwork(e){return S.subscribe(({activeCaipNetwork:t})=>{e({caipNetwork:t,chainId:t==null?void 0:t.id,caipNetworkId:t==null?void 0:t.caipNetworkId})})}subscribeWalletInfo(e){return he.subscribeKey("connectedWalletInfo",e)}subscribeShouldUpdateToAddress(e){he.subscribeKey("shouldUpdateToAddress",e)}subscribeCaipNetworkChange(e){S.subscribeKey("activeCaipNetwork",e)}getState(){return Vs.state}subscribeState(e){return Vs.subscribe(e)}showErrorMessage(e){os.showError(e)}showSuccessMessage(e){os.showSuccess(e)}getEvent(){return{...At.state}}subscribeEvents(e){return At.subscribe(e)}replace(e){tt.replace(e)}redirect(e){tt.push(e)}popTransactionStack(e){tt.popTransactionStack(e)}isOpen(){return Ut.state.open}isTransactionStackEmpty(){return tt.state.transactionStack.length===0}isTransactionShouldReplaceView(){var e;return(e=tt.state.transactionStack[tt.state.transactionStack.length-1])==null?void 0:e.replace}static getInstance(){return this.instance}updateFeatures(e){K.setFeatures(e)}updateOptions(e){const n={...K.state||{},...e};K.setOptions(n)}setConnectMethodsOrder(e){K.setConnectMethodsOrder(e)}setWalletFeaturesOrder(e){K.setWalletFeaturesOrder(e)}setCollapseWallets(e){K.setCollapseWallets(e)}setSocialsOrder(e){K.setSocialsOrder(e)}getConnectMethodsOrder(){return Dw.getConnectOrderMethod(K.state.features,_e.getConnectors())}addNetwork(e,t){if(this.chainAdapters&&!this.chainAdapters[e])throw new Error(`Adapter for namespace ${e} doesn't exist`);const n=this.extendCaipNetwork(t,this.options);this.getCaipNetworks().find(s=>s.id===n.id)||S.addNetwork(n)}removeNetwork(e,t){if(this.chainAdapters&&!this.chainAdapters[e])throw new Error(`Adapter for namespace ${e} doesn't exist`);this.getCaipNetworks().find(s=>s.id===t)&&S.removeNetwork(e,t)}}let u1=!1;class uz extends lz{setupAuthConnectorListeners(e){e.onRpcRequest(t=>{yn.checkIfRequestExists(t)?yn.checkIfRequestIsSafe(t)||this.handleUnsafeRPCRequest():(this.open(),console.error(dr.RPC_METHOD_NOT_ALLOWED_MESSAGE,{method:t.method}),setTimeout(()=>{this.showErrorMessage(dr.RPC_METHOD_NOT_ALLOWED_UI_MESSAGE)},300),e.rejectRpcRequests())}),e.onRpcError(()=>{this.isOpen()&&(this.isTransactionStackEmpty()?this.close(!0):this.popTransactionStack(!0))}),e.onRpcSuccess((t,n)=>{const s=yn.checkIfRequestIsSafe(n),i=he.state.address,o=S.state.activeCaipNetwork;s||(this.isTransactionStackEmpty()?(this.close(!0),i&&(o!=null&&o.id)&&this.updateNativeBalance(i,o.id,o.chainNamespace)):(this.popTransactionStack(),i&&(o!=null&&o.id)&&this.updateNativeBalance(i,o.id,o.chainNamespace)))}),e.onNotConnected(()=>{const t=S.state.activeChain;_e.getConnectorId(t)===ee.CONNECTOR_ID.AUTH&&(this.setCaipAddress(void 0,t),this.setLoading(!1,t))}),e.onConnect(async t=>{var a,c;const n=S.state.activeChain,s=n===ee.CHAIN.EVM?`eip155:${t.chainId}:${t.address}`:`${t.chainId}:${t.address}`,i=t.preferredAccountType||((a=he.state.preferredAccountTypes)==null?void 0:a[n])||K.state.defaultAccountTypes[n];Wg.isLowerCaseMatch(t.address,he.state.address)||this.syncIdentity({address:t.address,chainId:t.chainId,chainNamespace:n}),this.setCaipAddress(s,n),this.setUser({...he.state.user||{},...t},n),this.setSmartAccountDeployed(!!t.smartAccountDeployed,n),this.setPreferredAccountType(i,n);const o=(c=t.accounts)==null?void 0:c.map(l=>{var u;return Ee.createAccount(n,l.address,l.type||((u=he.state.preferredAccountTypes)==null?void 0:u[n])||K.state.defaultAccountTypes[n])});this.setAllAccounts(o||[Ee.createAccount(n,t.address,t.preferredAccountType||i)],n),await e.getSmartAccountEnabledNetworks(),this.setLoading(!1,n)}),e.onSocialConnected(({userName:t})=>{this.setUser({...he.state.user||{},username:t},S.state.activeChain)}),e.onGetSmartAccountEnabledNetworks(t=>{this.setSmartAccountEnabledNetworks(t,S.state.activeChain)}),e.onSetPreferredAccount(({address:t,type:n})=>{t&&this.setPreferredAccountType(n,S.state.activeChain)})}async syncAuthConnector(e,t){var u,h,d,f;const n=ee.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(t);if(!n)return;this.setLoading(!0,t);const s=e.getLoginEmailUsed();this.setLoading(s,t),s&&this.setStatus("connecting",t);const i=e.getEmail(),o=e.getUsername();this.setUser({...((u=he.state)==null?void 0:u.user)||{},username:o,email:i},S.state.activeChain),this.setupAuthConnectorListeners(e);const{isConnected:a}=await e.isConnected(),c=Ar.getSnapshot(),l=K.getSnapshot();e.syncDappData({metadata:l.metadata,sdkVersion:l.sdkVersion,projectId:l.projectId,sdkType:l.sdkType}),e.syncTheme({themeMode:c.themeMode,themeVariables:c.themeVariables,w3mThemeVariables:xi(c.themeVariables,c.themeMode)}),t&&n&&(a&&((h=this.connectionControllerClient)!=null&&h.connectExternal)?(await((f=this.connectionControllerClient)==null?void 0:f.connectExternal({id:ee.CONNECTOR_ID.AUTH,info:{name:ee.CONNECTOR_ID.AUTH},type:ft.CONNECTOR_TYPE_AUTH,provider:e,chainId:(d=S.state.activeCaipNetwork)==null?void 0:d.id,chain:t})),this.setStatus("connected",t)):_e.getConnectorId(t)===ee.CONNECTOR_ID.AUTH&&(this.setStatus("disconnected",t),se.removeConnectedNamespace(t))),this.setLoading(!1,t)}async checkExistingTelegramSocialConnection(e){var t;try{if(!Ee.isTelegram())return;const n=se.getTelegramSocialProvider();if(!n||typeof window>"u"||typeof document>"u")return;const i=new URL(window.location.href).searchParams.get("result_uri");if(!i)return;he.setSocialProvider(n,e),await((t=this.authProvider)==null?void 0:t.init());const o=_e.getAuthConnector();n&&o&&(this.setLoading(!0,e),await o.provider.connectSocial(i),await Et.connectExternal(o,o.chain),se.setConnectedSocialProvider(n),se.removeTelegramSocialProvider(),At.sendEvent({type:"track",event:"SOCIAL_LOGIN_SUCCESS",properties:{provider:n}}))}catch(n){this.setLoading(!1,e),console.error("checkExistingSTelegramocialConnection error",n)}try{const n=new URL(window.location.href);n.searchParams.delete("result_uri"),window.history.replaceState({},document.title,n.toString())}catch(n){console.error("tma social login failed",n)}}createAuthProvider(e){var o,a,c,l,u,h,d,f,g,p,m,w,A,v,N;if(!ee.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(e))return;const n=((a=(o=this.options)==null?void 0:o.features)==null?void 0:a.email)===void 0?ur.DEFAULT_FEATURES.email:(l=(c=this.options)==null?void 0:c.features)==null?void 0:l.email,s=(h=(u=this.options)==null?void 0:u.features)!=null&&h.socials?((g=(f=(d=this.options)==null?void 0:d.features)==null?void 0:f.socials)==null?void 0:g.length)>0:((m=(p=this.options)==null?void 0:p.features)==null?void 0:m.socials)??ur.DEFAULT_FEATURES.socials,i=n||s;!this.authProvider&&((w=this.options)!=null&&w.projectId)&&i&&(this.authProvider=Bh.getInstance({projectId:this.options.projectId,enableLogger:this.options.enableAuthLogger,chainId:(A=this.getCaipNetwork(e))==null?void 0:A.caipNetworkId,abortController:$s.EmbeddedWalletAbortController,onTimeout:T=>{T==="iframe_load_failed"?Ni.open($s.ALERT_ERRORS.IFRAME_LOAD_FAILED,"error"):T==="iframe_request_timeout"?Ni.open($s.ALERT_ERRORS.IFRAME_REQUEST_TIMEOUT,"error"):T==="unverified_domain"&&Ni.open($s.ALERT_ERRORS.UNVERIFIED_DOMAIN,"error")}}),Vs.subscribeOpen(T=>{var P;!T&&this.isTransactionStackEmpty()&&((P=this.authProvider)==null||P.rejectRpcRequests())}),e===ee.CHAIN.EVM&&((v=he.state.preferredAccountTypes)!=null&&v.eip155)&&this.authProvider.setPreferredAccount((N=he.state.preferredAccountTypes)==null?void 0:N.eip155),this.syncAuthConnector(this.authProvider,e),this.checkExistingTelegramSocialConnection(e))}createAuthProviderForAdapter(e){var t,n,s;this.createAuthProvider(e),this.authProvider&&((s=(n=(t=this.chainAdapters)==null?void 0:t[e])==null?void 0:n.setAuthProvider)==null||s.call(n,this.authProvider))}initControllers(e){super.initControllers(e),this.options.excludeWalletIds&&be.initializeExcludedWallets({ids:this.options.excludeWalletIds})}async switchCaipNetwork(e){var i,o;if(!e)return;const t=S.state.activeChain,n=e.chainNamespace,s=this.getAddressByChainNamespace(e.chainNamespace);if(e.chainNamespace===S.state.activeChain&&s){const a=this.getAdapter(n),c=qe.getProvider(n),l=qe.getProviderId(n);await(a==null?void 0:a.switchNetwork({caipNetwork:e,provider:c,providerType:l})),this.setCaipNetwork(e)}else{const c=qe.getProviderId(t)===ft.CONNECTOR_TYPE_AUTH,l=qe.getProviderId(n),u=l===ft.CONNECTOR_TYPE_AUTH,h=ee.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(n);if((c||u)&&h)try{S.state.activeChain=e.chainNamespace,await((o=(i=this.connectionControllerClient)==null?void 0:i.connectExternal)==null?void 0:o.call(i,{id:ee.CONNECTOR_ID.AUTH,provider:this.authProvider,chain:n,chainId:e.id,type:ft.CONNECTOR_TYPE_AUTH,caipNetwork:e})),this.setCaipNetwork(e)}catch{const f=this.getAdapter(n);await(f==null?void 0:f.switchNetwork({caipNetwork:e,provider:this.authProvider,providerType:l}))}else l===ft.CONNECTOR_TYPE_WALLET_CONNECT?(this.setCaipNetwork(e),this.syncWalletConnectAccount()):(this.setCaipNetwork(e),s&&this.syncAccount({address:s,chainId:e.id,chainNamespace:n}))}}async initChainAdapter(e){await super.initChainAdapter(e),this.createAuthProviderForAdapter(e)}async syncIdentity({address:e,chainId:t,chainNamespace:n}){var o;const s=`${n}:${t}`,i=(o=this.caipNetworks)==null?void 0:o.find(a=>a.caipNetworkId===s);if(n!==ee.CHAIN.EVM||i!=null&&i.testnet){this.setProfileName(null,n),this.setProfileImage(null,n);return}try{const{name:a,avatar:c}=await this.fetchIdentity({address:e,caipNetworkId:s});this.setProfileName(a,n),this.setProfileImage(c,n)}catch{await this.syncReownName(e,n),t!==1&&this.setProfileImage(null,n)}}syncConnectedWalletInfo(e){const t=qe.getProviderId(e);if(t===ft.CONNECTOR_TYPE_AUTH){const n=this.authProvider;if(n){const s=se.getConnectedSocialProvider()??"email",i=n.getEmail()??n.getUsername();this.setConnectedWalletInfo({name:t,identifier:i,social:s},e)}}else super.syncConnectedWalletInfo(e)}async injectModalUi(){if(!u1&&Ee.isClient()){const e={...ur.DEFAULT_FEATURES,...this.options.features},t=[];if(e&&((e.email||e.socials&&e.socials.length)&&t.push(cn(()=>import("./embedded-wallet-BDXHrTBS.js"),__vite__mapDeps([7,8,1,2,9,10,11,12,13,14,15,16,17,18,3,4,5,6]))),e.email&&t.push(cn(()=>import("./email-Bf9vZ0VD.js"),__vite__mapDeps([19,8,1,2,18,12,17,11,16,20,13,3,4,5,6]))),e.socials&&t.push(cn(()=>import("./socials-BFOkH0gS.js"),__vite__mapDeps([21,8,1,2,22,11,23,24,17,25,16,12,18,26,10,3,27,4,5,6]))),e.swaps&&t.push(cn(()=>import("./swaps-CXzbbxfm.js"),__vite__mapDeps([28,8,1,2,16,12,29,30,31,10,17,27,13,11,3,4,5,6]))),e.send&&t.push(cn(()=>import("./send-DW1KYLkk.js"),__vite__mapDeps([32,8,1,2,16,12,17,11,23,18,31,10,13,33,34,3,4,5,6]))),e.receive&&t.push(cn(()=>import("./receive-NxioL1Mo.js"),__vite__mapDeps([35,8,1,2,36,10,26,3,4,5,6]))),e.onramp&&t.push(cn(()=>import("./onramp-ncVVSYkj.js"),__vite__mapDeps([37,8,1,2,38,27,17,10,12,39,22,11,23,40,18,16,25,13,3,4,5,6]))),e.history&&t.push(cn(()=>import("./transactions-EHsmFSxl.js"),__vite__mapDeps([41,8,1,2,42,38,27,17,18,10,3,4,5,6]))),e.pay&&t.push(cn(()=>import("./index-DFplMpj9.js"),__vite__mapDeps([43,8,1,2,16,12,44,10,17,14,39,34,25,3,4,5,6])))),await Promise.all([...t,cn(()=>import("./index-CfC33MLK.js"),__vite__mapDeps([45,8,1,2,10,12,33,17,46,30,14,39,16,15,44,42,38,27,18,29,11,13,34,20,22,23,24,9,25,36,26,3,40,4,5,6])),cn(()=>import("./w3m-modal-aPO4RrzA.js"),__vite__mapDeps([47,8,1,2,14,10,17,15,12,30,46,3,4,5,6]))]),!document.querySelector("w3m-modal")){const s=document.createElement("w3m-modal");!K.state.disableAppend&&!K.state.enableEmbedded&&document.body.insertAdjacentElement("beforeend",s)}u1=!0}}}let eo;function hz(r){r&&(eo=r)}function dz(r){const{providers:e,providerIds:t}=Qb(qe.state),n=e[r],s=t[r];return{walletProvider:n,walletProviderType:s}}function fz(){if(!eo)throw new Error('Please call "createAppKit" before using "useAppKit" hook');async function r(t){await(eo==null?void 0:eo.open(t))}async function e(){await(eo==null?void 0:eo.close())}return{open:r,close:e}}const pz="1.7.4";let tp;function gz(r){return tp||(tp=new uz({...r,sdkVersion:Ee.generateSdkVersion(r.adapters??[],"react",pz)}),hz(tp)),tp}const mz="6.14.0";function yz(r,e,t){const n=e.split("|").map(i=>i.trim());for(let i=0;i<n.length;i++)switch(e){case"any":return;case"bigint":case"boolean":case"number":case"string":if(typeof r===e)return}const s=new Error(`invalid value for type ${e}`);throw s.code="INVALID_ARGUMENT",s.argument=`value.${t}`,s.value=r,s}async function Pr(r){const e=Object.keys(r);return(await Promise.all(e.map(n=>Promise.resolve(r[n])))).reduce((n,s,i)=>(n[e[i]]=s,n),{})}function ye(r,e,t){for(let n in e){let s=e[n];const i=t?t[n]:null;i&&yz(s,i,n),Object.defineProperty(r,n,{enumerable:!0,value:s,writable:!1})}}function al(r){if(r==null)return"null";if(Array.isArray(r))return"[ "+r.map(al).join(", ")+" ]";if(r instanceof Uint8Array){const e="0123456789abcdef";let t="0x";for(let n=0;n<r.length;n++)t+=e[r[n]>>4],t+=e[r[n]&15];return t}if(typeof r=="object"&&typeof r.toJSON=="function")return al(r.toJSON());switch(typeof r){case"boolean":case"symbol":return r.toString();case"bigint":return BigInt(r).toString();case"number":return r.toString();case"string":return JSON.stringify(r);case"object":{const e=Object.keys(r);return e.sort(),"{ "+e.map(t=>`${al(t)}: ${al(r[t])}`).join(", ")+" }"}}return"[ COULD NOT SERIALIZE ]"}function lr(r,e){return r&&r.code===e}function r0(r){return lr(r,"CALL_EXCEPTION")}function Ct(r,e,t){let n=r;{const i=[];if(t){if("message"in t||"code"in t||"name"in t)throw new Error(`value will overwrite populated values: ${al(t)}`);for(const o in t){if(o==="shortMessage")continue;const a=t[o];i.push(o+"="+al(a))}}i.push(`code=${e}`),i.push(`version=${mz}`),i.length&&(r+=" ("+i.join(", ")+")")}let s;switch(e){case"INVALID_ARGUMENT":s=new TypeError(r);break;case"NUMERIC_FAULT":case"BUFFER_OVERRUN":s=new RangeError(r);break;default:s=new Error(r)}return ye(s,{code:e}),t&&Object.assign(s,t),s.shortMessage==null&&ye(s,{shortMessage:n}),s}function q(r,e,t,n){if(!r)throw Ct(e,t,n)}function R(r,e,t,n){q(r,e,"INVALID_ARGUMENT",{argument:t,value:n})}function GI(r,e,t){t==null&&(t=""),t&&(t=": "+t),q(r>=e,"missing argument"+t,"MISSING_ARGUMENT",{count:r,expectedCount:e}),q(r<=e,"too many arguments"+t,"UNEXPECTED_ARGUMENT",{count:r,expectedCount:e})}["NFD","NFC","NFKD","NFKC"].reduce((r,e)=>{try{if("test".normalize(e)!=="test")throw new Error("bad");if(e==="NFD"&&"".normalize("NFD")!=="e")throw new Error("broken");r.push(e)}catch{}return r},[]);function Af(r,e,t){if(t==null&&(t=""),r!==e){let n=t,s="new";t&&(n+=".",s+=" "+t),q(!1,`private constructor; use ${n}from* methods`,"UNSUPPORTED_OPERATION",{operation:s})}}function KI(r,e,t){if(r instanceof Uint8Array)return t?new Uint8Array(r):r;if(typeof r=="string"&&r.match(/^0x(?:[0-9a-f][0-9a-f])*$/i)){const n=new Uint8Array((r.length-2)/2);let s=2;for(let i=0;i<n.length;i++)n[i]=parseInt(r.substring(s,s+2),16),s+=2;return n}R(!1,"invalid BytesLike value",e||"value",r)}function Ue(r,e){return KI(r,e,!1)}function Or(r,e){return KI(r,e,!0)}function pt(r,e){return!(typeof r!="string"||!r.match(/^0x[0-9A-Fa-f]*$/)||typeof e=="number"&&r.length!==2+2*e||e===!0&&r.length%2!==0)}function n0(r){return pt(r,!0)||r instanceof Uint8Array}const h1="0123456789abcdef";function re(r){const e=Ue(r);let t="0x";for(let n=0;n<e.length;n++){const s=e[n];t+=h1[(s&240)>>4]+h1[s&15]}return t}function Pt(r){return"0x"+r.map(e=>re(e).substring(2)).join("")}function yl(r){return pt(r,!0)?(r.length-2)/2:Ue(r).length}function Tt(r,e,t){const n=Ue(r);return t!=null&&t>n.length&&q(!1,"cannot slice beyond data bounds","BUFFER_OVERRUN",{buffer:n,length:n.length,offset:t}),re(n.slice(e??0,t??n.length))}function JI(r,e,t){const n=Ue(r);q(e>=n.length,"padding exceeds data length","BUFFER_OVERRUN",{buffer:new Uint8Array(n),length:e,offset:e+1});const s=new Uint8Array(e);return s.fill(0),t?s.set(n,e-n.length):s.set(n,0),re(s)}function $i(r,e){return JI(r,e,!0)}function wz(r,e){return JI(r,e,!1)}const Jg=BigInt(0),as=BigInt(1),Uw=9007199254740991;function ng(r,e){const t=Yg(r,"value"),n=BigInt(Pe(e,"width"));if(q(t>>n===Jg,"overflow","NUMERIC_FAULT",{operation:"fromTwos",fault:"overflow",value:r}),t>>n-as){const s=(as<<n)-as;return-((~t&s)+as)}return t}function YI(r,e){let t=de(r,"value");const n=BigInt(Pe(e,"width")),s=as<<n-as;if(t<Jg){t=-t,q(t<=s,"too low","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:r});const i=(as<<n)-as;return(~t&i)+as}else q(t<s,"too high","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:r});return t}function wa(r,e){const t=Yg(r,"value"),n=BigInt(Pe(e,"bits"));return t&(as<<n)-as}function de(r,e){switch(typeof r){case"bigint":return r;case"number":return R(Number.isInteger(r),"underflow",e||"value",r),R(r>=-9007199254740991&&r<=Uw,"overflow",e||"value",r),BigInt(r);case"string":try{if(r==="")throw new Error("empty string");return r[0]==="-"&&r[1]!=="-"?-BigInt(r.substring(1)):BigInt(r)}catch(t){R(!1,`invalid BigNumberish string: ${t.message}`,e||"value",r)}}R(!1,"invalid BigNumberish value",e||"value",r)}function Yg(r,e){const t=de(r,e);return q(t>=Jg,"unsigned value cannot be negative","NUMERIC_FAULT",{fault:"overflow",operation:"getUint",value:r}),t}const d1="0123456789abcdef";function Qg(r){if(r instanceof Uint8Array){let e="0x0";for(const t of r)e+=d1[t>>4],e+=d1[t&15];return BigInt(e)}return de(r)}function Pe(r,e){switch(typeof r){case"bigint":return R(r>=-9007199254740991&&r<=Uw,"overflow",e||"value",r),Number(r);case"number":return R(Number.isInteger(r),"underflow",e||"value",r),R(r>=-9007199254740991&&r<=Uw,"overflow",e||"value",r),r;case"string":try{if(r==="")throw new Error("empty string");return Pe(BigInt(r),e)}catch(t){R(!1,`invalid numeric string: ${t.message}`,e||"value",r)}}R(!1,"invalid numeric value",e||"value",r)}function bz(r){return Pe(Qg(r))}function Lo(r,e){let n=Yg(r,"value").toString(16);if(e==null)n.length%2&&(n="0"+n);else{const s=Pe(e,"width");for(q(s*2>=n.length,`value exceeds width (${s} bytes)`,"NUMERIC_FAULT",{operation:"toBeHex",fault:"overflow",value:r});n.length<s*2;)n="0"+n}return"0x"+n}function hr(r){const e=Yg(r,"value");if(e===Jg)return new Uint8Array([]);let t=e.toString(16);t.length%2&&(t="0"+t);const n=new Uint8Array(t.length/2);for(let s=0;s<n.length;s++){const i=s*2;n[s]=parseInt(t.substring(i,i+2),16)}return n}function Pi(r){let e=re(n0(r)?r:hr(r)).substring(2);for(;e.startsWith("0");)e=e.substring(1);return e===""&&(e="0"),"0x"+e}const f1="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";BigInt(0);const p1=BigInt(58);function Ez(r){const e=Ue(r);let t=Qg(e),n="";for(;t;)n=f1[Number(t%p1)]+n,t/=p1;for(let s=0;s<e.length&&!e[s];s++)n=f1[0]+n;return n}function vz(r){r=atob(r);const e=new Uint8Array(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return Ue(e)}function Az(r){const e=Ue(r);let t="";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return btoa(t)}var Al;class QI{constructor(e,t,n){L(this,"filter");L(this,"emitter");F(this,Al);_(this,Al,t),ye(this,{emitter:e,filter:n})}async removeListener(){y(this,Al)!=null&&await this.emitter.off(this.filter,y(this,Al))}}Al=new WeakMap;function Cz(r,e,t,n,s){R(!1,`invalid codepoint at offset ${e}; ${r}`,"bytes",t)}function ZI(r,e,t,n,s){if(r==="BAD_PREFIX"||r==="UNEXPECTED_CONTINUE"){let i=0;for(let o=e+1;o<t.length&&t[o]>>6===2;o++)i++;return i}return r==="OVERRUN"?t.length-e-1:0}function _z(r,e,t,n,s){return r==="OVERLONG"?(R(typeof s=="number","invalid bad code point for replacement","badCodepoint",s),n.push(s),0):(n.push(65533),ZI(r,e,t))}const Nz=Object.freeze({error:Cz,ignore:ZI,replace:_z});function Iz(r,e){e==null&&(e=Nz.error);const t=Ue(r,"bytes"),n=[];let s=0;for(;s<t.length;){const i=t[s++];if(!(i>>7)){n.push(i);continue}let o=null,a=null;if((i&224)===192)o=1,a=127;else if((i&240)===224)o=2,a=2047;else if((i&248)===240)o=3,a=65535;else{(i&192)===128?s+=e("UNEXPECTED_CONTINUE",s-1,t,n):s+=e("BAD_PREFIX",s-1,t,n);continue}if(s-1+o>=t.length){s+=e("OVERRUN",s-1,t,n);continue}let c=i&(1<<8-o-1)-1;for(let l=0;l<o;l++){let u=t[s];if((u&192)!=128){s+=e("MISSING_CONTINUE",s,t,n),c=null;break}c=c<<6|u&63,s++}if(c!==null){if(c>1114111){s+=e("OUT_OF_RANGE",s-1-o,t,n,c);continue}if(c>=55296&&c<=57343){s+=e("UTF16_SURROGATE",s-1-o,t,n,c);continue}if(c<=a){s+=e("OVERLONG",s-1-o,t,n,c);continue}n.push(c)}}return n}function Ws(r,e){R(typeof r=="string","invalid string value","str",r);let t=[];for(let n=0;n<r.length;n++){const s=r.charCodeAt(n);if(s<128)t.push(s);else if(s<2048)t.push(s>>6|192),t.push(s&63|128);else if((s&64512)==55296){n++;const i=r.charCodeAt(n);R(n<r.length&&(i&64512)===56320,"invalid surrogate pair","str",r);const o=65536+((s&1023)<<10)+(i&1023);t.push(o>>18|240),t.push(o>>12&63|128),t.push(o>>6&63|128),t.push(o&63|128)}else t.push(s>>12|224),t.push(s>>6&63|128),t.push(s&63|128)}return new Uint8Array(t)}function Sz(r){return r.map(e=>e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode((e>>10&1023)+55296,(e&1023)+56320))).join("")}function sg(r,e){return Sz(Iz(r,e))}function XI(r){async function e(t,n){q(n==null||!n.cancelled,"request cancelled before sending","CANCELLED");const s=t.url.split(":")[0].toLowerCase();q(s==="http"||s==="https",`unsupported protocol ${s}`,"UNSUPPORTED_OPERATION",{info:{protocol:s},operation:"request"}),q(s==="https"||!t.credentials||t.allowInsecureAuthentication,"insecure authorized connections unsupported","UNSUPPORTED_OPERATION",{operation:"request"});let i=null;const o=new AbortController,a=setTimeout(()=>{i=Ct("request timeout","TIMEOUT"),o.abort()},t.timeout);n&&n.addListener(()=>{i=Ct("request cancelled","CANCELLED"),o.abort()});const c=Object.assign({},r,{method:t.method,headers:new Headers(Array.from(t)),body:t.body||void 0,signal:o.signal});let l;try{l=await fetch(t.url,c)}catch(f){throw clearTimeout(a),i||f}clearTimeout(a);const u={};l.headers.forEach((f,g)=>{u[g.toLowerCase()]=f});const h=await l.arrayBuffer(),d=h==null?null:new Uint8Array(h);return{statusCode:l.status,statusMessage:l.statusText,headers:u,body:d}}return e}const xz=12,Tz=250;let g1=XI();const Pz=new RegExp("^data:([^;:]*)?(;base64)?,(.*)$","i"),Oz=new RegExp("^ipfs://(ipfs/)?(.*)$","i");let wy=!1;async function eS(r,e){try{const t=r.match(Pz);if(!t)throw new Error("invalid data");return new Do(200,"OK",{"content-type":t[1]||"text/plain"},t[2]?vz(t[3]):Dz(t[3]))}catch{return new Do(599,"BAD REQUEST (invalid data: URI)",{},null,new Mi(r))}}function tS(r){async function e(t,n){try{const s=t.match(Oz);if(!s)throw new Error("invalid link");return new Mi(`${r}${s[2]}`)}catch{return new Do(599,"BAD REQUEST (invalid IPFS URI)",{},null,new Mi(t))}}return e}const rp={data:eS,ipfs:tS("https://gateway.ipfs.io/ipfs/")},rS=new WeakMap;var Aa,co;class Rz{constructor(e){F(this,Aa);F(this,co);_(this,Aa,[]),_(this,co,!1),rS.set(e,()=>{if(!y(this,co)){_(this,co,!0);for(const t of y(this,Aa))setTimeout(()=>{t()},0);_(this,Aa,[])}})}addListener(e){q(!y(this,co),"singal already cancelled","UNSUPPORTED_OPERATION",{operation:"fetchCancelSignal.addCancelListener"}),y(this,Aa).push(e)}get cancelled(){return y(this,co)}checkSignal(){q(!this.cancelled,"cancelled","CANCELLED",{})}}Aa=new WeakMap,co=new WeakMap;function np(r){if(r==null)throw new Error("missing signal; should not happen");return r.checkSignal(),r}var Cl,_l,Xn,pi,Nl,Il,Kt,hn,gi,Ca,_a,Na,xs,es,lo,Ia,Ch;const yg=class yg{constructor(e){F(this,Ia);F(this,Cl);F(this,_l);F(this,Xn);F(this,pi);F(this,Nl);F(this,Il);F(this,Kt);F(this,hn);F(this,gi);F(this,Ca);F(this,_a);F(this,Na);F(this,xs);F(this,es);F(this,lo);_(this,Il,String(e)),_(this,Cl,!1),_(this,_l,!0),_(this,Xn,{}),_(this,pi,""),_(this,Nl,3e5),_(this,es,{slotInterval:Tz,maxAttempts:xz}),_(this,lo,null)}get url(){return y(this,Il)}set url(e){_(this,Il,String(e))}get body(){return y(this,Kt)==null?null:new Uint8Array(y(this,Kt))}set body(e){if(e==null)_(this,Kt,void 0),_(this,hn,void 0);else if(typeof e=="string")_(this,Kt,Ws(e)),_(this,hn,"text/plain");else if(e instanceof Uint8Array)_(this,Kt,e),_(this,hn,"application/octet-stream");else if(typeof e=="object")_(this,Kt,Ws(JSON.stringify(e))),_(this,hn,"application/json");else throw new Error("invalid body")}hasBody(){return y(this,Kt)!=null}get method(){return y(this,pi)?y(this,pi):this.hasBody()?"POST":"GET"}set method(e){e==null&&(e=""),_(this,pi,String(e).toUpperCase())}get headers(){const e=Object.assign({},y(this,Xn));return y(this,gi)&&(e.authorization=`Basic ${Az(Ws(y(this,gi)))}`),this.allowGzip&&(e["accept-encoding"]="gzip"),e["content-type"]==null&&y(this,hn)&&(e["content-type"]=y(this,hn)),this.body&&(e["content-length"]=String(this.body.length)),e}getHeader(e){return this.headers[e.toLowerCase()]}setHeader(e,t){y(this,Xn)[String(e).toLowerCase()]=String(t)}clearHeaders(){_(this,Xn,{})}[Symbol.iterator](){const e=this.headers,t=Object.keys(e);let n=0;return{next:()=>{if(n<t.length){const s=t[n++];return{value:[s,e[s]],done:!1}}return{value:void 0,done:!0}}}}get credentials(){return y(this,gi)||null}setCredentials(e,t){R(!e.match(/:/),"invalid basic authentication username","username","[REDACTED]"),_(this,gi,`${e}:${t}`)}get allowGzip(){return y(this,_l)}set allowGzip(e){_(this,_l,!!e)}get allowInsecureAuthentication(){return!!y(this,Cl)}set allowInsecureAuthentication(e){_(this,Cl,!!e)}get timeout(){return y(this,Nl)}set timeout(e){R(e>=0,"timeout must be non-zero","timeout",e),_(this,Nl,e)}get preflightFunc(){return y(this,Ca)||null}set preflightFunc(e){_(this,Ca,e)}get processFunc(){return y(this,_a)||null}set processFunc(e){_(this,_a,e)}get retryFunc(){return y(this,Na)||null}set retryFunc(e){_(this,Na,e)}get getUrlFunc(){return y(this,lo)||g1}set getUrlFunc(e){_(this,lo,e)}toString(){return`<FetchRequest method=${JSON.stringify(this.method)} url=${JSON.stringify(this.url)} headers=${JSON.stringify(this.headers)} body=${y(this,Kt)?re(y(this,Kt)):"null"}>`}setThrottleParams(e){e.slotInterval!=null&&(y(this,es).slotInterval=e.slotInterval),e.maxAttempts!=null&&(y(this,es).maxAttempts=e.maxAttempts)}send(){return q(y(this,xs)==null,"request already sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.send"}),_(this,xs,new Rz(this)),W(this,Ia,Ch).call(this,0,m1()+this.timeout,0,this,new Do(0,"",{},null,this))}cancel(){q(y(this,xs)!=null,"request has not been sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.cancel"});const e=rS.get(this);if(!e)throw new Error("missing signal; should not happen");e()}redirect(e){const t=this.url.split(":")[0].toLowerCase(),n=e.split(":")[0].toLowerCase();q(this.method==="GET"&&(t!=="https"||n!=="http")&&e.match(/^https?:/),"unsupported redirect","UNSUPPORTED_OPERATION",{operation:`redirect(${this.method} ${JSON.stringify(this.url)} => ${JSON.stringify(e)})`});const s=new yg(e);return s.method="GET",s.allowGzip=this.allowGzip,s.timeout=this.timeout,_(s,Xn,Object.assign({},y(this,Xn))),y(this,Kt)&&_(s,Kt,new Uint8Array(y(this,Kt))),_(s,hn,y(this,hn)),s}clone(){const e=new yg(this.url);return _(e,pi,y(this,pi)),y(this,Kt)&&_(e,Kt,y(this,Kt)),_(e,hn,y(this,hn)),_(e,Xn,Object.assign({},y(this,Xn))),_(e,gi,y(this,gi)),this.allowGzip&&(e.allowGzip=!0),e.timeout=this.timeout,this.allowInsecureAuthentication&&(e.allowInsecureAuthentication=!0),_(e,Ca,y(this,Ca)),_(e,_a,y(this,_a)),_(e,Na,y(this,Na)),_(e,es,Object.assign({},y(this,es))),_(e,lo,y(this,lo)),e}static lockConfig(){wy=!0}static getGateway(e){return rp[e.toLowerCase()]||null}static registerGateway(e,t){if(e=e.toLowerCase(),e==="http"||e==="https")throw new Error(`cannot intercept ${e}; use registerGetUrl`);if(wy)throw new Error("gateways locked");rp[e]=t}static registerGetUrl(e){if(wy)throw new Error("gateways locked");g1=e}static createGetUrlFunc(e){return XI(e)}static createDataGateway(){return eS}static createIpfsGatewayFunc(e){return tS(e)}};Cl=new WeakMap,_l=new WeakMap,Xn=new WeakMap,pi=new WeakMap,Nl=new WeakMap,Il=new WeakMap,Kt=new WeakMap,hn=new WeakMap,gi=new WeakMap,Ca=new WeakMap,_a=new WeakMap,Na=new WeakMap,xs=new WeakMap,es=new WeakMap,lo=new WeakMap,Ia=new WeakSet,Ch=async function(e,t,n,s,i){var u,h,d;if(e>=y(this,es).maxAttempts)return i.makeServerError("exceeded maximum retry limit");q(m1()<=t,"timeout","TIMEOUT",{operation:"request.send",reason:"timeout",request:s}),n>0&&await kz(n);let o=this.clone();const a=(o.url.split(":")[0]||"").toLowerCase();if(a in rp){const f=await rp[a](o.url,np(y(s,xs)));if(f instanceof Do){let g=f;if(this.processFunc){np(y(s,xs));try{g=await this.processFunc(o,g)}catch(p){(p.throttle==null||typeof p.stall!="number")&&g.makeServerError("error in post-processing function",p).assertOk()}}return g}o=f}this.preflightFunc&&(o=await this.preflightFunc(o));const c=await this.getUrlFunc(o,np(y(s,xs)));let l=new Do(c.statusCode,c.statusMessage,c.headers,c.body,s);if(l.statusCode===301||l.statusCode===302){try{const f=l.headers.location||"";return W(u=o.redirect(f),Ia,Ch).call(u,e+1,t,0,s,l)}catch{}return l}else if(l.statusCode===429&&(this.retryFunc==null||await this.retryFunc(o,l,e))){const f=l.headers["retry-after"];let g=y(this,es).slotInterval*Math.trunc(Math.random()*Math.pow(2,e));return typeof f=="string"&&f.match(/^[1-9][0-9]*$/)&&(g=parseInt(f)),W(h=o.clone(),Ia,Ch).call(h,e+1,t,g,s,l)}if(this.processFunc){np(y(s,xs));try{l=await this.processFunc(o,l)}catch(f){(f.throttle==null||typeof f.stall!="number")&&l.makeServerError("error in post-processing function",f).assertOk();let g=y(this,es).slotInterval*Math.trunc(Math.random()*Math.pow(2,e));return f.stall>=0&&(g=f.stall),W(d=o.clone(),Ia,Ch).call(d,e+1,t,g,s,l)}}return l};let Mi=yg;var Vd,Wd,Gd,dn,Sl,Sa;const A0=class A0{constructor(e,t,n,s,i){F(this,Vd);F(this,Wd);F(this,Gd);F(this,dn);F(this,Sl);F(this,Sa);_(this,Vd,e),_(this,Wd,t),_(this,Gd,Object.keys(n).reduce((o,a)=>(o[a.toLowerCase()]=String(n[a]),o),{})),_(this,dn,s==null?null:new Uint8Array(s)),_(this,Sl,i||null),_(this,Sa,{message:""})}toString(){return`<FetchResponse status=${this.statusCode} body=${y(this,dn)?re(y(this,dn)):"null"}>`}get statusCode(){return y(this,Vd)}get statusMessage(){return y(this,Wd)}get headers(){return Object.assign({},y(this,Gd))}get body(){return y(this,dn)==null?null:new Uint8Array(y(this,dn))}get bodyText(){try{return y(this,dn)==null?"":sg(y(this,dn))}catch{q(!1,"response body is not valid UTF-8 data","UNSUPPORTED_OPERATION",{operation:"bodyText",info:{response:this}})}}get bodyJson(){try{return JSON.parse(this.bodyText)}catch{q(!1,"response body is not valid JSON","UNSUPPORTED_OPERATION",{operation:"bodyJson",info:{response:this}})}}[Symbol.iterator](){const e=this.headers,t=Object.keys(e);let n=0;return{next:()=>{if(n<t.length){const s=t[n++];return{value:[s,e[s]],done:!1}}return{value:void 0,done:!0}}}}makeServerError(e,t){let n;e?n=`CLIENT ESCALATED SERVER ERROR (${this.statusCode} ${this.statusMessage}; ${e})`:(e=`${this.statusCode} ${this.statusMessage}`,n=`CLIENT ESCALATED SERVER ERROR (${e})`);const s=new A0(599,n,this.headers,this.body,y(this,Sl)||void 0);return _(s,Sa,{message:e,error:t}),s}throwThrottleError(e,t){t==null?t=-1:R(Number.isInteger(t)&&t>=0,"invalid stall timeout","stall",t);const n=new Error(e||"throttling requests");throw ye(n,{stall:t,throttle:!0}),n}getHeader(e){return this.headers[e.toLowerCase()]}hasBody(){return y(this,dn)!=null}get request(){return y(this,Sl)}ok(){return y(this,Sa).message===""&&this.statusCode>=200&&this.statusCode<300}assertOk(){if(this.ok())return;let{message:e,error:t}=y(this,Sa);e===""&&(e=`server response ${this.statusCode} ${this.statusMessage}`);let n=null;this.request&&(n=this.request.url);let s=null;try{y(this,dn)&&(s=sg(y(this,dn)))}catch{}q(!1,e,"SERVER_ERROR",{request:this.request||"unknown request",response:this,error:t,info:{requestUrl:n,responseBody:s,responseStatus:`${this.statusCode} ${this.statusMessage}`}})}};Vd=new WeakMap,Wd=new WeakMap,Gd=new WeakMap,dn=new WeakMap,Sl=new WeakMap,Sa=new WeakMap;let Do=A0;function m1(){return new Date().getTime()}function Dz(r){return Ws(r.replace(/%([0-9a-f][0-9a-f])/gi,(e,t)=>String.fromCharCode(parseInt(t,16))))}function kz(r){return new Promise(e=>setTimeout(e,r))}const Uz=BigInt(-1),Yn=BigInt(0),cl=BigInt(1),Bz=BigInt(5),Kc={};let wl="0000";for(;wl.length<80;)wl+=wl;function Zo(r){let e=wl;for(;e.length<r;)e+=e;return BigInt("1"+e.substring(0,r))}function gh(r,e,t){const n=BigInt(e.width);if(e.signed){const s=cl<<n-cl;q(t==null||r>=-s&&r<s,"overflow","NUMERIC_FAULT",{operation:t,fault:"overflow",value:r}),r>Yn?r=ng(wa(r,n),n):r=-ng(wa(-r,n),n)}else{const s=cl<<n;q(t==null||r>=0&&r<s,"overflow","NUMERIC_FAULT",{operation:t,fault:"overflow",value:r}),r=(r%s+s)%s&s-cl}return r}function by(r){typeof r=="number"&&(r=`fixed128x${r}`);let e=!0,t=128,n=18;if(typeof r=="string"){if(r!=="fixed")if(r==="ufixed")e=!1;else{const i=r.match(/^(u?)fixed([0-9]+)x([0-9]+)$/);R(i,"invalid fixed format","format",r),e=i[1]!=="u",t=parseInt(i[2]),n=parseInt(i[3])}}else if(r){const i=r,o=(a,c,l)=>i[a]==null?l:(R(typeof i[a]===c,"invalid fixed format ("+a+" not "+c+")","format."+a,i[a]),i[a]);e=o("signed","boolean",e),t=o("width","number",t),n=o("decimals","number",n)}R(t%8===0,"invalid FixedNumber width (not byte aligned)","format.width",t),R(n<=80,"invalid FixedNumber decimals (too large)","format.decimals",n);const s=(e?"":"u")+"fixed"+String(t)+"x"+String(n);return{signed:e,width:t,decimals:n,name:s}}function Lz(r,e){let t="";r<Yn&&(t="-",r*=Uz);let n=r.toString();if(e===0)return t+n;for(;n.length<=e;)n=wl+n;const s=n.length-e;for(n=n.substring(0,s)+"."+n.substring(s);n[0]==="0"&&n[1]!==".";)n=n.substring(1);for(;n[n.length-1]==="0"&&n[n.length-2]!==".";)n=n.substring(0,n.length-1);return t+n}var ts,ot,xr,rt,na,li,Bw,Lw,$w,Mw;const so=class so{constructor(e,t,n){F(this,rt);L(this,"format");F(this,ts);F(this,ot);F(this,xr);L(this,"_value");Af(e,Kc,"FixedNumber"),_(this,ot,t),_(this,ts,n);const s=Lz(t,n.decimals);ye(this,{format:n.name,_value:s}),_(this,xr,Zo(n.decimals))}get signed(){return y(this,ts).signed}get width(){return y(this,ts).width}get decimals(){return y(this,ts).decimals}get value(){return y(this,ot)}addUnsafe(e){return W(this,rt,Bw).call(this,e)}add(e){return W(this,rt,Bw).call(this,e,"add")}subUnsafe(e){return W(this,rt,Lw).call(this,e)}sub(e){return W(this,rt,Lw).call(this,e,"sub")}mulUnsafe(e){return W(this,rt,$w).call(this,e)}mul(e){return W(this,rt,$w).call(this,e,"mul")}mulSignal(e){W(this,rt,na).call(this,e);const t=y(this,ot)*y(e,ot);return q(t%y(this,xr)===Yn,"precision lost during signalling mul","NUMERIC_FAULT",{operation:"mulSignal",fault:"underflow",value:this}),W(this,rt,li).call(this,t/y(this,xr),"mulSignal")}divUnsafe(e){return W(this,rt,Mw).call(this,e)}div(e){return W(this,rt,Mw).call(this,e,"div")}divSignal(e){q(y(e,ot)!==Yn,"division by zero","NUMERIC_FAULT",{operation:"div",fault:"divide-by-zero",value:this}),W(this,rt,na).call(this,e);const t=y(this,ot)*y(this,xr);return q(t%y(e,ot)===Yn,"precision lost during signalling div","NUMERIC_FAULT",{operation:"divSignal",fault:"underflow",value:this}),W(this,rt,li).call(this,t/y(e,ot),"divSignal")}cmp(e){let t=this.value,n=e.value;const s=this.decimals-e.decimals;return s>0?n*=Zo(s):s<0&&(t*=Zo(-s)),t<n?-1:t>n?1:0}eq(e){return this.cmp(e)===0}lt(e){return this.cmp(e)<0}lte(e){return this.cmp(e)<=0}gt(e){return this.cmp(e)>0}gte(e){return this.cmp(e)>=0}floor(){let e=y(this,ot);return y(this,ot)<Yn&&(e-=y(this,xr)-cl),e=y(this,ot)/y(this,xr)*y(this,xr),W(this,rt,li).call(this,e,"floor")}ceiling(){let e=y(this,ot);return y(this,ot)>Yn&&(e+=y(this,xr)-cl),e=y(this,ot)/y(this,xr)*y(this,xr),W(this,rt,li).call(this,e,"ceiling")}round(e){if(e==null&&(e=0),e>=this.decimals)return this;const t=this.decimals-e,n=Bz*Zo(t-1);let s=this.value+n;const i=Zo(t);return s=s/i*i,gh(s,y(this,ts),"round"),new so(Kc,s,y(this,ts))}isZero(){return y(this,ot)===Yn}isNegative(){return y(this,ot)<Yn}toString(){return this._value}toUnsafeFloat(){return parseFloat(this.toString())}toFormat(e){return so.fromString(this.toString(),e)}static fromValue(e,t,n){const s=t==null?0:Pe(t),i=by(n);let o=de(e,"value");const a=s-i.decimals;if(a>0){const c=Zo(a);q(o%c===Yn,"value loses precision for format","NUMERIC_FAULT",{operation:"fromValue",fault:"underflow",value:e}),o/=c}else a<0&&(o*=Zo(-a));return gh(o,i,"fromValue"),new so(Kc,o,i)}static fromString(e,t){const n=e.match(/^(-?)([0-9]*)\.?([0-9]*)$/);R(n&&n[2].length+n[3].length>0,"invalid FixedNumber string value","value",e);const s=by(t);let i=n[2]||"0",o=n[3]||"";for(;o.length<s.decimals;)o+=wl;q(o.substring(s.decimals).match(/^0*$/),"too many decimals for format","NUMERIC_FAULT",{operation:"fromString",fault:"underflow",value:e}),o=o.substring(0,s.decimals);const a=BigInt(n[1]+i+o);return gh(a,s,"fromString"),new so(Kc,a,s)}static fromBytes(e,t){let n=Qg(Ue(e,"value"));const s=by(t);return s.signed&&(n=ng(n,s.width)),gh(n,s,"fromBytes"),new so(Kc,n,s)}};ts=new WeakMap,ot=new WeakMap,xr=new WeakMap,rt=new WeakSet,na=function(e){R(this.format===e.format,"incompatible format; use fixedNumber.toFormat","other",e)},li=function(e,t){return e=gh(e,y(this,ts),t),new so(Kc,e,y(this,ts))},Bw=function(e,t){return W(this,rt,na).call(this,e),W(this,rt,li).call(this,y(this,ot)+y(e,ot),t)},Lw=function(e,t){return W(this,rt,na).call(this,e),W(this,rt,li).call(this,y(this,ot)-y(e,ot),t)},$w=function(e,t){return W(this,rt,na).call(this,e),W(this,rt,li).call(this,y(this,ot)*y(e,ot)/y(this,xr),t)},Mw=function(e,t){return q(y(e,ot)!==Yn,"division by zero","NUMERIC_FAULT",{operation:"div",fault:"divide-by-zero",value:this}),W(this,rt,na).call(this,e),W(this,rt,li).call(this,y(this,ot)*y(this,xr)/y(e,ot),t)};let ig=so;function $z(r){let e=r.toString(16);for(;e.length<2;)e="0"+e;return"0x"+e}function y1(r,e,t){let n=0;for(let s=0;s<t;s++)n=n*256+r[e+s];return n}function w1(r,e,t,n){const s=[];for(;t<e+1+n;){const i=nS(r,t);s.push(i.result),t+=i.consumed,q(t<=e+1+n,"child data too short","BUFFER_OVERRUN",{buffer:r,length:n,offset:e})}return{consumed:1+n,result:s}}function nS(r,e){q(r.length!==0,"data too short","BUFFER_OVERRUN",{buffer:r,length:0,offset:1});const t=n=>{q(n<=r.length,"data short segment too short","BUFFER_OVERRUN",{buffer:r,length:r.length,offset:n})};if(r[e]>=248){const n=r[e]-247;t(e+1+n);const s=y1(r,e+1,n);return t(e+1+n+s),w1(r,e,e+1+n,n+s)}else if(r[e]>=192){const n=r[e]-192;return t(e+1+n),w1(r,e,e+1,n)}else if(r[e]>=184){const n=r[e]-183;t(e+1+n);const s=y1(r,e+1,n);t(e+1+n+s);const i=re(r.slice(e+1+n,e+1+n+s));return{consumed:1+n+s,result:i}}else if(r[e]>=128){const n=r[e]-128;t(e+1+n);const s=re(r.slice(e+1,e+1+n));return{consumed:1+n,result:s}}return{consumed:1,result:$z(r[e])}}function Cf(r){const e=Ue(r,"data"),t=nS(e,0);return R(t.consumed===e.length,"unexpected junk after rlp payload","data",r),t.result}function b1(r){const e=[];for(;r;)e.unshift(r&255),r>>=8;return e}function sS(r){if(Array.isArray(r)){let n=[];if(r.forEach(function(i){n=n.concat(sS(i))}),n.length<=55)return n.unshift(192+n.length),n;const s=b1(n.length);return s.unshift(247+s.length),s.concat(n)}const e=Array.prototype.slice.call(Ue(r,"object"));if(e.length===1&&e[0]<=127)return e;if(e.length<=55)return e.unshift(128+e.length),e;const t=b1(e.length);return t.unshift(183+t.length),t.concat(e)}const E1="0123456789abcdef";function $o(r){let e="0x";for(const t of sS(r))e+=E1[t>>4],e+=E1[t&15];return e}const iS=["wei","kwei","mwei","gwei","szabo","finney","ether"];function oS(r,e){let t=18;if(typeof e=="string"){const n=iS.indexOf(e);R(n>=0,"invalid unit","unit",e),t=3*n}else e!=null&&(t=Pe(e,"unit"));return ig.fromValue(r,t,{decimals:t,width:512}).toString()}function aS(r,e){R(typeof r=="string","value must be a string","value",r);let t=18;if(typeof e=="string"){const n=iS.indexOf(e);R(n>=0,"invalid unit","unit",e),t=3*n}else e!=null&&(t=Pe(e,"unit"));return ig.fromString(r,{decimals:t,width:512}).value}function s0(r){return oS(r,18)}function v1(r){return aS(r,18)}const Rr=32,Fw=new Uint8Array(Rr),Mz=["then"],sp={},cS=new WeakMap;function la(r){return cS.get(r)}function A1(r,e){cS.set(r,e)}function mh(r,e){const t=new Error(`deferred error during ABI decoding triggered accessing ${r}`);throw t.error=e,t}function jw(r,e,t){return r.indexOf(null)>=0?e.map((n,s)=>n instanceof Iu?jw(la(n),n,t):n):r.reduce((n,s,i)=>{let o=e.getValue(s);return s in n||(t&&o instanceof Iu&&(o=jw(la(o),o,t)),n[s]=o),n},{})}var xl;const ll=class ll extends Array{constructor(...t){const n=t[0];let s=t[1],i=(t[2]||[]).slice(),o=!0;n!==sp&&(s=t,i=[],o=!1);super(s.length);F(this,xl);s.forEach((l,u)=>{this[u]=l});const a=i.reduce((l,u)=>(typeof u=="string"&&l.set(u,(l.get(u)||0)+1),l),new Map);if(A1(this,Object.freeze(s.map((l,u)=>{const h=i[u];return h!=null&&a.get(h)===1?h:null}))),_(this,xl,[]),y(this,xl)==null&&y(this,xl),!o)return;Object.freeze(this);const c=new Proxy(this,{get:(l,u,h)=>{if(typeof u=="string"){if(u.match(/^[0-9]+$/)){const f=Pe(u,"%index");if(f<0||f>=this.length)throw new RangeError("out of result range");const g=l[f];return g instanceof Error&&mh(`index ${f}`,g),g}if(Mz.indexOf(u)>=0)return Reflect.get(l,u,h);const d=l[u];if(d instanceof Function)return function(...f){return d.apply(this===h?l:this,f)};if(!(u in l))return l.getValue.apply(this===h?l:this,[u])}return Reflect.get(l,u,h)}});return A1(c,la(this)),c}toArray(t){const n=[];return this.forEach((s,i)=>{s instanceof Error&&mh(`index ${i}`,s),t&&s instanceof ll&&(s=s.toArray(t)),n.push(s)}),n}toObject(t){const n=la(this);return n.reduce((s,i,o)=>(q(i!=null,`value at index ${o} unnamed`,"UNSUPPORTED_OPERATION",{operation:"toObject()"}),jw(n,this,t)),{})}slice(t,n){t==null&&(t=0),t<0&&(t+=this.length,t<0&&(t=0)),n==null&&(n=this.length),n<0&&(n+=this.length,n<0&&(n=0)),n>this.length&&(n=this.length);const s=la(this),i=[],o=[];for(let a=t;a<n;a++)i.push(this[a]),o.push(s[a]);return new ll(sp,i,o)}filter(t,n){const s=la(this),i=[],o=[];for(let a=0;a<this.length;a++){const c=this[a];c instanceof Error&&mh(`index ${a}`,c),t.call(n,c,a,this)&&(i.push(c),o.push(s[a]))}return new ll(sp,i,o)}map(t,n){const s=[];for(let i=0;i<this.length;i++){const o=this[i];o instanceof Error&&mh(`index ${i}`,o),s.push(t.call(n,o,i,this))}return s}getValue(t){const n=la(this).indexOf(t);if(n===-1)return;const s=this[n];return s instanceof Error&&mh(`property ${JSON.stringify(t)}`,s.error),s}static fromItems(t,n){return new ll(sp,t,n)}};xl=new WeakMap;let Iu=ll;function C1(r){let e=hr(r);return q(e.length<=Rr,"value out-of-bounds","BUFFER_OVERRUN",{buffer:e,length:Rr,offset:e.length}),e.length!==Rr&&(e=Or(Pt([Fw.slice(e.length%Rr),e]))),e}class ji{constructor(e,t,n,s){L(this,"name");L(this,"type");L(this,"localName");L(this,"dynamic");ye(this,{name:e,type:t,localName:n,dynamic:s},{name:"string",type:"string",localName:"string",dynamic:"boolean"})}_throwError(e,t){R(!1,e,this.localName,t)}}var mi,xa,Tl,Np;class Hw{constructor(){F(this,Tl);F(this,mi);F(this,xa);_(this,mi,[]),_(this,xa,0)}get data(){return Pt(y(this,mi))}get length(){return y(this,xa)}appendWriter(e){return W(this,Tl,Np).call(this,Or(e.data))}writeBytes(e){let t=Or(e);const n=t.length%Rr;return n&&(t=Or(Pt([t,Fw.slice(n)]))),W(this,Tl,Np).call(this,t)}writeValue(e){return W(this,Tl,Np).call(this,C1(e))}writeUpdatableValue(){const e=y(this,mi).length;return y(this,mi).push(Fw),_(this,xa,y(this,xa)+Rr),t=>{y(this,mi)[e]=C1(t)}}}mi=new WeakMap,xa=new WeakMap,Tl=new WeakSet,Np=function(e){return y(this,mi).push(e),_(this,xa,y(this,xa)+e.length),e.length};var qr,fn,Ta,Pa,uo,dc,qw,lS;const C0=class C0{constructor(e,t,n){F(this,dc);L(this,"allowLoose");F(this,qr);F(this,fn);F(this,Ta);F(this,Pa);F(this,uo);ye(this,{allowLoose:!!t}),_(this,qr,Or(e)),_(this,Ta,0),_(this,Pa,null),_(this,uo,n??1024),_(this,fn,0)}get data(){return re(y(this,qr))}get dataLength(){return y(this,qr).length}get consumed(){return y(this,fn)}get bytes(){return new Uint8Array(y(this,qr))}subReader(e){const t=new C0(y(this,qr).slice(y(this,fn)+e),this.allowLoose,y(this,uo));return _(t,Pa,this),t}readBytes(e,t){let n=W(this,dc,lS).call(this,0,e,!!t);return W(this,dc,qw).call(this,e),_(this,fn,y(this,fn)+n.length),n.slice(0,e)}readValue(){return Qg(this.readBytes(Rr))}readIndex(){return bz(this.readBytes(Rr))}};qr=new WeakMap,fn=new WeakMap,Ta=new WeakMap,Pa=new WeakMap,uo=new WeakMap,dc=new WeakSet,qw=function(e){var t;if(y(this,Pa))return W(t=y(this,Pa),dc,qw).call(t,e);_(this,Ta,y(this,Ta)+e),q(y(this,uo)<1||y(this,Ta)<=y(this,uo)*this.dataLength,`compressed ABI data exceeds inflation ratio of ${y(this,uo)} ( see: https://github.com/ethers-io/ethers.js/issues/4537 )`,"BUFFER_OVERRUN",{buffer:Or(y(this,qr)),offset:y(this,fn),length:e,info:{bytesRead:y(this,Ta),dataLength:this.dataLength}})},lS=function(e,t,n){let s=Math.ceil(t/Rr)*Rr;return y(this,fn)+s>y(this,qr).length&&(this.allowLoose&&n&&y(this,fn)+t<=y(this,qr).length?s=t:q(!1,"data out-of-bounds","BUFFER_OVERRUN",{buffer:Or(y(this,qr)),length:y(this,qr).length,offset:y(this,fn)+s})),y(this,qr).slice(y(this,fn),y(this,fn)+s)};let zw=C0;function og(r){if(!Number.isSafeInteger(r)||r<0)throw new Error(`Wrong positive integer: ${r}`)}function i0(r,...e){if(!(r instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(r.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${r.length}`)}function Fz(r){if(typeof r!="function"||typeof r.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");og(r.outputLen),og(r.blockLen)}function Su(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function uS(r,e){i0(r);const t=e.outputLen;if(r.length<t)throw new Error(`digestInto() expects output buffer of length at least ${t}`)}const Ey=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const hS=r=>r instanceof Uint8Array,jz=r=>new Uint32Array(r.buffer,r.byteOffset,Math.floor(r.byteLength/4)),vy=r=>new DataView(r.buffer,r.byteOffset,r.byteLength),Cs=(r,e)=>r<<32-e|r>>>e,Hz=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Hz)throw new Error("Non little-endian hardware is not supported");function zz(r){if(typeof r!="string")throw new Error(`utf8ToBytes expected string, got ${typeof r}`);return new Uint8Array(new TextEncoder().encode(r))}function Zg(r){if(typeof r=="string"&&(r=zz(r)),!hS(r))throw new Error(`expected Uint8Array, got ${typeof r}`);return r}function qz(...r){const e=new Uint8Array(r.reduce((n,s)=>n+s.length,0));let t=0;return r.forEach(n=>{if(!hS(n))throw new Error("Uint8Array expected");e.set(n,t),t+=n.length}),e}class o0{clone(){return this._cloneInto()}}function a0(r){const e=n=>r().update(Zg(n)).digest(),t=r();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>r(),e}function Vz(r=32){if(Ey&&typeof Ey.getRandomValues=="function")return Ey.getRandomValues(new Uint8Array(r));throw new Error("crypto.getRandomValues must be defined")}class dS extends o0{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,Fz(e);const n=Zg(t);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,i=new Uint8Array(s);i.set(n.length>s?e.create().update(n).digest():n);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=e.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),i.fill(0)}update(e){return Su(this),this.iHash.update(e),this}digestInto(e){Su(this),i0(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:n,finished:s,destroyed:i,blockLen:o,outputLen:a}=this;return e=e,e.finished=s,e.destroyed=i,e.blockLen=o,e.outputLen=a,e.oHash=t._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const fS=(r,e,t)=>new dS(r,e).update(t).digest();fS.create=(r,e)=>new dS(r,e);function Wz(r,e,t,n){if(typeof r.setBigUint64=="function")return r.setBigUint64(e,t,n);const s=BigInt(32),i=BigInt(4294967295),o=Number(t>>s&i),a=Number(t&i),c=n?4:0,l=n?0:4;r.setUint32(e+c,o,n),r.setUint32(e+l,a,n)}class pS extends o0{constructor(e,t,n,s){super(),this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=vy(this.buffer)}update(e){Su(this);const{view:t,buffer:n,blockLen:s}=this;e=Zg(e);const i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=vy(e);for(;s<=i-o;o+=s)this.process(c,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Su(this),uS(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:s,isLE:i}=this;let{pos:o}=this;t[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(n,0),o=0);for(let h=o;h<s;h++)t[h]=0;Wz(n,s-8,BigInt(this.length*8),i),this.process(n,0);const a=vy(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<l;h++)a.setUint32(4*h,u[h],i)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:s,finished:i,destroyed:o,pos:a}=this;return e.length=s,e.pos=a,e.finished=i,e.destroyed=o,s%t&&e.buffer.set(n),e}}const Gz=(r,e,t)=>r&e^~r&t,Kz=(r,e,t)=>r&e^r&t^e&t,Jz=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Yi=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Qi=new Uint32Array(64);class Yz extends pS{constructor(){super(64,32,8,!1),this.A=Yi[0]|0,this.B=Yi[1]|0,this.C=Yi[2]|0,this.D=Yi[3]|0,this.E=Yi[4]|0,this.F=Yi[5]|0,this.G=Yi[6]|0,this.H=Yi[7]|0}get(){const{A:e,B:t,C:n,D:s,E:i,F:o,G:a,H:c}=this;return[e,t,n,s,i,o,a,c]}set(e,t,n,s,i,o,a,c){this.A=e|0,this.B=t|0,this.C=n|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,t){for(let h=0;h<16;h++,t+=4)Qi[h]=e.getUint32(t,!1);for(let h=16;h<64;h++){const d=Qi[h-15],f=Qi[h-2],g=Cs(d,7)^Cs(d,18)^d>>>3,p=Cs(f,17)^Cs(f,19)^f>>>10;Qi[h]=p+Qi[h-7]+g+Qi[h-16]|0}let{A:n,B:s,C:i,D:o,E:a,F:c,G:l,H:u}=this;for(let h=0;h<64;h++){const d=Cs(a,6)^Cs(a,11)^Cs(a,25),f=u+d+Gz(a,c,l)+Jz[h]+Qi[h]|0,p=(Cs(n,2)^Cs(n,13)^Cs(n,22))+Kz(n,s,i)|0;u=l,l=c,c=a,a=o+f|0,o=i,i=s,s=n,n=f+p|0}n=n+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(n,s,i,o,a,c,l,u)}roundClean(){Qi.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const gS=a0(()=>new Yz),ip=BigInt(2**32-1),Vw=BigInt(32);function mS(r,e=!1){return e?{h:Number(r&ip),l:Number(r>>Vw&ip)}:{h:Number(r>>Vw&ip)|0,l:Number(r&ip)|0}}function yS(r,e=!1){let t=new Uint32Array(r.length),n=new Uint32Array(r.length);for(let s=0;s<r.length;s++){const{h:i,l:o}=mS(r[s],e);[t[s],n[s]]=[i,o]}return[t,n]}const Qz=(r,e)=>BigInt(r>>>0)<<Vw|BigInt(e>>>0),Zz=(r,e,t)=>r>>>t,Xz=(r,e,t)=>r<<32-t|e>>>t,eq=(r,e,t)=>r>>>t|e<<32-t,tq=(r,e,t)=>r<<32-t|e>>>t,rq=(r,e,t)=>r<<64-t|e>>>t-32,nq=(r,e,t)=>r>>>t-32|e<<64-t,sq=(r,e)=>e,iq=(r,e)=>r,wS=(r,e,t)=>r<<t|e>>>32-t,bS=(r,e,t)=>e<<t|r>>>32-t,ES=(r,e,t)=>e<<t-32|r>>>64-t,vS=(r,e,t)=>r<<t-32|e>>>64-t;function oq(r,e,t,n){const s=(e>>>0)+(n>>>0);return{h:r+t+(s/2**32|0)|0,l:s|0}}const aq=(r,e,t)=>(r>>>0)+(e>>>0)+(t>>>0),cq=(r,e,t,n)=>e+t+n+(r/2**32|0)|0,lq=(r,e,t,n)=>(r>>>0)+(e>>>0)+(t>>>0)+(n>>>0),uq=(r,e,t,n,s)=>e+t+n+s+(r/2**32|0)|0,hq=(r,e,t,n,s)=>(r>>>0)+(e>>>0)+(t>>>0)+(n>>>0)+(s>>>0),dq=(r,e,t,n,s,i)=>e+t+n+s+i+(r/2**32|0)|0,ke={fromBig:mS,split:yS,toBig:Qz,shrSH:Zz,shrSL:Xz,rotrSH:eq,rotrSL:tq,rotrBH:rq,rotrBL:nq,rotr32H:sq,rotr32L:iq,rotlSH:wS,rotlSL:bS,rotlBH:ES,rotlBL:vS,add:oq,add3L:aq,add3H:cq,add4L:lq,add4H:uq,add5H:dq,add5L:hq},[fq,pq]=ke.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(r=>BigInt(r))),Zi=new Uint32Array(80),Xi=new Uint32Array(80);class gq extends pS{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:t,Bh:n,Bl:s,Ch:i,Cl:o,Dh:a,Dl:c,Eh:l,El:u,Fh:h,Fl:d,Gh:f,Gl:g,Hh:p,Hl:m}=this;return[e,t,n,s,i,o,a,c,l,u,h,d,f,g,p,m]}set(e,t,n,s,i,o,a,c,l,u,h,d,f,g,p,m){this.Ah=e|0,this.Al=t|0,this.Bh=n|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=u|0,this.Fh=h|0,this.Fl=d|0,this.Gh=f|0,this.Gl=g|0,this.Hh=p|0,this.Hl=m|0}process(e,t){for(let v=0;v<16;v++,t+=4)Zi[v]=e.getUint32(t),Xi[v]=e.getUint32(t+=4);for(let v=16;v<80;v++){const N=Zi[v-15]|0,T=Xi[v-15]|0,P=ke.rotrSH(N,T,1)^ke.rotrSH(N,T,8)^ke.shrSH(N,T,7),D=ke.rotrSL(N,T,1)^ke.rotrSL(N,T,8)^ke.shrSL(N,T,7),U=Zi[v-2]|0,x=Xi[v-2]|0,j=ke.rotrSH(U,x,19)^ke.rotrBH(U,x,61)^ke.shrSH(U,x,6),$=ke.rotrSL(U,x,19)^ke.rotrBL(U,x,61)^ke.shrSL(U,x,6),H=ke.add4L(D,$,Xi[v-7],Xi[v-16]),Z=ke.add4H(H,P,j,Zi[v-7],Zi[v-16]);Zi[v]=Z|0,Xi[v]=H|0}let{Ah:n,Al:s,Bh:i,Bl:o,Ch:a,Cl:c,Dh:l,Dl:u,Eh:h,El:d,Fh:f,Fl:g,Gh:p,Gl:m,Hh:w,Hl:A}=this;for(let v=0;v<80;v++){const N=ke.rotrSH(h,d,14)^ke.rotrSH(h,d,18)^ke.rotrBH(h,d,41),T=ke.rotrSL(h,d,14)^ke.rotrSL(h,d,18)^ke.rotrBL(h,d,41),P=h&f^~h&p,D=d&g^~d&m,U=ke.add5L(A,T,D,pq[v],Xi[v]),x=ke.add5H(U,w,N,P,fq[v],Zi[v]),j=U|0,$=ke.rotrSH(n,s,28)^ke.rotrBH(n,s,34)^ke.rotrBH(n,s,39),H=ke.rotrSL(n,s,28)^ke.rotrBL(n,s,34)^ke.rotrBL(n,s,39),Z=n&i^n&a^i&a,z=s&o^s&c^o&c;w=p|0,A=m|0,p=f|0,m=g|0,f=h|0,g=d|0,{h,l:d}=ke.add(l|0,u|0,x|0,j|0),l=a|0,u=c|0,a=i|0,c=o|0,i=n|0,o=s|0;const b=ke.add3L(j,H,z);n=ke.add3H(b,x,$,Z),s=b|0}({h:n,l:s}=ke.add(this.Ah|0,this.Al|0,n|0,s|0)),{h:i,l:o}=ke.add(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:c}=ke.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:u}=ke.add(this.Dh|0,this.Dl|0,l|0,u|0),{h,l:d}=ke.add(this.Eh|0,this.El|0,h|0,d|0),{h:f,l:g}=ke.add(this.Fh|0,this.Fl|0,f|0,g|0),{h:p,l:m}=ke.add(this.Gh|0,this.Gl|0,p|0,m|0),{h:w,l:A}=ke.add(this.Hh|0,this.Hl|0,w|0,A|0),this.set(n,s,i,o,a,c,l,u,h,d,f,g,p,m,w,A)}roundClean(){Zi.fill(0),Xi.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const mq=a0(()=>new gq);function yq(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")}const _1=yq();_1.crypto||_1.msCrypto;function wq(r){switch(r){case"sha256":return gS.create();case"sha512":return mq.create()}R(!1,"invalid hashing algorithm name","algorithm",r)}const[AS,CS,_S]=[[],[],[]],bq=BigInt(0),yh=BigInt(1),Eq=BigInt(2),vq=BigInt(7),Aq=BigInt(256),Cq=BigInt(113);for(let r=0,e=yh,t=1,n=0;r<24;r++){[t,n]=[n,(2*t+3*n)%5],AS.push(2*(5*n+t)),CS.push((r+1)*(r+2)/2%64);let s=bq;for(let i=0;i<7;i++)e=(e<<yh^(e>>vq)*Cq)%Aq,e&Eq&&(s^=yh<<(yh<<BigInt(i))-yh);_S.push(s)}const[_q,Nq]=yS(_S,!0),N1=(r,e,t)=>t>32?ES(r,e,t):wS(r,e,t),I1=(r,e,t)=>t>32?vS(r,e,t):bS(r,e,t);function Iq(r,e=24){const t=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let o=0;o<10;o++)t[o]=r[o]^r[o+10]^r[o+20]^r[o+30]^r[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=t[c],u=t[c+1],h=N1(l,u,1)^t[a],d=I1(l,u,1)^t[a+1];for(let f=0;f<50;f+=10)r[o+f]^=h,r[o+f+1]^=d}let s=r[2],i=r[3];for(let o=0;o<24;o++){const a=CS[o],c=N1(s,i,a),l=I1(s,i,a),u=AS[o];s=r[u],i=r[u+1],r[u]=c,r[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)t[a]=r[o+a];for(let a=0;a<10;a++)r[o+a]^=~t[(a+2)%10]&t[(a+4)%10]}r[0]^=_q[n],r[1]^=Nq[n]}t.fill(0)}class c0 extends o0{constructor(e,t,n,s=!1,i=24){if(super(),this.blockLen=e,this.suffix=t,this.outputLen=n,this.enableXOF=s,this.rounds=i,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,og(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=jz(this.state)}keccak(){Iq(this.state32,this.rounds),this.posOut=0,this.pos=0}update(e){Su(this);const{blockLen:t,state:n}=this;e=Zg(e);const s=e.length;for(let i=0;i<s;){const o=Math.min(t-this.pos,s-i);for(let a=0;a<o;a++)n[this.pos++]^=e[i++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:n,blockLen:s}=this;e[n]^=t,t&128&&n===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){Su(this,!1),i0(e),this.finish();const t=this.state,{blockLen:n}=this;for(let s=0,i=e.length;s<i;){this.posOut>=n&&this.keccak();const o=Math.min(n-this.posOut,i-s);e.set(t.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return og(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(uS(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:t,suffix:n,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new c0(t,n,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=n,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}}const Sq=(r,e,t)=>a0(()=>new c0(e,r,t)),xq=Sq(1,136,256/8);let NS=!1;const IS=function(r){return xq(r)};let SS=IS;function Ft(r){const e=Ue(r,"data");return re(SS(e))}Ft._=IS;Ft.lock=function(){NS=!0};Ft.register=function(r){if(NS)throw new TypeError("keccak256 is locked");SS=r};Object.freeze(Ft);const xS=function(r){return wq("sha256").update(r).digest()};let TS=xS,PS=!1;function qu(r){const e=Ue(r,"data");return re(TS(e))}qu._=xS;qu.lock=function(){PS=!0};qu.register=function(r){if(PS)throw new Error("sha256 is locked");TS=r};Object.freeze(qu);Object.freeze(qu);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const OS=BigInt(0),Xg=BigInt(1),Tq=BigInt(2),em=r=>r instanceof Uint8Array,Pq=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));function xu(r){if(!em(r))throw new Error("Uint8Array expected");let e="";for(let t=0;t<r.length;t++)e+=Pq[r[t]];return e}function RS(r){const e=r.toString(16);return e.length&1?`0${e}`:e}function l0(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);return BigInt(r===""?"0":`0x${r}`)}function Tu(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);const e=r.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const t=new Uint8Array(e/2);for(let n=0;n<t.length;n++){const s=n*2,i=r.slice(s,s+2),o=Number.parseInt(i,16);if(Number.isNaN(o)||o<0)throw new Error("Invalid byte sequence");t[n]=o}return t}function Ga(r){return l0(xu(r))}function u0(r){if(!em(r))throw new Error("Uint8Array expected");return l0(xu(Uint8Array.from(r).reverse()))}function Pu(r,e){return Tu(r.toString(16).padStart(e*2,"0"))}function h0(r,e){return Pu(r,e).reverse()}function Oq(r){return Tu(RS(r))}function Zn(r,e,t){let n;if(typeof e=="string")try{n=Tu(e)}catch(i){throw new Error(`${r} must be valid hex string, got "${e}". Cause: ${i}`)}else if(em(e))n=Uint8Array.from(e);else throw new Error(`${r} must be hex string or Uint8Array`);const s=n.length;if(typeof t=="number"&&s!==t)throw new Error(`${r} expected ${t} bytes, got ${s}`);return n}function kd(...r){const e=new Uint8Array(r.reduce((n,s)=>n+s.length,0));let t=0;return r.forEach(n=>{if(!em(n))throw new Error("Uint8Array expected");e.set(n,t),t+=n.length}),e}function Rq(r,e){if(r.length!==e.length)return!1;for(let t=0;t<r.length;t++)if(r[t]!==e[t])return!1;return!0}function Dq(r){if(typeof r!="string")throw new Error(`utf8ToBytes expected string, got ${typeof r}`);return new Uint8Array(new TextEncoder().encode(r))}function kq(r){let e;for(e=0;r>OS;r>>=Xg,e+=1);return e}function Uq(r,e){return r>>BigInt(e)&Xg}const Bq=(r,e,t)=>r|(t?Xg:OS)<<BigInt(e),d0=r=>(Tq<<BigInt(r-1))-Xg,Ay=r=>new Uint8Array(r),S1=r=>Uint8Array.from(r);function DS(r,e,t){if(typeof r!="number"||r<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof t!="function")throw new Error("hmacFn must be a function");let n=Ay(r),s=Ay(r),i=0;const o=()=>{n.fill(1),s.fill(0),i=0},a=(...h)=>t(s,n,...h),c=(h=Ay())=>{s=a(S1([0]),h),n=a(),h.length!==0&&(s=a(S1([1]),h),n=a())},l=()=>{if(i++>=1e3)throw new Error("drbg: tried 1000 values");let h=0;const d=[];for(;h<e;){n=a();const f=n.slice();d.push(f),h+=n.length}return kd(...d)};return(h,d)=>{o(),c(h);let f;for(;!(f=d(l()));)c();return o(),f}}const Lq={bigint:r=>typeof r=="bigint",function:r=>typeof r=="function",boolean:r=>typeof r=="boolean",string:r=>typeof r=="string",stringOrUint8Array:r=>typeof r=="string"||r instanceof Uint8Array,isSafeInteger:r=>Number.isSafeInteger(r),array:r=>Array.isArray(r),field:(r,e)=>e.Fp.isValid(r),hash:r=>typeof r=="function"&&Number.isSafeInteger(r.outputLen)};function _f(r,e,t={}){const n=(s,i,o)=>{const a=Lq[i];if(typeof a!="function")throw new Error(`Invalid validator "${i}", expected function`);const c=r[s];if(!(o&&c===void 0)&&!a(c,r))throw new Error(`Invalid param ${String(s)}=${c} (${typeof c}), expected ${i}`)};for(const[s,i]of Object.entries(e))n(s,i,!1);for(const[s,i]of Object.entries(t))n(s,i,!0);return r}const $q=Object.freeze(Object.defineProperty({__proto__:null,bitGet:Uq,bitLen:kq,bitMask:d0,bitSet:Bq,bytesToHex:xu,bytesToNumberBE:Ga,bytesToNumberLE:u0,concatBytes:kd,createHmacDrbg:DS,ensureBytes:Zn,equalBytes:Rq,hexToBytes:Tu,hexToNumber:l0,numberToBytesBE:Pu,numberToBytesLE:h0,numberToHexUnpadded:RS,numberToVarBytesBE:Oq,utf8ToBytes:Dq,validateObject:_f},Symbol.toStringTag,{value:"Module"}));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const tr=BigInt(0),Bt=BigInt(1),ua=BigInt(2),Mq=BigInt(3),Ww=BigInt(4),x1=BigInt(5),T1=BigInt(8);BigInt(9);BigInt(16);function Gr(r,e){const t=r%e;return t>=tr?t:e+t}function Fq(r,e,t){if(t<=tr||e<tr)throw new Error("Expected power/modulo > 0");if(t===Bt)return tr;let n=Bt;for(;e>tr;)e&Bt&&(n=n*r%t),r=r*r%t,e>>=Bt;return n}function Sn(r,e,t){let n=r;for(;e-- >tr;)n*=n,n%=t;return n}function Gw(r,e){if(r===tr||e<=tr)throw new Error(`invert: expected positive integers, got n=${r} mod=${e}`);let t=Gr(r,e),n=e,s=tr,i=Bt;for(;t!==tr;){const a=n/t,c=n%t,l=s-i*a;n=t,t=c,s=i,i=l}if(n!==Bt)throw new Error("invert: does not exist");return Gr(s,e)}function jq(r){const e=(r-Bt)/ua;let t,n,s;for(t=r-Bt,n=0;t%ua===tr;t/=ua,n++);for(s=ua;s<r&&Fq(s,e,r)!==r-Bt;s++);if(n===1){const o=(r+Bt)/Ww;return function(c,l){const u=c.pow(l,o);if(!c.eql(c.sqr(u),l))throw new Error("Cannot find square root");return u}}const i=(t+Bt)/ua;return function(a,c){if(a.pow(c,e)===a.neg(a.ONE))throw new Error("Cannot find square root");let l=n,u=a.pow(a.mul(a.ONE,s),t),h=a.pow(c,i),d=a.pow(c,t);for(;!a.eql(d,a.ONE);){if(a.eql(d,a.ZERO))return a.ZERO;let f=1;for(let p=a.sqr(d);f<l&&!a.eql(p,a.ONE);f++)p=a.sqr(p);const g=a.pow(u,Bt<<BigInt(l-f-1));u=a.sqr(g),h=a.mul(h,g),d=a.mul(d,u),l=f}return h}}function Hq(r){if(r%Ww===Mq){const e=(r+Bt)/Ww;return function(n,s){const i=n.pow(s,e);if(!n.eql(n.sqr(i),s))throw new Error("Cannot find square root");return i}}if(r%T1===x1){const e=(r-x1)/T1;return function(n,s){const i=n.mul(s,ua),o=n.pow(i,e),a=n.mul(s,o),c=n.mul(n.mul(a,ua),o),l=n.mul(a,n.sub(c,n.ONE));if(!n.eql(n.sqr(l),s))throw new Error("Cannot find square root");return l}}return jq(r)}const zq=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function qq(r){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},t=zq.reduce((n,s)=>(n[s]="function",n),e);return _f(r,t)}function Vq(r,e,t){if(t<tr)throw new Error("Expected power > 0");if(t===tr)return r.ONE;if(t===Bt)return e;let n=r.ONE,s=e;for(;t>tr;)t&Bt&&(n=r.mul(n,s)),s=r.sqr(s),t>>=Bt;return n}function Wq(r,e){const t=new Array(e.length),n=e.reduce((i,o,a)=>r.is0(o)?i:(t[a]=i,r.mul(i,o)),r.ONE),s=r.inv(n);return e.reduceRight((i,o,a)=>r.is0(o)?i:(t[a]=r.mul(i,t[a]),r.mul(i,o)),s),t}function kS(r,e){const t=e!==void 0?e:r.toString(2).length,n=Math.ceil(t/8);return{nBitLength:t,nByteLength:n}}function Gq(r,e,t=!1,n={}){if(r<=tr)throw new Error(`Expected Field ORDER > 0, got ${r}`);const{nBitLength:s,nByteLength:i}=kS(r,e);if(i>2048)throw new Error("Field lengths over 2048 bytes are not supported");const o=Hq(r),a=Object.freeze({ORDER:r,BITS:s,BYTES:i,MASK:d0(s),ZERO:tr,ONE:Bt,create:c=>Gr(c,r),isValid:c=>{if(typeof c!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof c}`);return tr<=c&&c<r},is0:c=>c===tr,isOdd:c=>(c&Bt)===Bt,neg:c=>Gr(-c,r),eql:(c,l)=>c===l,sqr:c=>Gr(c*c,r),add:(c,l)=>Gr(c+l,r),sub:(c,l)=>Gr(c-l,r),mul:(c,l)=>Gr(c*l,r),pow:(c,l)=>Vq(a,c,l),div:(c,l)=>Gr(c*Gw(l,r),r),sqrN:c=>c*c,addN:(c,l)=>c+l,subN:(c,l)=>c-l,mulN:(c,l)=>c*l,inv:c=>Gw(c,r),sqrt:n.sqrt||(c=>o(a,c)),invertBatch:c=>Wq(a,c),cmov:(c,l,u)=>u?l:c,toBytes:c=>t?h0(c,i):Pu(c,i),fromBytes:c=>{if(c.length!==i)throw new Error(`Fp.fromBytes: expected ${i}, got ${c.length}`);return t?u0(c):Ga(c)}});return Object.freeze(a)}function US(r){if(typeof r!="bigint")throw new Error("field order must be bigint");const e=r.toString(2).length;return Math.ceil(e/8)}function BS(r){const e=US(r);return e+Math.ceil(e/2)}function Kq(r,e,t=!1){const n=r.length,s=US(e),i=BS(e);if(n<16||n<i||n>1024)throw new Error(`expected ${i}-1024 bytes of input, got ${n}`);const o=t?Ga(r):u0(r),a=Gr(o,e-Bt)+Bt;return t?h0(a,s):Pu(a,s)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Jq=BigInt(0),Cy=BigInt(1);function Yq(r,e){const t=(s,i)=>{const o=i.negate();return s?o:i},n=s=>{const i=Math.ceil(e/s)+1,o=2**(s-1);return{windows:i,windowSize:o}};return{constTimeNegate:t,unsafeLadder(s,i){let o=r.ZERO,a=s;for(;i>Jq;)i&Cy&&(o=o.add(a)),a=a.double(),i>>=Cy;return o},precomputeWindow(s,i){const{windows:o,windowSize:a}=n(i),c=[];let l=s,u=l;for(let h=0;h<o;h++){u=l,c.push(u);for(let d=1;d<a;d++)u=u.add(l),c.push(u);l=u.double()}return c},wNAF(s,i,o){const{windows:a,windowSize:c}=n(s);let l=r.ZERO,u=r.BASE;const h=BigInt(2**s-1),d=2**s,f=BigInt(s);for(let g=0;g<a;g++){const p=g*c;let m=Number(o&h);o>>=f,m>c&&(m-=d,o+=Cy);const w=p,A=p+Math.abs(m)-1,v=g%2!==0,N=m<0;m===0?u=u.add(t(v,i[w])):l=l.add(t(N,i[A]))}return{p:l,f:u}},wNAFCached(s,i,o,a){const c=s._WINDOW_SIZE||1;let l=i.get(s);return l||(l=this.precomputeWindow(s,c),c!==1&&i.set(s,a(l))),this.wNAF(c,l,o)}}}function LS(r){return qq(r.Fp),_f(r,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...kS(r.n,r.nBitLength),...r,p:r.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Qq(r){const e=LS(r);_f(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:t,Fp:n,a:s}=e;if(t){if(!n.eql(s,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof t!="object"||typeof t.beta!="bigint"||typeof t.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}const{bytesToNumberBE:Zq,hexToBytes:Xq}=$q,ba={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(r){const{Err:e}=ba;if(r.length<2||r[0]!==2)throw new e("Invalid signature integer tag");const t=r[1],n=r.subarray(2,t+2);if(!t||n.length!==t)throw new e("Invalid signature integer: wrong length");if(n[0]&128)throw new e("Invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new e("Invalid signature integer: unnecessary leading zero");return{d:Zq(n),l:r.subarray(t+2)}},toSig(r){const{Err:e}=ba,t=typeof r=="string"?Xq(r):r;if(!(t instanceof Uint8Array))throw new Error("ui8a expected");let n=t.length;if(n<2||t[0]!=48)throw new e("Invalid signature tag");if(t[1]!==n-2)throw new e("Invalid signature: incorrect length");const{d:s,l:i}=ba._parseInt(t.subarray(2)),{d:o,l:a}=ba._parseInt(i);if(a.length)throw new e("Invalid signature: left bytes after parsing");return{r:s,s:o}},hexFromSig(r){const e=l=>Number.parseInt(l[0],16)&8?"00"+l:l,t=l=>{const u=l.toString(16);return u.length&1?`0${u}`:u},n=e(t(r.s)),s=e(t(r.r)),i=n.length/2,o=s.length/2,a=t(i),c=t(o);return`30${t(o+i+4)}02${c}${s}02${a}${n}`}},Si=BigInt(0),Ln=BigInt(1);BigInt(2);const P1=BigInt(3);BigInt(4);function eV(r){const e=Qq(r),{Fp:t}=e,n=e.toBytes||((g,p,m)=>{const w=p.toAffine();return kd(Uint8Array.from([4]),t.toBytes(w.x),t.toBytes(w.y))}),s=e.fromBytes||(g=>{const p=g.subarray(1),m=t.fromBytes(p.subarray(0,t.BYTES)),w=t.fromBytes(p.subarray(t.BYTES,2*t.BYTES));return{x:m,y:w}});function i(g){const{a:p,b:m}=e,w=t.sqr(g),A=t.mul(w,g);return t.add(t.add(A,t.mul(g,p)),m)}if(!t.eql(t.sqr(e.Gy),i(e.Gx)))throw new Error("bad generator point: equation left != right");function o(g){return typeof g=="bigint"&&Si<g&&g<e.n}function a(g){if(!o(g))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function c(g){const{allowedPrivateKeyLengths:p,nByteLength:m,wrapPrivateKey:w,n:A}=e;if(p&&typeof g!="bigint"){if(g instanceof Uint8Array&&(g=xu(g)),typeof g!="string"||!p.includes(g.length))throw new Error("Invalid key");g=g.padStart(m*2,"0")}let v;try{v=typeof g=="bigint"?g:Ga(Zn("private key",g,m))}catch{throw new Error(`private key must be ${m} bytes, hex or bigint, not ${typeof g}`)}return w&&(v=Gr(v,A)),a(v),v}const l=new Map;function u(g){if(!(g instanceof h))throw new Error("ProjectivePoint expected")}class h{constructor(p,m,w){if(this.px=p,this.py=m,this.pz=w,p==null||!t.isValid(p))throw new Error("x required");if(m==null||!t.isValid(m))throw new Error("y required");if(w==null||!t.isValid(w))throw new Error("z required")}static fromAffine(p){const{x:m,y:w}=p||{};if(!p||!t.isValid(m)||!t.isValid(w))throw new Error("invalid affine point");if(p instanceof h)throw new Error("projective point not allowed");const A=v=>t.eql(v,t.ZERO);return A(m)&&A(w)?h.ZERO:new h(m,w,t.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(p){const m=t.invertBatch(p.map(w=>w.pz));return p.map((w,A)=>w.toAffine(m[A])).map(h.fromAffine)}static fromHex(p){const m=h.fromAffine(s(Zn("pointHex",p)));return m.assertValidity(),m}static fromPrivateKey(p){return h.BASE.multiply(c(p))}_setWindowSize(p){this._WINDOW_SIZE=p,l.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!t.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:p,y:m}=this.toAffine();if(!t.isValid(p)||!t.isValid(m))throw new Error("bad point: x or y not FE");const w=t.sqr(m),A=i(p);if(!t.eql(w,A))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:p}=this.toAffine();if(t.isOdd)return!t.isOdd(p);throw new Error("Field doesn't support isOdd")}equals(p){u(p);const{px:m,py:w,pz:A}=this,{px:v,py:N,pz:T}=p,P=t.eql(t.mul(m,T),t.mul(v,A)),D=t.eql(t.mul(w,T),t.mul(N,A));return P&&D}negate(){return new h(this.px,t.neg(this.py),this.pz)}double(){const{a:p,b:m}=e,w=t.mul(m,P1),{px:A,py:v,pz:N}=this;let T=t.ZERO,P=t.ZERO,D=t.ZERO,U=t.mul(A,A),x=t.mul(v,v),j=t.mul(N,N),$=t.mul(A,v);return $=t.add($,$),D=t.mul(A,N),D=t.add(D,D),T=t.mul(p,D),P=t.mul(w,j),P=t.add(T,P),T=t.sub(x,P),P=t.add(x,P),P=t.mul(T,P),T=t.mul($,T),D=t.mul(w,D),j=t.mul(p,j),$=t.sub(U,j),$=t.mul(p,$),$=t.add($,D),D=t.add(U,U),U=t.add(D,U),U=t.add(U,j),U=t.mul(U,$),P=t.add(P,U),j=t.mul(v,N),j=t.add(j,j),U=t.mul(j,$),T=t.sub(T,U),D=t.mul(j,x),D=t.add(D,D),D=t.add(D,D),new h(T,P,D)}add(p){u(p);const{px:m,py:w,pz:A}=this,{px:v,py:N,pz:T}=p;let P=t.ZERO,D=t.ZERO,U=t.ZERO;const x=e.a,j=t.mul(e.b,P1);let $=t.mul(m,v),H=t.mul(w,N),Z=t.mul(A,T),z=t.add(m,w),b=t.add(v,N);z=t.mul(z,b),b=t.add($,H),z=t.sub(z,b),b=t.add(m,A);let E=t.add(v,T);return b=t.mul(b,E),E=t.add($,Z),b=t.sub(b,E),E=t.add(w,A),P=t.add(N,T),E=t.mul(E,P),P=t.add(H,Z),E=t.sub(E,P),U=t.mul(x,b),P=t.mul(j,Z),U=t.add(P,U),P=t.sub(H,U),U=t.add(H,U),D=t.mul(P,U),H=t.add($,$),H=t.add(H,$),Z=t.mul(x,Z),b=t.mul(j,b),H=t.add(H,Z),Z=t.sub($,Z),Z=t.mul(x,Z),b=t.add(b,Z),$=t.mul(H,b),D=t.add(D,$),$=t.mul(E,b),P=t.mul(z,P),P=t.sub(P,$),$=t.mul(z,H),U=t.mul(E,U),U=t.add(U,$),new h(P,D,U)}subtract(p){return this.add(p.negate())}is0(){return this.equals(h.ZERO)}wNAF(p){return f.wNAFCached(this,l,p,m=>{const w=t.invertBatch(m.map(A=>A.pz));return m.map((A,v)=>A.toAffine(w[v])).map(h.fromAffine)})}multiplyUnsafe(p){const m=h.ZERO;if(p===Si)return m;if(a(p),p===Ln)return this;const{endo:w}=e;if(!w)return f.unsafeLadder(this,p);let{k1neg:A,k1:v,k2neg:N,k2:T}=w.splitScalar(p),P=m,D=m,U=this;for(;v>Si||T>Si;)v&Ln&&(P=P.add(U)),T&Ln&&(D=D.add(U)),U=U.double(),v>>=Ln,T>>=Ln;return A&&(P=P.negate()),N&&(D=D.negate()),D=new h(t.mul(D.px,w.beta),D.py,D.pz),P.add(D)}multiply(p){a(p);let m=p,w,A;const{endo:v}=e;if(v){const{k1neg:N,k1:T,k2neg:P,k2:D}=v.splitScalar(m);let{p:U,f:x}=this.wNAF(T),{p:j,f:$}=this.wNAF(D);U=f.constTimeNegate(N,U),j=f.constTimeNegate(P,j),j=new h(t.mul(j.px,v.beta),j.py,j.pz),w=U.add(j),A=x.add($)}else{const{p:N,f:T}=this.wNAF(m);w=N,A=T}return h.normalizeZ([w,A])[0]}multiplyAndAddUnsafe(p,m,w){const A=h.BASE,v=(T,P)=>P===Si||P===Ln||!T.equals(A)?T.multiplyUnsafe(P):T.multiply(P),N=v(this,m).add(v(p,w));return N.is0()?void 0:N}toAffine(p){const{px:m,py:w,pz:A}=this,v=this.is0();p==null&&(p=v?t.ONE:t.inv(A));const N=t.mul(m,p),T=t.mul(w,p),P=t.mul(A,p);if(v)return{x:t.ZERO,y:t.ZERO};if(!t.eql(P,t.ONE))throw new Error("invZ was invalid");return{x:N,y:T}}isTorsionFree(){const{h:p,isTorsionFree:m}=e;if(p===Ln)return!0;if(m)return m(h,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:p,clearCofactor:m}=e;return p===Ln?this:m?m(h,this):this.multiplyUnsafe(e.h)}toRawBytes(p=!0){return this.assertValidity(),n(h,this,p)}toHex(p=!0){return xu(this.toRawBytes(p))}}h.BASE=new h(e.Gx,e.Gy,t.ONE),h.ZERO=new h(t.ZERO,t.ONE,t.ZERO);const d=e.nBitLength,f=Yq(h,e.endo?Math.ceil(d/2):d);return{CURVE:e,ProjectivePoint:h,normPrivateKeyToScalar:c,weierstrassEquation:i,isWithinCurveOrder:o}}function tV(r){const e=LS(r);return _f(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function rV(r){const e=tV(r),{Fp:t,n}=e,s=t.BYTES+1,i=2*t.BYTES+1;function o(b){return Si<b&&b<t.ORDER}function a(b){return Gr(b,n)}function c(b){return Gw(b,n)}const{ProjectivePoint:l,normPrivateKeyToScalar:u,weierstrassEquation:h,isWithinCurveOrder:d}=eV({...e,toBytes(b,E,O){const B=E.toAffine(),k=t.toBytes(B.x),M=kd;return O?M(Uint8Array.from([E.hasEvenY()?2:3]),k):M(Uint8Array.from([4]),k,t.toBytes(B.y))},fromBytes(b){const E=b.length,O=b[0],B=b.subarray(1);if(E===s&&(O===2||O===3)){const k=Ga(B);if(!o(k))throw new Error("Point is not on curve");const M=h(k);let G=t.sqrt(M);const J=(G&Ln)===Ln;return(O&1)===1!==J&&(G=t.neg(G)),{x:k,y:G}}else if(E===i&&O===4){const k=t.fromBytes(B.subarray(0,t.BYTES)),M=t.fromBytes(B.subarray(t.BYTES,2*t.BYTES));return{x:k,y:M}}else throw new Error(`Point of length ${E} was invalid. Expected ${s} compressed bytes or ${i} uncompressed bytes`)}}),f=b=>xu(Pu(b,e.nByteLength));function g(b){const E=n>>Ln;return b>E}function p(b){return g(b)?a(-b):b}const m=(b,E,O)=>Ga(b.slice(E,O));class w{constructor(E,O,B){this.r=E,this.s=O,this.recovery=B,this.assertValidity()}static fromCompact(E){const O=e.nByteLength;return E=Zn("compactSignature",E,O*2),new w(m(E,0,O),m(E,O,2*O))}static fromDER(E){const{r:O,s:B}=ba.toSig(Zn("DER",E));return new w(O,B)}assertValidity(){if(!d(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!d(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(E){return new w(this.r,this.s,E)}recoverPublicKey(E){const{r:O,s:B,recovery:k}=this,M=D(Zn("msgHash",E));if(k==null||![0,1,2,3].includes(k))throw new Error("recovery id invalid");const G=k===2||k===3?O+e.n:O;if(G>=t.ORDER)throw new Error("recovery id 2 or 3 invalid");const J=k&1?"03":"02",oe=l.fromHex(J+f(G)),Q=c(G),ge=a(-M*Q),Oe=a(B*Q),$e=l.BASE.multiplyAndAddUnsafe(oe,ge,Oe);if(!$e)throw new Error("point at infinify");return $e.assertValidity(),$e}hasHighS(){return g(this.s)}normalizeS(){return this.hasHighS()?new w(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return Tu(this.toDERHex())}toDERHex(){return ba.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Tu(this.toCompactHex())}toCompactHex(){return f(this.r)+f(this.s)}}const A={isValidPrivateKey(b){try{return u(b),!0}catch{return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>{const b=BS(e.n);return Kq(e.randomBytes(b),e.n)},precompute(b=8,E=l.BASE){return E._setWindowSize(b),E.multiply(BigInt(3)),E}};function v(b,E=!0){return l.fromPrivateKey(b).toRawBytes(E)}function N(b){const E=b instanceof Uint8Array,O=typeof b=="string",B=(E||O)&&b.length;return E?B===s||B===i:O?B===2*s||B===2*i:b instanceof l}function T(b,E,O=!0){if(N(b))throw new Error("first arg must be private key");if(!N(E))throw new Error("second arg must be public key");return l.fromHex(E).multiply(u(b)).toRawBytes(O)}const P=e.bits2int||function(b){const E=Ga(b),O=b.length*8-e.nBitLength;return O>0?E>>BigInt(O):E},D=e.bits2int_modN||function(b){return a(P(b))},U=d0(e.nBitLength);function x(b){if(typeof b!="bigint")throw new Error("bigint expected");if(!(Si<=b&&b<U))throw new Error(`bigint expected < 2^${e.nBitLength}`);return Pu(b,e.nByteLength)}function j(b,E,O=$){if(["recovered","canonical"].some(Ne=>Ne in O))throw new Error("sign() legacy options not supported");const{hash:B,randomBytes:k}=e;let{lowS:M,prehash:G,extraEntropy:J}=O;M==null&&(M=!0),b=Zn("msgHash",b),G&&(b=Zn("prehashed msgHash",B(b)));const oe=D(b),Q=u(E),ge=[x(Q),x(oe)];if(J!=null){const Ne=J===!0?k(t.BYTES):J;ge.push(Zn("extraEntropy",Ne))}const Oe=kd(...ge),$e=oe;function Me(Ne){const Qe=P(Ne);if(!d(Qe))return;const gt=c(Qe),_t=l.BASE.multiply(Qe).toAffine(),ut=a(_t.x);if(ut===Si)return;const Ot=a(gt*a($e+ut*Q));if(Ot===Si)return;let Hn=(_t.x===ut?0:2)|Number(_t.y&Ln),Wu=Ot;return M&&g(Ot)&&(Wu=p(Ot),Hn^=1),new w(ut,Wu,Hn)}return{seed:Oe,k2sig:Me}}const $={lowS:e.lowS,prehash:!1},H={lowS:e.lowS,prehash:!1};function Z(b,E,O=$){const{seed:B,k2sig:k}=j(b,E,O),M=e;return DS(M.hash.outputLen,M.nByteLength,M.hmac)(B,k)}l.BASE._setWindowSize(8);function z(b,E,O,B=H){var _t;const k=b;if(E=Zn("msgHash",E),O=Zn("publicKey",O),"strict"in B)throw new Error("options.strict was renamed to lowS");const{lowS:M,prehash:G}=B;let J,oe;try{if(typeof k=="string"||k instanceof Uint8Array)try{J=w.fromDER(k)}catch(ut){if(!(ut instanceof ba.Err))throw ut;J=w.fromCompact(k)}else if(typeof k=="object"&&typeof k.r=="bigint"&&typeof k.s=="bigint"){const{r:ut,s:Ot}=k;J=new w(ut,Ot)}else throw new Error("PARSE");oe=l.fromHex(O)}catch(ut){if(ut.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(M&&J.hasHighS())return!1;G&&(E=e.hash(E));const{r:Q,s:ge}=J,Oe=D(E),$e=c(ge),Me=a(Oe*$e),Ne=a(Q*$e),Qe=(_t=l.BASE.multiplyAndAddUnsafe(oe,Me,Ne))==null?void 0:_t.toAffine();return Qe?a(Qe.x)===Q:!1}return{CURVE:e,getPublicKey:v,getSharedSecret:T,sign:Z,verify:z,ProjectivePoint:l,Signature:w,utils:A}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function nV(r){return{hash:r,hmac:(e,...t)=>fS(r,e,qz(...t)),randomBytes:Vz}}function sV(r,e){const t=n=>rV({...r,...nV(n)});return Object.freeze({...t(e),create:t})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const $S=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),O1=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),iV=BigInt(1),Kw=BigInt(2),R1=(r,e)=>(r+e/Kw)/e;function oV(r){const e=$S,t=BigInt(3),n=BigInt(6),s=BigInt(11),i=BigInt(22),o=BigInt(23),a=BigInt(44),c=BigInt(88),l=r*r*r%e,u=l*l*r%e,h=Sn(u,t,e)*u%e,d=Sn(h,t,e)*u%e,f=Sn(d,Kw,e)*l%e,g=Sn(f,s,e)*f%e,p=Sn(g,i,e)*g%e,m=Sn(p,a,e)*p%e,w=Sn(m,c,e)*m%e,A=Sn(w,a,e)*p%e,v=Sn(A,t,e)*u%e,N=Sn(v,o,e)*g%e,T=Sn(N,n,e)*l%e,P=Sn(T,Kw,e);if(!Jw.eql(Jw.sqr(P),r))throw new Error("Cannot find square root");return P}const Jw=Gq($S,void 0,void 0,{sqrt:oV}),to=sV({a:BigInt(0),b:BigInt(7),Fp:Jw,n:O1,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:r=>{const e=O1,t=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-iV*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),s=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=t,o=BigInt("0x100000000000000000000000000000000"),a=R1(i*r,e),c=R1(-n*r,e);let l=Gr(r-a*t-c*s,e),u=Gr(-a*n-c*i,e);const h=l>o,d=u>o;if(h&&(l=e-l),d&&(u=e-u),l>o||u>o)throw new Error("splitScalar: Endomorphism failed, k="+r);return{k1neg:h,k1:l,k2neg:d,k2:u}}}},gS);BigInt(0);to.ProjectivePoint;const Ud="0x0000000000000000000000000000000000000000",D1="0x0000000000000000000000000000000000000000000000000000000000000000",k1=BigInt(0),U1=BigInt(1),B1=BigInt(2),L1=BigInt(27),$1=BigInt(28),op=BigInt(35),Jc={};function M1(r){return $i(hr(r),32)}var Pl,Ol,Rl,Oa;const Qn=class Qn{constructor(e,t,n,s){F(this,Pl);F(this,Ol);F(this,Rl);F(this,Oa);Af(e,Jc,"Signature"),_(this,Pl,t),_(this,Ol,n),_(this,Rl,s),_(this,Oa,null)}get r(){return y(this,Pl)}set r(e){R(yl(e)===32,"invalid r","value",e),_(this,Pl,re(e))}get s(){return y(this,Ol)}set s(e){R(yl(e)===32,"invalid s","value",e);const t=re(e);R(parseInt(t.substring(0,3))<8,"non-canonical s","value",t),_(this,Ol,t)}get v(){return y(this,Rl)}set v(e){const t=Pe(e,"value");R(t===27||t===28,"invalid v","v",e),_(this,Rl,t)}get networkV(){return y(this,Oa)}get legacyChainId(){const e=this.networkV;return e==null?null:Qn.getChainId(e)}get yParity(){return this.v===27?0:1}get yParityAndS(){const e=Ue(this.s);return this.yParity&&(e[0]|=128),re(e)}get compactSerialized(){return Pt([this.r,this.yParityAndS])}get serialized(){return Pt([this.r,this.s,this.yParity?"0x1c":"0x1b"])}[Symbol.for("nodejs.util.inspect.custom")](){return`Signature { r: "${this.r}", s: "${this.s}", yParity: ${this.yParity}, networkV: ${this.networkV} }`}clone(){const e=new Qn(Jc,this.r,this.s,this.v);return this.networkV&&_(e,Oa,this.networkV),e}toJSON(){const e=this.networkV;return{_type:"signature",networkV:e!=null?e.toString():null,r:this.r,s:this.s,v:this.v}}static getChainId(e){const t=de(e,"v");return t==L1||t==$1?k1:(R(t>=op,"invalid EIP-155 v","v",e),(t-op)/B1)}static getChainIdV(e,t){return de(e)*B1+BigInt(35+t-27)}static getNormalizedV(e){const t=de(e);return t===k1||t===L1?27:t===U1||t===$1?28:(R(t>=op,"invalid v","v",e),t&U1?27:28)}static from(e){function t(l,u){R(l,u,"signature",e)}if(e==null)return new Qn(Jc,D1,D1,27);if(typeof e=="string"){const l=Ue(e,"signature");if(l.length===64){const u=re(l.slice(0,32)),h=l.slice(32,64),d=h[0]&128?28:27;return h[0]&=127,new Qn(Jc,u,re(h),d)}if(l.length===65){const u=re(l.slice(0,32)),h=l.slice(32,64);t((h[0]&128)===0,"non-canonical s");const d=Qn.getNormalizedV(l[64]);return new Qn(Jc,u,re(h),d)}t(!1,"invalid raw signature length")}if(e instanceof Qn)return e.clone();const n=e.r;t(n!=null,"missing r");const s=M1(n),i=function(l,u){if(l!=null)return M1(l);if(u!=null){t(pt(u,32),"invalid yParityAndS");const h=Ue(u);return h[0]&=127,re(h)}t(!1,"missing s")}(e.s,e.yParityAndS);t((Ue(i)[0]&128)==0,"non-canonical s");const{networkV:o,v:a}=function(l,u,h){if(l!=null){const d=de(l);return{networkV:d>=op?d:void 0,v:Qn.getNormalizedV(d)}}if(u!=null)return t(pt(u,32),"invalid yParityAndS"),{v:Ue(u)[0]&128?28:27};if(h!=null){switch(Pe(h,"sig.yParity")){case 0:return{v:27};case 1:return{v:28}}t(!1,"invalid yParity")}t(!1,"missing v")}(e.v,e.yParityAndS,e.yParity),c=new Qn(Jc,s,i,a);return o&&_(c,Oa,o),t(e.yParity==null||Pe(e.yParity,"sig.yParity")===c.yParity,"yParity mismatch"),t(e.yParityAndS==null||e.yParityAndS===c.yParityAndS,"yParityAndS mismatch"),c}};Pl=new WeakMap,Ol=new WeakMap,Rl=new WeakMap,Oa=new WeakMap;let Yr=Qn;var yi;const ha=class ha{constructor(e){F(this,yi);R(yl(e)===32,"invalid private key","privateKey","[REDACTED]"),_(this,yi,re(e))}get privateKey(){return y(this,yi)}get publicKey(){return ha.computePublicKey(y(this,yi))}get compressedPublicKey(){return ha.computePublicKey(y(this,yi),!0)}sign(e){R(yl(e)===32,"invalid digest length","digest",e);const t=to.sign(Or(e),Or(y(this,yi)),{lowS:!0});return Yr.from({r:Lo(t.r,32),s:Lo(t.s,32),v:t.recovery?28:27})}computeSharedSecret(e){const t=ha.computePublicKey(e);return re(to.getSharedSecret(Or(y(this,yi)),Ue(t),!1))}static computePublicKey(e,t){let n=Ue(e,"key");if(n.length===32){const i=to.getPublicKey(n,!!t);return re(i)}if(n.length===64){const i=new Uint8Array(65);i[0]=4,i.set(n,1),n=i}const s=to.ProjectivePoint.fromHex(n);return re(s.toRawBytes(t))}static recoverPublicKey(e,t){R(yl(e)===32,"invalid digest length","digest",e);const n=Yr.from(t);let s=to.Signature.fromCompact(Or(Pt([n.r,n.s])));s=s.addRecoveryBit(n.yParity);const i=s.recoverPublicKey(Or(e));return R(i!=null,"invalid signature for digest","signature",t),"0x"+i.toHex(!1)}static addPoints(e,t,n){const s=to.ProjectivePoint.fromHex(ha.computePublicKey(e).substring(2)),i=to.ProjectivePoint.fromHex(ha.computePublicKey(t).substring(2));return"0x"+s.add(i).toHex(!!n)}};yi=new WeakMap;let Bd=ha;const aV=BigInt(0),cV=BigInt(36);function F1(r){r=r.toLowerCase();const e=r.substring(2).split(""),t=new Uint8Array(40);for(let s=0;s<40;s++)t[s]=e[s].charCodeAt(0);const n=Ue(Ft(t));for(let s=0;s<40;s+=2)n[s>>1]>>4>=8&&(e[s]=e[s].toUpperCase()),(n[s>>1]&15)>=8&&(e[s+1]=e[s+1].toUpperCase());return"0x"+e.join("")}const f0={};for(let r=0;r<10;r++)f0[String(r)]=String(r);for(let r=0;r<26;r++)f0[String.fromCharCode(65+r)]=String(10+r);const j1=15;function lV(r){r=r.toUpperCase(),r=r.substring(4)+r.substring(0,2)+"00";let e=r.split("").map(n=>f0[n]).join("");for(;e.length>=j1;){let n=e.substring(0,j1);e=parseInt(n,10)%97+e.substring(n.length)}let t=String(98-parseInt(e,10)%97);for(;t.length<2;)t="0"+t;return t}const uV=function(){const r={};for(let e=0;e<36;e++){const t="0123456789abcdefghijklmnopqrstuvwxyz"[e];r[t]=BigInt(e)}return r}();function hV(r){r=r.toLowerCase();let e=aV;for(let t=0;t<r.length;t++)e=e*cV+uV[r[t]];return e}function nt(r){if(R(typeof r=="string","invalid address","address",r),r.match(/^(0x)?[0-9a-fA-F]{40}$/)){r.startsWith("0x")||(r="0x"+r);const e=F1(r);return R(!r.match(/([A-F].*[a-f])|([a-f].*[A-F])/)||e===r,"bad address checksum","address",r),e}if(r.match(/^XE[0-9]{2}[0-9A-Za-z]{30,31}$/)){R(r.substring(2,4)===lV(r),"bad icap checksum","address",r);let e=hV(r.substring(4)).toString(16);for(;e.length<40;)e="0"+e;return F1("0x"+e)}R(!1,"invalid address","address",r)}function dV(r){const e=nt(r.from);let n=de(r.nonce,"tx.nonce").toString(16);return n==="0"?n="0x":n.length%2?n="0x0"+n:n="0x"+n,nt(Tt(Ft($o([e,n])),12))}function MS(r){return r&&typeof r.getAddress=="function"}async function _y(r,e){const t=await e;return(t==null||t==="0x0000000000000000000000000000000000000000")&&(q(typeof r!="string","unconfigured name","UNCONFIGURED_NAME",{value:r}),R(!1,"invalid AddressLike value; did not resolve to a value address","target",r)),nt(t)}function Dr(r,e){if(typeof r=="string")return r.match(/^0x[0-9a-f]{40}$/i)?nt(r):(q(e!=null,"ENS resolution requires a provider","UNSUPPORTED_OPERATION",{operation:"resolveName"}),_y(r,e.resolveName(r)));if(MS(r))return _y(r,r.getAddress());if(r&&typeof r.then=="function")return _y(r,r);R(!1,"unsupported addressable value","target",r)}const ui={};function ue(r,e){let t=!1;return e<0&&(t=!0,e*=-1),new Cr(ui,`${t?"":"u"}int${e}`,r,{signed:t,width:e})}function Ke(r,e){return new Cr(ui,`bytes${e||""}`,r,{size:e})}const H1=Symbol.for("_ethers_typed");var Ra;const hi=class hi{constructor(e,t,n,s){L(this,"type");L(this,"value");F(this,Ra);L(this,"_typedSymbol");s==null&&(s=null),Af(ui,e,"Typed"),ye(this,{_typedSymbol:H1,type:t,value:n}),_(this,Ra,s),this.format()}format(){if(this.type==="array")throw new Error("");if(this.type==="dynamicArray")throw new Error("");return this.type==="tuple"?`tuple(${this.value.map(e=>e.format()).join(",")})`:this.type}defaultValue(){return 0}minValue(){return 0}maxValue(){return 0}isBigInt(){return!!this.type.match(/^u?int[0-9]+$/)}isData(){return this.type.startsWith("bytes")}isString(){return this.type==="string"}get tupleName(){if(this.type!=="tuple")throw TypeError("not a tuple");return y(this,Ra)}get arrayLength(){if(this.type!=="array")throw TypeError("not an array");return y(this,Ra)===!0?-1:y(this,Ra)===!1?this.value.length:null}static from(e,t){return new hi(ui,e,t)}static uint8(e){return ue(e,8)}static uint16(e){return ue(e,16)}static uint24(e){return ue(e,24)}static uint32(e){return ue(e,32)}static uint40(e){return ue(e,40)}static uint48(e){return ue(e,48)}static uint56(e){return ue(e,56)}static uint64(e){return ue(e,64)}static uint72(e){return ue(e,72)}static uint80(e){return ue(e,80)}static uint88(e){return ue(e,88)}static uint96(e){return ue(e,96)}static uint104(e){return ue(e,104)}static uint112(e){return ue(e,112)}static uint120(e){return ue(e,120)}static uint128(e){return ue(e,128)}static uint136(e){return ue(e,136)}static uint144(e){return ue(e,144)}static uint152(e){return ue(e,152)}static uint160(e){return ue(e,160)}static uint168(e){return ue(e,168)}static uint176(e){return ue(e,176)}static uint184(e){return ue(e,184)}static uint192(e){return ue(e,192)}static uint200(e){return ue(e,200)}static uint208(e){return ue(e,208)}static uint216(e){return ue(e,216)}static uint224(e){return ue(e,224)}static uint232(e){return ue(e,232)}static uint240(e){return ue(e,240)}static uint248(e){return ue(e,248)}static uint256(e){return ue(e,256)}static uint(e){return ue(e,256)}static int8(e){return ue(e,-8)}static int16(e){return ue(e,-16)}static int24(e){return ue(e,-24)}static int32(e){return ue(e,-32)}static int40(e){return ue(e,-40)}static int48(e){return ue(e,-48)}static int56(e){return ue(e,-56)}static int64(e){return ue(e,-64)}static int72(e){return ue(e,-72)}static int80(e){return ue(e,-80)}static int88(e){return ue(e,-88)}static int96(e){return ue(e,-96)}static int104(e){return ue(e,-104)}static int112(e){return ue(e,-112)}static int120(e){return ue(e,-120)}static int128(e){return ue(e,-128)}static int136(e){return ue(e,-136)}static int144(e){return ue(e,-144)}static int152(e){return ue(e,-152)}static int160(e){return ue(e,-160)}static int168(e){return ue(e,-168)}static int176(e){return ue(e,-176)}static int184(e){return ue(e,-184)}static int192(e){return ue(e,-192)}static int200(e){return ue(e,-200)}static int208(e){return ue(e,-208)}static int216(e){return ue(e,-216)}static int224(e){return ue(e,-224)}static int232(e){return ue(e,-232)}static int240(e){return ue(e,-240)}static int248(e){return ue(e,-248)}static int256(e){return ue(e,-256)}static int(e){return ue(e,-256)}static bytes1(e){return Ke(e,1)}static bytes2(e){return Ke(e,2)}static bytes3(e){return Ke(e,3)}static bytes4(e){return Ke(e,4)}static bytes5(e){return Ke(e,5)}static bytes6(e){return Ke(e,6)}static bytes7(e){return Ke(e,7)}static bytes8(e){return Ke(e,8)}static bytes9(e){return Ke(e,9)}static bytes10(e){return Ke(e,10)}static bytes11(e){return Ke(e,11)}static bytes12(e){return Ke(e,12)}static bytes13(e){return Ke(e,13)}static bytes14(e){return Ke(e,14)}static bytes15(e){return Ke(e,15)}static bytes16(e){return Ke(e,16)}static bytes17(e){return Ke(e,17)}static bytes18(e){return Ke(e,18)}static bytes19(e){return Ke(e,19)}static bytes20(e){return Ke(e,20)}static bytes21(e){return Ke(e,21)}static bytes22(e){return Ke(e,22)}static bytes23(e){return Ke(e,23)}static bytes24(e){return Ke(e,24)}static bytes25(e){return Ke(e,25)}static bytes26(e){return Ke(e,26)}static bytes27(e){return Ke(e,27)}static bytes28(e){return Ke(e,28)}static bytes29(e){return Ke(e,29)}static bytes30(e){return Ke(e,30)}static bytes31(e){return Ke(e,31)}static bytes32(e){return Ke(e,32)}static address(e){return new hi(ui,"address",e)}static bool(e){return new hi(ui,"bool",!!e)}static bytes(e){return new hi(ui,"bytes",e)}static string(e){return new hi(ui,"string",e)}static array(e,t){throw new Error("not implemented yet")}static tuple(e,t){throw new Error("not implemented yet")}static overrides(e){return new hi(ui,"overrides",Object.assign({},e))}static isTyped(e){return e&&typeof e=="object"&&"_typedSymbol"in e&&e._typedSymbol===H1}static dereference(e,t){if(hi.isTyped(e)){if(e.type!==t)throw new Error(`invalid type: expecetd ${t}, got ${e.type}`);return e.value}return e}};Ra=new WeakMap;let Cr=hi;class fV extends ji{constructor(e){super("address","address",e,!1)}defaultValue(){return"0x0000000000000000000000000000000000000000"}encode(e,t){let n=Cr.dereference(t,"string");try{n=nt(n)}catch(s){return this._throwError(s.message,t)}return e.writeValue(n)}decode(e){return nt(Lo(e.readValue(),20))}}class pV extends ji{constructor(t){super(t.name,t.type,"_",t.dynamic);L(this,"coder");this.coder=t}defaultValue(){return this.coder.defaultValue()}encode(t,n){return this.coder.encode(t,n)}decode(t){return this.coder.decode(t)}}function FS(r,e,t){let n=[];if(Array.isArray(t))n=t;else if(t&&typeof t=="object"){let c={};n=e.map(l=>{const u=l.localName;return q(u,"cannot encode object for signature with missing names","INVALID_ARGUMENT",{argument:"values",info:{coder:l},value:t}),q(!c[u],"cannot encode object for signature with duplicate names","INVALID_ARGUMENT",{argument:"values",info:{coder:l},value:t}),c[u]=!0,t[u]})}else R(!1,"invalid tuple value","tuple",t);R(e.length===n.length,"types/value length mismatch","tuple",t);let s=new Hw,i=new Hw,o=[];e.forEach((c,l)=>{let u=n[l];if(c.dynamic){let h=i.length;c.encode(i,u);let d=s.writeUpdatableValue();o.push(f=>{d(f+h)})}else c.encode(s,u)}),o.forEach(c=>{c(s.length)});let a=r.appendWriter(s);return a+=r.appendWriter(i),a}function jS(r,e){let t=[],n=[],s=r.subReader(0);return e.forEach(i=>{let o=null;if(i.dynamic){let a=r.readIndex(),c=s.subReader(a);try{o=i.decode(c)}catch(l){if(lr(l,"BUFFER_OVERRUN"))throw l;o=l,o.baseType=i.name,o.name=i.localName,o.type=i.type}}else try{o=i.decode(r)}catch(a){if(lr(a,"BUFFER_OVERRUN"))throw a;o=a,o.baseType=i.name,o.name=i.localName,o.type=i.type}if(o==null)throw new Error("investigate");t.push(o),n.push(i.localName||null)}),Iu.fromItems(t,n)}class gV extends ji{constructor(t,n,s){const i=t.type+"["+(n>=0?n:"")+"]",o=n===-1||t.dynamic;super("array",i,s,o);L(this,"coder");L(this,"length");ye(this,{coder:t,length:n})}defaultValue(){const t=this.coder.defaultValue(),n=[];for(let s=0;s<this.length;s++)n.push(t);return n}encode(t,n){const s=Cr.dereference(n,"array");Array.isArray(s)||this._throwError("expected array value",s);let i=this.length;i===-1&&(i=s.length,t.writeValue(s.length)),GI(s.length,i,"coder array"+(this.localName?" "+this.localName:""));let o=[];for(let a=0;a<s.length;a++)o.push(this.coder);return FS(t,o,s)}decode(t){let n=this.length;n===-1&&(n=t.readIndex(),q(n*Rr<=t.dataLength,"insufficient data length","BUFFER_OVERRUN",{buffer:t.bytes,offset:n*Rr,length:t.dataLength}));let s=[];for(let i=0;i<n;i++)s.push(new pV(this.coder));return jS(t,s)}}class mV extends ji{constructor(e){super("bool","bool",e,!1)}defaultValue(){return!1}encode(e,t){const n=Cr.dereference(t,"bool");return e.writeValue(n?1:0)}decode(e){return!!e.readValue()}}class HS extends ji{constructor(e,t){super(e,e,t,!0)}defaultValue(){return"0x"}encode(e,t){t=Or(t);let n=e.writeValue(t.length);return n+=e.writeBytes(t),n}decode(e){return e.readBytes(e.readIndex(),!0)}}class yV extends HS{constructor(e){super("bytes",e)}decode(e){return re(super.decode(e))}}class wV extends ji{constructor(t,n){let s="bytes"+String(t);super(s,s,n,!1);L(this,"size");ye(this,{size:t},{size:"number"})}defaultValue(){return"0x0000000000000000000000000000000000000000000000000000000000000000".substring(0,2+this.size*2)}encode(t,n){let s=Or(Cr.dereference(n,this.type));return s.length!==this.size&&this._throwError("incorrect data length",n),t.writeBytes(s)}decode(t){return re(t.readBytes(this.size))}}const bV=new Uint8Array([]);class EV extends ji{constructor(e){super("null","",e,!1)}defaultValue(){return null}encode(e,t){return t!=null&&this._throwError("not null",t),e.writeBytes(bV)}decode(e){return e.readBytes(0),null}}const vV=BigInt(0),AV=BigInt(1),CV=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");class _V extends ji{constructor(t,n,s){const i=(n?"int":"uint")+t*8;super(i,i,s,!1);L(this,"size");L(this,"signed");ye(this,{size:t,signed:n},{size:"number",signed:"boolean"})}defaultValue(){return 0}encode(t,n){let s=de(Cr.dereference(n,this.type)),i=wa(CV,Rr*8);if(this.signed){let o=wa(i,this.size*8-1);(s>o||s<-(o+AV))&&this._throwError("value out-of-bounds",n),s=YI(s,8*Rr)}else(s<vV||s>wa(i,this.size*8))&&this._throwError("value out-of-bounds",n);return t.writeValue(s)}decode(t){let n=wa(t.readValue(),this.size*8);return this.signed&&(n=ng(n,this.size*8)),n}}class NV extends HS{constructor(e){super("string",e)}defaultValue(){return""}encode(e,t){return super.encode(e,Ws(Cr.dereference(t,"string")))}decode(e){return sg(super.decode(e))}}class ap extends ji{constructor(t,n){let s=!1;const i=[];t.forEach(a=>{a.dynamic&&(s=!0),i.push(a.type)});const o="tuple("+i.join(",")+")";super("tuple",o,n,s);L(this,"coders");ye(this,{coders:Object.freeze(t.slice())})}defaultValue(){const t=[];this.coders.forEach(s=>{t.push(s.defaultValue())});const n=this.coders.reduce((s,i)=>{const o=i.localName;return o&&(s[o]||(s[o]=0),s[o]++),s},{});return this.coders.forEach((s,i)=>{let o=s.localName;!o||n[o]!==1||(o==="length"&&(o="_length"),t[o]==null&&(t[o]=t[i]))}),Object.freeze(t)}encode(t,n){const s=Cr.dereference(n,"tuple");return FS(t,this.coders,s)}decode(t){return jS(t,this.coders)}}function Ny(r,e){return{address:nt(r),storageKeys:e.map((t,n)=>(R(pt(t,32),"invalid slot",`storageKeys[${n}]`,t),t.toLowerCase()))}}function vc(r){if(Array.isArray(r))return r.map((t,n)=>Array.isArray(t)?(R(t.length===2,"invalid slot set",`value[${n}]`,t),Ny(t[0],t[1])):(R(t!=null&&typeof t=="object","invalid address-slot set","value",r),Ny(t.address,t.storageKeys)));R(r!=null&&typeof r=="object","invalid access list","value",r);const e=Object.keys(r).map(t=>{const n=r[t].reduce((s,i)=>(s[i]=!0,s),{});return Ny(t,Object.keys(n).sort())});return e.sort((t,n)=>t.address.localeCompare(n.address)),e}function zS(r){return{address:nt(r.address),nonce:de(r.nonce!=null?r.nonce:0),chainId:de(r.chainId!=null?r.chainId:0),signature:Yr.from(r.signature)}}function IV(r){let e;return typeof r=="string"?e=Bd.computePublicKey(r,!1):e=r.publicKey,nt(Ft("0x"+e.substring(4)).substring(26))}function SV(r,e){return IV(Bd.recoverPublicKey(r,e))}const Yt=BigInt(0),xV=BigInt(2),TV=BigInt(27),PV=BigInt(28),OV=BigInt(35),RV=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),Iy=4096*32;function DV(r){return{blobToKzgCommitment:n=>{if("computeBlobProof"in r){if("blobToKzgCommitment"in r&&typeof r.blobToKzgCommitment=="function")return Ue(r.blobToKzgCommitment(re(n)))}else if("blobToKzgCommitment"in r&&typeof r.blobToKzgCommitment=="function")return Ue(r.blobToKzgCommitment(n));if("blobToKZGCommitment"in r&&typeof r.blobToKZGCommitment=="function")return Ue(r.blobToKZGCommitment(re(n)));R(!1,"unsupported KZG library","kzg",r)},computeBlobKzgProof:(n,s)=>{if("computeBlobProof"in r&&typeof r.computeBlobProof=="function")return Ue(r.computeBlobProof(re(n),re(s)));if("computeBlobKzgProof"in r&&typeof r.computeBlobKzgProof=="function")return r.computeBlobKzgProof(n,s);if("computeBlobKZGProof"in r&&typeof r.computeBlobKZGProof=="function")return Ue(r.computeBlobKZGProof(re(n),re(s)));R(!1,"unsupported KZG library","kzg",r)}}}function z1(r,e){let t=r.toString(16);for(;t.length<2;)t="0"+t;return t+=qu(e).substring(4),"0x"+t}function Vu(r){return r==="0x"?null:nt(r)}function tm(r,e){try{return vc(r)}catch(t){R(!1,t.message,e,r)}}function kV(r,e){try{if(!Array.isArray(r))throw new Error("authorizationList: invalid array");const t=[];for(let n=0;n<r.length;n++){const s=r[n];if(!Array.isArray(s))throw new Error(`authorization[${n}]: invalid array`);if(s.length!==6)throw new Error(`authorization[${n}]: wrong length`);if(!s[1])throw new Error(`authorization[${n}]: null address`);t.push({address:Vu(s[1]),nonce:ct(s[2],"nonce"),chainId:ct(s[0],"chainId"),signature:Yr.from({yParity:Ac(s[3],"yParity"),r:$i(s[4],32),s:$i(s[5],32)})})}return t}catch(t){R(!1,t.message,e,r)}}function Ac(r,e){return r==="0x"?0:Pe(r,e)}function ct(r,e){if(r==="0x")return Yt;const t=de(r,e);return R(t<=RV,"value exceeds uint size",e,t),t}function ze(r,e){const t=de(r,"value"),n=hr(t);return R(n.length<=32,"value too large",`tx.${e}`,t),n}function rm(r){return vc(r).map(e=>[e.address,e.storageKeys])}function UV(r){return r.map(e=>[ze(e.chainId,"chainId"),e.address,ze(e.nonce,"nonce"),ze(e.signature.yParity,"yParity"),e.signature.r,e.signature.s])}function BV(r,e){R(Array.isArray(r),`invalid ${e}`,"value",r);for(let t=0;t<r.length;t++)R(pt(r[t],32),"invalid ${ param } hash",`value[${t}]`,r[t]);return r}function LV(r){const e=Cf(r);R(Array.isArray(e)&&(e.length===9||e.length===6),"invalid field count for legacy transaction","data",r);const t={type:0,nonce:Ac(e[0],"nonce"),gasPrice:ct(e[1],"gasPrice"),gasLimit:ct(e[2],"gasLimit"),to:Vu(e[3]),value:ct(e[4],"value"),data:re(e[5]),chainId:Yt};if(e.length===6)return t;const n=ct(e[6],"v"),s=ct(e[7],"r"),i=ct(e[8],"s");if(s===Yt&&i===Yt)t.chainId=n;else{let o=(n-OV)/xV;o<Yt&&(o=Yt),t.chainId=o,R(o!==Yt||n===TV||n===PV,"non-canonical legacy v","v",e[6]),t.signature=Yr.from({r:$i(e[7],32),s:$i(e[8],32),v:n})}return t}function $V(r,e){const t=[ze(r.nonce,"nonce"),ze(r.gasPrice||0,"gasPrice"),ze(r.gasLimit,"gasLimit"),r.to||"0x",ze(r.value,"value"),r.data];let n=Yt;if(r.chainId!=Yt)n=de(r.chainId,"tx.chainId"),R(!e||e.networkV==null||e.legacyChainId===n,"tx.chainId/sig.v mismatch","sig",e);else if(r.signature){const i=r.signature.legacyChainId;i!=null&&(n=i)}if(!e)return n!==Yt&&(t.push(hr(n)),t.push("0x"),t.push("0x")),$o(t);let s=BigInt(27+e.yParity);return n!==Yt?s=Yr.getChainIdV(n,e.v):BigInt(e.v)!==s&&R(!1,"tx.chainId/sig.v mismatch","sig",e),t.push(hr(s)),t.push(hr(e.r)),t.push(hr(e.s)),$o(t)}function nm(r,e){let t;try{if(t=Ac(e[0],"yParity"),t!==0&&t!==1)throw new Error("bad yParity")}catch{R(!1,"invalid yParity","yParity",e[0])}const n=$i(e[1],32),s=$i(e[2],32),i=Yr.from({r:n,s,yParity:t});r.signature=i}function MV(r){const e=Cf(Ue(r).slice(1));R(Array.isArray(e)&&(e.length===9||e.length===12),"invalid field count for transaction type: 2","data",re(r));const t={type:2,chainId:ct(e[0],"chainId"),nonce:Ac(e[1],"nonce"),maxPriorityFeePerGas:ct(e[2],"maxPriorityFeePerGas"),maxFeePerGas:ct(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:ct(e[4],"gasLimit"),to:Vu(e[5]),value:ct(e[6],"value"),data:re(e[7]),accessList:tm(e[8],"accessList")};return e.length===9||nm(t,e.slice(9)),t}function FV(r,e){const t=[ze(r.chainId,"chainId"),ze(r.nonce,"nonce"),ze(r.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),ze(r.maxFeePerGas||0,"maxFeePerGas"),ze(r.gasLimit,"gasLimit"),r.to||"0x",ze(r.value,"value"),r.data,rm(r.accessList||[])];return e&&(t.push(ze(e.yParity,"yParity")),t.push(hr(e.r)),t.push(hr(e.s))),Pt(["0x02",$o(t)])}function jV(r){const e=Cf(Ue(r).slice(1));R(Array.isArray(e)&&(e.length===8||e.length===11),"invalid field count for transaction type: 1","data",re(r));const t={type:1,chainId:ct(e[0],"chainId"),nonce:Ac(e[1],"nonce"),gasPrice:ct(e[2],"gasPrice"),gasLimit:ct(e[3],"gasLimit"),to:Vu(e[4]),value:ct(e[5],"value"),data:re(e[6]),accessList:tm(e[7],"accessList")};return e.length===8||nm(t,e.slice(8)),t}function HV(r,e){const t=[ze(r.chainId,"chainId"),ze(r.nonce,"nonce"),ze(r.gasPrice||0,"gasPrice"),ze(r.gasLimit,"gasLimit"),r.to||"0x",ze(r.value,"value"),r.data,rm(r.accessList||[])];return e&&(t.push(ze(e.yParity,"recoveryParam")),t.push(hr(e.r)),t.push(hr(e.s))),Pt(["0x01",$o(t)])}function zV(r){let e=Cf(Ue(r).slice(1)),t="3",n=null;if(e.length===4&&Array.isArray(e[0])){t="3 (network format)";const i=e[1],o=e[2],a=e[3];R(Array.isArray(i),"invalid network format: blobs not an array","fields[1]",i),R(Array.isArray(o),"invalid network format: commitments not an array","fields[2]",o),R(Array.isArray(a),"invalid network format: proofs not an array","fields[3]",a),R(i.length===o.length,"invalid network format: blobs/commitments length mismatch","fields",e),R(i.length===a.length,"invalid network format: blobs/proofs length mismatch","fields",e),n=[];for(let c=0;c<e[1].length;c++)n.push({data:i[c],commitment:o[c],proof:a[c]});e=e[0]}R(Array.isArray(e)&&(e.length===11||e.length===14),`invalid field count for transaction type: ${t}`,"data",re(r));const s={type:3,chainId:ct(e[0],"chainId"),nonce:Ac(e[1],"nonce"),maxPriorityFeePerGas:ct(e[2],"maxPriorityFeePerGas"),maxFeePerGas:ct(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:ct(e[4],"gasLimit"),to:Vu(e[5]),value:ct(e[6],"value"),data:re(e[7]),accessList:tm(e[8],"accessList"),maxFeePerBlobGas:ct(e[9],"maxFeePerBlobGas"),blobVersionedHashes:e[10]};n&&(s.blobs=n),R(s.to!=null,`invalid address for transaction type: ${t}`,"data",r),R(Array.isArray(s.blobVersionedHashes),"invalid blobVersionedHashes: must be an array","data",r);for(let i=0;i<s.blobVersionedHashes.length;i++)R(pt(s.blobVersionedHashes[i],32),`invalid blobVersionedHash at index ${i}: must be length 32`,"data",r);return e.length===11||nm(s,e.slice(11)),s}function qV(r,e,t){const n=[ze(r.chainId,"chainId"),ze(r.nonce,"nonce"),ze(r.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),ze(r.maxFeePerGas||0,"maxFeePerGas"),ze(r.gasLimit,"gasLimit"),r.to||Ud,ze(r.value,"value"),r.data,rm(r.accessList||[]),ze(r.maxFeePerBlobGas||0,"maxFeePerBlobGas"),BV(r.blobVersionedHashes||[],"blobVersionedHashes")];return e&&(n.push(ze(e.yParity,"yParity")),n.push(hr(e.r)),n.push(hr(e.s)),t)?Pt(["0x03",$o([n,t.map(s=>s.data),t.map(s=>s.commitment),t.map(s=>s.proof)])]):Pt(["0x03",$o(n)])}function VV(r){const e=Cf(Ue(r).slice(1));R(Array.isArray(e)&&(e.length===10||e.length===13),"invalid field count for transaction type: 4","data",re(r));const t={type:4,chainId:ct(e[0],"chainId"),nonce:Ac(e[1],"nonce"),maxPriorityFeePerGas:ct(e[2],"maxPriorityFeePerGas"),maxFeePerGas:ct(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:ct(e[4],"gasLimit"),to:Vu(e[5]),value:ct(e[6],"value"),data:re(e[7]),accessList:tm(e[8],"accessList"),authorizationList:kV(e[9],"authorizationList")};return e.length===10||nm(t,e.slice(10)),t}function WV(r,e){const t=[ze(r.chainId,"chainId"),ze(r.nonce,"nonce"),ze(r.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),ze(r.maxFeePerGas||0,"maxFeePerGas"),ze(r.gasLimit,"gasLimit"),r.to||"0x",ze(r.value,"value"),r.data,rm(r.accessList||[]),UV(r.authorizationList||[])];return e&&(t.push(ze(e.yParity,"yParity")),t.push(hr(e.r)),t.push(hr(e.s))),Pt(["0x04",$o(t)])}var rs,Dl,kl,Ul,Bl,Ll,$l,Ml,Fl,jl,Hl,zl,Da,ho,Ts,fo,ql,Vl,Ip;const Ss=class Ss{constructor(){F(this,Vl);F(this,rs);F(this,Dl);F(this,kl);F(this,Ul);F(this,Bl);F(this,Ll);F(this,$l);F(this,Ml);F(this,Fl);F(this,jl);F(this,Hl);F(this,zl);F(this,Da);F(this,ho);F(this,Ts);F(this,fo);F(this,ql);_(this,rs,null),_(this,Dl,null),_(this,Ul,0),_(this,Bl,Yt),_(this,Ll,null),_(this,$l,null),_(this,Ml,null),_(this,kl,"0x"),_(this,Fl,Yt),_(this,jl,Yt),_(this,Hl,null),_(this,zl,null),_(this,Da,null),_(this,ho,null),_(this,Ts,null),_(this,fo,null),_(this,ql,null)}get type(){return y(this,rs)}set type(e){switch(e){case null:_(this,rs,null);break;case 0:case"legacy":_(this,rs,0);break;case 1:case"berlin":case"eip-2930":_(this,rs,1);break;case 2:case"london":case"eip-1559":_(this,rs,2);break;case 3:case"cancun":case"eip-4844":_(this,rs,3);break;case 4:case"pectra":case"eip-7702":_(this,rs,4);break;default:R(!1,"unsupported transaction type","type",e)}}get typeName(){switch(this.type){case 0:return"legacy";case 1:return"eip-2930";case 2:return"eip-1559";case 3:return"eip-4844";case 4:return"eip-7702"}return null}get to(){const e=y(this,Dl);return e==null&&this.type===3?Ud:e}set to(e){_(this,Dl,e==null?null:nt(e))}get nonce(){return y(this,Ul)}set nonce(e){_(this,Ul,Pe(e,"value"))}get gasLimit(){return y(this,Bl)}set gasLimit(e){_(this,Bl,de(e))}get gasPrice(){const e=y(this,Ll);return e==null&&(this.type===0||this.type===1)?Yt:e}set gasPrice(e){_(this,Ll,e==null?null:de(e,"gasPrice"))}get maxPriorityFeePerGas(){const e=y(this,$l);return e??(this.type===2||this.type===3?Yt:null)}set maxPriorityFeePerGas(e){_(this,$l,e==null?null:de(e,"maxPriorityFeePerGas"))}get maxFeePerGas(){const e=y(this,Ml);return e??(this.type===2||this.type===3?Yt:null)}set maxFeePerGas(e){_(this,Ml,e==null?null:de(e,"maxFeePerGas"))}get data(){return y(this,kl)}set data(e){_(this,kl,re(e))}get value(){return y(this,Fl)}set value(e){_(this,Fl,de(e,"value"))}get chainId(){return y(this,jl)}set chainId(e){_(this,jl,de(e))}get signature(){return y(this,Hl)||null}set signature(e){_(this,Hl,e==null?null:Yr.from(e))}get accessList(){const e=y(this,zl)||null;return e??(this.type===1||this.type===2||this.type===3?[]:null)}set accessList(e){_(this,zl,e==null?null:vc(e))}get authorizationList(){const e=y(this,ql)||null;return e==null&&this.type===4?[]:e}set authorizationList(e){_(this,ql,e==null?null:e.map(t=>zS(t)))}get maxFeePerBlobGas(){const e=y(this,Da);return e==null&&this.type===3?Yt:e}set maxFeePerBlobGas(e){_(this,Da,e==null?null:de(e,"maxFeePerBlobGas"))}get blobVersionedHashes(){let e=y(this,ho);return e==null&&this.type===3?[]:e}set blobVersionedHashes(e){if(e!=null){R(Array.isArray(e),"blobVersionedHashes must be an Array","value",e),e=e.slice();for(let t=0;t<e.length;t++)R(pt(e[t],32),"invalid blobVersionedHash",`value[${t}]`,e[t])}_(this,ho,e)}get blobs(){return y(this,fo)==null?null:y(this,fo).map(e=>Object.assign({},e))}set blobs(e){if(e==null){_(this,fo,null);return}const t=[],n=[];for(let s=0;s<e.length;s++){const i=e[s];if(n0(i)){q(y(this,Ts),"adding a raw blob requires a KZG library","UNSUPPORTED_OPERATION",{operation:"set blobs()"});let o=Ue(i);if(R(o.length<=Iy,"blob is too large",`blobs[${s}]`,i),o.length!==Iy){const l=new Uint8Array(Iy);l.set(o),o=l}const a=y(this,Ts).blobToKzgCommitment(o),c=re(y(this,Ts).computeBlobKzgProof(o,a));t.push({data:re(o),commitment:re(a),proof:c}),n.push(z1(1,a))}else{const o=re(i.commitment);t.push({data:re(i.data),commitment:o,proof:re(i.proof)}),n.push(z1(1,o))}}_(this,fo,t),_(this,ho,n)}get kzg(){return y(this,Ts)}set kzg(e){e==null?_(this,Ts,null):_(this,Ts,DV(e))}get hash(){return this.signature==null?null:Ft(W(this,Vl,Ip).call(this,!0,!1))}get unsignedHash(){return Ft(this.unsignedSerialized)}get from(){return this.signature==null?null:SV(this.unsignedHash,this.signature)}get fromPublicKey(){return this.signature==null?null:Bd.recoverPublicKey(this.unsignedHash,this.signature)}isSigned(){return this.signature!=null}get serialized(){return W(this,Vl,Ip).call(this,!0,!0)}get unsignedSerialized(){return W(this,Vl,Ip).call(this,!1,!1)}inferType(){const e=this.inferTypes();return e.indexOf(2)>=0?2:e.pop()}inferTypes(){const e=this.gasPrice!=null,t=this.maxFeePerGas!=null||this.maxPriorityFeePerGas!=null,n=this.accessList!=null,s=y(this,Da)!=null||y(this,ho);this.maxFeePerGas!=null&&this.maxPriorityFeePerGas!=null&&q(this.maxFeePerGas>=this.maxPriorityFeePerGas,"priorityFee cannot be more than maxFee","BAD_DATA",{value:this}),q(!t||this.type!==0&&this.type!==1,"transaction type cannot have maxFeePerGas or maxPriorityFeePerGas","BAD_DATA",{value:this}),q(this.type!==0||!n,"legacy transaction cannot have accessList","BAD_DATA",{value:this});const i=[];return this.type!=null?i.push(this.type):this.authorizationList&&this.authorizationList.length?i.push(4):t?i.push(2):e?(i.push(1),n||i.push(0)):n?(i.push(1),i.push(2)):(s&&this.to||(i.push(0),i.push(1),i.push(2)),i.push(3)),i.sort(),i}isLegacy(){return this.type===0}isBerlin(){return this.type===1}isLondon(){return this.type===2}isCancun(){return this.type===3}clone(){return Ss.from(this)}toJSON(){const e=t=>t==null?null:t.toString();return{type:this.type,to:this.to,data:this.data,nonce:this.nonce,gasLimit:e(this.gasLimit),gasPrice:e(this.gasPrice),maxPriorityFeePerGas:e(this.maxPriorityFeePerGas),maxFeePerGas:e(this.maxFeePerGas),value:e(this.value),chainId:e(this.chainId),sig:this.signature?this.signature.toJSON():null,accessList:this.accessList}}static from(e){if(e==null)return new Ss;if(typeof e=="string"){const n=Ue(e);if(n[0]>=127)return Ss.from(LV(n));switch(n[0]){case 1:return Ss.from(jV(n));case 2:return Ss.from(MV(n));case 3:return Ss.from(zV(n));case 4:return Ss.from(VV(n))}q(!1,"unsupported transaction type","UNSUPPORTED_OPERATION",{operation:"from"})}const t=new Ss;return e.type!=null&&(t.type=e.type),e.to!=null&&(t.to=e.to),e.nonce!=null&&(t.nonce=e.nonce),e.gasLimit!=null&&(t.gasLimit=e.gasLimit),e.gasPrice!=null&&(t.gasPrice=e.gasPrice),e.maxPriorityFeePerGas!=null&&(t.maxPriorityFeePerGas=e.maxPriorityFeePerGas),e.maxFeePerGas!=null&&(t.maxFeePerGas=e.maxFeePerGas),e.maxFeePerBlobGas!=null&&(t.maxFeePerBlobGas=e.maxFeePerBlobGas),e.data!=null&&(t.data=e.data),e.value!=null&&(t.value=e.value),e.chainId!=null&&(t.chainId=e.chainId),e.signature!=null&&(t.signature=Yr.from(e.signature)),e.accessList!=null&&(t.accessList=e.accessList),e.authorizationList!=null&&(t.authorizationList=e.authorizationList),e.blobVersionedHashes!=null&&(t.blobVersionedHashes=e.blobVersionedHashes),e.kzg!=null&&(t.kzg=e.kzg),e.blobs!=null&&(t.blobs=e.blobs),e.hash!=null&&(R(t.isSigned(),"unsigned transaction cannot define '.hash'","tx",e),R(t.hash===e.hash,"hash mismatch","tx",e)),e.from!=null&&(R(t.isSigned(),"unsigned transaction cannot define '.from'","tx",e),R(t.from.toLowerCase()===(e.from||"").toLowerCase(),"from mismatch","tx",e)),t}};rs=new WeakMap,Dl=new WeakMap,kl=new WeakMap,Ul=new WeakMap,Bl=new WeakMap,Ll=new WeakMap,$l=new WeakMap,Ml=new WeakMap,Fl=new WeakMap,jl=new WeakMap,Hl=new WeakMap,zl=new WeakMap,Da=new WeakMap,ho=new WeakMap,Ts=new WeakMap,fo=new WeakMap,ql=new WeakMap,Vl=new WeakSet,Ip=function(e,t){q(!e||this.signature!=null,"cannot serialize unsigned transaction; maybe you meant .unsignedSerialized","UNSUPPORTED_OPERATION",{operation:".serialized"});const n=e?this.signature:null;switch(this.inferType()){case 0:return $V(this,n);case 1:return HV(this,n);case 2:return FV(this,n);case 3:return qV(this,n,t?this.blobs:null);case 4:return WV(this,n)}q(!1,"unsupported transaction type","UNSUPPORTED_OPERATION",{operation:".serialized"})};let ag=Ss;function cc(r){return Ft(Ws(r))}var GV="AEEUdwmgDS8BxQKKAP4BOgDjATAAngDUAIMAoABoAOAAagCOAEQAhABMAHIAOwA9ACsANgAmAGIAHgAuACgAJwAXAC0AGgAjAB8ALwAUACkAEgAeAAkAGwARABkAFgA5ACgALQArADcAFQApABAAHgAiABAAGgAeABMAGAUhBe8BFxREN8sF2wC5AK5HAW8ArQkDzQCuhzc3NzcBP68NEfMABQdHBuw5BV8FYAA9MzkI9r4ZBg7QyQAWA9CeOwLNCjcCjqkChuA/lm+RAsXTAoP6ASfnEQDytQFJAjWVCkeXAOsA6godAB/cwdAUE0WlBCN/AQUCQRjFD/MRBjHxDQSJbw0jBzUAswBxme+tnIcAYwabAysG8QAjAEMMmxcDqgPKQyDXCMMxA7kUQwD3NXOrAKmFIAAfBC0D3x4BJQDBGdUFAhEgVD8JnwmQJiNWYUzrg0oAGwAUAB0AFnNcACkAFgBP9h3gPfsDOWDKneY2ChglX1UDYD30ABsAFAAdABZzIGRAnwDD8wAjAEEMzRbDqgMB2sAFYwXqAtCnAsS4AwpUJKRtFHsadUz9AMMVbwLpABM1NJEX0ZkCgYMBEyMAxRVvAukAEzUBUFAtmUwSAy4DBTER33EftQHfSwB5MxJ/AjkWKQLzL8E/cwBB6QH9LQDPDtO9ASNriQC5DQANAwCK21EFI91zHwCoL9kBqQcHBwcHKzUDowBvAQohPvU3fAQgHwCyAc8CKQMA5zMSezr7ULgFmDp/LzVQBgEGAi8FYQVgt8AFcTtlQhpCWEmfe5tmZ6IAExsDzQ8t+X8rBKtTAltbAn0jsy8Bl6utPWMDTR8Ei2kRANkDBrNHNysDBzECQWUAcwFpJ3kAiyUhAJ0BUb8AL3EfAbfNAz81KUsFWwF3YQZtAm0A+VEfAzEJDQBRSQCzAQBlAHsAM70GD/v3IZWHBwARKQAxALsjTwHZAeMPEzmXgIHwABIAGQA8AEUAQDt3gdvIEGcQZAkGTRFMdEIVEwK0D64L7REdDNkq09PgADSxB/MDWwfzA1sDWwfzB/MDWwfzA1sDWwNbA1scEvAi28gQZw9QBHUFlgWTBN4IiyZREYkHMAjaVBV0JhxPA00BBCMtSSQ7mzMTJUpMFE0LCAQ2SmyvfUADTzGzVP2QqgPTMlc5dAkGHnkSqAAyD3skNb1OhnpPcagKU0+2tYdJak5vAsY6sEAACikJm2/Dd1YGRRAfJ6kQ+ww3AbkBPw3xS9wE9QY/BM0fgRkdD9GVoAipLeEM8SbnLqWAXiP5KocF8Uv4POELUVFsD10LaQnnOmeBUgMlAREijwrhDT0IcRD3Cs1vDekRSQc9A9lJngCpBwULFR05FbkmFGKwCw05ewb/GvoLkyazEy17AAXXGiUGUQEtGwMA0y7rhbRaNVwgT2MGBwspI8sUrFAkDSlAu3hMGh8HGSWtApVDdEqLUToelyH6PEENai4XUYAH+TwJGVMLhTyiRq9FEhHWPpE9TCJNTDAEOYMsMyePCdMPiQy9fHYBXQklCbUMdRM1ERs3yQg9Bx0xlygnGQglRplgngT7owP3E9UDDwVDCUUHFwO5HDETMhUtBRGBKNsC9zbZLrcCk1aEARsFzw8pH+MQVEfkDu0InwJpA4cl7wAxFSUAGyKfCEdnAGOP3FMJLs8Iy2pwI3gDaxTrZRF3B5UOWwerHDcVwxzlcMxeD4YMKKezCV8BeQmdAWME5wgNNV+MpCBFZ1eLXBifIGVBQ14AAjUMaRWjRMGHfAKPD28SHwE5AXcHPQ0FAnsR8RFvEJkI74YINbkz/DopBFMhhyAVCisDU2zSCysm/Qz8bQGnEmYDEDRBd/Jnr2C6KBgBBx0yyUFkIfULlk/RDKAaxRhGVDIZ6AfDA/ca9yfuQVsGAwOnBxc6UTPyBMELbQiPCUMATQ6nGwfbGG4KdYzUATWPAbudA1uVhwJzkwY7Bw8Aaw+LBX3pACECqwinAAkA0wNbAD0CsQehAB0AiUUBQQMrMwEl6QKTA5cINc8BmTMB9y0EH8cMGQD7O25OAsO1AoBuZqYF4VwCkgJNOQFRKQQJUktVA7N15QDfAE8GF+NLARmvTs8e50cB43MvAMsA/wAJOQcJRQHRAfdxALsBYws1Caa3uQFR7S0AhwAZbwHbAo0A4QA5AIP1AVcAUQVd/QXXAlNNARU1HC9bZQG/AyMBNwERAH0Gz5GpzQsjBHEH1wIQHxXlAu8yB7kFAyLjE9FCyQK94lkAMhoKPAqrCqpgX2Q3CjV2PVQAEh+sPss/UgVVO1c7XDtXO1w7VztcO1c7XDtXO1wDm8Pmw+YKcF9JYe8Mqg3YRMw6TRPfYFVgNhPMLbsUxRXSJVoZQRrAJwkl6FUNDwgt12Y0CDA0eRfAAEMpbINFY4oeNApPHOtTlVT8LR8AtUumM7MNsBsZREQFS3XxYi4WEgomAmSFAmJGX1GzAV83JAKh+wJonAJmDQKfiDgfDwJmPwJmKgRyBIMDfxcDfpY5Cjl7GzmGOicnAmwhAjI6OA4CbcsCbbLzjgM3a0kvAWsA4gDlAE4JB5wMkQECD8YAEbkCdzMCdqZDAnlPRwJ4viFg30WyRvcCfEMCeswCfQ0CfPRIBEiBZygALxlJXEpfGRtK0ALRBQLQ0EsrA4hTA4fqRMmRNgLypV0HAwOyS9JMMSkH001QTbMCi0MCitzFHwshR2sJuwKOOwKOYESbhQKO3QKOYHxRuFM5AQ5S2FSJApP/ApMQAO0AIFUiVbNV1AosHymZijLleGpFPz0Cl6MC77ZYJawAXSkClpMCloCgAK1ZsFoNhVEAPwKWuQKWUlxIXNUCmc8CmWhczl0LHQKcnznGOqECnBoCn58CnryOACETNS4TAp31Ap6WALlBYThh8wKe1wKgcgGtAp6jIwKeUqljzGQrKS8CJ7MCJoICoP8CoFDbAqYzAqXSAqgDAIECp/ZogGi1AAdNaiBq1QKs5wKssgKtawKtBgJXIQJV4AKx5dsDH1JsmwKywRECsuwbbORtZ21MYwMl0QK2YD9DbpQDKUkCuGICuUsZArkue3A6cOUCvR0DLbYDMhUCvoxyBgMzdQK+HnMmc1MCw88CwwhzhnRPOUl05AM8qwEDPJ4DPcMCxYACxksCxhSNAshtVQLISALJUwLJMgJkoQLd1nh9ZXiyeSlL1AMYp2cGAmH4GfeVKHsPXpZevxUCz28Cz3AzT1fW9xejAMqxAs93AS3uA04Wfk8JAtwrAtuOAtJTA1JgA1NjAQUDVZCAjUMEzxrxZEl5A4LSg5EC2ssC2eKEFIRNp0ADhqkAMwNkEoZ1Xf0AWQLfaQLevHd7AuIz7RgB8zQrAfSfAfLWiwLr9wLpdH0DAur9AuroAP1LAb0C7o0C66CWrpcHAu5DA4XkmH1w5HGlAvMHAG0DjhqZlwL3FwORcgOSiwL3nAL53QL4apogmq+/O5siA52HAv7+AR8APZ8gAZ+3AwWRA6ZuA6bdANXJAwZuoYyiCQ0DDE0BEwEjB3EGZb1rCQC/BG/DFY8etxEAG3k9ACcDNxJRA42DAWcrJQCM8wAlAOanC6OVCLsGI6fJBgCvBRnDBvElRUYFFoAFcD9GSDNCKUK8X3kZX8QAls0FOgCQVCGbwTsuYDoZutcONxjOGJHJ/gVfBWAFXwVgBWsFYAVfBWAFXwVgBV8FYAVfBWBOHQjfjW8KCgoKbF7xMwTRA7kGN8PDAMMEr8MA70gxFroFTj5xPnhCR0K+X30/X/AAWBkzswCNBsxzzASm70aCRS4rDDMeLz49fnXfcsH5GcoscQFz13Y4HwVnBXLJycnACNdRYwgICAqEXoWTxgA7P4kACxbZBu21Kw0AjMsTAwkVAOVtJUUsJ1JCuULESUArXy9gPi9AKwnJRQYKTD9LPoA+iT54PnkCkULEUUpDX9NWV3JVEjQAc1w3A3IBE3YnX+g7QiMJb6MKaiszRCUuQrNCxDPMCcwEX9EWJzYREBEEBwIHKn6l33JCNVIfybPJtAltydPUCmhBZw/tEKsZAJOVJU1CLRuxbUHOQAo7P0s+eEJHHA8SJVRPdGM0NVrpvBoKhfUlM0JHHGUQUhEWO1xLSj8MO0ucNAqJIzVCRxv9EFsqKyA4OQgNj2nwZgp5ZNFgE2A1K3YHS2AhQQojJmC7DgpzGG1WYFUZCQYHZO9gHWCdYIVgu2BTYJlwFh8GvRbcXbG8YgtDHrMBwzPVyQonHQgkCyYBgQJ0Ajc4nVqIAwGSCsBPIgDsK3SWEtIVBa5N8gGjAo+kVwVIZwD/AEUSCDweX4ITrRQsJ8K3TwBXFDwEAB0TvzVcAtoTS20RIwDgVgZ9BBImYgA5AL4Coi8LFnezOkCnIQFjAY4KBAPh9RcGsgZSBsEAJctdsWIRu2kTkQstRw7DAcMBKgpPBGIGMDAwKCYnKTQaLg4AKRSVAFwCdl+YUZ0JdicFD3lPAdt1F9ZZKCGxuE3yBxkFVGcA/wBFEgiCBwAOLHQSjxOtQDg1z7deFRMAZ8QTAGtKb1ApIiPHADkAvgKiLy1DFtYCmBiDAlDDWNB0eo7fpaMO/aEVRRv0ATEQZBIODyMEAc8JQhCbDRgzFD4TAEMAu9YBCgCsAOkAm5I3ABwAYxvONnR+MhXJAxgKQyxL2+kkJhMbhQKDBMkSsvF0AD9BNQ6uQC7WqSQHwxEAEEIu1hkhAH2z4iQPwyJPHNWpdyYBRSpnJALzoBAEVPPsH20MxA0CCEQKRgAFyAtFAlMNwwjEDUQJRArELtapMg7DDZgJIw+TGukEIwvDFkMAqAtDEMMMBhioe+QAO3MMRAACrgnEBSPY9Q0FDnbSBoMAB8MSYxkSxAEJAPIJAAB8FWMOFtMc/HcXwxhDAC7DAvOowwAewwJdKDKHAAHDAALrFUQVwwAbwyvzpWMWv8wA/ABpAy++bcYDUKPD0KhDCwKmJ1MAAmMA5+UZwxAagwipBRL/eADfw6fDGOMCGsOjk3l6BwOpo4sAEsMOGxMAA5sAbcMOAAvDp0MJGkMDwgipnNIPAwfIqUMGAOGDAAPzABXDAAcDAAnDAGmTABrDAA7DChjDjnEWAwABYwAOcwAuUyYABsMAF8MIKQANUgC6wy4AA8MADqMq8wCyYgAcIwAB8wqpAAXOCx0V4wAHowBCwwEKAGnDAAuDAB3DAAjDCakABdIAbqcZ3QCZCCkABdIAAAFDAAfjAB2jCCkABqIACYMAGzMAbSMA5sOIAAhjAAhDABTDBAkpAAbSAOOTAAlDC6kOzPtnAAdDAG6kQFAATwAKwwwAA0MACbUDPwAHIwAZgwACE6cDAAojAApDAAoDp/MGwwAJIwADEwAQQwgAFEMAEXMAD5MADfMADcMAGRMOFiMAFUMAbqMWuwHDAMIAE0MLAGkzEgDhUwACQwAEWgAXgwUjAAbYABjDBSYBgzBaAEFNALcQBxUMegAwMngBrA0IZgJ0KxQHBREPd1N0ZzKRJwaIHAZqNT4DqQq8BwngAB4DAwt2AX56T1ocKQNXAh1GATQGC3tOxYNagkgAMQA5CQADAQEAWxLjAIOYNAEzAH7tFRk6TglSAF8NAAlYAQ+S1ACAQwQorQBiAN4dAJ1wPyeTANVzuQDX3AIeEMp9eyMgXiUAEdkBkJizKltbVVAaRMqRAAEAhyQ/SDEz6BmfVwB6ATEsOClKIRcDOF0E/832AFNt5AByAnkCRxGCOs94NjXdAwINGBonDBwPALW2AwICAgAAAAAAAAYDBQMDARrUAwAtAAAAAgEGBgYGBgYFBQUFBQUEBQYHCAkEBQUFBQQAAAICAAAAIgCNAJAAlT0A6gC7ANwApEQAwgCyAK0AqADuAKYA2gCjAOcBCAEDAMcAgQBiANIA1AEDAN4A8gCQAKkBMQDqAN8A3AsBCQ8yO9ra2tq8xuLT1tRJOB0BUgFcNU0BWgFpAWgBWwFMUUlLbhMBUxsNEAs6PhMOACcUKy0vMj5AQENDQ0RFFEYGJFdXV1dZWVhZL1pbXVxcI2NnZ2ZoZypsbnZ1eHh4eHh4enp6enp6enp6enp8fH18e2IARPIASQCaAHgAMgBm+ACOAFcAVwA3AnbvAIsABfj4AGQAk/IAnwBPAGIAZP//sACFAIUAaQBWALEAJAC2AIMCQAJDAPwA5wD+AP4A6AD/AOkA6QDoAOYALwJ7AVEBQAE+AVQBPgE+AT4BOQE4ATgBOAEcAVgXADEQCAEAUx8SHgsdHhYAjgCWAKYAUQBqIAIxAHYAbwCXAxUDJzIDIUlGTzEAkQJPAMcCVwKkAMAClgKWApYClgKWApYCiwKWApYClgKWApYClgKVApUCmAKgApcClgKWApQClAKUApQCkgKVAnUB1AKXAp8ClgKWApUeAIETBQD+DQOfAmECOh8BVBg9AuIZEjMbAU4/G1WZAXusRAFpYQEFA0FPAQYAmTEeIJdyADFoAHEANgCRA5zMk/C2jGINwjMWygIZCaXdfDILBCs5dAE7YnQBugDlhoiHhoiGiYqKhouOjIaNkI6Ij4qQipGGkoaThpSSlYaWhpeKmIaZhpqGm4aci52QnoqfhuIC4XTpAt90AIp0LHSoAIsAdHQEQwRABEIERQRDBEkERgRBBEcESQRIBEQERgRJAJ5udACrA490ALxuAQ10ANFZdHQA13QCFHQA/mJ0AP4BIQD+APwA/AD9APwDhGZ03ASMK23HAP4A/AD8AP0A/CR0dACRYnQA/gCRASEA/gCRAvQA/gCRA4RmdNwEjCttxyR0AP9idAEhAP4A/gD8APwA/QD8AP8A/AD8AP0A/AOEZnTcBIwrbcckdHQAkWJ0ASEA/gCRAP4AkQL0AP4AkQOEZnTcBIwrbcckdAJLAT50AlIBQXQCU8l0dAJfdHQDpgL0A6YDpgOnA6cDpwOnA4RmdNwEjCttxyR0dACRYnQBIQOmAJEDpgCRAvQDpgCRA4RmdNwEjCttxyR0BDh0AJEEOQCRDpU5dSgCADR03gV2CwArdAEFAM5iCnR0AF1iAAYcOgp0dACRCnQAXAEIwWZ0CnRmdHQAkWZ0CnRmdEXgAFF03gp0dEY0tlT2u3SOAQTwscwhjZZKrhYcBSfFp9XNbKiVDOD2b+cpe4/Z17mQnbtzzhaeQtE2GGj0IDNTjRUSyTxxw/RPHW/+vS7d1NfRt9z9QPZg4X7QFfhCnkvgNPIItOsC2eV6hPannZNHlZ9xrwZXIMOlu3jSoQSq78WEjwLjw1ELSlF1aBvfzwk5ZX7AUvQzjPQKbDuQ+sm4wNOp4A6AdVuRS0t1y/DZpg4R6m7FNjM9HgvW7Bi88zaMjOo6lM8wtBBdj8LP4ylv3zCXPhebMKJc066o9sF71oFW/8JXu86HJbwDID5lzw5GWLR/LhT0Qqnp2JQxNZNfcbLIzPy+YypqRm/lBmGmex+82+PisxUumSeJkALIT6rJezxMH+CTJmQtt5uwTVbL3ptmjDUQzlSIvWi8Tl7ng1NpuRn1Ng4n14Qc+3Iil7OwkvNWogLSPkn3pihIFytyIGmMhOe3n1tWsuMy9BdKyqF4Z3v2SgggTL9KVvMXPnCbRe+oOuFFP3HejBG/w9gvmfNYvg6JuWia2lcSSN1uIjBktzoIazOHPJZ7kKHPz8mRWVdW3lA8WGF9dQF6Bm673boov3BUWDU2JNcahR23GtfHKLOz/viZ+rYnZFaIznXO67CYEJ1fXuTRpZhYZkKe54xeoagkNGLs+NTZHE0rX45/XvQ2RGADX6vcAvdxIUBV27wxGm2zjZo4X3ILgAlrOFheuZ6wtsvaIj4yLY7qqawlliaIcrz2G+c3vscAnCkCuMzMmZvMfu9lLwTvfX+3cVSyPdN9ZwgDZhfjRgNJcLiJ67b9xx8JHswprbiE3v9UphotAPIgnXVIN5KmMc0piXhc6cChPnN+MRhG9adtdttQTTwSIpl8I4/j//d3sz1326qTBTpPRM/Hgh3kzqEXs8ZAk4ErQhNO8hzrQ0DLkWMA/N+91tn2MdOJnWC2FCZehkQrwzwbKOjhvZsbM95QoeL9skYyMf4srVPVJSgg7pOLUtr/n9eT99oe9nLtFRpjA9okV2Kj8h9k5HaC0oivRD8VyXkJ81tcd4fHNXPCfloIQasxsuO18/46dR2jgul/UIet2G0kRvnyONMKhHs6J26FEoqSqd+rfYjeEGwHWVDpX1fh1jBBcKGMqRepju9Y00mDVHC+Xdij/j44rKfvfjGinNs1jO/0F3jB83XCDINN/HB84axlP+3E/klktRo+vl3U/aiyMJbIodE1XSsDn6UAzIoMtUObY2+k/4gY/l+AkZJ5Sj2vQrkyLm3FoxjhDX+31UXBFf9XrAH31fFqoBmDEZvhvvpnZ87N+oZEu7U9O/nnk+QWj3x8uyoRbEnf+O5UMr9i0nHP38IF5AvzrBW8YWBUR0mIAzIvndQq9N3v/Jto3aPjPXUPl8ASdPPyAp7jENf8bk7VMM9ol9XGmlBmeDMuGqt+WzuL6CXAxXjIhCPM5vACchgMJ/8XBGLO/D1isVvGhwwHHr1DLaI5mn2Jr/b1pUD90uciDaS8cXNDzCWvNmT/PhQe5e8nTnnnkt8Ds/SIjibcum/fqDhKopxAY8AkSrPn+IGDEKOO+U3XOP6djFs2H5N9+orhOahiQk5KnEUWa+CzkVzhp8bMHRbg81qhjjXuIKbHjSLSIBKWqockGtKinY+z4/RdBUF6pcc3JmnlxVcNgrI4SEzKUZSwcD2QCyxzKve+gAmg6ZuSRkpPFa6mfThu7LJNu3H5K42uCpNvPAsoedolKV/LHe/eJ+BbaG5MG0NaSGVPRUmNFMFFSSpXEcXwbVh7UETOZZtoVNRGOIbbkig3McEtR68cG0RZAoJevWYo7Dg/lZ1CQzblWeUvVHmr8fY4Nqd9JJiH/zEX24mJviH60fAyFr0A3c4bC1j3yZU60VgJxXn8JgJXLUIsiBnmKmMYz+7yBQFBvqb2eYnuW59joZBf56/wXvWIR4R8wTmV80i1mZy+S4+BUES+hzjk0uXpC///z/IlqHZ1monzlXp8aCfhGKMti73FI1KbL1q6IKO4fuBuZ59gagjn5xU79muMpHXg6S+e+gDM/U9BKLHbl9l6o8czQKl4RUkJJiqftQG2i3BMg/TQlUYFkJDYBOOvAugYuzYSDnZbDDd/aSd9x0Oe6F+bJcHfl9+gp6L5/TgA+BdFFovbfCrQ40s5vMPw8866pNX8zyFGeFWdxIpPVp9Rg1UPOVFbFZrvaFq/YAzHQgqMWpahMYfqHpmwXfHL1/kpYmGuHFwT55mQu0dylfNuq2Oq0hTMCPwqfxnuBIPLXfci4Y1ANy+1CUipQxld/izVh16WyG2Q0CQQ9NqtAnx1HCHwDj7sYxOSB0wopZSnOzxQOcExmxrVTF2BkOthVpGfuhaGECfCJpJKpjnihY+xOT2QJxN61+9K6QSqtv2Shr82I3jgJrqBg0wELFZPjvHpvzTtaJnLK6Vb97Yn933koO/saN7fsjwNKzp4l2lJVx2orjCGzC/4ZL4zCver6aQYtC5sdoychuFE6ufOiog+VWi5UDkbmvmtah/3aArEBIi39s5ILUnlFLgilcGuz9CQshEY7fw2ouoILAYPVT/gyAIq3TFAIwVsl+ktkRz/qGfnCDGrm5gsl/l9QdvCWGsjPz3dU7XuqKfdUrr/6XIgjp4rey6AJBmCmUJMjITHVdFb5m1p+dLMCL8t55zD42cmftmLEJC0Da04YiRCVUBLLa8D071/N5UBNBXDh0LFsmhV/5B5ExOB4j3WVG/S3lfK5o+V6ELHvy6RR9n4ac+VsK4VE4yphPvV+kG9FegTBH4ZRXL2HytUHCduJazB/KykjfetYxOXTLws267aGOd+I+JhKP//+VnXmS90OD/jvLcVu0asyqcuYN1mSb6XTlCkqv1vigZPIYwNF/zpWcT1GR/6aEIRjkh0yhg4LXJfaGobYJTY4JI58KiAKgmmgAKWdl5nYCeLqavRJGQNuYuZtZFGx+IkI4w4NS2xwbetNMunOjBu/hmKCI/w7tfiiyUd//4rbTeWt4izBY8YvGIN6vyKYmP/8X8wHKCeN+WRcKM70+tXKNGyevU9H2Dg5BsljnTf8YbsJ1TmMs74Ce2XlHisleguhyeg44rQOHZuw/6HTkhnnurK2d62q6yS7210SsAIaR+jXMQA+svkrLpsUY+F30Uw89uOdGAR6vo4FIME0EfVVeHTu6eKicfhSqOeXJhbftcd08sWEnNUL1C9fnprTgd83IMut8onVUF0hvqzZfHduPjbjwEXIcoYmy+P6tcJZHmeOv6VrvEdkHDJecjHuHeWANe79VG662qTjA/HCvumVv3qL+LrOcpqGps2ZGwQdFJ7PU4iuyRlBrwfO+xnPyr47s2cXVbWzAyznDiBGjCM3ksxjjqM62GE9C8f5U38kB3VjtabKp/nRdvMESPGDG90bWRLAt1Qk5DyLuazRR1YzdC1c+hZXvAWV8xA72S4A8B67vjVhbba3MMop293FeEXpe7zItMWrJG/LOH9ByOXmYnNJfjmfuX9KbrpgLOba4nZ+fl8Gbdv/ihv+6wFGKHCYrVwmhFC0J3V2bn2tIB1wCc1CST3d3X2OyxhguXcs4sm679UngzofuSeBewMFJboIQHbUh/m2JhW2hG9DIvG2t7yZIzKBTz9wBtnNC+2pCRYhSIuQ1j8xsz5VvqnyUIthvuoyyu7fNIrg/KQUVmGQaqkqZk/Vx5b33/gsEs8yX7SC1J+NV4icz6bvIE7C5G6McBaI8rVg56q5QBJWxn/87Q1sPK4+sQa8fLU5gXo4paaq4cOcQ4wR0VBHPGjKh+UlPCbA1nLXyEUX45qZ8J7/Ln4FPJE2TdzD0Z8MLSNQiykMMmSyOCiFfy84Rq60emYB2vD09KjYwsoIpeDcBDTElBbXxND72yhd9pC/1CMid/5HUMvAL27OtcIJDzNKpRPNqPOpyt2aPGz9QWIs9hQ9LiX5s8m9hjTUu/f7MyIatjjd+tSfQ3ufZxPpmJhTaBtZtKLUcfOCUqADuO+QoH8B9v6U+P0HV1GLQmtoNFTb3s74ivZgjES0qfK+8RdGgBbcCMSy8eBvh98+et1KIFqSe1KQPyXULBMTsIYnysIwiZBJYdI20vseV+wuJkcqGemehKjaAb9L57xZm3g2zX0bZ2xk/fU+bCo7TlnbW7JuF1YdURo/2Gw7VclDG1W7LOtas2LX4upifZ/23rzpsnY/ALfRgrcWP5hYmV9VxVOQA1fZvp9F2UNU+7d7xRyVm5wiLp3/0dlV7vdw1PMiZrbDAYzIVqEjRY2YU03sJhPnlwIPcZUG5ltL6S8XCxU1eYS5cjr34veBmXAvy7yN4ZjArIG0dfD/5UpBNlX1ZPoxJOwyqRi3wQWtOzd4oNKh0LkoTm8cwqgIfKhqqGOhwo71I+zXnMemTv2B2AUzABWyFztGgGULjDDzWYwJUVBTjKCn5K2QGMK1CQT7SzziOjo+BhAmqBjzuc3xYym2eedGeOIRJVyTwDw37iCMe4g5Vbnsb5ZBdxOAnMT7HU4DHpxWGuQ7GeiY30Cpbvzss55+5Km1YsbD5ea3NI9QNYIXol5apgSu9dZ8f8xS5dtHpido5BclDuLWY4lhik0tbJa07yJhH0BOyEut/GRbYTS6RfiTYWGMCkNpfSHi7HvdiTglEVHKZXaVhezH4kkXiIvKopYAlPusftpE4a5IZwvw1x/eLvoDIh/zpo9FiQInsTb2SAkKHV42XYBjpJDg4374XiVb3ws4qM0s9eSQ5HzsMU4OZJKuopFjBM+dAZEl8RUMx5uU2N486Kr141tVsGQfGjORYMCJAMsxELeNT4RmWjRcpdTGBwcx6XN9drWqPmJzcrGrH4+DRc7+n1w3kPZwu0BkNr6hQrqgo7JTB9A5kdJ/H7P4cWBMwsmuixAzJB3yrQpnGIq90lxAXLzDCdn1LPibsRt7rHNjgQBklRgPZ8vTbjXdgXrTWQsK5MdrXXQVPp0Rinq3frzZKJ0qD6Qhc40VzAraUXlob1gvkhK3vpmHgI6FRlQZNx6eRqkp0zy4AQlX813fAPtL3jMRaitGFFjo0zmErloC+h+YYdVQ6k4F/epxAoF0BmqEoKNTt6j4vQZNQ2BoqF9Vj53TOIoNmDiu9Xp15RkIgQIGcoLpfoIbenzpGUAtqFJp5W+LLnx38jHeECTJ/navKY1NWfN0sY1T8/pB8kIH3DU3DX+u6W3YwpypBMYOhbSxGjq84RZ84fWJow8pyHqn4S/9J15EcCMsXqrfwyd9mhiu3+rEo9pPpoJkdZqHjra4NvzFwuThNKy6hao/SlLw3ZADUcUp3w3SRVfW2rhl80zOgTYnKE0Hs2qp1J6H3xqPqIkvUDRMFDYyRbsFI3M9MEyovPk8rlw7/0a81cDVLmBsR2ze2pBuKb23fbeZC0uXoIvDppfTwIDxk1Oq2dGesGc+oJXWJLGkOha3CX+DUnzgAp9HGH9RsPZN63Hn4RMA5eSVhPHO+9RcRb/IOgtW31V1Q5IPGtoxPjC+MEJbVlIMYADd9aHYWUIQKopuPOHmoqSkubnAKnzgKHqgIOfW5RdAgotN6BN+O2ZYHkuemLnvQ8U9THVrS1RtLmKbcC7PeeDsYznvqzeg6VCNwmr0Yyx1wnLjyT84BZz3EJyCptD3yeueAyDWIs0L2qs/VQ3HUyqfrja0V1LdDzqAikeWuV4sc7RLIB69jEIBjCkyZedoUHqCrOvShVzyd73OdrJW0hPOuQv2qOoHDc9xVb6Yu6uq3Xqp2ZaH46A7lzevbxQEmfrzvAYSJuZ4WDk1Hz3QX1LVdiUK0EvlAGAYlG3Md30r7dcPN63yqBCIj25prpvZP0nI4+EgWoFG95V596CurXpKRBGRjQlHCvy5Ib/iW8nZJWwrET3mgd6mEhfP4KCuaLjopWs7h+MdXFdIv8dHQJgg1xi1eYqB0uDYjxwVmri0Sv5XKut/onqapC+FQiC2C1lvYJ9MVco6yDYsS3AANUfMtvtbYI2hfwZatiSsnoUeMZd34GVjkMMKA+XnjJpXgRW2SHTZplVowPmJsvXy6w3cfO1AK2dvtZEKTkC/TY9LFiKHCG0DnrMQdGm2lzlBHM9iEYynH2UcVMhUEjsc0oDBTgo2ZSQ1gzkAHeWeBXYFjYLuuf8yzTCy7/RFR81WDjXMbq2BOH5dURnxo6oivmxL3cKzKInlZkD31nvpHB9Kk7GfcfE1t+1V64b9LtgeJGlpRFxQCAqWJ5DoY77ski8gsOEOr2uywZaoO/NGa0X0y1pNQHBi3b2SUGNpcZxDT7rLbBf1FSnQ8guxGW3W+36BW0gBje4DOz6Ba6SVk0xiKgt+q2JOFyr4SYfnu+Ic1QZYIuwHBrgzr6UvOcSCzPTOo7D6IC4ISeS7zkl4h+2VoeHpnG/uWR3+ysNgPcOIXQbv0n4mr3BwQcdKJxgPSeyuP/z1Jjg4e9nUvoXegqQVIE30EHx5GHv+FAVUNTowYDJgyFhf5IvlYmEqRif6+WN1MkEJmDcQITx9FX23a4mxy1AQRsOHO/+eImX9l8EMJI3oPWzVXxSOeHU1dUWYr2uAA7AMb+vAEZSbU3qob9ibCyXeypEMpZ6863o6QPqlqGHZkuWABSTVNd4cOh9hv3qEpSx2Zy/DJMP6cItEmiBJ5PFqQnDEIt3NrA3COlOSgz43D7gpNFNJ5MBh4oFzhDPiglC2ypsNU4ISywY2erkyb1NC3Qh/IfWj0eDgZI4/ln8WPfBsT3meTjq1Uqt1E7Zl/qftqkx6aM9KueMCekSnMrcHj1CqTWWzEzPsZGcDe3Ue4Ws+XFYVxNbOFF8ezkvQGR6ZOtOLU2lQEnMBStx47vE6Pb7AYMBRj2OOfZXfisjJnpTfSNjo6sZ6qSvNxZNmDeS7Gk3yYyCk1HtKN2UnhMIjOXUzAqDv90lx9O/q/AT1ZMnit5XQe9wmQxnE/WSH0CqZ9/2Hy+Sfmpeg8RwsHI5Z8kC8H293m/LHVVM/BA7HaTJYg5Enk7M/xWpq0192ACfBai2LA/qrCjCr6Dh1BIMzMXINBmX96MJ5Hn2nxln/RXPFhwHxUmSV0EV2V0jm86/dxxuYSU1W7sVkEbN9EzkG0QFwPhyHKyb3t+Fj5WoUUTErcazE/N6EW6Lvp0d//SDPj7EV9UdJN+Amnf3Wwk3A0SlJ9Z00yvXZ7n3z70G47Hfsow8Wq1JXcfwnA+Yxa5mFsgV464KKP4T31wqIgzFPd3eCe3j5ory5fBF2hgCFyVFrLzI9eetNXvM7oQqyFgDo4CTp/hDV9NMX9JDHQ/nyHTLvZLNLF6ftn2OxjGm8+PqOwhxnPHWipkE/8wbtyri80Sr7pMNkQGMfo4ZYK9OcCC4ESVFFbLMIvlxSoRqWie0wxqnLfcLSXMSpMMQEJYDVObYsXIQNv4TGNwjq1kvT1UOkicTrG3IaBZ3XdScS3u8sgeZPVpOLkbiF940FjbCeNRINNvDbd01EPBrTCPpm12m43ze1bBB59Ia6Ovhnur/Nvx3IxwSWol+3H2qfCJR8df6aQf4v6WiONxkK+IqT4pKQrZK/LplgDI/PJZbOep8dtbV7oCr6CgfpWa8NczOkPx81iSHbsNhVSJBOtrLIMrL31LK9TqHqAbAHe0RLmmV806kRLDLNEhUEJfm9u0sxpkL93Zgd6rw+tqBfTMi59xqXHLXSHwSbSBl0EK0+loECOPtrl+/nsaFe197di4yUgoe4jKoAJDXc6DGDjrQOoFDWZJ9HXwt8xDrQP+7aRwWKWI1GF8s8O4KzxWBBcwnl3vnl1Oez3oh6Ea1vjR7/z7DDTrFtqU2W/KAEzAuXDNZ7MY73MF216dzdSbWmUp4lcm7keJfWaMHgut9x5C9mj66Z0lJ+yhsjVvyiWrfk1lzPOTdhG15Y7gQlXtacvI7qv/XNSscDwqkgwHT/gUsD5yB7LdRRvJxQGYINn9hTpodKFVSTPrtGvyQw+HlRFXIkodErAGu9Iy1YpfSPc3jkFh5CX3lPxv7aqjE/JAfTIpEjGb/H7MO0e2vsViSW1qa/Lmi4/n4DEI3g7lYrcanspDfEpKkdV1OjSLOy0BCUqVoECaB55vs06rXl4jqmLsPsFM/7vYJ0vrBhDCm/00A/H81l1uekJ/6Lml3Hb9+NKiLqATJmDpyzfYZFHumEjC662L0Bwkxi7E9U4cQA0XMVDuMYAIeLMPgQaMVOd8fmt5SflFIfuBoszeAw7ow5gXPE2Y/yBc/7jExARUf/BxIHQBF5Sn3i61w4z5xJdCyO1F1X3+3ax+JSvMeZ7S6QSKp1Fp/sjYz6Z+VgCZzibGeEoujryfMulH7Rai5kAft9ebcW50DyJr2uo2z97mTWIu45YsSnNSMrrNUuG1XsYBtD9TDYzQffKB87vWbkM4EbPAFgoBV4GQS+vtFDUqOFAoi1nTtmIOvg38N4hT2Sn8r8clmBCXspBlMBYTnrqFJGBT3wZOzAyJDre9dHH7+x7qaaKDOB4UQALD5ecS0DE4obubQEiuJZ0EpBVpLuYcce8Aa4PYd/V4DLDAJBYKQPCWTcrEaZ5HYbJi11Gd6hjGom1ii18VHYnG28NKpkz2UKVPxlhYSp8uZr367iOmoy7zsxehW9wzcy2zG0a80PBMCRQMb32hnaHeOR8fnNDzZhaNYhkOdDsBUZ3loDMa1YP0uS0cjUP3b/6DBlqmZOeNABDsLl5BI5QJups8uxAuWJdkUB/pO6Zax6tsg7fN5mjjDgMGngO+DPcKqiHIDbFIGudxtPTIyDi9SFMKBDcfdGQRv41q1AqmxgkVfJMnP8w/Bc7N9/TR6C7mGObFqFkIEom8sKi2xYqJLTCHK7cxzaZvqODo22c3wisBCP4HeAgcRbNPAsBkNRhSmD48dHupdBRw4mIvtS5oeF6zeT1KMCyhMnmhpkFAGWnGscoNkwvQ8ZM5lE/vgTHFYL99OuNxdFBxTEDd5v2qLR8y9WkXsWgG6kZNndFG+pO/UAkOCipqIhL3hq7cRSdrCq7YhUsTocEcnaFa6nVkhnSeRYUA1YO0z5itF9Sly3VlxYDw239TJJH6f3EUfYO5lb7bcFcz8Bp7Oo8QmnsUHOz/fagVUBtKEw1iT88j+aKkv8cscKNkMxjYr8344D1kFoZ7/td1W6LCNYN594301tUGRmFjAzeRg5vyoM1F6+bJZ/Q54jN/k8SFd3DxPTYaAUsivsBfgTn7Mx8H2SpPt4GOdYRnEJOH6jHM2p6SgB0gzIRq6fHxGMmSmqaPCmlfwxiuloaVIitLGN8wie2CDWhkzLoCJcODh7KIOAqbHEvXdUxaS4TTTs07Clzj/6GmVs9kiZDerMxEnhUB6QQPlcfqkG9882RqHoLiHGBoHfQuXIsAG8GTAtao2KVwRnvvam8jo1e312GQAKWEa4sUVEAMG4G6ckcONDwRcg1e2D3+ohXgY4UAWF8wHKQMrSnzCgfFpsxh+aHXMGtPQroQasRY4U6UdG0rz1Vjbka0MekOGRZQEvqQFlxseFor8zWFgHek3v29+WqN6gaK5gZOTOMZzpQIC1201LkMCXild3vWXSc5UX9xcFYfbRPzGFa1FDcPfPB/jUEq/FeGt419CI3YmBlVoHsa4KdcwQP5ZSwHHhFJ7/Ph/Rap/4vmG91eDwPP0lDfCDRCLszTqfzM71xpmiKi2HwS4WlqvGNwtvwF5Dqpn6KTq8ax00UMPkxDcZrEEEsIvHiUXXEphdb4GB4FymlPwBz4Gperqq5pW7TQ6/yNRhW8VT5NhuP0udlxo4gILq5ZxAZk8ZGh3g4CqxJlPKY7AQxupfUcVpWT5VItp1+30UqoyP4wWsRo3olRRgkWZZ2ZN6VC3OZFeXB8NbnUrSdikNptD1QiGuKkr8EmSR/AK9Rw+FF3s5uwuPbvHGiPeFOViltMK7AUaOsq9+x9cndk3iJEE5LKZRlWJbKOZweROzmPNVPkjE3K/TyA57Rs68TkZ3MR8akKpm7cFjnjPd/DdkWjgYoKHSr5Wu5ssoBYU4acRs5g2DHxUmdq8VXOXRbunD8QN0LhgkssgahcdoYsNvuXGUK/KXD/7oFb+VGdhqIn02veuM5bLudJOc2Ky0GMaG4W/xWBxIJcL7yliJOXOpx0AkBqUgzlDczmLT4iILXDxxtRR1oZa2JWFgiAb43obrJnG/TZC2KSK2wqOzRZTXavZZFMb1f3bXvVaNaK828w9TO610gk8JNf3gMfETzXXsbcvRGCG9JWQZ6+cDPqc4466Yo2RcKH+PILeKOqtnlbInR3MmBeGG3FH10yzkybuqEC2HSQwpA0An7d9+73BkDUTm30bZmoP/RGbgFN+GrCOfADgqr0WbI1a1okpFms8iHYw9hm0zUvlEMivBRxModrbJJ+9/p3jUdQQ9BCtQdxnOGrT5dzRUmw0593/mbRSdBg0nRvRZM5/E16m7ZHmDEtWhwvfdZCZ8J8M12W0yRMszXamWfQTwIZ4ayYktrnscQuWr8idp3PjT2eF/jmtdhIfcpMnb+IfZY2FebW6UY/AK3jP4u3Tu4zE4qlnQgLFbM19EBIsNf7KhjdbqQ/D6yiDb+NlEi2SKD+ivXVUK8ib0oBo366gXkR8ZxGjpJIDcEgZPa9TcYe0TIbiPl/rPUQDu3XBJ9X/GNq3FAUsKsll57DzaGMrjcT+gctp+9MLYXCq+sqP81eVQ0r9lt+gcQfZbACRbEjvlMskztZG8gbC8Qn9tt26Q7y7nDrbZq/LEz7kR6Jc6pg3N9rVX8Y5MJrGlML9p9lU4jbTkKqCveeZUJjHB03m2KRKR2TytoFkTXOLg7keU1s1lrPMQJpoOKLuAAC+y1HlJucU6ysB5hsXhvSPPLq5J7JtnqHKZ4vYjC4Vy8153QY+6780xDuGARsGbOs1WqzH0QS765rnSKEbbKlkO8oI/VDwUd0is13tKpqILu1mDJFNy/iJAWcvDgjxvusIT+PGz3ST/J9r9Mtfd0jpaGeiLYIqXc7DiHSS8TcjFVksi66PEkxW1z6ujbLLUGNNYnzOWpH8BZGK4bCK7iR+MbIv8ncDAz1u4StN3vTTzewr9IQjk9wxFxn+6N1ddKs0vffJiS08N3a4G1SVrlZ97Q/M+8G9fe5AP6d9/Qq4WRnORVhofPIKEdCr3llspUfE0oKIIYoByBRPh+bX1HLS3JWGJRhIvE1aW4NTd8ePi4Z+kXb+Z8snYfSNcqijhAgVsx4RCM54cXUiYkjeBmmC4ajOHrChoELscJJC7+9jjMjw5BagZKlgRMiSNYz7h7vvZIoQqbtQmspc0cUk1G/73iXtSpROl5wtLgQi0mW2Ex8i3WULhcggx6E1LMVHUsdc9GHI1PH3U2Ko0PyGdn9KdVOLm7FPBui0i9a0HpA60MsewVE4z8CAt5d401Gv6zXlIT5Ybit1VIA0FCs7wtvYreru1fUyW3oLAZ/+aTnZrOcYRNVA8spoRtlRoWflsRClFcgzkqiHOrf0/SVw+EpVaFlJ0g4Kxq1MMOmiQdpMNpte8lMMQqm6cIFXlnGbfJllysKDi+0JJMotkqgIxOSQgU9dn/lWkeVf8nUm3iwX2Nl3WDw9i6AUK3vBAbZZrcJpDQ/N64AVwjT07Jef30GSSmtNu2WlW7YoyW2FlWfZFQUwk867EdLYKk9VG6JgEnBiBxkY7LMo4YLQJJlAo9l/oTvJkSARDF/XtyAzM8O2t3eT/iXa6wDN3WewNmQHdPfsxChU/KtLG2Mn8i4ZqKdSlIaBZadxJmRzVS/o4yA65RTSViq60oa395Lqw0pzY4SipwE0SXXsKV+GZraGSkr/RW08wPRvqvSUkYBMA9lPx4m24az+IHmCbXA+0faxTRE9wuGeO06DIXa6QlKJ3puIyiuAVfPr736vzo2pBirS+Vxel3TMm3JKhz9o2ZoRvaFVpIkykb0Hcm4oHFBMcNSNj7/4GJt43ogonY2Vg4nsDQIWxAcorpXACzgBqQPjYsE/VUpXpwNManEru4NwMCFPkXvMoqvoeLN3qyu/N1eWEHttMD65v19l/0kH2mR35iv/FI+yjoHJ9gPMz67af3Mq/BoWXqu3rphiWMXVkmnPSEkpGpUI2h1MThideGFEOK6YZHPwYzMBvpNC7+ZHxPb7epfefGyIB4JzO9DTNEYnDLVVHdQyvOEVefrk6Uv5kTQYVYWWdqrdcIl7yljwwIWdfQ/y+2QB3eR/qxYObuYyB4gTbo2in4PzarU1sO9nETkmj9/AoxDA+JM3GMqQtJR4jtduHtnoCLxd1gQUscHRB/MoRYIEsP2pDZ9KvHgtlk1iTbWWbHhohwFEYX7y51fUV2nuUmnoUcqnWIQAAgl9LTVX+Bc0QGNEhChxHR4YjfE51PUdGfsSFE6ck7BL3/hTf9jLq4G1IafINxOLKeAtO7quulYvH5YOBc+zX7CrMgWnW47/jfRsWnJjYYoE7xMfWV2HN2iyIqLI";const q1=new Map([[8217,"apostrophe"],[8260,"fraction slash"],[12539,"middle dot"]]),V1=4;function KV(r){let e=0;function t(){return r[e++]<<8|r[e++]}let n=t(),s=1,i=[0,1];for(let T=1;T<n;T++)i.push(s+=t());let o=t(),a=e;e+=o;let c=0,l=0;function u(){return c==0&&(l=l<<8|r[e++],c=8),l>>--c&1}const h=31,d=2**h,f=d>>>1,g=f>>1,p=d-1;let m=0;for(let T=0;T<h;T++)m=m<<1|u();let w=[],A=0,v=d;for(;;){let T=Math.floor(((m-A+1)*s-1)/v),P=0,D=n;for(;D-P>1;){let j=P+D>>>1;T<i[j]?D=j:P=j}if(P==0)break;w.push(P);let U=A+Math.floor(v*i[P]/s),x=A+Math.floor(v*i[P+1]/s)-1;for(;!((U^x)&f);)m=m<<1&p|u(),U=U<<1&p,x=x<<1&p|1;for(;U&~x&g;)m=m&f|m<<1&p>>>1|u(),U=U<<1^f,x=(x^f)<<1|f|1;A=U,v=1+x-U}let N=n-4;return w.map(T=>{switch(T-N){case 3:return N+65792+(r[a++]<<16|r[a++]<<8|r[a++]);case 2:return N+256+(r[a++]<<8|r[a++]);case 1:return N+r[a++];default:return T-1}})}function JV(r){let e=0;return()=>r[e++]}function qS(r){return JV(KV(YV(r)))}function YV(r){let e=[];[..."ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"].forEach((s,i)=>e[s.charCodeAt(0)]=i);let t=r.length,n=new Uint8Array(6*t>>3);for(let s=0,i=0,o=0,a=0;s<t;s++)a=a<<6|e[r.charCodeAt(s)],o+=6,o>=8&&(n[i++]=a>>(o-=8));return n}function QV(r){return r&1?~r>>1:r>>1}function ZV(r,e){let t=Array(r);for(let n=0,s=0;n<r;n++)t[n]=s+=QV(e());return t}function Ld(r,e=0){let t=[];for(;;){let n=r(),s=r();if(!s)break;e+=n;for(let i=0;i<s;i++)t.push(e+i);e+=s+1}return t}function VS(r){return $d(()=>{let e=Ld(r);if(e.length)return e})}function WS(r){let e=[];for(;;){let t=r();if(t==0)break;e.push(XV(t,r))}for(;;){let t=r()-1;if(t<0)break;e.push(eW(t,r))}return e.flat()}function $d(r){let e=[];for(;;){let t=r(e.length);if(!t)break;e.push(t)}return e}function GS(r,e,t){let n=Array(r).fill().map(()=>[]);for(let s=0;s<e;s++)ZV(r,t).forEach((i,o)=>n[o].push(i));return n}function XV(r,e){let t=1+e(),n=e(),s=$d(e);return GS(s.length,1+r,e).flatMap((o,a)=>{let[c,...l]=o;return Array(s[a]).fill().map((u,h)=>{let d=h*n;return[c+h*t,l.map(f=>f+d)]})})}function eW(r,e){let t=1+e();return GS(t,1+r,e).map(s=>[s[0],s.slice(1)])}function tW(r){let e=[],t=Ld(r);return s(n([]),[]),e;function n(i){let o=r(),a=$d(()=>{let c=Ld(r).map(l=>t[l]);if(c.length)return n(c)});return{S:o,B:a,Q:i}}function s({S:i,B:o},a,c){if(!(i&4&&c===a[a.length-1])){i&2&&(c=a[a.length-1]),i&1&&e.push(a);for(let l of o)for(let u of l.Q)s(l,[...a,u],c)}}}function rW(r){return r.toString(16).toUpperCase().padStart(2,"0")}function KS(r){return`{${rW(r)}}`}function nW(r){let e=[];for(let t=0,n=r.length;t<n;){let s=r.codePointAt(t);t+=s<65536?1:2,e.push(s)}return e}function Ou(r){let t=r.length;if(t<4096)return String.fromCodePoint(...r);let n=[];for(let s=0;s<t;)n.push(String.fromCodePoint(...r.slice(s,s+=4096)));return n.join("")}function sW(r,e){let t=r.length,n=t-e.length;for(let s=0;n==0&&s<t;s++)n=r[s]-e[s];return n}var iW="AEUDTAHBCFQATQDRADAAcgAgADQAFAAsABQAHwAOACQADQARAAoAFwAHABIACAAPAAUACwAFAAwABAAQAAMABwAEAAoABQAIAAIACgABAAQAFAALAAIACwABAAIAAQAHAAMAAwAEAAsADAAMAAwACgANAA0AAwAKAAkABAAdAAYAZwDSAdsDJgC0CkMB8xhZAqfoC190UGcThgBurwf7PT09Pb09AjgJum8OjDllxHYUKXAPxzq6tABAxgK8ysUvWAgMPT09PT09PSs6LT2HcgWXWwFLoSMEEEl5RFVMKvO0XQ8ExDdJMnIgsj26PTQyy8FfEQ8AY8IPAGcEbwRwBHEEcgRzBHQEdQR2BHcEeAR6BHsEfAR+BIAEgfndBQoBYgULAWIFDAFiBNcE2ATZBRAFEQUvBdALFAsVDPcNBw13DYcOMA4xDjMB4BllHI0B2grbAMDpHLkQ7QHVAPRNQQFnGRUEg0yEB2uaJF8AJpIBpob5AERSMAKNoAXqaQLUBMCzEiACnwRZEkkVsS7tANAsBG0RuAQLEPABv9HICTUBXigPZwRBApMDOwAamhtaABqEAY8KvKx3LQ4ArAB8UhwEBAVSagD8AEFZADkBIadVj2UMUgx5Il4ANQC9AxIB1BlbEPMAs30CGxlXAhwZKQIECBc6EbsCoxngzv7UzRQA8M0BawL6ZwkN7wABAD33OQRcsgLJCjMCjqUChtw/km+NAsXPAoP2BT84PwURAK0RAvptb6cApQS/OMMey5HJS84UdxpxTPkCogVFITaTOwERAK5pAvkNBOVyA7q3BKlOJSALAgUIBRcEdASpBXqzABXFSWZOawLCOqw//AolCZdvv3dSBkEQGyelEPcMMwG1ATsN7UvYBPEGOwTJH30ZGQ/NlZwIpS3dDO0m4y6hgFoj9SqDBe1L9DzdC01RaA9ZC2UJ4zpjgU4DIQENIosK3Q05CG0Q8wrJaw3lEUUHOQPVSZoApQcBCxEdNRW1JhBirAsJOXcG+xr2C48mrxMpevwF0xohBk0BKRr/AM8u54WwWjFcHE9fBgMLJSPHFKhQIA0lQLd4SBobBxUlqQKRQ3BKh1E2HpMh9jw9DWYuE1F8B/U8BRlPC4E8nkarRQ4R0j6NPUgiSUwsBDV/LC8niwnPD4UMuXxyAVkJIQmxDHETMREXN8UIOQcZLZckJxUIIUaVYJoE958D8xPRAwsFPwlBBxMDtRwtEy4VKQUNgSTXAvM21S6zAo9WgAEXBcsPJR/fEFBH4A7pCJsCZQODJesALRUhABcimwhDYwBfj9hTBS7LCMdqbCN0A2cU52ERcweRDlcHpxwzFb8c4XDIXguGCCijrwlbAXUJmQFfBOMICTVbjKAgQWdTi1gYmyBhQT9d/AIxDGUVn0S9h3gCiw9rEhsBNQFzBzkNAQJ3Ee0RaxCVCOuGBDW1M/g6JQRPIYMgEQonA09szgsnJvkM+GkBoxJiAww0PXfuZ6tgtiQX/QcZMsVBYCHxC5JPzQycGsEYQlQuGeQHvwPzGvMn6kFXBf8DowMTOk0z7gS9C2kIiwk/AEkOoxcH1xhqCnGM0AExiwG3mQNXkYMCb48GNwcLAGcLhwV55QAdAqcIowAFAM8DVwA5Aq0HnQAZAIVBAT0DJy8BIeUCjwOTCDHLAZUvAfMpBBvDDBUA9zduSgLDsQKAamaiBd1YAo4CSTUBTSUEBU5HUQOvceEA2wBLBhPfRwEVq0rLGuNDAd9vKwDHAPsABTUHBUEBzQHzbQC3AV8LMQmis7UBTekpAIMAFWsB1wKJAN0ANQB/8QFTAE0FWfkF0wJPSQERMRgrV2EBuwMfATMBDQB5BsuNpckHHwRtB9MCEBsV4QLvLge1AQMi3xPNQsUCvd5VoWACZIECYkJbTa9bNyACofcCaJgCZgkCn4Q4GwsCZjsCZiYEbgR/A38TA36SOQY5dxc5gjojIwJsHQIyNjgKAm3HAm2u74ozZ0UrAWcA3gDhAEoFB5gMjQD+C8IADbUCdy8CdqI/AnlLQwJ4uh1c20WuRtcCfD8CesgCfQkCfPAFWQUgSABIfWMkAoFtAoAAAoAFAn+uSVhKWxUXSswC0QEC0MxLJwOITwOH5kTFkTIC8qFdAwMDrkvOTC0lA89NTE2vAos/AorYwRsHHUNnBbcCjjcCjlxAl4ECjtkCjlx4UbRTNQpS1FSFApP7ApMMAOkAHFUeVa9V0AYsGymVhjLheGZFOzkCl58C77JYIagAWSUClo8ClnycAKlZrFoJgU0AOwKWtQKWTlxEXNECmcsCmWRcyl0HGQKcmznCOp0CnBYCn5sCnriKAB0PMSoPAp3xAp6SALU9YTRh7wKe0wKgbgGpAp6fHwKeTqVjyGQnJSsCJ68CJn4CoPsCoEwCot0CocQCpi8Cpc4Cp/8AfQKn8mh8aLEAA0lqHGrRAqzjAqyuAq1nAq0CAlcdAlXcArHh1wMfTmyXArK9DQKy6Bds4G1jbUhfAyXNArZcOz9ukAMpRQK4XgK5RxUCuSp3cDZw4QK9GQK72nCWAzIRAr6IcgIDM3ECvhpzInNPAsPLAsMEc4J0SzVFdOADPKcDPJoDPb8CxXwCxkcCxhCJAshpUQLIRALJTwLJLgJknQLd0nh5YXiueSVL0AMYo2cCAmH0GfOVJHsLXpJeuxECz2sCz2wvS1PS8xOfAMatAs9zASnqA04SfksFAtwnAtuKAtJPA1JcA1NfAQEDVYyAiT8AyxbtYEWCHILTgs6DjQLaxwLZ3oQQhEmnPAOGpQAvA2QOhnFZ+QBVAt9lAt64c3cC4i/tFAHzMCcB9JsB8tKHAuvzAulweQLq+QLq5AD5RwG5Au6JAuuclqqXAwLuPwOF4Jh5cOBxoQLzAwBpA44WmZMC9xMDkW4DkocC95gC+dkC+GaaHJqruzebHgOdgwL++gEbADmfHJ+zAwWNA6ZqA6bZANHFAwZqoYiiBQkDDEkCwAA/AwDhQRdTARHzA2sHl2cFAJMtK7evvdsBiZkUfxEEOQH7KQUhDp0JnwCS/SlXxQL3AZ0AtwW5AG8LbUEuFCaNLgFDAYD8AbUmAHUDDgRtACwCFgyhAAAKAj0CagPdA34EkQEgRQUhfAoABQBEABMANhICdwEABdUDa+8KxQIA9wqfJ7+xt+UBkSFBQgHpFH8RNMCJAAQAGwBaAkUChIsABjpTOpSNbQC4Oo860ACNOME63AClAOgAywE6gTo7Ofw5+Tt2iTpbO56JOm85GAFWATMBbAUvNV01njWtNWY1dTW2NcU1gjWRNdI14TWeNa017jX9NbI1wTYCNhE1xjXVNhY2JzXeNe02LjY9Ni41LSE2OjY9Njw2yTcIBJA8VzY4Nt03IDcPNsogN4k3MAoEsDxnNiQ3GTdsOo03IULUQwdC4EMLHA8PCZsobShRVQYA6X8A6bABFCnXAukBowC9BbcAbwNzBL8MDAMMAQgDAAkKCwsLCQoGBAVVBI/DvwDz9b29kaUCb0QtsRTNLt4eGBcSHAMZFhYZEhYEARAEBUEcQRxBHEEcQRxBHEEaQRxBHEFCSTxBPElISUhBNkM2QTYbNklISVmBVIgBFLWZAu0BhQCjBcEAbykBvwGJAaQcEZ0ePCklMAAhMvAIMAL54gC7Bm8EescjzQMpARQpKgDUABavAj626xQAJP0A3etzuf4NNRA7efy2Z9NQrCnC0OSyANz5BBIbJ5IFDR6miIavYS6tprjjmuKebxm5C74Q225X1pkaYYPb6f1DK4k3xMEBb9S2WMjEibTNWhsRJIA+vwNVEiXTE5iXs/wezV66oFLfp9NZGYW+Gk19J2+bCT6Ye2w6LDYdgzKMUabk595eLBCXANz9HUpWbATq9vqXVx9XDg+Pc9Xp4+bsS005SVM/BJBM4687WUuf+Uj9dEi8aDNaPxtpbDxcG1THTImUMZq4UCaaNYpsVqraNyKLJXDYsFZ/5jl7bLRtO88t7P3xZaAxhb5OdPMXqsSkp1WCieG8jXm1U99+blvLlXzPCS+M93VnJCiK+09LfaSaBAVBomyDgJua8dfUzR7ga34IvR2Nvj+A9heJ6lsl1KG4NkI1032Cnff1m1wof2B9oHJK4bi6JkEdSqeNeiuo6QoZZincoc73/TH9SXF8sCE7XyuYyW8WSgbGFCjPV0ihLKhdPs08Tx82fYAkLLc4I2wdl4apY7GU5lHRFzRWJep7Ww3wbeA3qmd59/86P4xuNaqDpygXt6M85glSBHOCGgJDnt+pN9bK7HApMguX6+06RZNjzVmcZJ+wcUrJ9//bpRNxNuKpNl9uFds+S9tdx7LaM5ZkIrPj6nIU9mnbFtVbs9s/uLgl8MVczAwet+iOEzzBlYW7RCMgE6gyNLeq6+1tIx4dpgZnd0DksJS5f+JNDpwwcPNXaaVspq1fbQajOrJgK0ofKtJ1Ne90L6VO4MOl5S886p7u6xo7OLjG8TGL+HU1JXGJgppg4nNbNJ5nlzSpuPYy21JUEcUA94PoFiZfjZue+QnyQ80ekOuZVkxx4g+cvhJfHgNl4hy1/a6+RKcKlar/J29y//EztlbVPHVUeQ1zX86eQVAjR/M3dA9w4W8LfaXp4EgM85wOWasli837PzVMOnsLzR+k3o75/lRPAJSE1xAKQzEi5v10ke+VBvRt1cwQRMd+U5mLCTGVd6XiZtgBG5cDi0w22GKcVNvHiu5LQbZEDVtz0onn7k5+heuKXVsZtSzilkLRAUmjMXEMB3J9YC50XBxPiz53SC+EhnPl9WsKCv92SM/OFFIMJZYfl0WW8tIO3UxYcwdMAj7FSmgrsZ2aAZO03BOhP1bNNZItyXYQFTpC3SG1VuPDqH9GkiCDmE+JwxyIVSO5siDErAOpEXFgjy6PQtOVDj+s6e1r8heWVvmZnTciuf4EiNZzCAd7SOMhXERIOlsHIMG399i9aLTy3m2hRLZjJVDNLS53iGIK11dPqQt0zBDyg6qc7YqkDm2M5Ve6dCWCaCbTXX2rToaIgz6+zh4lYUi/+6nqcFMAkQJKHYLK0wYk5N9szV6xihDbDDFr45lN1K4aCXBq/FitPSud9gLt5ZVn+ZqGX7cwm2z5EGMgfFpIFyhGGuDPmso6TItTMwny+7uPnLCf4W6goFQFV0oQSsc9VfMmVLcLr6ZetDZbaSFTLqnSO/bIPjA3/zAUoqgGFAEQS4IhuMzEp2I3jJzbzkk/IEmyax+rhZTwd6f+CGtwPixu8IvzACquPWPREu9ZvGkUzpRwvRRuaNN6cr0W1wWits9ICdYJ7ltbgMiSL3sTPeufgNcVqMVWFkCPDH4jG2jA0XcVgQj62Cb29v9f/z/+2KbYvIv/zzjpQAPkliaVDzNrW57TZ/ZOyZD0nlfMmAIBIAGAI0D3k/mdN4xr9v85ZbZbbqfH2jGd5hUqNZWwl5SPfoGmfElmazUIeNL1j/mkF7VNAzTq4jNt8JoQ11NQOcmhprXoxSxfRGJ9LDEOAQ+dmxAQH90iti9e2u/MoeuaGcDTHoC+xsmEeWmxEKefQuIzHbpw5Tc5cEocboAD09oipWQhtTO1wivf/O+DRe2rpl/E9wlrzBorjJsOeG1B/XPW4EaJEFdNlECEZga5ZoGRHXgYouGRuVkm8tDESiEyFNo+3s5M5puSdTyUL2llnINVHEt91XUNW4ewdMgJ4boJfEyt/iY5WXqbA+A2Fkt5Z0lutiWhe9nZIyIUjyXDC3UsaG1t+eNx6z4W/OYoTB7A6x+dNSTOi9AInctbESqm5gvOLww7OWXPrmHwVZasrl4eD113pm+JtT7JVOvnCXqdzzdTRHgJ0PiGTFYW5Gvt9R9LD6Lzfs0v/TZZHSmyVNq7viIHE6DBK7Qp07Iz55EM8SYtQvZf/obBniTWi5C2/ovHfw4VndkE5XYdjOhCMRjDeOEfXeN/CwfGduiUIfsoFeUxXeQXba7c7972XNv8w+dTjjUM0QeNAReW+J014dKAD/McQYXT7c0GQPIkn3Ll6R7gGjuiQoZD0TEeEqQpKoZ15g/0OPQI17QiSv9AUROa/V/TQN3dvLArec3RrsYlvBm1b8LWzltdugsC50lNKYLEp2a+ZZYqPejULRlOJh5zj/LVMyTDvwKhMxxwuDkxJ1QpoNI0OTWLom4Z71SNzI9TV1iXJrIu9Wcnd+MCaAw8o1jSXd94YU/1gnkrC9BUEOtQvEIQ7g0i6h+KL2JKk8Ydl7HruvgWMSAmNe+LshGhV4qnWHhO9/RIPQzY1tHRj2VqOyNsDpK0cww+56AdDC4gsWwY0XxoucIWIqs/GcwnWqlaT0KPr8mbK5U94/301i1WLt4YINTVvCFBrFZbIbY8eycOdeJ2teD5IfPLCRg7jjcFTwlMFNl9zdh/o3E/hHPwj7BWg0MU09pPrBLbrCgm54A6H+I6v27+jL5gkjWg/iYdks9jbfVP5y/n0dlgWEMlKasl7JvFZd56LfybW1eeaVO0gxTfXZwD8G4SI116yx7UKVRgui6Ya1YpixqXeNLc8IxtAwCU5IhwQgn+NqHnRaDv61CxKhOq4pOX7M6pkA+Pmpd4j1vn6ACUALoLLc4vpXci8VidLxzm7qFBe7s+quuJs6ETYmnpgS3LwSZxPIltgBDXz8M1k/W2ySNv2f9/NPhxLGK2D21dkHeSGmenRT3Yqcdl0m/h3OYr8V+lXNYGf8aCCpd4bWjE4QIPj7vUKN4Nrfs7ML6Y2OyS830JCnofg/k7lpFpt4SqZc5HGg1HCOrHvOdC8bP6FGDbE/VV0mX4IakzbdS/op+Kt3G24/8QbBV7y86sGSQ/vZzU8FXs7u6jIvwchsEP2BpIhW3G8uWNwa3HmjfH/ZjhhCWvluAcF+nMf14ClKg5hGgtPLJ98ueNAkc5Hs2WZlk2QHvfreCK1CCGO6nMZVSb99VM/ajr8WHTte9JSmkXq/i/U943HEbdzW6Re/S88dKgg8pGOLlAeNiqrcLkUR3/aClFpMXcOUP3rmETcWSfMXZE3TUOi8i+fqRnTYLflVx/Vb/6GJ7eIRZUA6k3RYR3iFSK9c4iDdNwJuZL2FKz/IK5VimcNWEqdXjSoxSgmF0UPlDoUlNrPcM7ftmA8Y9gKiqKEHuWN+AZRIwtVSxye2Kf8rM3lhJ5XcBXU9n4v0Oy1RU2M+4qM8AQPVwse8ErNSob5oFPWxuqZnVzo1qB/IBxkM3EVUKFUUlO3e51259GgNcJbCmlvrdjtoTW7rChm1wyCKzpCTwozUUEOIcWLneRLgMXh+SjGSFkAllzbGS5HK7LlfCMRNRDSvbQPjcXaenNYxCvu2Qyznz6StuxVj66SgI0T8B6/sfHAJYZaZ78thjOSIFumNWLQbeZixDCCC+v0YBtkxiBB3jefHqZ/dFHU+crbj6OvS1x/JDD7vlm7zOVPwpUC01nhxZuY/63E7g";const Md=44032,cg=4352,lg=4449,ug=4519,JS=19,YS=21,Ru=28,hg=YS*Ru,oW=JS*hg,aW=Md+oW,cW=cg+JS,lW=lg+YS,uW=ug+Ru;function _h(r){return r>>24&255}function QS(r){return r&16777215}let Yw,W1,Qw,Sp;function hW(){let r=qS(iW);Yw=new Map(VS(r).flatMap((e,t)=>e.map(n=>[n,t+1<<24]))),W1=new Set(Ld(r)),Qw=new Map,Sp=new Map;for(let[e,t]of WS(r)){if(!W1.has(e)&&t.length==2){let[n,s]=t,i=Sp.get(n);i||(i=new Map,Sp.set(n,i)),i.set(s,e)}Qw.set(e,t.reverse())}}function ZS(r){return r>=Md&&r<aW}function dW(r,e){if(r>=cg&&r<cW&&e>=lg&&e<lW)return Md+(r-cg)*hg+(e-lg)*Ru;if(ZS(r)&&e>ug&&e<uW&&(r-Md)%Ru==0)return r+(e-ug);{let t=Sp.get(r);return t&&(t=t.get(e),t)?t:-1}}function XS(r){Yw||hW();let e=[],t=[],n=!1;function s(i){let o=Yw.get(i);o&&(n=!0,i|=o),e.push(i)}for(let i of r)for(;;){if(i<128)e.push(i);else if(ZS(i)){let o=i-Md,a=o/hg|0,c=o%hg/Ru|0,l=o%Ru;s(cg+a),s(lg+c),l>0&&s(ug+l)}else{let o=Qw.get(i);o?t.push(...o):s(i)}if(!t.length)break;i=t.pop()}if(n&&e.length>1){let i=_h(e[0]);for(let o=1;o<e.length;o++){let a=_h(e[o]);if(a==0||i<=a){i=a;continue}let c=o-1;for(;;){let l=e[c+1];if(e[c+1]=e[c],e[c]=l,!c||(i=_h(e[--c]),i<=a))break}i=_h(e[o])}}return e}function fW(r){let e=[],t=[],n=-1,s=0;for(let i of r){let o=_h(i),a=QS(i);if(n==-1)o==0?n=a:e.push(a);else if(s>0&&s>=o)o==0?(e.push(n,...t),t.length=0,n=a):t.push(a),s=o;else{let c=dW(n,a);c>=0?n=c:s==0&&o==0?(e.push(n),n=a):(t.push(a),s=o)}}return n>=0&&e.push(n,...t),e}function ex(r){return XS(r).map(QS)}function pW(r){return fW(XS(r))}const G1=45,tx=".",rx=65039,nx=1,dg=r=>Array.from(r);function Fd(r,e){return r.P.has(e)||r.Q.has(e)}class gW extends Array{get is_emoji(){return!0}}let Zw,sx,Ea,Xw,ix,bl,Sy,rl,sa,K1,eb;function p0(){if(Zw)return;let r=qS(GV);const e=()=>Ld(r),t=()=>new Set(e()),n=(u,h)=>h.forEach(d=>u.add(d));Zw=new Map(WS(r)),sx=t(),Ea=e(),Xw=new Set(e().map(u=>Ea[u])),Ea=new Set(Ea),ix=t(),t();let s=VS(r),i=r();const o=()=>{let u=new Set;return e().forEach(h=>n(u,s[h])),n(u,e()),u};bl=$d(u=>{let h=$d(r).map(d=>d+96);if(h.length){let d=u>=i;h[0]-=32,h=Ou(h),d&&(h=`Restricted[${h}]`);let f=o(),g=o(),p=!r();return{N:h,P:f,Q:g,M:p,R:d}}}),Sy=t(),rl=new Map;let a=e().concat(dg(Sy)).sort((u,h)=>u-h);a.forEach((u,h)=>{let d=r(),f=a[h]=d?a[h-d]:{V:[],M:new Map};f.V.push(u),Sy.has(u)||rl.set(u,f)});for(let{V:u,M:h}of new Set(rl.values())){let d=[];for(let g of u){let p=bl.filter(w=>Fd(w,g)),m=d.find(({G:w})=>p.some(A=>w.has(A)));m||(m={G:new Set,V:[]},d.push(m)),m.V.push(g),n(m.G,p)}let f=d.flatMap(g=>dg(g.G));for(let{G:g,V:p}of d){let m=new Set(f.filter(w=>!g.has(w)));for(let w of p)h.set(w,m)}}sa=new Set;let c=new Set;const l=u=>sa.has(u)?c.add(u):sa.add(u);for(let u of bl){for(let h of u.P)l(h);for(let h of u.Q)l(h)}for(let u of sa)!rl.has(u)&&!c.has(u)&&rl.set(u,nx);n(sa,ex(sa)),K1=tW(r).map(u=>gW.from(u)).sort(sW),eb=new Map;for(let u of K1){let h=[eb];for(let d of u){let f=h.map(g=>{let p=g.get(d);return p||(p=new Map,g.set(d,p)),p});d===rx?h.push(...f):h=f}for(let d of h)d.V=u}}function g0(r){return(ox(r)?"":`${m0(sm([r]))} `)+KS(r)}function m0(r){return`"${r}"`}function mW(r){if(r.length>=4&&r[2]==G1&&r[3]==G1)throw new Error(`invalid label extension: "${Ou(r.slice(0,4))}"`)}function yW(r){for(let t=r.lastIndexOf(95);t>0;)if(r[--t]!==95)throw new Error("underscore allowed only at start")}function wW(r){let e=r[0],t=q1.get(e);if(t)throw Fh(`leading ${t}`);let n=r.length,s=-1;for(let i=1;i<n;i++){e=r[i];let o=q1.get(e);if(o){if(s==i)throw Fh(`${t} + ${o}`);s=i+1,t=o}}if(s==n)throw Fh(`trailing ${t}`)}function sm(r,e=1/0,t=KS){let n=[];bW(r[0])&&n.push(""),r.length>e&&(e>>=1,r=[...r.slice(0,e),8230,...r.slice(-e)]);let s=0,i=r.length;for(let o=0;o<i;o++){let a=r[o];ox(a)&&(n.push(Ou(r.slice(s,o))),n.push(t(a)),s=o+1)}return n.push(Ou(r.slice(s,i))),n.join("")}function bW(r){return p0(),Ea.has(r)}function ox(r){return p0(),ix.has(r)}function EW(r){return _W(vW(r,pW,SW))}function vW(r,e,t){if(!r)return[];p0();let n=0;return r.split(tx).map(s=>{let i=nW(s),o={input:i,offset:n};n+=i.length+1;try{let a=o.tokens=IW(i,e,t),c=a.length,l;if(!c)throw new Error("empty label");let u=o.output=a.flat();if(yW(u),!(o.emoji=c>1||a[0].is_emoji)&&u.every(d=>d<128))mW(u),l="ASCII";else{let d=a.flatMap(f=>f.is_emoji?[]:f);if(!d.length)l="Emoji";else{if(Ea.has(u[0]))throw Fh("leading combining mark");for(let p=1;p<c;p++){let m=a[p];if(!m.is_emoji&&Ea.has(m[0]))throw Fh(`emoji + combining mark: "${Ou(a[p-1])} + ${sm([m[0]])}"`)}wW(u);let f=dg(new Set(d)),[g]=CW(f);NW(g,d),AW(g,f),l=g.N}}o.type=l}catch(a){o.error=a}return o})}function AW(r,e){let t,n=[];for(let s of e){let i=rl.get(s);if(i===nx)return;if(i){let o=i.M.get(s);if(t=t?t.filter(a=>o.has(a)):dg(o),!t.length)return}else n.push(s)}if(t){for(let s of t)if(n.every(i=>Fd(s,i)))throw new Error(`whole-script confusable: ${r.N}/${s.N}`)}}function CW(r){let e=bl;for(let t of r){let n=e.filter(s=>Fd(s,t));if(!n.length)throw bl.some(s=>Fd(s,t))?cx(e[0],t):ax(t);if(e=n,n.length==1)break}return e}function _W(r){return r.map(({input:e,error:t,output:n})=>{if(t){let s=t.message;throw new Error(r.length==1?s:`Invalid label ${m0(sm(e,63))}: ${s}`)}return Ou(n)}).join(tx)}function ax(r){return new Error(`disallowed character: ${g0(r)}`)}function cx(r,e){let t=g0(e),n=bl.find(s=>s.P.has(e));return n&&(t=`${n.N} ${t}`),new Error(`illegal mixture: ${r.N} + ${t}`)}function Fh(r){return new Error(`illegal placement: ${r}`)}function NW(r,e){for(let t of e)if(!Fd(r,t))throw cx(r,t);if(r.M){let t=ex(e);for(let n=1,s=t.length;n<s;n++)if(Xw.has(t[n])){let i=n+1;for(let o;i<s&&Xw.has(o=t[i]);i++)for(let a=n;a<i;a++)if(t[a]==o)throw new Error(`duplicate non-spacing marks: ${g0(o)}`);if(i-n>V1)throw new Error(`excessive non-spacing marks: ${m0(sm(t.slice(n-1,i)))} (${i-n}/${V1})`);n=i}}}function IW(r,e,t){let n=[],s=[];for(r=r.slice().reverse();r.length;){let i=xW(r);if(i)s.length&&(n.push(e(s)),s=[]),n.push(t(i));else{let o=r.pop();if(sa.has(o))s.push(o);else{let a=Zw.get(o);if(a)s.push(...a);else if(!sx.has(o))throw ax(o)}}}return s.length&&n.push(e(s)),n}function SW(r){return r.filter(e=>e!=rx)}function xW(r,e){let t=eb,n,s=r.length;for(;s&&(t=t.get(r[--s]),!!t);){let{V:i}=t;i&&(n=i,r.length=s)}return n}const lx=new Uint8Array(32);lx.fill(0);function J1(r){return R(r.length!==0,"invalid ENS name; empty component","comp",r),r}function ux(r){const e=Ws(TW(r)),t=[];if(r.length===0)return t;let n=0;for(let s=0;s<e.length;s++)e[s]===46&&(t.push(J1(e.slice(n,s))),n=s+1);return R(n<e.length,"invalid ENS name; empty component","name",r),t.push(J1(e.slice(n))),t}function TW(r){try{if(r.length===0)throw new Error("empty label");return EW(r)}catch(e){R(!1,`invalid ENS name (${e.message})`,"name",r)}}function tb(r){R(typeof r=="string","invalid ENS name; not a string","name",r),R(r.length,"invalid ENS name (empty label)","name",r);let e=lx;const t=ux(r);for(;t.length;)e=Ft(Pt([e,Ft(t.pop())]));return re(e)}function PW(r,e){const t=e;return R(t<=255,"DNS encoded label cannot exceed 255","length",t),re(Pt(ux(r).map(n=>{R(n.length<=t,`label ${JSON.stringify(r)} exceeds ${t} bytes`,"name",r);const s=new Uint8Array(n.length+1);return s.set(n,1),s[0]=s.length-1,s})))+"00"}const hx=new Uint8Array(32);hx.fill(0);const OW=BigInt(-1),dx=BigInt(0),fx=BigInt(1),RW=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function DW(r){const e=Ue(r),t=e.length%32;return t?Pt([e,hx.slice(t)]):re(e)}const kW=Lo(fx,32),UW=Lo(dx,32),Y1={name:"string",version:"string",chainId:"uint256",verifyingContract:"address",salt:"bytes32"},xy=["name","version","chainId","verifyingContract","salt"];function Q1(r){return function(e){return R(typeof e=="string",`invalid domain value for ${JSON.stringify(r)}`,`domain.${r}`,e),e}}const BW={name:Q1("name"),version:Q1("version"),chainId:function(r){const e=de(r,"domain.chainId");return R(e>=0,"invalid chain ID","domain.chainId",r),Number.isSafeInteger(e)?Number(e):Pi(e)},verifyingContract:function(r){try{return nt(r).toLowerCase()}catch{}R(!1,'invalid domain value "verifyingContract"',"domain.verifyingContract",r)},salt:function(r){const e=Ue(r,"domain.salt");return R(e.length===32,'invalid domain value "salt"',"domain.salt",r),re(e)}};function Ty(r){{const e=r.match(/^(u?)int(\d+)$/);if(e){const t=e[1]==="",n=parseInt(e[2]);R(n%8===0&&n!==0&&n<=256&&e[2]===String(n),"invalid numeric width","type",r);const s=wa(RW,t?n-1:n),i=t?(s+fx)*OW:dx;return function(o){const a=de(o,"value");return R(a>=i&&a<=s,`value out-of-bounds for ${r}`,"value",a),Lo(t?YI(a,256):a,32)}}}{const e=r.match(/^bytes(\d+)$/);if(e){const t=parseInt(e[1]);return R(t!==0&&t<=32&&e[1]===String(t),"invalid bytes width","type",r),function(n){const s=Ue(n);return R(s.length===t,`invalid length for ${r}`,"value",n),DW(n)}}}switch(r){case"address":return function(e){return $i(nt(e),32)};case"bool":return function(e){return e?kW:UW};case"bytes":return function(e){return Ft(e)};case"string":return function(e){return cc(e)}}return null}function Z1(r,e){return`${r}(${e.map(({name:t,type:n})=>n+" "+t).join(",")})`}function cp(r){const e=r.match(/^([^\x5b]*)((\x5b\d*\x5d)*)(\x5b(\d*)\x5d)$/);return e?{base:e[1],index:e[2]+e[4],array:{base:e[1],prefix:e[1]+e[2],count:e[5]?parseInt(e[5]):-1}}:{base:r}}var Kd,wi,Wl,wg,px;const Pn=class Pn{constructor(e){F(this,wg);L(this,"primaryType");F(this,Kd);F(this,wi);F(this,Wl);_(this,wi,new Map),_(this,Wl,new Map);const t=new Map,n=new Map,s=new Map,i={};Object.keys(e).forEach(c=>{i[c]=e[c].map(({name:l,type:u})=>{let{base:h,index:d}=cp(u);return h==="int"&&!e.int&&(h="int256"),h==="uint"&&!e.uint&&(h="uint256"),{name:l,type:h+(d||"")}}),t.set(c,new Set),n.set(c,[]),s.set(c,new Set)}),_(this,Kd,JSON.stringify(i));for(const c in i){const l=new Set;for(const u of i[c]){R(!l.has(u.name),`duplicate variable name ${JSON.stringify(u.name)} in ${JSON.stringify(c)}`,"types",e),l.add(u.name);const h=cp(u.type).base;R(h!==c,`circular type reference to ${JSON.stringify(h)}`,"types",e),!Ty(h)&&(R(n.has(h),`unknown type ${JSON.stringify(h)}`,"types",e),n.get(h).push(c),t.get(c).add(h))}}const o=Array.from(n.keys()).filter(c=>n.get(c).length===0);R(o.length!==0,"missing primary type","types",e),R(o.length===1,`ambiguous primary types or unused types: ${o.map(c=>JSON.stringify(c)).join(", ")}`,"types",e),ye(this,{primaryType:o[0]});function a(c,l){R(!l.has(c),`circular type reference to ${JSON.stringify(c)}`,"types",e),l.add(c);for(const u of t.get(c))if(n.has(u)){a(u,l);for(const h of l)s.get(h).add(u)}l.delete(c)}a(this.primaryType,new Set);for(const[c,l]of s){const u=Array.from(l);u.sort(),y(this,wi).set(c,Z1(c,i[c])+u.map(h=>Z1(h,i[h])).join(""))}}get types(){return JSON.parse(y(this,Kd))}getEncoder(e){let t=y(this,Wl).get(e);return t||(t=W(this,wg,px).call(this,e),y(this,Wl).set(e,t)),t}encodeType(e){const t=y(this,wi).get(e);return R(t,`unknown type: ${JSON.stringify(e)}`,"name",e),t}encodeData(e,t){return this.getEncoder(e)(t)}hashStruct(e,t){return Ft(this.encodeData(e,t))}encode(e){return this.encodeData(this.primaryType,e)}hash(e){return this.hashStruct(this.primaryType,e)}_visit(e,t,n){if(Ty(e))return n(e,t);const s=cp(e).array;if(s)return R(s.count===-1||s.count===t.length,`array length mismatch; expected length ${s.count}`,"value",t),t.map(o=>this._visit(s.prefix,o,n));const i=this.types[e];if(i)return i.reduce((o,{name:a,type:c})=>(o[a]=this._visit(c,t[a],n),o),{});R(!1,`unknown type: ${e}`,"type",e)}visit(e,t){return this._visit(this.primaryType,e,t)}static from(e){return new Pn(e)}static getPrimaryType(e){return Pn.from(e).primaryType}static hashStruct(e,t,n){return Pn.from(t).hashStruct(e,n)}static hashDomain(e){const t=[];for(const n in e){if(e[n]==null)continue;const s=Y1[n];R(s,`invalid typed-data domain key: ${JSON.stringify(n)}`,"domain",e),t.push({name:n,type:s})}return t.sort((n,s)=>xy.indexOf(n.name)-xy.indexOf(s.name)),Pn.hashStruct("EIP712Domain",{EIP712Domain:t},e)}static encode(e,t,n){return Pt(["0x1901",Pn.hashDomain(e),Pn.from(t).hash(n)])}static hash(e,t,n){return Ft(Pn.encode(e,t,n))}static async resolveNames(e,t,n,s){e=Object.assign({},e);for(const a in e)e[a]==null&&delete e[a];const i={};e.verifyingContract&&!pt(e.verifyingContract,20)&&(i[e.verifyingContract]="0x");const o=Pn.from(t);o.visit(n,(a,c)=>(a==="address"&&!pt(c,20)&&(i[c]="0x"),c));for(const a in i)i[a]=await s(a);return e.verifyingContract&&i[e.verifyingContract]&&(e.verifyingContract=i[e.verifyingContract]),n=o.visit(n,(a,c)=>a==="address"&&i[c]?i[c]:c),{domain:e,value:n}}static getPayload(e,t,n){Pn.hashDomain(e);const s={},i=[];xy.forEach(c=>{const l=e[c];l!=null&&(s[c]=BW[c](l),i.push({name:c,type:Y1[c]}))});const o=Pn.from(t);t=o.types;const a=Object.assign({},t);return R(a.EIP712Domain==null,"types must not contain EIP712Domain type","types.EIP712Domain",t),a.EIP712Domain=i,o.encode(n),{types:a,domain:s,primaryType:o.primaryType,message:o.visit(n,(c,l)=>{if(c.match(/^bytes(\d*)/))return re(Ue(l));if(c.match(/^u?int/))return de(l).toString();switch(c){case"address":return l.toLowerCase();case"bool":return!!l;case"string":return R(typeof l=="string","invalid string","value",l),l}R(!1,"unsupported type","type",c)})}}};Kd=new WeakMap,wi=new WeakMap,Wl=new WeakMap,wg=new WeakSet,px=function(e){{const s=Ty(e);if(s)return s}const t=cp(e).array;if(t){const s=t.prefix,i=this.getEncoder(s);return o=>{R(t.count===-1||t.count===o.length,`array length mismatch; expected length ${t.count}`,"value",o);let a=o.map(i);return y(this,wi).has(s)&&(a=a.map(Ft)),Ft(Pt(a))}}const n=this.types[e];if(n){const s=cc(y(this,wi).get(e));return i=>{const o=n.map(({name:a,type:c})=>{const l=this.getEncoder(c)(i[a]);return y(this,wi).has(c)?Ft(l):l});return o.unshift(s),Pt(o)}}R(!1,`unknown type: ${e}`,"type",e)};let fg=Pn;function kr(r){const e=new Set;return r.forEach(t=>e.add(t)),Object.freeze(e)}const LW="external public payable override",$W=kr(LW.split(" ")),gx="constant external internal payable private public pure view override",MW=kr(gx.split(" ")),mx="constructor error event fallback function receive struct",yx=kr(mx.split(" ")),wx="calldata memory storage payable indexed",FW=kr(wx.split(" ")),jW="tuple returns",HW=[mx,wx,jW,gx].join(" "),zW=kr(HW.split(" ")),qW={"(":"OPEN_PAREN",")":"CLOSE_PAREN","[":"OPEN_BRACKET","]":"CLOSE_BRACKET",",":"COMMA","@":"AT"},VW=new RegExp("^(\\s*)"),WW=new RegExp("^([0-9]+)"),GW=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)"),bx=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)$"),Ex=new RegExp("^(address|bool|bytes([0-9]*)|string|u?int([0-9]*))$");var or,ns,Jd,rb;const bg=class bg{constructor(e){F(this,Jd);F(this,or);F(this,ns);_(this,or,0),_(this,ns,e.slice())}get offset(){return y(this,or)}get length(){return y(this,ns).length-y(this,or)}clone(){return new bg(y(this,ns))}reset(){_(this,or,0)}popKeyword(e){const t=this.peek();if(t.type!=="KEYWORD"||!e.has(t.text))throw new Error(`expected keyword ${t.text}`);return this.pop().text}popType(e){if(this.peek().type!==e){const t=this.peek();throw new Error(`expected ${e}; got ${t.type} ${JSON.stringify(t.text)}`)}return this.pop().text}popParen(){const e=this.peek();if(e.type!=="OPEN_PAREN")throw new Error("bad start");const t=W(this,Jd,rb).call(this,y(this,or)+1,e.match+1);return _(this,or,e.match+1),t}popParams(){const e=this.peek();if(e.type!=="OPEN_PAREN")throw new Error("bad start");const t=[];for(;y(this,or)<e.match-1;){const n=this.peek().linkNext;t.push(W(this,Jd,rb).call(this,y(this,or)+1,n)),_(this,or,n)}return _(this,or,e.match+1),t}peek(){if(y(this,or)>=y(this,ns).length)throw new Error("out-of-bounds");return y(this,ns)[y(this,or)]}peekKeyword(e){const t=this.peekType("KEYWORD");return t!=null&&e.has(t)?t:null}peekType(e){if(this.length===0)return null;const t=this.peek();return t.type===e?t.text:null}pop(){const e=this.peek();return Qu(this,or)._++,e}toString(){const e=[];for(let t=y(this,or);t<y(this,ns).length;t++){const n=y(this,ns)[t];e.push(`${n.type}:${n.text}`)}return`<TokenString ${e.join(" ")}>`}};or=new WeakMap,ns=new WeakMap,Jd=new WeakSet,rb=function(e=0,t=0){return new bg(y(this,ns).slice(e,t).map(n=>Object.freeze(Object.assign({},n,{match:n.match-e,linkBack:n.linkBack-e,linkNext:n.linkNext-e}))))};let fs=bg;function jo(r){const e=[],t=o=>{const a=i<r.length?JSON.stringify(r[i]):"$EOI";throw new Error(`invalid token ${a} at ${i}: ${o}`)};let n=[],s=[],i=0;for(;i<r.length;){let o=r.substring(i),a=o.match(VW);a&&(i+=a[1].length,o=r.substring(i));const c={depth:n.length,linkBack:-1,linkNext:-1,match:-1,type:"",text:"",offset:i,value:-1};e.push(c);let l=qW[o[0]]||"";if(l){if(c.type=l,c.text=o[0],i++,l==="OPEN_PAREN")n.push(e.length-1),s.push(e.length-1);else if(l=="CLOSE_PAREN")n.length===0&&t("no matching open bracket"),c.match=n.pop(),e[c.match].match=e.length-1,c.depth--,c.linkBack=s.pop(),e[c.linkBack].linkNext=e.length-1;else if(l==="COMMA")c.linkBack=s.pop(),e[c.linkBack].linkNext=e.length-1,s.push(e.length-1);else if(l==="OPEN_BRACKET")c.type="BRACKET";else if(l==="CLOSE_BRACKET"){let u=e.pop().text;if(e.length>0&&e[e.length-1].type==="NUMBER"){const h=e.pop().text;u=h+u,e[e.length-1].value=Pe(h)}if(e.length===0||e[e.length-1].type!=="BRACKET")throw new Error("missing opening bracket");e[e.length-1].text+=u}continue}if(a=o.match(GW),a){if(c.text=a[1],i+=c.text.length,zW.has(c.text)){c.type="KEYWORD";continue}if(c.text.match(Ex)){c.type="TYPE";continue}c.type="ID";continue}if(a=o.match(WW),a){c.text=a[1],c.type="NUMBER",i+=c.text.length;continue}throw new Error(`unexpected token ${JSON.stringify(o[0])} at position ${i}`)}return new fs(e.map(o=>Object.freeze(o)))}function X1(r,e){let t=[];for(const n in e.keys())r.has(n)&&t.push(n);if(t.length>1)throw new Error(`conflicting types: ${t.join(", ")}`)}function im(r,e){if(e.peekKeyword(yx)){const t=e.pop().text;if(t!==r)throw new Error(`expected ${r}, got ${t}`)}return e.popType("ID")}function Fi(r,e){const t=new Set;for(;;){const n=r.peekType("KEYWORD");if(n==null||e&&!e.has(n))break;if(r.pop(),t.has(n))throw new Error(`duplicate keywords: ${JSON.stringify(n)}`);t.add(n)}return Object.freeze(t)}function vx(r){let e=Fi(r,MW);return X1(e,kr("constant payable nonpayable".split(" "))),X1(e,kr("pure view payable nonpayable".split(" "))),e.has("view")?"view":e.has("pure")?"pure":e.has("payable")?"payable":e.has("nonpayable")?"nonpayable":e.has("constant")?"view":"nonpayable"}function Ui(r,e){return r.popParams().map(t=>fr.from(t,e))}function Ax(r){if(r.peekType("AT")){if(r.pop(),r.peekType("NUMBER"))return de(r.pop().text);throw new Error("invalid gas")}return null}function lc(r){if(r.length)throw new Error(`unexpected tokens at offset ${r.offset}: ${r.toString()}`)}const KW=new RegExp(/^(.*)\[([0-9]*)\]$/);function eC(r){const e=r.match(Ex);if(R(e,"invalid type","type",r),r==="uint")return"uint256";if(r==="int")return"int256";if(e[2]){const t=parseInt(e[2]);R(t!==0&&t<=32,"invalid bytes length","type",r)}else if(e[3]){const t=parseInt(e[3]);R(t!==0&&t<=256&&t%8===0,"invalid numeric width","type",r)}return r}const It={},Qr=Symbol.for("_ethers_internal"),tC="_ParamTypeInternal",rC="_ErrorInternal",nC="_EventInternal",sC="_ConstructorInternal",iC="_FallbackInternal",oC="_FunctionInternal",aC="_StructInternal";var Gl,xp;const On=class On{constructor(e,t,n,s,i,o,a,c){F(this,Gl);L(this,"name");L(this,"type");L(this,"baseType");L(this,"indexed");L(this,"components");L(this,"arrayLength");L(this,"arrayChildren");if(Af(e,It,"ParamType"),Object.defineProperty(this,Qr,{value:tC}),o&&(o=Object.freeze(o.slice())),s==="array"){if(a==null||c==null)throw new Error("")}else if(a!=null||c!=null)throw new Error("");if(s==="tuple"){if(o==null)throw new Error("")}else if(o!=null)throw new Error("");ye(this,{name:t,type:n,baseType:s,indexed:i,components:o,arrayLength:a,arrayChildren:c})}format(e){if(e==null&&(e="sighash"),e==="json"){const n=this.name||"";if(this.isArray()){const i=JSON.parse(this.arrayChildren.format("json"));return i.name=n,i.type+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`,JSON.stringify(i)}const s={type:this.baseType==="tuple"?"tuple":this.type,name:n};return typeof this.indexed=="boolean"&&(s.indexed=this.indexed),this.isTuple()&&(s.components=this.components.map(i=>JSON.parse(i.format(e)))),JSON.stringify(s)}let t="";return this.isArray()?(t+=this.arrayChildren.format(e),t+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`):this.isTuple()?t+="("+this.components.map(n=>n.format(e)).join(e==="full"?", ":",")+")":t+=this.type,e!=="sighash"&&(this.indexed===!0&&(t+=" indexed"),e==="full"&&this.name&&(t+=" "+this.name)),t}isArray(){return this.baseType==="array"}isTuple(){return this.baseType==="tuple"}isIndexable(){return this.indexed!=null}walk(e,t){if(this.isArray()){if(!Array.isArray(e))throw new Error("invalid array value");if(this.arrayLength!==-1&&e.length!==this.arrayLength)throw new Error("array is wrong length");const n=this;return e.map(s=>n.arrayChildren.walk(s,t))}if(this.isTuple()){if(!Array.isArray(e))throw new Error("invalid tuple value");if(e.length!==this.components.length)throw new Error("array is wrong length");const n=this;return e.map((s,i)=>n.components[i].walk(s,t))}return t(this.type,e)}async walkAsync(e,t){const n=[],s=[e];return W(this,Gl,xp).call(this,n,e,t,i=>{s[0]=i}),n.length&&await Promise.all(n),s[0]}static from(e,t){if(On.isParamType(e))return e;if(typeof e=="string")try{return On.from(jo(e),t)}catch{R(!1,"invalid param type","obj",e)}else if(e instanceof fs){let a="",c="",l=null;Fi(e,kr(["tuple"])).has("tuple")||e.peekType("OPEN_PAREN")?(c="tuple",l=e.popParams().map(p=>On.from(p)),a=`tuple(${l.map(p=>p.format()).join(",")})`):(a=eC(e.popType("TYPE")),c=a);let u=null,h=null;for(;e.length&&e.peekType("BRACKET");){const p=e.pop();u=new On(It,"",a,c,null,l,h,u),h=p.value,a+=p.text,c="array",l=null}let d=null;if(Fi(e,FW).has("indexed")){if(!t)throw new Error("");d=!0}const g=e.peekType("ID")?e.pop().text:"";if(e.length)throw new Error("leftover tokens");return new On(It,g,a,c,d,l,h,u)}const n=e.name;R(!n||typeof n=="string"&&n.match(bx),"invalid name","obj.name",n);let s=e.indexed;s!=null&&(R(t,"parameter cannot be indexed","obj.indexed",e.indexed),s=!!s);let i=e.type,o=i.match(KW);if(o){const a=parseInt(o[2]||"-1"),c=On.from({type:o[1],components:e.components});return new On(It,n||"",i,"array",s,null,a,c)}if(i==="tuple"||i.startsWith("tuple(")||i.startsWith("(")){const a=e.components!=null?e.components.map(l=>On.from(l)):null;return new On(It,n||"",i,"tuple",s,a,null,null)}return i=eC(e.type),new On(It,n||"",i,i,s,null,null,null)}static isParamType(e){return e&&e[Qr]===tC}};Gl=new WeakSet,xp=function(e,t,n,s){if(this.isArray()){if(!Array.isArray(t))throw new Error("invalid array value");if(this.arrayLength!==-1&&t.length!==this.arrayLength)throw new Error("array is wrong length");const o=this.arrayChildren,a=t.slice();a.forEach((c,l)=>{var u;W(u=o,Gl,xp).call(u,e,c,n,h=>{a[l]=h})}),s(a);return}if(this.isTuple()){const o=this.components;let a;if(Array.isArray(t))a=t.slice();else{if(t==null||typeof t!="object")throw new Error("invalid tuple value");a=o.map(c=>{if(!c.name)throw new Error("cannot use object value with unnamed components");if(!(c.name in t))throw new Error(`missing value for component ${c.name}`);return t[c.name]})}if(a.length!==this.components.length)throw new Error("array is wrong length");a.forEach((c,l)=>{var u;W(u=o[l],Gl,xp).call(u,e,c,n,h=>{a[l]=h})}),s(a);return}const i=n(this.type,t);i.then?e.push(async function(){s(await i)}()):s(i)};let fr=On;class uc{constructor(e,t,n){L(this,"type");L(this,"inputs");Af(e,It,"Fragment"),n=Object.freeze(n.slice()),ye(this,{type:t,inputs:n})}static from(e){if(typeof e=="string"){try{uc.from(JSON.parse(e))}catch{}return uc.from(jo(e))}if(e instanceof fs)switch(e.peekKeyword(yx)){case"constructor":return Oi.from(e);case"error":return Kr.from(e);case"event":return Fs.from(e);case"fallback":case"receive":return fi.from(e);case"function":return js.from(e);case"struct":return Ka.from(e)}else if(typeof e=="object"){switch(e.type){case"constructor":return Oi.from(e);case"error":return Kr.from(e);case"event":return Fs.from(e);case"fallback":case"receive":return fi.from(e);case"function":return js.from(e);case"struct":return Ka.from(e)}q(!1,`unsupported type: ${e.type}`,"UNSUPPORTED_OPERATION",{operation:"Fragment.from"})}R(!1,"unsupported frgament object","obj",e)}static isConstructor(e){return Oi.isFragment(e)}static isError(e){return Kr.isFragment(e)}static isEvent(e){return Fs.isFragment(e)}static isFunction(e){return js.isFragment(e)}static isStruct(e){return Ka.isFragment(e)}}class om extends uc{constructor(t,n,s,i){super(t,n,i);L(this,"name");R(typeof s=="string"&&s.match(bx),"invalid identifier","name",s),i=Object.freeze(i.slice()),ye(this,{name:s})}}function jd(r,e){return"("+e.map(t=>t.format(r)).join(r==="full"?", ":",")+")"}class Kr extends om{constructor(e,t,n){super(e,"error",t,n),Object.defineProperty(this,Qr,{value:rC})}get selector(){return cc(this.format("sighash")).substring(0,10)}format(e){if(e==null&&(e="sighash"),e==="json")return JSON.stringify({type:"error",name:this.name,inputs:this.inputs.map(n=>JSON.parse(n.format(e)))});const t=[];return e!=="sighash"&&t.push("error"),t.push(this.name+jd(e,this.inputs)),t.join(" ")}static from(e){if(Kr.isFragment(e))return e;if(typeof e=="string")return Kr.from(jo(e));if(e instanceof fs){const t=im("error",e),n=Ui(e);return lc(e),new Kr(It,t,n)}return new Kr(It,e.name,e.inputs?e.inputs.map(fr.from):[])}static isFragment(e){return e&&e[Qr]===rC}}class Fs extends om{constructor(t,n,s,i){super(t,"event",n,s);L(this,"anonymous");Object.defineProperty(this,Qr,{value:nC}),ye(this,{anonymous:i})}get topicHash(){return cc(this.format("sighash"))}format(t){if(t==null&&(t="sighash"),t==="json")return JSON.stringify({type:"event",anonymous:this.anonymous,name:this.name,inputs:this.inputs.map(s=>JSON.parse(s.format(t)))});const n=[];return t!=="sighash"&&n.push("event"),n.push(this.name+jd(t,this.inputs)),t!=="sighash"&&this.anonymous&&n.push("anonymous"),n.join(" ")}static getTopicHash(t,n){return n=(n||[]).map(i=>fr.from(i)),new Fs(It,t,n,!1).topicHash}static from(t){if(Fs.isFragment(t))return t;if(typeof t=="string")try{return Fs.from(jo(t))}catch{R(!1,"invalid event fragment","obj",t)}else if(t instanceof fs){const n=im("event",t),s=Ui(t,!0),i=!!Fi(t,kr(["anonymous"])).has("anonymous");return lc(t),new Fs(It,n,s,i)}return new Fs(It,t.name,t.inputs?t.inputs.map(n=>fr.from(n,!0)):[],!!t.anonymous)}static isFragment(t){return t&&t[Qr]===nC}}class Oi extends uc{constructor(t,n,s,i,o){super(t,n,s);L(this,"payable");L(this,"gas");Object.defineProperty(this,Qr,{value:sC}),ye(this,{payable:i,gas:o})}format(t){if(q(t!=null&&t!=="sighash","cannot format a constructor for sighash","UNSUPPORTED_OPERATION",{operation:"format(sighash)"}),t==="json")return JSON.stringify({type:"constructor",stateMutability:this.payable?"payable":"undefined",payable:this.payable,gas:this.gas!=null?this.gas:void 0,inputs:this.inputs.map(s=>JSON.parse(s.format(t)))});const n=[`constructor${jd(t,this.inputs)}`];return this.payable&&n.push("payable"),this.gas!=null&&n.push(`@${this.gas.toString()}`),n.join(" ")}static from(t){if(Oi.isFragment(t))return t;if(typeof t=="string")try{return Oi.from(jo(t))}catch{R(!1,"invalid constuctor fragment","obj",t)}else if(t instanceof fs){Fi(t,kr(["constructor"]));const n=Ui(t),s=!!Fi(t,$W).has("payable"),i=Ax(t);return lc(t),new Oi(It,"constructor",n,s,i)}return new Oi(It,"constructor",t.inputs?t.inputs.map(fr.from):[],!!t.payable,t.gas!=null?t.gas:null)}static isFragment(t){return t&&t[Qr]===sC}}class fi extends uc{constructor(t,n,s){super(t,"fallback",n);L(this,"payable");Object.defineProperty(this,Qr,{value:iC}),ye(this,{payable:s})}format(t){const n=this.inputs.length===0?"receive":"fallback";if(t==="json"){const s=this.payable?"payable":"nonpayable";return JSON.stringify({type:n,stateMutability:s})}return`${n}()${this.payable?" payable":""}`}static from(t){if(fi.isFragment(t))return t;if(typeof t=="string")try{return fi.from(jo(t))}catch{R(!1,"invalid fallback fragment","obj",t)}else if(t instanceof fs){const n=t.toString(),s=t.peekKeyword(kr(["fallback","receive"]));if(R(s,"type must be fallback or receive","obj",n),t.popKeyword(kr(["fallback","receive"]))==="receive"){const c=Ui(t);return R(c.length===0,"receive cannot have arguments","obj.inputs",c),Fi(t,kr(["payable"])),lc(t),new fi(It,[],!0)}let o=Ui(t);o.length?R(o.length===1&&o[0].type==="bytes","invalid fallback inputs","obj.inputs",o.map(c=>c.format("minimal")).join(", ")):o=[fr.from("bytes")];const a=vx(t);if(R(a==="nonpayable"||a==="payable","fallback cannot be constants","obj.stateMutability",a),Fi(t,kr(["returns"])).has("returns")){const c=Ui(t);R(c.length===1&&c[0].type==="bytes","invalid fallback outputs","obj.outputs",c.map(l=>l.format("minimal")).join(", "))}return lc(t),new fi(It,o,a==="payable")}if(t.type==="receive")return new fi(It,[],!0);if(t.type==="fallback"){const n=[fr.from("bytes")],s=t.stateMutability==="payable";return new fi(It,n,s)}R(!1,"invalid fallback description","obj",t)}static isFragment(t){return t&&t[Qr]===iC}}class js extends om{constructor(t,n,s,i,o,a){super(t,"function",n,i);L(this,"constant");L(this,"outputs");L(this,"stateMutability");L(this,"payable");L(this,"gas");Object.defineProperty(this,Qr,{value:oC}),o=Object.freeze(o.slice()),ye(this,{constant:s==="view"||s==="pure",gas:a,outputs:o,payable:s==="payable",stateMutability:s})}get selector(){return cc(this.format("sighash")).substring(0,10)}format(t){if(t==null&&(t="sighash"),t==="json")return JSON.stringify({type:"function",name:this.name,constant:this.constant,stateMutability:this.stateMutability!=="nonpayable"?this.stateMutability:void 0,payable:this.payable,gas:this.gas!=null?this.gas:void 0,inputs:this.inputs.map(s=>JSON.parse(s.format(t))),outputs:this.outputs.map(s=>JSON.parse(s.format(t)))});const n=[];return t!=="sighash"&&n.push("function"),n.push(this.name+jd(t,this.inputs)),t!=="sighash"&&(this.stateMutability!=="nonpayable"&&n.push(this.stateMutability),this.outputs&&this.outputs.length&&(n.push("returns"),n.push(jd(t,this.outputs))),this.gas!=null&&n.push(`@${this.gas.toString()}`)),n.join(" ")}static getSelector(t,n){return n=(n||[]).map(i=>fr.from(i)),new js(It,t,"view",n,[],null).selector}static from(t){if(js.isFragment(t))return t;if(typeof t=="string")try{return js.from(jo(t))}catch{R(!1,"invalid function fragment","obj",t)}else if(t instanceof fs){const s=im("function",t),i=Ui(t),o=vx(t);let a=[];Fi(t,kr(["returns"])).has("returns")&&(a=Ui(t));const c=Ax(t);return lc(t),new js(It,s,o,i,a,c)}let n=t.stateMutability;return n==null&&(n="payable",typeof t.constant=="boolean"?(n="view",t.constant||(n="payable",typeof t.payable=="boolean"&&!t.payable&&(n="nonpayable"))):typeof t.payable=="boolean"&&!t.payable&&(n="nonpayable")),new js(It,t.name,n,t.inputs?t.inputs.map(fr.from):[],t.outputs?t.outputs.map(fr.from):[],t.gas!=null?t.gas:null)}static isFragment(t){return t&&t[Qr]===oC}}class Ka extends om{constructor(e,t,n){super(e,"struct",t,n),Object.defineProperty(this,Qr,{value:aC})}format(){throw new Error("@TODO")}static from(e){if(typeof e=="string")try{return Ka.from(jo(e))}catch{R(!1,"invalid struct fragment","obj",e)}else if(e instanceof fs){const t=im("struct",e),n=Ui(e);return lc(e),new Ka(It,t,n)}return new Ka(It,e.name,e.inputs?e.inputs.map(fr.from):[])}static isFragment(e){return e&&e[Qr]===aC}}const gs=new Map;gs.set(0,"GENERIC_PANIC");gs.set(1,"ASSERT_FALSE");gs.set(17,"OVERFLOW");gs.set(18,"DIVIDE_BY_ZERO");gs.set(33,"ENUM_RANGE_ERROR");gs.set(34,"BAD_STORAGE_DATA");gs.set(49,"STACK_UNDERFLOW");gs.set(50,"ARRAY_RANGE_ERROR");gs.set(65,"OUT_OF_MEMORY");gs.set(81,"UNINITIALIZED_FUNCTION_CALL");const JW=new RegExp(/^bytes([0-9]*)$/),YW=new RegExp(/^(u?int)([0-9]*)$/);let Py=null,cC=1024;function QW(r,e,t,n){let s="missing revert data",i=null;const o=null;let a=null;if(t){s="execution reverted";const l=Ue(t);if(t=re(t),l.length===0)s+=" (no data present; likely require(false) occurred",i="require(false)";else if(l.length%32!==4)s+=" (could not decode reason; invalid data length)";else if(re(l.slice(0,4))==="0x08c379a0")try{i=n.decode(["string"],l.slice(4))[0],a={signature:"Error(string)",name:"Error",args:[i]},s+=`: ${JSON.stringify(i)}`}catch{s+=" (could not decode reason; invalid string data)"}else if(re(l.slice(0,4))==="0x4e487b71")try{const u=Number(n.decode(["uint256"],l.slice(4))[0]);a={signature:"Panic(uint256)",name:"Panic",args:[u]},i=`Panic due to ${gs.get(u)||"UNKNOWN"}(${u})`,s+=`: ${i}`}catch{s+=" (could not decode panic code)"}else s+=" (unknown custom error)"}const c={to:e.to?nt(e.to):null,data:e.data||"0x"};return e.from&&(c.from=nt(e.from)),Ct(s,"CALL_EXCEPTION",{action:r,data:t,reason:i,transaction:c,invocation:o,revert:a})}var po,nl;const Eg=class Eg{constructor(){F(this,po)}getDefaultValue(e){const t=e.map(s=>W(this,po,nl).call(this,fr.from(s)));return new ap(t,"_").defaultValue()}encode(e,t){GI(t.length,e.length,"types/values length mismatch");const n=e.map(o=>W(this,po,nl).call(this,fr.from(o))),s=new ap(n,"_"),i=new Hw;return s.encode(i,t),i.data}decode(e,t,n){const s=e.map(o=>W(this,po,nl).call(this,fr.from(o)));return new ap(s,"_").decode(new zw(t,n,cC))}static _setDefaultMaxInflation(e){R(typeof e=="number"&&Number.isInteger(e),"invalid defaultMaxInflation factor","value",e),cC=e}static defaultAbiCoder(){return Py==null&&(Py=new Eg),Py}static getBuiltinCallException(e,t,n){return QW(e,t,n,Eg.defaultAbiCoder())}};po=new WeakSet,nl=function(e){if(e.isArray())return new gV(W(this,po,nl).call(this,e.arrayChildren),e.arrayLength,e.name);if(e.isTuple())return new ap(e.components.map(n=>W(this,po,nl).call(this,n)),e.name);switch(e.baseType){case"address":return new fV(e.name);case"bool":return new mV(e.name);case"string":return new NV(e.name);case"bytes":return new yV(e.name);case"":return new EV(e.name)}let t=e.type.match(YW);if(t){let n=parseInt(t[2]||"256");return R(n!==0&&n<=256&&n%8===0,"invalid "+t[1]+" bit length","param",e),new _V(n/8,t[1]==="int",e.name)}if(t=e.type.match(JW),t){let n=parseInt(t[1]);return R(n!==0&&n<=32,"invalid bytes length","param",e),new wV(n,e.name)}R(!1,"invalid type","type",e.type)};let Hd=Eg;class ZW{constructor(e,t,n){L(this,"fragment");L(this,"name");L(this,"signature");L(this,"topic");L(this,"args");const s=e.name,i=e.format();ye(this,{fragment:e,name:s,signature:i,topic:t,args:n})}}class XW{constructor(e,t,n,s){L(this,"fragment");L(this,"name");L(this,"args");L(this,"signature");L(this,"selector");L(this,"value");const i=e.name,o=e.format();ye(this,{fragment:e,name:i,args:n,signature:o,selector:t,value:s})}}class eG{constructor(e,t,n){L(this,"fragment");L(this,"name");L(this,"args");L(this,"signature");L(this,"selector");const s=e.name,i=e.format();ye(this,{fragment:e,name:s,args:n,signature:i,selector:t})}}class lC{constructor(e){L(this,"hash");L(this,"_isIndexed");ye(this,{hash:e,_isIndexed:!0})}static isIndexed(e){return!!(e&&e._isIndexed)}}const uC={0:"generic panic",1:"assert(false)",17:"arithmetic overflow",18:"division or modulo by zero",33:"enum overflow",34:"invalid encoded storage byte array accessed",49:"out-of-bounds array access; popping on an empty array",50:"out-of-bounds access of an array or bytesN",65:"out of memory",81:"uninitialized function"},hC={"0x08c379a0":{signature:"Error(string)",name:"Error",inputs:["string"],reason:r=>`reverted with reason string ${JSON.stringify(r)}`},"0x4e487b71":{signature:"Panic(uint256)",name:"Panic",inputs:["uint256"],reason:r=>{let e="unknown panic code";return r>=0&&r<=255&&uC[r.toString()]&&(e=uC[r.toString()]),`reverted with panic code 0x${r.toString(16)} (${e})`}}};var Ps,Os,Rs,br,Gs,Tp,Pp;const da=class da{constructor(e){F(this,Gs);L(this,"fragments");L(this,"deploy");L(this,"fallback");L(this,"receive");F(this,Ps);F(this,Os);F(this,Rs);F(this,br);let t=[];typeof e=="string"?t=JSON.parse(e):t=e,_(this,Rs,new Map),_(this,Ps,new Map),_(this,Os,new Map);const n=[];for(const o of t)try{n.push(uc.from(o))}catch(a){console.log(`[Warning] Invalid Fragment ${JSON.stringify(o)}:`,a.message)}ye(this,{fragments:Object.freeze(n)});let s=null,i=!1;_(this,br,this.getAbiCoder()),this.fragments.forEach((o,a)=>{let c;switch(o.type){case"constructor":if(this.deploy){console.log("duplicate definition - constructor");return}ye(this,{deploy:o});return;case"fallback":o.inputs.length===0?i=!0:(R(!s||o.payable!==s.payable,"conflicting fallback fragments",`fragments[${a}]`,o),s=o,i=s.payable);return;case"function":c=y(this,Rs);break;case"event":c=y(this,Os);break;case"error":c=y(this,Ps);break;default:return}const l=o.format();c.has(l)||c.set(l,o)}),this.deploy||ye(this,{deploy:Oi.from("constructor()")}),ye(this,{fallback:s,receive:i})}format(e){const t=e?"minimal":"full";return this.fragments.map(s=>s.format(t))}formatJson(){const e=this.fragments.map(t=>t.format("json"));return JSON.stringify(e.map(t=>JSON.parse(t)))}getAbiCoder(){return Hd.defaultAbiCoder()}getFunctionName(e){const t=W(this,Gs,Tp).call(this,e,null,!1);return R(t,"no matching function","key",e),t.name}hasFunction(e){return!!W(this,Gs,Tp).call(this,e,null,!1)}getFunction(e,t){return W(this,Gs,Tp).call(this,e,t||null,!0)}forEachFunction(e){const t=Array.from(y(this,Rs).keys());t.sort((n,s)=>n.localeCompare(s));for(let n=0;n<t.length;n++){const s=t[n];e(y(this,Rs).get(s),n)}}getEventName(e){const t=W(this,Gs,Pp).call(this,e,null,!1);return R(t,"no matching event","key",e),t.name}hasEvent(e){return!!W(this,Gs,Pp).call(this,e,null,!1)}getEvent(e,t){return W(this,Gs,Pp).call(this,e,t||null,!0)}forEachEvent(e){const t=Array.from(y(this,Os).keys());t.sort((n,s)=>n.localeCompare(s));for(let n=0;n<t.length;n++){const s=t[n];e(y(this,Os).get(s),n)}}getError(e,t){if(pt(e)){const s=e.toLowerCase();if(hC[s])return Kr.from(hC[s].signature);for(const i of y(this,Ps).values())if(s===i.selector)return i;return null}if(e.indexOf("(")===-1){const s=[];for(const[i,o]of y(this,Ps))i.split("(")[0]===e&&s.push(o);if(s.length===0)return e==="Error"?Kr.from("error Error(string)"):e==="Panic"?Kr.from("error Panic(uint256)"):null;if(s.length>1){const i=s.map(o=>JSON.stringify(o.format())).join(", ");R(!1,`ambiguous error description (i.e. ${i})`,"name",e)}return s[0]}if(e=Kr.from(e).format(),e==="Error(string)")return Kr.from("error Error(string)");if(e==="Panic(uint256)")return Kr.from("error Panic(uint256)");const n=y(this,Ps).get(e);return n||null}forEachError(e){const t=Array.from(y(this,Ps).keys());t.sort((n,s)=>n.localeCompare(s));for(let n=0;n<t.length;n++){const s=t[n];e(y(this,Ps).get(s),n)}}_decodeParams(e,t){return y(this,br).decode(e,t)}_encodeParams(e,t){return y(this,br).encode(e,t)}encodeDeploy(e){return this._encodeParams(this.deploy.inputs,e||[])}decodeErrorResult(e,t){if(typeof e=="string"){const n=this.getError(e);R(n,"unknown error","fragment",e),e=n}return R(Tt(t,0,4)===e.selector,`data signature does not match error ${e.name}.`,"data",t),this._decodeParams(e.inputs,Tt(t,4))}encodeErrorResult(e,t){if(typeof e=="string"){const n=this.getError(e);R(n,"unknown error","fragment",e),e=n}return Pt([e.selector,this._encodeParams(e.inputs,t||[])])}decodeFunctionData(e,t){if(typeof e=="string"){const n=this.getFunction(e);R(n,"unknown function","fragment",e),e=n}return R(Tt(t,0,4)===e.selector,`data signature does not match function ${e.name}.`,"data",t),this._decodeParams(e.inputs,Tt(t,4))}encodeFunctionData(e,t){if(typeof e=="string"){const n=this.getFunction(e);R(n,"unknown function","fragment",e),e=n}return Pt([e.selector,this._encodeParams(e.inputs,t||[])])}decodeFunctionResult(e,t){if(typeof e=="string"){const i=this.getFunction(e);R(i,"unknown function","fragment",e),e=i}let n="invalid length for result data";const s=Or(t);if(s.length%32===0)try{return y(this,br).decode(e.outputs,s)}catch{n="could not decode result data"}q(!1,n,"BAD_DATA",{value:re(s),info:{method:e.name,signature:e.format()}})}makeError(e,t){const n=Ue(e,"data"),s=Hd.getBuiltinCallException("call",t,n);if(s.message.startsWith("execution reverted (unknown custom error)")){const a=re(n.slice(0,4)),c=this.getError(a);if(c)try{const l=y(this,br).decode(c.inputs,n.slice(4));s.revert={name:c.name,signature:c.format(),args:l},s.reason=s.revert.signature,s.message=`execution reverted: ${s.reason}`}catch{s.message="execution reverted (coult not decode custom error)"}}const o=this.parseTransaction(t);return o&&(s.invocation={method:o.name,signature:o.signature,args:o.args}),s}encodeFunctionResult(e,t){if(typeof e=="string"){const n=this.getFunction(e);R(n,"unknown function","fragment",e),e=n}return re(y(this,br).encode(e.outputs,t||[]))}encodeFilterTopics(e,t){if(typeof e=="string"){const i=this.getEvent(e);R(i,"unknown event","eventFragment",e),e=i}q(t.length<=e.inputs.length,`too many arguments for ${e.format()}`,"UNEXPECTED_ARGUMENT",{count:t.length,expectedCount:e.inputs.length});const n=[];e.anonymous||n.push(e.topicHash);const s=(i,o)=>i.type==="string"?cc(o):i.type==="bytes"?Ft(re(o)):(i.type==="bool"&&typeof o=="boolean"?o=o?"0x01":"0x00":i.type.match(/^u?int/)?o=Lo(o):i.type.match(/^bytes/)?o=wz(o,32):i.type==="address"&&y(this,br).encode(["address"],[o]),$i(re(o),32));for(t.forEach((i,o)=>{const a=e.inputs[o];if(!a.indexed){R(i==null,"cannot filter non-indexed parameters; must be null","contract."+a.name,i);return}i==null?n.push(null):a.baseType==="array"||a.baseType==="tuple"?R(!1,"filtering with tuples or arrays not supported","contract."+a.name,i):Array.isArray(i)?n.push(i.map(c=>s(a,c))):n.push(s(a,i))});n.length&&n[n.length-1]===null;)n.pop();return n}encodeEventLog(e,t){if(typeof e=="string"){const o=this.getEvent(e);R(o,"unknown event","eventFragment",e),e=o}const n=[],s=[],i=[];return e.anonymous||n.push(e.topicHash),R(t.length===e.inputs.length,"event arguments/values mismatch","values",t),e.inputs.forEach((o,a)=>{const c=t[a];if(o.indexed)if(o.type==="string")n.push(cc(c));else if(o.type==="bytes")n.push(Ft(c));else{if(o.baseType==="tuple"||o.baseType==="array")throw new Error("not implemented");n.push(y(this,br).encode([o.type],[c]))}else s.push(o),i.push(c)}),{data:y(this,br).encode(s,i),topics:n}}decodeEventLog(e,t,n){if(typeof e=="string"){const f=this.getEvent(e);R(f,"unknown event","eventFragment",e),e=f}if(n!=null&&!e.anonymous){const f=e.topicHash;R(pt(n[0],32)&&n[0].toLowerCase()===f,"fragment/topic mismatch","topics[0]",n[0]),n=n.slice(1)}const s=[],i=[],o=[];e.inputs.forEach((f,g)=>{f.indexed?f.type==="string"||f.type==="bytes"||f.baseType==="tuple"||f.baseType==="array"?(s.push(fr.from({type:"bytes32",name:f.name})),o.push(!0)):(s.push(f),o.push(!1)):(i.push(f),o.push(!1))});const a=n!=null?y(this,br).decode(s,Pt(n)):null,c=y(this,br).decode(i,t,!0),l=[],u=[];let h=0,d=0;return e.inputs.forEach((f,g)=>{let p=null;if(f.indexed)if(a==null)p=new lC(null);else if(o[g])p=new lC(a[d++]);else try{p=a[d++]}catch(m){p=m}else try{p=c[h++]}catch(m){p=m}l.push(p),u.push(f.name||null)}),Iu.fromItems(l,u)}parseTransaction(e){const t=Ue(e.data,"tx.data"),n=de(e.value!=null?e.value:0,"tx.value"),s=this.getFunction(re(t.slice(0,4)));if(!s)return null;const i=y(this,br).decode(s.inputs,t.slice(4));return new XW(s,s.selector,i,n)}parseCallResult(e){throw new Error("@TODO")}parseLog(e){const t=this.getEvent(e.topics[0]);return!t||t.anonymous?null:new ZW(t,t.topicHash,this.decodeEventLog(t,e.data,e.topics))}parseError(e){const t=re(e),n=this.getError(Tt(t,0,4));if(!n)return null;const s=y(this,br).decode(n.inputs,Tt(t,4));return new eG(n,n.selector,s)}static from(e){return e instanceof da?e:typeof e=="string"?new da(JSON.parse(e)):typeof e.formatJson=="function"?new da(e.formatJson()):typeof e.format=="function"?new da(e.format("json")):new da(e)}};Ps=new WeakMap,Os=new WeakMap,Rs=new WeakMap,br=new WeakMap,Gs=new WeakSet,Tp=function(e,t,n){if(pt(e)){const i=e.toLowerCase();for(const o of y(this,Rs).values())if(i===o.selector)return o;return null}if(e.indexOf("(")===-1){const i=[];for(const[o,a]of y(this,Rs))o.split("(")[0]===e&&i.push(a);if(t){const o=t.length>0?t[t.length-1]:null;let a=t.length,c=!0;Cr.isTyped(o)&&o.type==="overrides"&&(c=!1,a--);for(let l=i.length-1;l>=0;l--){const u=i[l].inputs.length;u!==a&&(!c||u!==a-1)&&i.splice(l,1)}for(let l=i.length-1;l>=0;l--){const u=i[l].inputs;for(let h=0;h<t.length;h++)if(Cr.isTyped(t[h])){if(h>=u.length){if(t[h].type==="overrides")continue;i.splice(l,1);break}if(t[h].type!==u[h].baseType){i.splice(l,1);break}}}}if(i.length===1&&t&&t.length!==i[0].inputs.length){const o=t[t.length-1];(o==null||Array.isArray(o)||typeof o!="object")&&i.splice(0,1)}if(i.length===0)return null;if(i.length>1&&n){const o=i.map(a=>JSON.stringify(a.format())).join(", ");R(!1,`ambiguous function description (i.e. matches ${o})`,"key",e)}return i[0]}const s=y(this,Rs).get(js.from(e).format());return s||null},Pp=function(e,t,n){if(pt(e)){const i=e.toLowerCase();for(const o of y(this,Os).values())if(i===o.topicHash)return o;return null}if(e.indexOf("(")===-1){const i=[];for(const[o,a]of y(this,Os))o.split("(")[0]===e&&i.push(a);if(t){for(let o=i.length-1;o>=0;o--)i[o].inputs.length<t.length&&i.splice(o,1);for(let o=i.length-1;o>=0;o--){const a=i[o].inputs;for(let c=0;c<t.length;c++)if(Cr.isTyped(t[c])&&t[c].type!==a[c].baseType){i.splice(o,1);break}}}if(i.length===0)return null;if(i.length>1&&n){const o=i.map(a=>JSON.stringify(a.format())).join(", ");R(!1,`ambiguous event description (i.e. matches ${o})`,"key",e)}return i[0]}const s=y(this,Os).get(Fs.from(e).format());return s||null};let nb=da;const Cx=BigInt(0);function El(r){return r??null}function Rt(r){return r==null?null:r.toString()}class dC{constructor(e,t,n){L(this,"gasPrice");L(this,"maxFeePerGas");L(this,"maxPriorityFeePerGas");ye(this,{gasPrice:El(e),maxFeePerGas:El(t),maxPriorityFeePerGas:El(n)})}toJSON(){const{gasPrice:e,maxFeePerGas:t,maxPriorityFeePerGas:n}=this;return{_type:"FeeData",gasPrice:Rt(e),maxFeePerGas:Rt(t),maxPriorityFeePerGas:Rt(n)}}}function pg(r){const e={};r.to&&(e.to=r.to),r.from&&(e.from=r.from),r.data&&(e.data=re(r.data));const t="chainId,gasLimit,gasPrice,maxFeePerBlobGas,maxFeePerGas,maxPriorityFeePerGas,value".split(/,/);for(const s of t)!(s in r)||r[s]==null||(e[s]=de(r[s],`request.${s}`));const n="type,nonce".split(/,/);for(const s of n)!(s in r)||r[s]==null||(e[s]=Pe(r[s],`request.${s}`));return r.accessList&&(e.accessList=vc(r.accessList)),r.authorizationList&&(e.authorizationList=r.authorizationList.slice()),"blockTag"in r&&(e.blockTag=r.blockTag),"enableCcipRead"in r&&(e.enableCcipRead=!!r.enableCcipRead),"customData"in r&&(e.customData=r.customData),"blobVersionedHashes"in r&&r.blobVersionedHashes&&(e.blobVersionedHashes=r.blobVersionedHashes.slice()),"kzg"in r&&(e.kzg=r.kzg),"blobs"in r&&r.blobs&&(e.blobs=r.blobs.map(s=>n0(s)?re(s):Object.assign({},s))),e}var bi;class tG{constructor(e,t){L(this,"provider");L(this,"number");L(this,"hash");L(this,"timestamp");L(this,"parentHash");L(this,"parentBeaconBlockRoot");L(this,"nonce");L(this,"difficulty");L(this,"gasLimit");L(this,"gasUsed");L(this,"stateRoot");L(this,"receiptsRoot");L(this,"blobGasUsed");L(this,"excessBlobGas");L(this,"miner");L(this,"prevRandao");L(this,"extraData");L(this,"baseFeePerGas");F(this,bi);_(this,bi,e.transactions.map(n=>typeof n!="string"?new zd(n,t):n)),ye(this,{provider:t,hash:El(e.hash),number:e.number,timestamp:e.timestamp,parentHash:e.parentHash,parentBeaconBlockRoot:e.parentBeaconBlockRoot,nonce:e.nonce,difficulty:e.difficulty,gasLimit:e.gasLimit,gasUsed:e.gasUsed,blobGasUsed:e.blobGasUsed,excessBlobGas:e.excessBlobGas,miner:e.miner,prevRandao:El(e.prevRandao),extraData:e.extraData,baseFeePerGas:El(e.baseFeePerGas),stateRoot:e.stateRoot,receiptsRoot:e.receiptsRoot})}get transactions(){return y(this,bi).map(e=>typeof e=="string"?e:e.hash)}get prefetchedTransactions(){const e=y(this,bi).slice();return e.length===0?[]:(q(typeof e[0]=="object","transactions were not prefetched with block request","UNSUPPORTED_OPERATION",{operation:"transactionResponses()"}),e)}toJSON(){const{baseFeePerGas:e,difficulty:t,extraData:n,gasLimit:s,gasUsed:i,hash:o,miner:a,prevRandao:c,nonce:l,number:u,parentHash:h,parentBeaconBlockRoot:d,stateRoot:f,receiptsRoot:g,timestamp:p,transactions:m}=this;return{_type:"Block",baseFeePerGas:Rt(e),difficulty:Rt(t),extraData:n,gasLimit:Rt(s),gasUsed:Rt(i),blobGasUsed:Rt(this.blobGasUsed),excessBlobGas:Rt(this.excessBlobGas),hash:o,miner:a,prevRandao:c,nonce:l,number:u,parentHash:h,timestamp:p,parentBeaconBlockRoot:d,stateRoot:f,receiptsRoot:g,transactions:m}}[Symbol.iterator](){let e=0;const t=this.transactions;return{next:()=>e<this.length?{value:t[e++],done:!1}:{value:void 0,done:!0}}}get length(){return y(this,bi).length}get date(){return this.timestamp==null?null:new Date(this.timestamp*1e3)}async getTransaction(e){let t;if(typeof e=="number")t=y(this,bi)[e];else{const n=e.toLowerCase();for(const s of y(this,bi))if(typeof s=="string"){if(s!==n)continue;t=s;break}else{if(s.hash!==n)continue;t=s;break}}if(t==null)throw new Error("no such tx");return typeof t=="string"?await this.provider.getTransaction(t):t}getPrefetchedTransaction(e){const t=this.prefetchedTransactions;if(typeof e=="number")return t[e];e=e.toLowerCase();for(const n of t)if(n.hash===e)return n;R(!1,"no matching transaction","indexOrHash",e)}isMined(){return!!this.hash}isLondon(){return!!this.baseFeePerGas}orphanedEvent(){if(!this.isMined())throw new Error("");return rG(this)}}bi=new WeakMap;class Nf{constructor(e,t){L(this,"provider");L(this,"transactionHash");L(this,"blockHash");L(this,"blockNumber");L(this,"removed");L(this,"address");L(this,"data");L(this,"topics");L(this,"index");L(this,"transactionIndex");this.provider=t;const n=Object.freeze(e.topics.slice());ye(this,{transactionHash:e.transactionHash,blockHash:e.blockHash,blockNumber:e.blockNumber,removed:e.removed,address:e.address,data:e.data,topics:n,index:e.index,transactionIndex:e.transactionIndex})}toJSON(){const{address:e,blockHash:t,blockNumber:n,data:s,index:i,removed:o,topics:a,transactionHash:c,transactionIndex:l}=this;return{_type:"log",address:e,blockHash:t,blockNumber:n,data:s,index:i,removed:o,topics:a,transactionHash:c,transactionIndex:l}}async getBlock(){const e=await this.provider.getBlock(this.blockHash);return q(!!e,"failed to find transaction","UNKNOWN_ERROR",{}),e}async getTransaction(){const e=await this.provider.getTransaction(this.transactionHash);return q(!!e,"failed to find transaction","UNKNOWN_ERROR",{}),e}async getTransactionReceipt(){const e=await this.provider.getTransactionReceipt(this.transactionHash);return q(!!e,"failed to find transaction receipt","UNKNOWN_ERROR",{}),e}removedEvent(){return nG(this)}}var Yd;class _x{constructor(e,t){L(this,"provider");L(this,"to");L(this,"from");L(this,"contractAddress");L(this,"hash");L(this,"index");L(this,"blockHash");L(this,"blockNumber");L(this,"logsBloom");L(this,"gasUsed");L(this,"blobGasUsed");L(this,"cumulativeGasUsed");L(this,"gasPrice");L(this,"blobGasPrice");L(this,"type");L(this,"status");L(this,"root");F(this,Yd);_(this,Yd,Object.freeze(e.logs.map(s=>new Nf(s,t))));let n=Cx;e.effectiveGasPrice!=null?n=e.effectiveGasPrice:e.gasPrice!=null&&(n=e.gasPrice),ye(this,{provider:t,to:e.to,from:e.from,contractAddress:e.contractAddress,hash:e.hash,index:e.index,blockHash:e.blockHash,blockNumber:e.blockNumber,logsBloom:e.logsBloom,gasUsed:e.gasUsed,cumulativeGasUsed:e.cumulativeGasUsed,blobGasUsed:e.blobGasUsed,gasPrice:n,blobGasPrice:e.blobGasPrice,type:e.type,status:e.status,root:e.root})}get logs(){return y(this,Yd)}toJSON(){const{to:e,from:t,contractAddress:n,hash:s,index:i,blockHash:o,blockNumber:a,logsBloom:c,logs:l,status:u,root:h}=this;return{_type:"TransactionReceipt",blockHash:o,blockNumber:a,contractAddress:n,cumulativeGasUsed:Rt(this.cumulativeGasUsed),from:t,gasPrice:Rt(this.gasPrice),blobGasUsed:Rt(this.blobGasUsed),blobGasPrice:Rt(this.blobGasPrice),gasUsed:Rt(this.gasUsed),hash:s,index:i,logs:l,logsBloom:c,root:h,status:u,to:e}}get length(){return this.logs.length}[Symbol.iterator](){let e=0;return{next:()=>e<this.length?{value:this.logs[e++],done:!1}:{value:void 0,done:!0}}}get fee(){return this.gasUsed*this.gasPrice}async getBlock(){const e=await this.provider.getBlock(this.blockHash);if(e==null)throw new Error("TODO");return e}async getTransaction(){const e=await this.provider.getTransaction(this.hash);if(e==null)throw new Error("TODO");return e}async getResult(){return await this.provider.getTransactionResult(this.hash)}async confirmations(){return await this.provider.getBlockNumber()-this.blockNumber+1}removedEvent(){return Ix(this)}reorderedEvent(e){return q(!e||e.isMined(),"unmined 'other' transction cannot be orphaned","UNSUPPORTED_OPERATION",{operation:"reorderedEvent(other)"}),Nx(this,e)}}Yd=new WeakMap;var go;const _0=class _0{constructor(e,t){L(this,"provider");L(this,"blockNumber");L(this,"blockHash");L(this,"index");L(this,"hash");L(this,"type");L(this,"to");L(this,"from");L(this,"nonce");L(this,"gasLimit");L(this,"gasPrice");L(this,"maxPriorityFeePerGas");L(this,"maxFeePerGas");L(this,"maxFeePerBlobGas");L(this,"data");L(this,"value");L(this,"chainId");L(this,"signature");L(this,"accessList");L(this,"blobVersionedHashes");L(this,"authorizationList");F(this,go);this.provider=t,this.blockNumber=e.blockNumber!=null?e.blockNumber:null,this.blockHash=e.blockHash!=null?e.blockHash:null,this.hash=e.hash,this.index=e.index,this.type=e.type,this.from=e.from,this.to=e.to||null,this.gasLimit=e.gasLimit,this.nonce=e.nonce,this.data=e.data,this.value=e.value,this.gasPrice=e.gasPrice,this.maxPriorityFeePerGas=e.maxPriorityFeePerGas!=null?e.maxPriorityFeePerGas:null,this.maxFeePerGas=e.maxFeePerGas!=null?e.maxFeePerGas:null,this.maxFeePerBlobGas=e.maxFeePerBlobGas!=null?e.maxFeePerBlobGas:null,this.chainId=e.chainId,this.signature=e.signature,this.accessList=e.accessList!=null?e.accessList:null,this.blobVersionedHashes=e.blobVersionedHashes!=null?e.blobVersionedHashes:null,this.authorizationList=e.authorizationList!=null?e.authorizationList:null,_(this,go,-1)}toJSON(){const{blockNumber:e,blockHash:t,index:n,hash:s,type:i,to:o,from:a,nonce:c,data:l,signature:u,accessList:h,blobVersionedHashes:d}=this;return{_type:"TransactionResponse",accessList:h,blockNumber:e,blockHash:t,blobVersionedHashes:d,chainId:Rt(this.chainId),data:l,from:a,gasLimit:Rt(this.gasLimit),gasPrice:Rt(this.gasPrice),hash:s,maxFeePerGas:Rt(this.maxFeePerGas),maxPriorityFeePerGas:Rt(this.maxPriorityFeePerGas),maxFeePerBlobGas:Rt(this.maxFeePerBlobGas),nonce:c,signature:u,to:o,index:n,type:i,value:Rt(this.value)}}async getBlock(){let e=this.blockNumber;if(e==null){const n=await this.getTransaction();n&&(e=n.blockNumber)}if(e==null)return null;const t=this.provider.getBlock(e);if(t==null)throw new Error("TODO");return t}async getTransaction(){return this.provider.getTransaction(this.hash)}async confirmations(){if(this.blockNumber==null){const{tx:t,blockNumber:n}=await Pr({tx:this.getTransaction(),blockNumber:this.provider.getBlockNumber()});return t==null||t.blockNumber==null?0:n-t.blockNumber+1}return await this.provider.getBlockNumber()-this.blockNumber+1}async wait(e,t){const n=e??1,s=t??0;let i=y(this,go),o=-1,a=i===-1;const c=async()=>{if(a)return null;const{blockNumber:d,nonce:f}=await Pr({blockNumber:this.provider.getBlockNumber(),nonce:this.provider.getTransactionCount(this.from)});if(f<this.nonce){i=d;return}if(a)return null;const g=await this.getTransaction();if(!(g&&g.blockNumber!=null))for(o===-1&&(o=i-3,o<y(this,go)&&(o=y(this,go)));o<=d;){if(a)return null;const p=await this.provider.getBlock(o,!0);if(p==null)return;for(const m of p)if(m===this.hash)return;for(let m=0;m<p.length;m++){const w=await p.getTransaction(m);if(w.from===this.from&&w.nonce===this.nonce){if(a)return null;const A=await this.provider.getTransactionReceipt(w.hash);if(A==null||d-A.blockNumber+1<n)return;let v="replaced";w.data===this.data&&w.to===this.to&&w.value===this.value?v="repriced":w.data==="0x"&&w.from===w.to&&w.value===Cx&&(v="cancelled"),q(!1,"transaction was replaced","TRANSACTION_REPLACED",{cancelled:v==="replaced"||v==="cancelled",reason:v,replacement:w.replaceableTransaction(i),hash:w.hash,receipt:A})}}o++}},l=d=>{if(d==null||d.status!==0)return d;q(!1,"transaction execution reverted","CALL_EXCEPTION",{action:"sendTransaction",data:null,reason:null,invocation:null,revert:null,transaction:{to:d.to,from:d.from,data:""},receipt:d})},u=await this.provider.getTransactionReceipt(this.hash);if(n===0)return l(u);if(u){if(await u.confirmations()>=n)return l(u)}else if(await c(),n===0)return null;return await new Promise((d,f)=>{const g=[],p=()=>{g.forEach(w=>w())};if(g.push(()=>{a=!0}),s>0){const w=setTimeout(()=>{p(),f(Ct("wait for transaction timeout","TIMEOUT"))},s);g.push(()=>{clearTimeout(w)})}const m=async w=>{if(await w.confirmations()>=n){p();try{d(l(w))}catch(A){f(A)}}};if(g.push(()=>{this.provider.off(this.hash,m)}),this.provider.on(this.hash,m),i>=0){const w=async()=>{try{await c()}catch(A){if(lr(A,"TRANSACTION_REPLACED")){p(),f(A);return}}a||this.provider.once("block",w)};g.push(()=>{this.provider.off("block",w)}),this.provider.once("block",w)}})}isMined(){return this.blockHash!=null}isLegacy(){return this.type===0}isBerlin(){return this.type===1}isLondon(){return this.type===2}isCancun(){return this.type===3}removedEvent(){return q(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),Ix(this)}reorderedEvent(e){return q(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),q(!e||e.isMined(),"unmined 'other' transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),Nx(this,e)}replaceableTransaction(e){R(Number.isInteger(e)&&e>=0,"invalid startBlock","startBlock",e);const t=new _0(this,this.provider);return _(t,go,e),t}};go=new WeakMap;let zd=_0;function rG(r){return{orphan:"drop-block",hash:r.hash,number:r.number}}function Nx(r,e){return{orphan:"reorder-transaction",tx:r,other:e}}function Ix(r){return{orphan:"drop-transaction",tx:r}}function nG(r){return{orphan:"drop-log",log:{transactionHash:r.transactionHash,blockHash:r.blockHash,blockNumber:r.blockNumber,address:r.address,data:r.data,topics:Object.freeze(r.topics.slice()),index:r.index}}}class y0 extends Nf{constructor(t,n,s){super(t,t.provider);L(this,"interface");L(this,"fragment");L(this,"args");const i=n.decodeEventLog(s,t.data,t.topics);ye(this,{args:i,fragment:s,interface:n})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}class Sx extends Nf{constructor(t,n){super(t,t.provider);L(this,"error");ye(this,{error:n})}}var Kl;class sG extends _x{constructor(t,n,s){super(s,n);F(this,Kl);_(this,Kl,t)}get logs(){return super.logs.map(t=>{const n=t.topics.length?y(this,Kl).getEvent(t.topics[0]):null;if(n)try{return new y0(t,y(this,Kl),n)}catch(s){return new Sx(t,s)}return t})}}Kl=new WeakMap;var Qd;class w0 extends zd{constructor(t,n,s){super(s,n);F(this,Qd);_(this,Qd,t)}async wait(t,n){const s=await super.wait(t,n);return s==null?null:new sG(y(this,Qd),this.provider,s)}}Qd=new WeakMap;class xx extends QI{constructor(t,n,s,i){super(t,n,s);L(this,"log");ye(this,{log:i})}async getBlock(){return await this.log.getBlock()}async getTransaction(){return await this.log.getTransaction()}async getTransactionReceipt(){return await this.log.getTransactionReceipt()}}class iG extends xx{constructor(e,t,n,s,i){super(e,t,n,new y0(i,e.interface,s));const o=e.interface.decodeEventLog(s,this.log.data,this.log.topics);ye(this,{args:o,fragment:s})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}const fC=BigInt(0);function Tx(r){return r&&typeof r.call=="function"}function Px(r){return r&&typeof r.estimateGas=="function"}function am(r){return r&&typeof r.resolveName=="function"}function Ox(r){return r&&typeof r.sendTransaction=="function"}function Rx(r){if(r!=null){if(am(r))return r;if(r.provider)return r.provider}}var Zd;class oG{constructor(e,t,n){F(this,Zd);L(this,"fragment");if(ye(this,{fragment:t}),t.inputs.length<n.length)throw new Error("too many arguments");const s=hc(e.runner,"resolveName"),i=am(s)?s:null;_(this,Zd,async function(){const o=await Promise.all(t.inputs.map((a,c)=>n[c]==null?null:a.walkAsync(n[c],(u,h)=>u==="address"?Array.isArray(h)?Promise.all(h.map(d=>Dr(d,i))):Dr(h,i):h)));return e.interface.encodeFilterTopics(t,o)}())}getTopicFilter(){return y(this,Zd)}}Zd=new WeakMap;function hc(r,e){return r==null?null:typeof r[e]=="function"?r:r.provider&&typeof r.provider[e]=="function"?r.provider:null}function va(r){return r==null?null:r.provider||null}async function Dx(r,e){const t=Cr.dereference(r,"overrides");R(typeof t=="object","invalid overrides parameter","overrides",r);const n=pg(t);return R(n.to==null||(e||[]).indexOf("to")>=0,"cannot override to","overrides.to",n.to),R(n.data==null||(e||[]).indexOf("data")>=0,"cannot override data","overrides.data",n.data),n.from&&(n.from=n.from),n}async function aG(r,e,t){const n=hc(r,"resolveName"),s=am(n)?n:null;return await Promise.all(e.map((i,o)=>i.walkAsync(t[o],(a,c)=>(c=Cr.dereference(c,a),a==="address"?Dr(c,s):c))))}function cG(r){const e=async function(o){const a=await Dx(o,["data"]);a.to=await r.getAddress(),a.from&&(a.from=await Dr(a.from,Rx(r.runner)));const c=r.interface,l=de(a.value||fC,"overrides.value")===fC,u=(a.data||"0x")==="0x";c.fallback&&!c.fallback.payable&&c.receive&&!u&&!l&&R(!1,"cannot send data to receive or send value to non-payable fallback","overrides",o),R(c.fallback||u,"cannot send data to receive-only contract","overrides.data",a.data);const h=c.receive||c.fallback&&c.fallback.payable;return R(h||l,"cannot send value to non-payable fallback","overrides.value",a.value),R(c.fallback||u,"cannot send data to receive-only contract","overrides.data",a.data),a},t=async function(o){const a=hc(r.runner,"call");q(Tx(a),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const c=await e(o);try{return await a.call(c)}catch(l){throw r0(l)&&l.data?r.interface.makeError(l.data,c):l}},n=async function(o){const a=r.runner;q(Ox(a),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const c=await a.sendTransaction(await e(o)),l=va(r.runner);return new w0(r.interface,l,c)},s=async function(o){const a=hc(r.runner,"estimateGas");return q(Px(a),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await a.estimateGas(await e(o))},i=async o=>await n(o);return ye(i,{_contract:r,estimateGas:s,populateTransaction:e,send:n,staticCall:t}),i}function lG(r,e){const t=function(...l){const u=r.interface.getFunction(e,l);return q(u,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e,args:l}}),u},n=async function(...l){const u=t(...l);let h={};if(u.inputs.length+1===l.length&&(h=await Dx(l.pop()),h.from&&(h.from=await Dr(h.from,Rx(r.runner)))),u.inputs.length!==l.length)throw new Error("internal error: fragment inputs doesn't match arguments; should not happen");const d=await aG(r.runner,u.inputs,l);return Object.assign({},h,await Pr({to:r.getAddress(),data:r.interface.encodeFunctionData(u,d)}))},s=async function(...l){const u=await a(...l);return u.length===1?u[0]:u},i=async function(...l){const u=r.runner;q(Ox(u),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const h=await u.sendTransaction(await n(...l)),d=va(r.runner);return new w0(r.interface,d,h)},o=async function(...l){const u=hc(r.runner,"estimateGas");return q(Px(u),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await u.estimateGas(await n(...l))},a=async function(...l){const u=hc(r.runner,"call");q(Tx(u),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const h=await n(...l);let d="0x";try{d=await u.call(h)}catch(g){throw r0(g)&&g.data?r.interface.makeError(g.data,h):g}const f=t(...l);return r.interface.decodeFunctionResult(f,d)},c=async(...l)=>t(...l).constant?await s(...l):await i(...l);return ye(c,{name:r.interface.getFunctionName(e),_contract:r,_key:e,getFragment:t,estimateGas:o,populateTransaction:n,send:i,staticCall:s,staticCallResult:a}),Object.defineProperty(c,"fragment",{configurable:!1,enumerable:!0,get:()=>{const l=r.interface.getFunction(e);return q(l,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e}}),l}}),c}function uG(r,e){const t=function(...s){const i=r.interface.getEvent(e,s);return q(i,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e,args:s}}),i},n=function(...s){return new oG(r,t(...s),s)};return ye(n,{name:r.interface.getEventName(e),_contract:r,_key:e,getFragment:t}),Object.defineProperty(n,"fragment",{configurable:!1,enumerable:!0,get:()=>{const s=r.interface.getEvent(e);return q(s,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e}}),s}}),n}const gg=Symbol.for("_ethersInternal_contract"),kx=new WeakMap;function hG(r,e){kx.set(r[gg],e)}function un(r){return kx.get(r[gg])}function dG(r){return r&&typeof r=="object"&&"getTopicFilter"in r&&typeof r.getTopicFilter=="function"&&r.fragment}async function b0(r,e){let t,n=null;if(Array.isArray(e)){const i=function(o){if(pt(o,32))return o;const a=r.interface.getEvent(o);return R(a,"unknown fragment","name",o),a.topicHash};t=e.map(o=>o==null?null:Array.isArray(o)?o.map(i):i(o))}else e==="*"?t=[null]:typeof e=="string"?pt(e,32)?t=[e]:(n=r.interface.getEvent(e),R(n,"unknown fragment","event",e),t=[n.topicHash]):dG(e)?t=await e.getTopicFilter():"fragment"in e?(n=e.fragment,t=[n.topicHash]):R(!1,"unknown event name","event",e);t=t.map(i=>{if(i==null)return null;if(Array.isArray(i)){const o=Array.from(new Set(i.map(a=>a.toLowerCase())).values());return o.length===1?o[0]:(o.sort(),o)}return i.toLowerCase()});const s=t.map(i=>i==null?"null":Array.isArray(i)?i.join("|"):i).join("&");return{fragment:n,tag:s,topics:t}}async function Nh(r,e){const{subs:t}=un(r);return t.get((await b0(r,e)).tag)||null}async function pC(r,e,t){const n=va(r.runner);q(n,"contract runner does not support subscribing","UNSUPPORTED_OPERATION",{operation:e});const{fragment:s,tag:i,topics:o}=await b0(r,t),{addr:a,subs:c}=un(r);let l=c.get(i);if(!l){const h={address:a||r,topics:o},d=m=>{let w=s;if(w==null)try{w=r.interface.getEvent(m.topics[0])}catch{}if(w){const A=w,v=s?r.interface.decodeEventLog(s,m.data,m.topics):[];ib(r,t,v,N=>new iG(r,N,t,A,m))}else ib(r,t,[],A=>new xx(r,A,t,m))};let f=[];l={tag:i,listeners:[],start:()=>{f.length||f.push(n.on(h,d))},stop:async()=>{if(f.length==0)return;let m=f;f=[],await Promise.all(m),n.off(h,d)}},c.set(i,l)}return l}let sb=Promise.resolve();async function fG(r,e,t,n){await sb;const s=await Nh(r,e);if(!s)return!1;const i=s.listeners.length;return s.listeners=s.listeners.filter(({listener:o,once:a})=>{const c=Array.from(t);n&&c.push(n(a?null:o));try{o.call(r,...c)}catch{}return!a}),s.listeners.length===0&&(s.stop(),un(r).subs.delete(s.tag)),i>0}async function ib(r,e,t,n){try{await sb}catch{}const s=fG(r,e,t,n);return sb=s,await s}const lp=["then"];var IC;IC=gg;const jh=class jh{constructor(e,t,n,s){L(this,"target");L(this,"interface");L(this,"runner");L(this,"filters");L(this,IC);L(this,"fallback");R(typeof e=="string"||MS(e),"invalid value for Contract target","target",e),n==null&&(n=null);const i=nb.from(t);ye(this,{target:e,runner:n,interface:i}),Object.defineProperty(this,gg,{value:{}});let o,a=null,c=null;if(s){const h=va(n);c=new w0(this.interface,h,s)}let l=new Map;if(typeof e=="string")if(pt(e))a=e,o=Promise.resolve(e);else{const h=hc(n,"resolveName");if(!am(h))throw Ct("contract runner does not support name resolution","UNSUPPORTED_OPERATION",{operation:"resolveName"});o=h.resolveName(e).then(d=>{if(d==null)throw Ct("an ENS name used for a contract target must be correctly configured","UNCONFIGURED_NAME",{value:e});return un(this).addr=d,d})}else o=e.getAddress().then(h=>{if(h==null)throw new Error("TODO");return un(this).addr=h,h});hG(this,{addrPromise:o,addr:a,deployTx:c,subs:l});const u=new Proxy({},{get:(h,d,f)=>{if(typeof d=="symbol"||lp.indexOf(d)>=0)return Reflect.get(h,d,f);try{return this.getEvent(d)}catch(g){if(!lr(g,"INVALID_ARGUMENT")||g.argument!=="key")throw g}},has:(h,d)=>lp.indexOf(d)>=0?Reflect.has(h,d):Reflect.has(h,d)||this.interface.hasEvent(String(d))});return ye(this,{filters:u}),ye(this,{fallback:i.receive||i.fallback?cG(this):null}),new Proxy(this,{get:(h,d,f)=>{if(typeof d=="symbol"||d in h||lp.indexOf(d)>=0)return Reflect.get(h,d,f);try{return h.getFunction(d)}catch(g){if(!lr(g,"INVALID_ARGUMENT")||g.argument!=="key")throw g}},has:(h,d)=>typeof d=="symbol"||d in h||lp.indexOf(d)>=0?Reflect.has(h,d):h.interface.hasFunction(d)})}connect(e){return new jh(this.target,this.interface,e)}attach(e){return new jh(e,this.interface,this.runner)}async getAddress(){return await un(this).addrPromise}async getDeployedCode(){const e=va(this.runner);q(e,"runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"getDeployedCode"});const t=await e.getCode(await this.getAddress());return t==="0x"?null:t}async waitForDeployment(){const e=this.deploymentTransaction();if(e)return await e.wait(),this;if(await this.getDeployedCode()!=null)return this;const n=va(this.runner);return q(n!=null,"contract runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"waitForDeployment"}),new Promise((s,i)=>{const o=async()=>{try{if(await this.getDeployedCode()!=null)return s(this);n.once("block",o)}catch(a){i(a)}};o()})}deploymentTransaction(){return un(this).deployTx}getFunction(e){return typeof e!="string"&&(e=e.format()),lG(this,e)}getEvent(e){return typeof e!="string"&&(e=e.format()),uG(this,e)}async queryTransaction(e){throw new Error("@TODO")}async queryFilter(e,t,n){t==null&&(t=0),n==null&&(n="latest");const{addr:s,addrPromise:i}=un(this),o=s||await i,{fragment:a,topics:c}=await b0(this,e),l={address:o,topics:c,fromBlock:t,toBlock:n},u=va(this.runner);return q(u,"contract runner does not have a provider","UNSUPPORTED_OPERATION",{operation:"queryFilter"}),(await u.getLogs(l)).map(h=>{let d=a;if(d==null)try{d=this.interface.getEvent(h.topics[0])}catch{}if(d)try{return new y0(h,this.interface,d)}catch(f){return new Sx(h,f)}return new Nf(h,u)})}async on(e,t){const n=await pC(this,"on",e);return n.listeners.push({listener:t,once:!1}),n.start(),this}async once(e,t){const n=await pC(this,"once",e);return n.listeners.push({listener:t,once:!0}),n.start(),this}async emit(e,...t){return await ib(this,e,t,null)}async listenerCount(e){if(e){const s=await Nh(this,e);return s?s.listeners.length:0}const{subs:t}=un(this);let n=0;for(const{listeners:s}of t.values())n+=s.length;return n}async listeners(e){if(e){const s=await Nh(this,e);return s?s.listeners.map(({listener:i})=>i):[]}const{subs:t}=un(this);let n=[];for(const{listeners:s}of t.values())n=n.concat(s.map(({listener:i})=>i));return n}async off(e,t){const n=await Nh(this,e);if(!n)return this;if(t){const s=n.listeners.map(({listener:i})=>i).indexOf(t);s>=0&&n.listeners.splice(s,1)}return(t==null||n.listeners.length===0)&&(n.stop(),un(this).subs.delete(n.tag)),this}async removeAllListeners(e){if(e){const t=await Nh(this,e);if(!t)return this;t.stop(),un(this).subs.delete(t.tag)}else{const{subs:t}=un(this);for(const{tag:n,stop:s}of t.values())s(),t.delete(n)}return this}async addListener(e,t){return await this.on(e,t)}async removeListener(e,t){return await this.off(e,t)}static buildClass(e){class t extends jh{constructor(s,i=null){super(s,e,i)}}return t}static from(e,t,n){return n==null&&(n=null),new this(e,t,n)}};let ob=jh;function pG(){return ob}class Ja extends pG(){}function Oy(r){return r.match(/^ipfs:\/\/ipfs\//i)?r=r.substring(12):r.match(/^ipfs:\/\//i)?r=r.substring(7):R(!1,"unsupported IPFS format","link",r),`https://gateway.ipfs.io/ipfs/${r}`}class gG{constructor(e){L(this,"name");ye(this,{name:e})}connect(e){return this}supportsCoinType(e){return!1}async encodeAddress(e,t){throw new Error("unsupported coin")}async decodeAddress(e,t){throw new Error("unsupported coin")}}const Ux=new RegExp("^(ipfs)://(.*)$","i"),gC=[new RegExp("^(https)://(.*)$","i"),new RegExp("^(data):(.*)$","i"),Ux,new RegExp("^eip155:[0-9]+/(erc[0-9]+):(.*)$","i")];var mo,ka,yo,sl,vg,Bx;const ul=class ul{constructor(e,t,n){F(this,yo);L(this,"provider");L(this,"address");L(this,"name");F(this,mo);F(this,ka);ye(this,{provider:e,address:t,name:n}),_(this,mo,null),_(this,ka,new Ja(t,["function supportsInterface(bytes4) view returns (bool)","function resolve(bytes, bytes) view returns (bytes)","function addr(bytes32) view returns (address)","function addr(bytes32, uint) view returns (bytes)","function text(bytes32, string) view returns (string)","function contenthash(bytes32) view returns (bytes)"],e))}async supportsWildcard(){return y(this,mo)==null&&_(this,mo,(async()=>{try{return await y(this,ka).supportsInterface("0x9061b923")}catch(e){if(lr(e,"CALL_EXCEPTION"))return!1;throw _(this,mo,null),e}})()),await y(this,mo)}async getAddress(e){if(e==null&&(e=60),e===60)try{const i=await W(this,yo,sl).call(this,"addr(bytes32)");return i==null||i===Ud?null:i}catch(i){if(lr(i,"CALL_EXCEPTION"))return null;throw i}if(e>=0&&e<2147483648){let i=e+2147483648;const o=await W(this,yo,sl).call(this,"addr(bytes32,uint)",[i]);if(pt(o,20))return nt(o)}let t=null;for(const i of this.provider.plugins)if(i instanceof gG&&i.supportsCoinType(e)){t=i;break}if(t==null)return null;const n=await W(this,yo,sl).call(this,"addr(bytes32,uint)",[e]);if(n==null||n==="0x")return null;const s=await t.decodeAddress(e,n);if(s!=null)return s;q(!1,"invalid coin data","UNSUPPORTED_OPERATION",{operation:`getAddress(${e})`,info:{coinType:e,data:n}})}async getText(e){const t=await W(this,yo,sl).call(this,"text(bytes32,string)",[e]);return t==null||t==="0x"?null:t}async getContentHash(){const e=await W(this,yo,sl).call(this,"contenthash(bytes32)");if(e==null||e==="0x")return null;const t=e.match(/^0x(e3010170|e5010172)(([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f]*))$/);if(t){const s=t[1]==="e3010170"?"ipfs":"ipns",i=parseInt(t[4],16);if(t[5].length===i*2)return`${s}://${Ez("0x"+t[2])}`}const n=e.match(/^0xe40101fa011b20([0-9a-f]*)$/);if(n&&n[1].length===64)return`bzz://${n[1]}`;q(!1,"invalid or unsupported content hash data","UNSUPPORTED_OPERATION",{operation:"getContentHash()",info:{data:e}})}async getAvatar(){return(await this._getAvatar()).url}async _getAvatar(){const e=[{type:"name",value:this.name}];try{const t=await this.getText("avatar");if(t==null)return e.push({type:"!avatar",value:""}),{url:null,linkage:e};e.push({type:"avatar",value:t});for(let n=0;n<gC.length;n++){const s=t.match(gC[n]);if(s==null)continue;const i=s[1].toLowerCase();switch(i){case"https":case"data":return e.push({type:"url",value:t}),{linkage:e,url:t};case"ipfs":{const o=Oy(t);return e.push({type:"ipfs",value:t}),e.push({type:"url",value:o}),{linkage:e,url:o}}case"erc721":case"erc1155":{const o=i==="erc721"?"tokenURI(uint256)":"uri(uint256)";e.push({type:i,value:t});const a=await this.getAddress();if(a==null)return e.push({type:"!owner",value:""}),{url:null,linkage:e};const c=(s[2]||"").split("/");if(c.length!==2)return e.push({type:`!${i}caip`,value:s[2]||""}),{url:null,linkage:e};const l=c[1],u=new Ja(c[0],["function tokenURI(uint) view returns (string)","function ownerOf(uint) view returns (address)","function uri(uint) view returns (string)","function balanceOf(address, uint256) view returns (uint)"],this.provider);if(i==="erc721"){const p=await u.ownerOf(l);if(a!==p)return e.push({type:"!owner",value:p}),{url:null,linkage:e};e.push({type:"owner",value:p})}else if(i==="erc1155"){const p=await u.balanceOf(a,l);if(!p)return e.push({type:"!balance",value:"0"}),{url:null,linkage:e};e.push({type:"balance",value:p.toString()})}let h=await u[o](l);if(h==null||h==="0x")return e.push({type:"!metadata-url",value:""}),{url:null,linkage:e};e.push({type:"metadata-url-base",value:h}),i==="erc1155"&&(h=h.replace("{id}",Lo(l,32).substring(2)),e.push({type:"metadata-url-expanded",value:h})),h.match(/^ipfs:/i)&&(h=Oy(h)),e.push({type:"metadata-url",value:h});let d={};const f=await new Mi(h).send();f.assertOk();try{d=f.bodyJson}catch{try{e.push({type:"!metadata",value:f.bodyText})}catch{const w=f.body;return w&&e.push({type:"!metadata",value:re(w)}),{url:null,linkage:e}}return{url:null,linkage:e}}if(!d)return e.push({type:"!metadata",value:""}),{url:null,linkage:e};e.push({type:"metadata",value:JSON.stringify(d)});let g=d.image;if(typeof g!="string")return e.push({type:"!imageUrl",value:""}),{url:null,linkage:e};if(!g.match(/^(https:\/\/|data:)/i)){if(g.match(Ux)==null)return e.push({type:"!imageUrl-ipfs",value:g}),{url:null,linkage:e};e.push({type:"imageUrl-ipfs",value:g}),g=Oy(g)}return e.push({type:"url",value:g}),{linkage:e,url:g}}}}}catch{}return{linkage:e,url:null}}static async getEnsAddress(e){const t=await e.getNetwork(),n=t.getPlugin("org.ethers.plugins.network.Ens");return q(n,"network does not support ENS","UNSUPPORTED_OPERATION",{operation:"getEnsAddress",info:{network:t}}),n.address}static async fromName(e,t){var s;let n=t;for(;;){if(n===""||n==="."||t!=="eth"&&n==="eth")return null;const i=await W(s=ul,vg,Bx).call(s,e,n);if(i!=null){const o=new ul(e,i,t);return n!==t&&!await o.supportsWildcard()?null:o}n=n.split(".").slice(1).join(".")}}};mo=new WeakMap,ka=new WeakMap,yo=new WeakSet,sl=async function(e,t){t=(t||[]).slice();const n=y(this,ka).interface;t.unshift(tb(this.name));let s=null;await this.supportsWildcard()&&(s=n.getFunction(e),q(s,"missing fragment","UNKNOWN_ERROR",{info:{funcName:e}}),t=[PW(this.name,255),n.encodeFunctionData(s,t)],e="resolve(bytes,bytes)"),t.push({enableCcipRead:!0});try{const i=await y(this,ka)[e](...t);return s?n.decodeFunctionResult(s,i)[0]:i}catch(i){if(!lr(i,"CALL_EXCEPTION"))throw i}return null},vg=new WeakSet,Bx=async function(e,t){const n=await ul.getEnsAddress(e);try{const i=await new Ja(n,["function resolver(bytes32) view returns (address)"],e).resolver(tb(t),{enableCcipRead:!0});return i===Ud?null:i}catch(s){throw s}return null},F(ul,vg);let mg=ul;const mC=BigInt(0);function He(r,e){return function(t){return t==null?e:r(t)}}function qd(r,e){return t=>{if(e&&t==null)return null;if(!Array.isArray(t))throw new Error("not an array");return t.map(n=>r(n))}}function If(r,e){return t=>{const n={};for(const s in r){let i=s;if(e&&s in e&&!(i in t)){for(const o of e[s])if(o in t){i=o;break}}try{const o=r[s](t[i]);o!==void 0&&(n[s]=o)}catch(o){const a=o instanceof Error?o.message:"not-an-error";q(!1,`invalid value for value.${s} (${a})`,"BAD_DATA",{value:t})}}return n}}function mG(r){switch(r){case!0:case"true":return!0;case!1:case"false":return!1}R(!1,`invalid boolean; ${JSON.stringify(r)}`,"value",r)}function Du(r){return R(pt(r,!0),"invalid data","value",r),r}function cr(r){return R(pt(r,32),"invalid hash","value",r),r}const yG=If({address:nt,blockHash:cr,blockNumber:Pe,data:Du,index:Pe,removed:He(mG,!1),topics:qd(cr),transactionHash:cr,transactionIndex:Pe},{index:["logIndex"]});function wG(r){return yG(r)}const bG=If({hash:He(cr),parentHash:cr,parentBeaconBlockRoot:He(cr,null),number:Pe,timestamp:Pe,nonce:He(Du),difficulty:de,gasLimit:de,gasUsed:de,stateRoot:He(cr,null),receiptsRoot:He(cr,null),blobGasUsed:He(de,null),excessBlobGas:He(de,null),miner:He(nt),prevRandao:He(cr,null),extraData:Du,baseFeePerGas:He(de)},{prevRandao:["mixHash"]});function EG(r){const e=bG(r);return e.transactions=r.transactions.map(t=>typeof t=="string"?t:Lx(t)),e}const vG=If({transactionIndex:Pe,blockNumber:Pe,transactionHash:cr,address:nt,topics:qd(cr),data:Du,index:Pe,blockHash:cr},{index:["logIndex"]});function AG(r){return vG(r)}const CG=If({to:He(nt,null),from:He(nt,null),contractAddress:He(nt,null),index:Pe,root:He(re),gasUsed:de,blobGasUsed:He(de,null),logsBloom:He(Du),blockHash:cr,hash:cr,logs:qd(AG),blockNumber:Pe,cumulativeGasUsed:de,effectiveGasPrice:He(de),blobGasPrice:He(de,null),status:He(Pe),type:He(Pe,0)},{effectiveGasPrice:["gasPrice"],hash:["transactionHash"],index:["transactionIndex"]});function _G(r){return CG(r)}function Lx(r){r.to&&de(r.to)===mC&&(r.to="0x0000000000000000000000000000000000000000");const e=If({hash:cr,index:He(Pe,void 0),type:t=>t==="0x"||t==null?0:Pe(t),accessList:He(vc,null),blobVersionedHashes:He(qd(cr,!0),null),authorizationList:He(qd(t=>({address:nt(t.address),chainId:de(t.chainId),nonce:de(t.nonce),signature:Yr.from(t.signature?t.signature:t)}),!1),null),blockHash:He(cr,null),blockNumber:He(Pe,null),transactionIndex:He(Pe,null),from:nt,gasPrice:He(de),maxPriorityFeePerGas:He(de),maxFeePerGas:He(de),maxFeePerBlobGas:He(de,null),gasLimit:de,to:He(nt,null),value:de,nonce:Pe,data:Du,creates:He(nt,null),chainId:He(de,null)},{data:["input"],gasLimit:["gas"],index:["transactionIndex"]})(r);if(e.to==null&&e.creates==null&&(e.creates=dV(e)),(r.type===1||r.type===2)&&r.accessList==null&&(e.accessList=[]),r.signature?e.signature=Yr.from(r.signature):e.signature=Yr.from(r),e.chainId==null){const t=e.signature.legacyChainId;t!=null&&(e.chainId=t)}return e.blockHash&&de(e.blockHash)===mC&&(e.blockHash=null),e}const NG="0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e";class Sf{constructor(e){L(this,"name");ye(this,{name:e})}clone(){return new Sf(this.name)}}class cm extends Sf{constructor(t,n){t==null&&(t=0);super(`org.ethers.network.plugins.GasCost#${t||0}`);L(this,"effectiveBlock");L(this,"txBase");L(this,"txCreate");L(this,"txDataZero");L(this,"txDataNonzero");L(this,"txAccessListStorageKey");L(this,"txAccessListAddress");const s={effectiveBlock:t};function i(o,a){let c=(n||{})[o];c==null&&(c=a),R(typeof c=="number",`invalud value for ${o}`,"costs",n),s[o]=c}i("txBase",21e3),i("txCreate",32e3),i("txDataZero",4),i("txDataNonzero",16),i("txAccessListStorageKey",1900),i("txAccessListAddress",2400),ye(this,s)}clone(){return new cm(this.effectiveBlock,this)}}class lm extends Sf{constructor(t,n){super("org.ethers.plugins.network.Ens");L(this,"address");L(this,"targetNetwork");ye(this,{address:t||NG,targetNetwork:n??1})}clone(){return new lm(this.address,this.targetNetwork)}}var Xd,ef;class IG extends Sf{constructor(t,n){super("org.ethers.plugins.network.FetchUrlFeeDataPlugin");F(this,Xd);F(this,ef);_(this,Xd,t),_(this,ef,n)}get url(){return y(this,Xd)}get processFunc(){return y(this,ef)}clone(){return this}}Xd=new WeakMap,ef=new WeakMap;const Ry=new Map;var Jl,Yl,wo;const hl=class hl{constructor(e,t){F(this,Jl);F(this,Yl);F(this,wo);_(this,Jl,e),_(this,Yl,de(t)),_(this,wo,new Map)}toJSON(){return{name:this.name,chainId:String(this.chainId)}}get name(){return y(this,Jl)}set name(e){_(this,Jl,e)}get chainId(){return y(this,Yl)}set chainId(e){_(this,Yl,de(e,"chainId"))}matches(e){if(e==null)return!1;if(typeof e=="string"){try{return this.chainId===de(e)}catch{}return this.name===e}if(typeof e=="number"||typeof e=="bigint"){try{return this.chainId===de(e)}catch{}return!1}if(typeof e=="object"){if(e.chainId!=null){try{return this.chainId===de(e.chainId)}catch{}return!1}return e.name!=null?this.name===e.name:!1}return!1}get plugins(){return Array.from(y(this,wo).values())}attachPlugin(e){if(y(this,wo).get(e.name))throw new Error(`cannot replace existing plugin: ${e.name} `);return y(this,wo).set(e.name,e.clone()),this}getPlugin(e){return y(this,wo).get(e)||null}getPlugins(e){return this.plugins.filter(t=>t.name.split("#")[0]===e)}clone(){const e=new hl(this.name,this.chainId);return this.plugins.forEach(t=>{e.attachPlugin(t.clone())}),e}computeIntrinsicGas(e){const t=this.getPlugin("org.ethers.plugins.network.GasCost")||new cm;let n=t.txBase;if(e.to==null&&(n+=t.txCreate),e.data)for(let s=2;s<e.data.length;s+=2)e.data.substring(s,s+2)==="00"?n+=t.txDataZero:n+=t.txDataNonzero;if(e.accessList){const s=vc(e.accessList);for(const i in s)n+=t.txAccessListAddress+t.txAccessListStorageKey*s[i].storageKeys.length}return n}static from(e){if(SG(),e==null)return hl.from("mainnet");if(typeof e=="number"&&(e=BigInt(e)),typeof e=="string"||typeof e=="bigint"){const t=Ry.get(e);if(t)return t();if(typeof e=="bigint")return new hl("unknown",e);R(!1,"unknown network","network",e)}if(typeof e.clone=="function")return e.clone();if(typeof e=="object"){R(typeof e.name=="string"&&typeof e.chainId=="number","invalid network object name or chainId","network",e);const t=new hl(e.name,e.chainId);return(e.ensAddress||e.ensNetwork!=null)&&t.attachPlugin(new lm(e.ensAddress,e.ensNetwork)),t}R(!1,"invalid network","network",e)}static register(e,t){typeof e=="number"&&(e=BigInt(e));const n=Ry.get(e);n&&R(!1,`conflicting network for ${JSON.stringify(n.name)}`,"nameOrChainId",e),Ry.set(e,t)}};Jl=new WeakMap,Yl=new WeakMap,wo=new WeakMap;let Hs=hl;function yC(r,e){const t=String(r);if(!t.match(/^[0-9.]+$/))throw new Error(`invalid gwei value: ${r}`);const n=t.split(".");if(n.length===1&&n.push(""),n.length!==2)throw new Error(`invalid gwei value: ${r}`);for(;n[1].length<e;)n[1]+="0";if(n[1].length>9){let s=BigInt(n[1].substring(0,9));n[1].substring(9).match(/^0+$/)||s++,n[1]=s.toString()}return BigInt(n[0]+n[1])}function wC(r){return new IG(r,async(e,t,n)=>{n.setHeader("User-Agent","ethers");let s;try{const[i,o]=await Promise.all([n.send(),e()]);s=i;const a=s.bodyJson.standard;return{gasPrice:o.gasPrice,maxFeePerGas:yC(a.maxFee,9),maxPriorityFeePerGas:yC(a.maxPriorityFee,9)}}catch(i){q(!1,`error encountered with polygon gas station (${JSON.stringify(n.url)})`,"SERVER_ERROR",{request:n,response:s,error:i})}})}let bC=!1;function SG(){if(bC)return;bC=!0;function r(e,t,n){const s=function(){const i=new Hs(e,t);return n.ensNetwork!=null&&i.attachPlugin(new lm(null,n.ensNetwork)),i.attachPlugin(new cm),(n.plugins||[]).forEach(o=>{i.attachPlugin(o)}),i};Hs.register(e,s),Hs.register(t,s),n.altNames&&n.altNames.forEach(i=>{Hs.register(i,s)})}r("mainnet",1,{ensNetwork:1,altNames:["homestead"]}),r("ropsten",3,{ensNetwork:3}),r("rinkeby",4,{ensNetwork:4}),r("goerli",5,{ensNetwork:5}),r("kovan",42,{ensNetwork:42}),r("sepolia",11155111,{ensNetwork:11155111}),r("holesky",17e3,{ensNetwork:17e3}),r("classic",61,{}),r("classicKotti",6,{}),r("arbitrum",42161,{ensNetwork:1}),r("arbitrum-goerli",421613,{}),r("arbitrum-sepolia",421614,{}),r("base",8453,{ensNetwork:1}),r("base-goerli",84531,{}),r("base-sepolia",84532,{}),r("bnb",56,{ensNetwork:1}),r("bnbt",97,{}),r("linea",59144,{ensNetwork:1}),r("linea-goerli",59140,{}),r("linea-sepolia",59141,{}),r("matic",137,{ensNetwork:1,plugins:[wC("https://gasstation.polygon.technology/v2")]}),r("matic-amoy",80002,{}),r("matic-mumbai",80001,{altNames:["maticMumbai","maticmum"],plugins:[wC("https://gasstation-testnet.polygon.technology/v2")]}),r("optimism",10,{ensNetwork:1,plugins:[]}),r("optimism-goerli",420,{}),r("optimism-sepolia",11155420,{}),r("xdai",100,{ensNetwork:1})}function ab(r){return JSON.parse(JSON.stringify(r))}var Ei,Rn,bo,Ds,Ql,Op;class xG{constructor(e){F(this,Ql);F(this,Ei);F(this,Rn);F(this,bo);F(this,Ds);_(this,Ei,e),_(this,Rn,null),_(this,bo,4e3),_(this,Ds,-2)}get pollingInterval(){return y(this,bo)}set pollingInterval(e){_(this,bo,e)}start(){y(this,Rn)||(_(this,Rn,y(this,Ei)._setTimeout(W(this,Ql,Op).bind(this),y(this,bo))),W(this,Ql,Op).call(this))}stop(){y(this,Rn)&&(y(this,Ei)._clearTimeout(y(this,Rn)),_(this,Rn,null))}pause(e){this.stop(),e&&_(this,Ds,-2)}resume(){this.start()}}Ei=new WeakMap,Rn=new WeakMap,bo=new WeakMap,Ds=new WeakMap,Ql=new WeakSet,Op=async function(){try{const e=await y(this,Ei).getBlockNumber();if(y(this,Ds)===-2){_(this,Ds,e);return}if(e!==y(this,Ds)){for(let t=y(this,Ds)+1;t<=e;t++){if(y(this,Rn)==null)return;await y(this,Ei).emit("block",t)}_(this,Ds,e)}}catch{}y(this,Rn)!=null&&_(this,Rn,y(this,Ei)._setTimeout(W(this,Ql,Op).bind(this),y(this,bo)))};var Ua,Ba,Eo;class E0{constructor(e){F(this,Ua);F(this,Ba);F(this,Eo);_(this,Ua,e),_(this,Eo,!1),_(this,Ba,t=>{this._poll(t,y(this,Ua))})}async _poll(e,t){throw new Error("sub-classes must override this")}start(){y(this,Eo)||(_(this,Eo,!0),y(this,Ba).call(this,-2),y(this,Ua).on("block",y(this,Ba)))}stop(){y(this,Eo)&&(_(this,Eo,!1),y(this,Ua).off("block",y(this,Ba)))}pause(e){this.stop()}resume(){this.start()}}Ua=new WeakMap,Ba=new WeakMap,Eo=new WeakMap;var Zl,vi;class TG extends E0{constructor(t,n){super(t);F(this,Zl);F(this,vi);_(this,Zl,n),_(this,vi,-2)}pause(t){t&&_(this,vi,-2),super.pause(t)}async _poll(t,n){const s=await n.getBlock(y(this,Zl));s!=null&&(y(this,vi)===-2?_(this,vi,s.number):s.number>y(this,vi)&&(n.emit(y(this,Zl),s.number),_(this,vi,s.number)))}}Zl=new WeakMap,vi=new WeakMap;var Ag;class PG extends E0{constructor(t,n){super(t);F(this,Ag);_(this,Ag,ab(n))}async _poll(t,n){throw new Error("@TODO")}}Ag=new WeakMap;var Xl;class OG extends E0{constructor(t,n){super(t);F(this,Xl);_(this,Xl,n)}async _poll(t,n){const s=await n.getTransactionReceipt(y(this,Xl));s&&n.emit(y(this,Xl),s)}}Xl=new WeakMap;var Ai,eu,tu,vo,Dn,Cg,$x;class v0{constructor(e,t){F(this,Cg);F(this,Ai);F(this,eu);F(this,tu);F(this,vo);F(this,Dn);_(this,Ai,e),_(this,eu,ab(t)),_(this,tu,W(this,Cg,$x).bind(this)),_(this,vo,!1),_(this,Dn,-2)}start(){y(this,vo)||(_(this,vo,!0),y(this,Dn)===-2&&y(this,Ai).getBlockNumber().then(e=>{_(this,Dn,e)}),y(this,Ai).on("block",y(this,tu)))}stop(){y(this,vo)&&(_(this,vo,!1),y(this,Ai).off("block",y(this,tu)))}pause(e){this.stop(),e&&_(this,Dn,-2)}resume(){this.start()}}Ai=new WeakMap,eu=new WeakMap,tu=new WeakMap,vo=new WeakMap,Dn=new WeakMap,Cg=new WeakSet,$x=async function(e){if(y(this,Dn)===-2)return;const t=ab(y(this,eu));t.fromBlock=y(this,Dn)+1,t.toBlock=e;const n=await y(this,Ai).getLogs(t);if(n.length===0){y(this,Dn)<e-60&&_(this,Dn,e-60);return}for(const s of n)y(this,Ai).emit(y(this,eu),s),_(this,Dn,s.blockNumber)};const RG=BigInt(2),DG=10;function up(r){return r&&typeof r.then=="function"}function Rp(r,e){return r+":"+JSON.stringify(e,(t,n)=>{if(n==null)return"null";if(typeof n=="bigint")return`bigint:${n.toString()}`;if(typeof n=="string")return n.toLowerCase();if(typeof n=="object"&&!Array.isArray(n)){const s=Object.keys(n);return s.sort(),s.reduce((i,o)=>(i[o]=n[o],i),{})}return n})}class Mx{constructor(e){L(this,"name");ye(this,{name:e})}start(){}stop(){}pause(e){}resume(){}}function kG(r){return JSON.parse(JSON.stringify(r))}function cb(r){return r=Array.from(new Set(r).values()),r.sort(),r}async function Dy(r,e){if(r==null)throw new Error("invalid event");if(Array.isArray(r)&&(r={topics:r}),typeof r=="string")switch(r){case"block":case"debug":case"error":case"finalized":case"network":case"pending":case"safe":return{type:r,tag:r}}if(pt(r,32)){const t=r.toLowerCase();return{type:"transaction",tag:Rp("tx",{hash:t}),hash:t}}if(r.orphan){const t=r;return{type:"orphan",tag:Rp("orphan",t),filter:kG(t)}}if(r.address||r.topics){const t=r,n={topics:(t.topics||[]).map(s=>s==null?null:Array.isArray(s)?cb(s.map(i=>i.toLowerCase())):s.toLowerCase())};if(t.address){const s=[],i=[],o=a=>{pt(a)?s.push(a):i.push((async()=>{s.push(await Dr(a,e))})())};Array.isArray(t.address)?t.address.forEach(o):o(t.address),i.length&&await Promise.all(i),n.address=cb(s.map(a=>a.toLowerCase()))}return{filter:n,tag:Rp("event",n),type:"event"}}R(!1,"unknown ProviderEvent","event",r)}function ky(){return new Date().getTime()}const UG={cacheTimeout:250,pollingInterval:4e3};var Er,Ao,vr,ru,pn,La,Co,Ci,tf,kn,nu,su,Le,an,lb,ub,Ih,hb,Sh,Dp;class BG{constructor(e,t){F(this,Le);F(this,Er);F(this,Ao);F(this,vr);F(this,ru);F(this,pn);F(this,La);F(this,Co);F(this,Ci);F(this,tf);F(this,kn);F(this,nu);F(this,su);if(_(this,su,Object.assign({},UG,t||{})),e==="any")_(this,La,!0),_(this,pn,null);else if(e){const n=Hs.from(e);_(this,La,!1),_(this,pn,Promise.resolve(n)),setTimeout(()=>{this.emit("network",n,null)},0)}else _(this,La,!1),_(this,pn,null);_(this,Ci,-1),_(this,Co,new Map),_(this,Er,new Map),_(this,Ao,new Map),_(this,vr,null),_(this,ru,!1),_(this,tf,1),_(this,kn,new Map),_(this,nu,!1)}get pollingInterval(){return y(this,su).pollingInterval}get provider(){return this}get plugins(){return Array.from(y(this,Ao).values())}attachPlugin(e){if(y(this,Ao).get(e.name))throw new Error(`cannot replace existing plugin: ${e.name} `);return y(this,Ao).set(e.name,e.connect(this)),this}getPlugin(e){return y(this,Ao).get(e)||null}get disableCcipRead(){return y(this,nu)}set disableCcipRead(e){_(this,nu,!!e)}async ccipReadFetch(e,t,n){if(this.disableCcipRead||n.length===0||e.to==null)return null;const s=e.to.toLowerCase(),i=t.toLowerCase(),o=[];for(let a=0;a<n.length;a++){const c=n[a],l=c.replace("{sender}",s).replace("{data}",i),u=new Mi(l);c.indexOf("{data}")===-1&&(u.body={data:i,sender:s}),this.emit("debug",{action:"sendCcipReadFetchRequest",request:u,index:a,urls:n});let h="unknown error",d;try{d=await u.send()}catch(f){o.push(f.message),this.emit("debug",{action:"receiveCcipReadFetchError",request:u,result:{error:f}});continue}try{const f=d.bodyJson;if(f.data)return this.emit("debug",{action:"receiveCcipReadFetchResult",request:u,result:f}),f.data;f.message&&(h=f.message),this.emit("debug",{action:"receiveCcipReadFetchError",request:u,result:f})}catch{}q(d.statusCode<400||d.statusCode>=500,`response not found during CCIP fetch: ${h}`,"OFFCHAIN_FAULT",{reason:"404_MISSING_RESOURCE",transaction:e,info:{url:c,errorMessage:h}}),o.push(h)}q(!1,`error encountered during CCIP fetch: ${o.map(a=>JSON.stringify(a)).join(", ")}`,"OFFCHAIN_FAULT",{reason:"500_SERVER_ERROR",transaction:e,info:{urls:n,errorMessages:o}})}_wrapBlock(e,t){return new tG(EG(e),this)}_wrapLog(e,t){return new Nf(wG(e),this)}_wrapTransactionReceipt(e,t){return new _x(_G(e),this)}_wrapTransactionResponse(e,t){return new zd(Lx(e),this)}_detectNetwork(){q(!1,"sub-classes must implement this","UNSUPPORTED_OPERATION",{operation:"_detectNetwork"})}async _perform(e){q(!1,`unsupported method: ${e.method}`,"UNSUPPORTED_OPERATION",{operation:e.method,info:e})}async getBlockNumber(){const e=Pe(await W(this,Le,an).call(this,{method:"getBlockNumber"}),"%response");return y(this,Ci)>=0&&_(this,Ci,e),e}_getAddress(e){return Dr(e,this)}_getBlockTag(e){if(e==null)return"latest";switch(e){case"earliest":return"0x0";case"finalized":case"latest":case"pending":case"safe":return e}if(pt(e))return pt(e,32)?e:Pi(e);if(typeof e=="bigint"&&(e=Pe(e,"blockTag")),typeof e=="number")return e>=0?Pi(e):y(this,Ci)>=0?Pi(y(this,Ci)+e):this.getBlockNumber().then(t=>Pi(t+e));R(!1,"invalid blockTag","blockTag",e)}_getFilter(e){const t=(e.topics||[]).map(c=>c==null?null:Array.isArray(c)?cb(c.map(l=>l.toLowerCase())):c.toLowerCase()),n="blockHash"in e?e.blockHash:void 0,s=(c,l,u)=>{let h;switch(c.length){case 0:break;case 1:h=c[0];break;default:c.sort(),h=c}if(n&&(l!=null||u!=null))throw new Error("invalid filter");const d={};return h&&(d.address=h),t.length&&(d.topics=t),l&&(d.fromBlock=l),u&&(d.toBlock=u),n&&(d.blockHash=n),d};let i=[];if(e.address)if(Array.isArray(e.address))for(const c of e.address)i.push(this._getAddress(c));else i.push(this._getAddress(e.address));let o;"fromBlock"in e&&(o=this._getBlockTag(e.fromBlock));let a;return"toBlock"in e&&(a=this._getBlockTag(e.toBlock)),i.filter(c=>typeof c!="string").length||o!=null&&typeof o!="string"||a!=null&&typeof a!="string"?Promise.all([Promise.all(i),o,a]).then(c=>s(c[0],c[1],c[2])):s(i,o,a)}_getTransactionRequest(e){const t=pg(e),n=[];if(["to","from"].forEach(s=>{if(t[s]==null)return;const i=Dr(t[s],this);up(i)?n.push(async function(){t[s]=await i}()):t[s]=i}),t.blockTag!=null){const s=this._getBlockTag(t.blockTag);up(s)?n.push(async function(){t.blockTag=await s}()):t.blockTag=s}return n.length?async function(){return await Promise.all(n),t}():t}async getNetwork(){if(y(this,pn)==null){const s=(async()=>{try{const i=await this._detectNetwork();return this.emit("network",i,null),i}catch(i){throw y(this,pn)===s&&_(this,pn,null),i}})();return _(this,pn,s),(await s).clone()}const e=y(this,pn),[t,n]=await Promise.all([e,this._detectNetwork()]);return t.chainId!==n.chainId&&(y(this,La)?(this.emit("network",n,t),y(this,pn)===e&&_(this,pn,Promise.resolve(n))):q(!1,`network changed: ${t.chainId} => ${n.chainId} `,"NETWORK_ERROR",{event:"changed"})),t.clone()}async getFeeData(){const e=await this.getNetwork(),t=async()=>{const{_block:s,gasPrice:i,priorityFee:o}=await Pr({_block:W(this,Le,hb).call(this,"latest",!1),gasPrice:(async()=>{try{const u=await W(this,Le,an).call(this,{method:"getGasPrice"});return de(u,"%response")}catch{}return null})(),priorityFee:(async()=>{try{const u=await W(this,Le,an).call(this,{method:"getPriorityFee"});return de(u,"%response")}catch{}return null})()});let a=null,c=null;const l=this._wrapBlock(s,e);return l&&l.baseFeePerGas&&(c=o??BigInt("1000000000"),a=l.baseFeePerGas*RG+c),new dC(i,a,c)},n=e.getPlugin("org.ethers.plugins.network.FetchUrlFeeDataPlugin");if(n){const s=new Mi(n.url),i=await n.processFunc(t,this,s);return new dC(i.gasPrice,i.maxFeePerGas,i.maxPriorityFeePerGas)}return await t()}async estimateGas(e){let t=this._getTransactionRequest(e);return up(t)&&(t=await t),de(await W(this,Le,an).call(this,{method:"estimateGas",transaction:t}),"%response")}async call(e){const{tx:t,blockTag:n}=await Pr({tx:this._getTransactionRequest(e),blockTag:this._getBlockTag(e.blockTag)});return await W(this,Le,ub).call(this,W(this,Le,lb).call(this,t,n,e.enableCcipRead?0:-1))}async getBalance(e,t){return de(await W(this,Le,Ih).call(this,{method:"getBalance"},e,t),"%response")}async getTransactionCount(e,t){return Pe(await W(this,Le,Ih).call(this,{method:"getTransactionCount"},e,t),"%response")}async getCode(e,t){return re(await W(this,Le,Ih).call(this,{method:"getCode"},e,t))}async getStorage(e,t,n){const s=de(t,"position");return re(await W(this,Le,Ih).call(this,{method:"getStorage",position:s},e,n))}async broadcastTransaction(e){const{blockNumber:t,hash:n,network:s}=await Pr({blockNumber:this.getBlockNumber(),hash:this._perform({method:"broadcastTransaction",signedTransaction:e}),network:this.getNetwork()}),i=ag.from(e);if(i.hash!==n)throw new Error("@TODO: the returned hash did not match");return this._wrapTransactionResponse(i,s).replaceableTransaction(t)}async getBlock(e,t){const{network:n,params:s}=await Pr({network:this.getNetwork(),params:W(this,Le,hb).call(this,e,!!t)});return s==null?null:this._wrapBlock(s,n)}async getTransaction(e){const{network:t,params:n}=await Pr({network:this.getNetwork(),params:W(this,Le,an).call(this,{method:"getTransaction",hash:e})});return n==null?null:this._wrapTransactionResponse(n,t)}async getTransactionReceipt(e){const{network:t,params:n}=await Pr({network:this.getNetwork(),params:W(this,Le,an).call(this,{method:"getTransactionReceipt",hash:e})});if(n==null)return null;if(n.gasPrice==null&&n.effectiveGasPrice==null){const s=await W(this,Le,an).call(this,{method:"getTransaction",hash:e});if(s==null)throw new Error("report this; could not find tx or effectiveGasPrice");n.effectiveGasPrice=s.gasPrice}return this._wrapTransactionReceipt(n,t)}async getTransactionResult(e){const{result:t}=await Pr({network:this.getNetwork(),result:W(this,Le,an).call(this,{method:"getTransactionResult",hash:e})});return t==null?null:re(t)}async getLogs(e){let t=this._getFilter(e);up(t)&&(t=await t);const{network:n,params:s}=await Pr({network:this.getNetwork(),params:W(this,Le,an).call(this,{method:"getLogs",filter:t})});return s.map(i=>this._wrapLog(i,n))}_getProvider(e){q(!1,"provider cannot connect to target network","UNSUPPORTED_OPERATION",{operation:"_getProvider()"})}async getResolver(e){return await mg.fromName(this,e)}async getAvatar(e){const t=await this.getResolver(e);return t?await t.getAvatar():null}async resolveName(e){const t=await this.getResolver(e);return t?await t.getAddress():null}async lookupAddress(e){e=nt(e);const t=tb(e.substring(2).toLowerCase()+".addr.reverse");try{const n=await mg.getEnsAddress(this),i=await new Ja(n,["function resolver(bytes32) view returns (address)"],this).resolver(t);if(i==null||i===Ud)return null;const a=await new Ja(i,["function name(bytes32) view returns (string)"],this).name(t);return await this.resolveName(a)!==e?null:a}catch(n){if(lr(n,"BAD_DATA")&&n.value==="0x"||lr(n,"CALL_EXCEPTION"))return null;throw n}return null}async waitForTransaction(e,t,n){const s=t??1;return s===0?this.getTransactionReceipt(e):new Promise(async(i,o)=>{let a=null;const c=async l=>{try{const u=await this.getTransactionReceipt(e);if(u!=null&&l-u.blockNumber+1>=s){i(u),a&&(clearTimeout(a),a=null);return}}catch(u){console.log("EEE",u)}this.once("block",c)};n!=null&&(a=setTimeout(()=>{a!=null&&(a=null,this.off("block",c),o(Ct("timeout","TIMEOUT",{reason:"timeout"})))},n)),c(await this.getBlockNumber())})}async waitForBlock(e){q(!1,"not implemented yet","NOT_IMPLEMENTED",{operation:"waitForBlock"})}_clearTimeout(e){const t=y(this,kn).get(e);t&&(t.timer&&clearTimeout(t.timer),y(this,kn).delete(e))}_setTimeout(e,t){t==null&&(t=0);const n=Qu(this,tf)._++,s=()=>{y(this,kn).delete(n),e()};if(this.paused)y(this,kn).set(n,{timer:null,func:s,time:t});else{const i=setTimeout(s,t);y(this,kn).set(n,{timer:i,func:s,time:ky()})}return n}_forEachSubscriber(e){for(const t of y(this,Er).values())e(t.subscriber)}_getSubscriber(e){switch(e.type){case"debug":case"error":case"network":return new Mx(e.type);case"block":{const t=new xG(this);return t.pollingInterval=this.pollingInterval,t}case"safe":case"finalized":return new TG(this,e.type);case"event":return new v0(this,e.filter);case"transaction":return new OG(this,e.hash);case"orphan":return new PG(this,e.filter)}throw new Error(`unsupported event: ${e.type}`)}_recoverSubscriber(e,t){for(const n of y(this,Er).values())if(n.subscriber===e){n.started&&n.subscriber.stop(),n.subscriber=t,n.started&&t.start(),y(this,vr)!=null&&t.pause(y(this,vr));break}}async on(e,t){const n=await W(this,Le,Dp).call(this,e);return n.listeners.push({listener:t,once:!1}),n.started||(n.subscriber.start(),n.started=!0,y(this,vr)!=null&&n.subscriber.pause(y(this,vr))),this}async once(e,t){const n=await W(this,Le,Dp).call(this,e);return n.listeners.push({listener:t,once:!0}),n.started||(n.subscriber.start(),n.started=!0,y(this,vr)!=null&&n.subscriber.pause(y(this,vr))),this}async emit(e,...t){const n=await W(this,Le,Sh).call(this,e,t);if(!n||n.listeners.length===0)return!1;const s=n.listeners.length;return n.listeners=n.listeners.filter(({listener:i,once:o})=>{const a=new QI(this,o?null:i,e);try{i.call(this,...t,a)}catch{}return!o}),n.listeners.length===0&&(n.started&&n.subscriber.stop(),y(this,Er).delete(n.tag)),s>0}async listenerCount(e){if(e){const n=await W(this,Le,Sh).call(this,e);return n?n.listeners.length:0}let t=0;for(const{listeners:n}of y(this,Er).values())t+=n.length;return t}async listeners(e){if(e){const n=await W(this,Le,Sh).call(this,e);return n?n.listeners.map(({listener:s})=>s):[]}let t=[];for(const{listeners:n}of y(this,Er).values())t=t.concat(n.map(({listener:s})=>s));return t}async off(e,t){const n=await W(this,Le,Sh).call(this,e);if(!n)return this;if(t){const s=n.listeners.map(({listener:i})=>i).indexOf(t);s>=0&&n.listeners.splice(s,1)}return(!t||n.listeners.length===0)&&(n.started&&n.subscriber.stop(),y(this,Er).delete(n.tag)),this}async removeAllListeners(e){if(e){const{tag:t,started:n,subscriber:s}=await W(this,Le,Dp).call(this,e);n&&s.stop(),y(this,Er).delete(t)}else for(const[t,{started:n,subscriber:s}]of y(this,Er))n&&s.stop(),y(this,Er).delete(t);return this}async addListener(e,t){return await this.on(e,t)}async removeListener(e,t){return this.off(e,t)}get destroyed(){return y(this,ru)}destroy(){this.removeAllListeners();for(const e of y(this,kn).keys())this._clearTimeout(e);_(this,ru,!0)}get paused(){return y(this,vr)!=null}set paused(e){!!e!==this.paused&&(this.paused?this.resume():this.pause(!1))}pause(e){if(_(this,Ci,-1),y(this,vr)!=null){if(y(this,vr)==!!e)return;q(!1,"cannot change pause type; resume first","UNSUPPORTED_OPERATION",{operation:"pause"})}this._forEachSubscriber(t=>t.pause(e)),_(this,vr,!!e);for(const t of y(this,kn).values())t.timer&&clearTimeout(t.timer),t.time=ky()-t.time}resume(){if(y(this,vr)!=null){this._forEachSubscriber(e=>e.resume()),_(this,vr,null);for(const e of y(this,kn).values()){let t=e.time;t<0&&(t=0),e.time=ky(),setTimeout(e.func,t)}}}}Er=new WeakMap,Ao=new WeakMap,vr=new WeakMap,ru=new WeakMap,pn=new WeakMap,La=new WeakMap,Co=new WeakMap,Ci=new WeakMap,tf=new WeakMap,kn=new WeakMap,nu=new WeakMap,su=new WeakMap,Le=new WeakSet,an=async function(e){const t=y(this,su).cacheTimeout;if(t<0)return await this._perform(e);const n=Rp(e.method,e);let s=y(this,Co).get(n);return s||(s=this._perform(e),y(this,Co).set(n,s),setTimeout(()=>{y(this,Co).get(n)===s&&y(this,Co).delete(n)},t)),await s},lb=async function(e,t,n){q(n<DG,"CCIP read exceeded maximum redirections","OFFCHAIN_FAULT",{reason:"TOO_MANY_REDIRECTS",transaction:Object.assign({},e,{blockTag:t,enableCcipRead:!0})});const s=pg(e);try{return re(await this._perform({method:"call",transaction:s,blockTag:t}))}catch(i){if(!this.disableCcipRead&&r0(i)&&i.data&&n>=0&&t==="latest"&&s.to!=null&&Tt(i.data,0,4)==="0x556f1830"){const o=i.data,a=await Dr(s.to,this);let c;try{c=jG(Tt(i.data,4))}catch(h){q(!1,h.message,"OFFCHAIN_FAULT",{reason:"BAD_DATA",transaction:s,info:{data:o}})}q(c.sender.toLowerCase()===a.toLowerCase(),"CCIP Read sender mismatch","CALL_EXCEPTION",{action:"call",data:o,reason:"OffchainLookup",transaction:s,invocation:null,revert:{signature:"OffchainLookup(address,string[],bytes,bytes4,bytes)",name:"OffchainLookup",args:c.errorArgs}});const l=await this.ccipReadFetch(s,c.calldata,c.urls);q(l!=null,"CCIP Read failed to fetch data","OFFCHAIN_FAULT",{reason:"FETCH_FAILED",transaction:s,info:{data:i.data,errorArgs:c.errorArgs}});const u={to:a,data:Pt([c.selector,FG([l,c.extraData])])};this.emit("debug",{action:"sendCcipReadCall",transaction:u});try{const h=await W(this,Le,lb).call(this,u,t,n+1);return this.emit("debug",{action:"receiveCcipReadCallResult",transaction:Object.assign({},u),result:h}),h}catch(h){throw this.emit("debug",{action:"receiveCcipReadCallError",transaction:Object.assign({},u),error:h}),h}}throw i}},ub=async function(e){const{value:t}=await Pr({network:this.getNetwork(),value:e});return t},Ih=async function(e,t,n){let s=this._getAddress(t),i=this._getBlockTag(n);return(typeof s!="string"||typeof i!="string")&&([s,i]=await Promise.all([s,i])),await W(this,Le,ub).call(this,W(this,Le,an).call(this,Object.assign(e,{address:s,blockTag:i})))},hb=async function(e,t){if(pt(e,32))return await W(this,Le,an).call(this,{method:"getBlock",blockHash:e,includeTransactions:t});let n=this._getBlockTag(e);return typeof n!="string"&&(n=await n),await W(this,Le,an).call(this,{method:"getBlock",blockTag:n,includeTransactions:t})},Sh=async function(e,t){let n=await Dy(e,this);return n.type==="event"&&t&&t.length>0&&t[0].removed===!0&&(n=await Dy({orphan:"drop-log",log:t[0]},this)),y(this,Er).get(n.tag)||null},Dp=async function(e){const t=await Dy(e,this),n=t.tag;let s=y(this,Er).get(n);return s||(s={subscriber:this._getSubscriber(t),tag:n,addressableMap:new WeakMap,nameMap:new Map,started:!1,listeners:[]},y(this,Er).set(n,s)),s};function LG(r,e){try{const t=db(r,e);if(t)return sg(t)}catch{}return null}function db(r,e){if(r==="0x")return null;try{const t=Pe(Tt(r,e,e+32)),n=Pe(Tt(r,t,t+32));return Tt(r,t+32,t+32+n)}catch{}return null}function EC(r){const e=hr(r);if(e.length>32)throw new Error("internal; should not happen");const t=new Uint8Array(32);return t.set(e,32-e.length),t}function $G(r){if(r.length%32===0)return r;const e=new Uint8Array(Math.ceil(r.length/32)*32);return e.set(r),e}const MG=new Uint8Array([]);function FG(r){const e=[];let t=0;for(let n=0;n<r.length;n++)e.push(MG),t+=32;for(let n=0;n<r.length;n++){const s=Ue(r[n]);e[n]=EC(t),e.push(EC(s.length)),e.push($G(s)),t+=32+Math.ceil(s.length/32)*32}return Pt(e)}const vC="0x0000000000000000000000000000000000000000000000000000000000000000";function jG(r){const e={sender:"",urls:[],calldata:"",selector:"",extraData:"",errorArgs:[]};q(yl(r)>=5*32,"insufficient OffchainLookup data","OFFCHAIN_FAULT",{reason:"insufficient OffchainLookup data"});const t=Tt(r,0,32);q(Tt(t,0,12)===Tt(vC,0,12),"corrupt OffchainLookup sender","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup sender"}),e.sender=Tt(t,12);try{const n=[],s=Pe(Tt(r,32,64)),i=Pe(Tt(r,s,s+32)),o=Tt(r,s+32);for(let a=0;a<i;a++){const c=LG(o,a*32);if(c==null)throw new Error("abort");n.push(c)}e.urls=n}catch{q(!1,"corrupt OffchainLookup urls","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup urls"})}try{const n=db(r,64);if(n==null)throw new Error("abort");e.calldata=n}catch{q(!1,"corrupt OffchainLookup calldata","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup calldata"})}q(Tt(r,100,128)===Tt(vC,0,28),"corrupt OffchainLookup callbaackSelector","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup callbaackSelector"}),e.selector=Tt(r,96,100);try{const n=db(r,128);if(n==null)throw new Error("abort");e.extraData=n}catch{q(!1,"corrupt OffchainLookup extraData","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup extraData"})}return e.errorArgs="sender,urls,calldata,selector,extraData".split(/,/).map(n=>e[n]),e}function Xo(r,e){if(r.provider)return r.provider;q(!1,"missing provider","UNSUPPORTED_OPERATION",{operation:e})}async function AC(r,e){let t=pg(e);if(t.to!=null&&(t.to=Dr(t.to,r)),t.from!=null){const n=t.from;t.from=Promise.all([r.getAddress(),Dr(n,r)]).then(([s,i])=>(R(s.toLowerCase()===i.toLowerCase(),"transaction from mismatch","tx.from",i),s))}else t.from=r.getAddress();return await Pr(t)}class HG{constructor(e){L(this,"provider");ye(this,{provider:e||null})}async getNonce(e){return Xo(this,"getTransactionCount").getTransactionCount(await this.getAddress(),e)}async populateCall(e){return await AC(this,e)}async populateTransaction(e){const t=Xo(this,"populateTransaction"),n=await AC(this,e);n.nonce==null&&(n.nonce=await this.getNonce("pending")),n.gasLimit==null&&(n.gasLimit=await this.estimateGas(n));const s=await this.provider.getNetwork();if(n.chainId!=null){const o=de(n.chainId);R(o===s.chainId,"transaction chainId mismatch","tx.chainId",e.chainId)}else n.chainId=s.chainId;const i=n.maxFeePerGas!=null||n.maxPriorityFeePerGas!=null;if(n.gasPrice!=null&&(n.type===2||i)?R(!1,"eip-1559 transaction do not support gasPrice","tx",e):(n.type===0||n.type===1)&&i&&R(!1,"pre-eip-1559 transaction do not support maxFeePerGas/maxPriorityFeePerGas","tx",e),(n.type===2||n.type==null)&&n.maxFeePerGas!=null&&n.maxPriorityFeePerGas!=null)n.type=2;else if(n.type===0||n.type===1){const o=await t.getFeeData();q(o.gasPrice!=null,"network does not support gasPrice","UNSUPPORTED_OPERATION",{operation:"getGasPrice"}),n.gasPrice==null&&(n.gasPrice=o.gasPrice)}else{const o=await t.getFeeData();if(n.type==null)if(o.maxFeePerGas!=null&&o.maxPriorityFeePerGas!=null)if(n.authorizationList&&n.authorizationList.length?n.type=4:n.type=2,n.gasPrice!=null){const a=n.gasPrice;delete n.gasPrice,n.maxFeePerGas=a,n.maxPriorityFeePerGas=a}else n.maxFeePerGas==null&&(n.maxFeePerGas=o.maxFeePerGas),n.maxPriorityFeePerGas==null&&(n.maxPriorityFeePerGas=o.maxPriorityFeePerGas);else o.gasPrice!=null?(q(!i,"network does not support EIP-1559","UNSUPPORTED_OPERATION",{operation:"populateTransaction"}),n.gasPrice==null&&(n.gasPrice=o.gasPrice),n.type=0):q(!1,"failed to get consistent fee data","UNSUPPORTED_OPERATION",{operation:"signer.getFeeData"});else(n.type===2||n.type===3||n.type===4)&&(n.maxFeePerGas==null&&(n.maxFeePerGas=o.maxFeePerGas),n.maxPriorityFeePerGas==null&&(n.maxPriorityFeePerGas=o.maxPriorityFeePerGas))}return await Pr(n)}async populateAuthorization(e){const t=Object.assign({},e);return t.chainId==null&&(t.chainId=(await Xo(this,"getNetwork").getNetwork()).chainId),t.nonce==null&&(t.nonce=await this.getNonce()),t}async estimateGas(e){return Xo(this,"estimateGas").estimateGas(await this.populateCall(e))}async call(e){return Xo(this,"call").call(await this.populateCall(e))}async resolveName(e){return await Xo(this,"resolveName").resolveName(e)}async sendTransaction(e){const t=Xo(this,"sendTransaction"),n=await this.populateTransaction(e);delete n.from;const s=ag.from(n);return await t.broadcastTransaction(await this.signTransaction(s))}authorize(e){q(!1,"authorization not implemented for this signer","UNSUPPORTED_OPERATION",{operation:"authorize"})}}function zG(r){return JSON.parse(JSON.stringify(r))}var Tr,ks,$a,_o,Ma,iu,Mo,fb,pb;class Fx{constructor(e){F(this,Mo);F(this,Tr);F(this,ks);F(this,$a);F(this,_o);F(this,Ma);F(this,iu);_(this,Tr,e),_(this,ks,null),_(this,$a,W(this,Mo,fb).bind(this)),_(this,_o,!1),_(this,Ma,null),_(this,iu,!1)}_subscribe(e){throw new Error("subclasses must override this")}_emitResults(e,t){throw new Error("subclasses must override this")}_recover(e){throw new Error("subclasses must override this")}start(){y(this,_o)||(_(this,_o,!0),W(this,Mo,fb).call(this,-2))}stop(){y(this,_o)&&(_(this,_o,!1),_(this,iu,!0),W(this,Mo,pb).call(this),y(this,Tr).off("block",y(this,$a)))}pause(e){e&&W(this,Mo,pb).call(this),y(this,Tr).off("block",y(this,$a))}resume(){this.start()}}Tr=new WeakMap,ks=new WeakMap,$a=new WeakMap,_o=new WeakMap,Ma=new WeakMap,iu=new WeakMap,Mo=new WeakSet,fb=async function(e){try{y(this,ks)==null&&_(this,ks,this._subscribe(y(this,Tr)));let t=null;try{t=await y(this,ks)}catch(i){if(!lr(i,"UNSUPPORTED_OPERATION")||i.operation!=="eth_newFilter")throw i}if(t==null){_(this,ks,null),y(this,Tr)._recoverSubscriber(this,this._recover(y(this,Tr)));return}const n=await y(this,Tr).getNetwork();if(y(this,Ma)||_(this,Ma,n),y(this,Ma).chainId!==n.chainId)throw new Error("chaid changed");if(y(this,iu))return;const s=await y(this,Tr).send("eth_getFilterChanges",[t]);await this._emitResults(y(this,Tr),s)}catch(t){console.log("@TODO",t)}y(this,Tr).once("block",y(this,$a))},pb=function(){const e=y(this,ks);e&&(_(this,ks,null),e.then(t=>{y(this,Tr).destroyed||y(this,Tr).send("eth_uninstallFilter",[t])}))};var Fa;class qG extends Fx{constructor(t,n){super(t);F(this,Fa);_(this,Fa,zG(n))}_recover(t){return new v0(t,y(this,Fa))}async _subscribe(t){return await t.send("eth_newFilter",[y(this,Fa)])}async _emitResults(t,n){for(const s of n)t.emit(y(this,Fa),t._wrapLog(s,t._network))}}Fa=new WeakMap;class VG extends Fx{async _subscribe(e){return await e.send("eth_newPendingTransactionFilter",[])}async _emitResults(e,t){for(const n of t)e.emit("pending",n)}}const WG="bigint,boolean,function,number,string,symbol".split(/,/g);function kp(r){if(r==null||WG.indexOf(typeof r)>=0||typeof r.getAddress=="function")return r;if(Array.isArray(r))return r.map(kp);if(typeof r=="object")return Object.keys(r).reduce((e,t)=>(e[t]=r[t],e),{});throw new Error(`should not happen: ${r} (${typeof r})`)}function GG(r){return new Promise(e=>{setTimeout(e,r)})}function Yc(r){return r&&r.toLowerCase()}function CC(r){return r&&typeof r.pollingInterval=="number"}const jx={polling:!1,staticNetwork:null,batchStallTime:10,batchMaxSize:1<<20,batchMaxCount:100,cacheTimeout:250,pollingInterval:4e3};class Ya extends HG{constructor(t,n){super(t);L(this,"address");n=nt(n),ye(this,{address:n})}connect(t){q(!1,"cannot reconnect JsonRpcSigner","UNSUPPORTED_OPERATION",{operation:"signer.connect"})}async getAddress(){return this.address}async populateTransaction(t){return await this.populateCall(t)}async sendUncheckedTransaction(t){const n=kp(t),s=[];if(n.from){const o=n.from;s.push((async()=>{const a=await Dr(o,this.provider);R(a!=null&&a.toLowerCase()===this.address.toLowerCase(),"from address mismatch","transaction",t),n.from=a})())}else n.from=this.address;if(n.gasLimit==null&&s.push((async()=>{n.gasLimit=await this.provider.estimateGas({...n,from:this.address})})()),n.to!=null){const o=n.to;s.push((async()=>{n.to=await Dr(o,this.provider)})())}s.length&&await Promise.all(s);const i=this.provider.getRpcTransaction(n);return this.provider.send("eth_sendTransaction",[i])}async sendTransaction(t){const n=await this.provider.getBlockNumber(),s=await this.sendUncheckedTransaction(t);return await new Promise((i,o)=>{const a=[1e3,100];let c=0;const l=async()=>{try{const u=await this.provider.getTransaction(s);if(u!=null){i(u.replaceableTransaction(n));return}}catch(u){if(lr(u,"CANCELLED")||lr(u,"BAD_DATA")||lr(u,"NETWORK_ERROR")||lr(u,"UNSUPPORTED_OPERATION")){u.info==null&&(u.info={}),u.info.sendTransactionHash=s,o(u);return}if(lr(u,"INVALID_ARGUMENT")&&(c++,u.info==null&&(u.info={}),u.info.sendTransactionHash=s,c>10)){o(u);return}this.provider.emit("error",Ct("failed to fetch transation after sending (will try again)","UNKNOWN_ERROR",{error:u}))}this.provider._setTimeout(()=>{l()},a.pop()||4e3)};l()})}async signTransaction(t){const n=kp(t);if(n.from){const i=await Dr(n.from,this.provider);R(i!=null&&i.toLowerCase()===this.address.toLowerCase(),"from address mismatch","transaction",t),n.from=i}else n.from=this.address;const s=this.provider.getRpcTransaction(n);return await this.provider.send("eth_signTransaction",[s])}async signMessage(t){const n=typeof t=="string"?Ws(t):t;return await this.provider.send("personal_sign",[re(n),this.address.toLowerCase()])}async signTypedData(t,n,s){const i=kp(s),o=await fg.resolveNames(t,n,i,async a=>{const c=await Dr(a);return R(c!=null,"TypedData does not support null address","value",a),c});return await this.provider.send("eth_signTypedData_v4",[this.address.toLowerCase(),JSON.stringify(fg.getPayload(o.domain,n,o.value))])}async unlock(t){return this.provider.send("personal_unlockAccount",[this.address.toLowerCase(),t,null])}async _legacySignMessage(t){const n=typeof t=="string"?Ws(t):t;return await this.provider.send("eth_sign",[this.address.toLowerCase(),re(n)])}}var ja,ou,_i,Us,ss,Un,Vr,rf,gb;class KG extends BG{constructor(t,n){super(t,n);F(this,rf);F(this,ja);F(this,ou);F(this,_i);F(this,Us);F(this,ss);F(this,Un);F(this,Vr);_(this,ou,1),_(this,ja,Object.assign({},jx,n||{})),_(this,_i,[]),_(this,Us,null),_(this,Un,null),_(this,Vr,null);{let i=null;const o=new Promise(a=>{i=a});_(this,ss,{promise:o,resolve:i})}const s=this._getOption("staticNetwork");typeof s=="boolean"?(R(!s||t!=="any","staticNetwork cannot be used on special network 'any'","options",n),s&&t!=null&&_(this,Un,Hs.from(t))):s&&(R(t==null||s.matches(t),"staticNetwork MUST match network object","options",n),_(this,Un,s))}_getOption(t){return y(this,ja)[t]}get _network(){return q(y(this,Un),"network is not available yet","NETWORK_ERROR"),y(this,Un)}async _perform(t){if(t.method==="call"||t.method==="estimateGas"){let s=t.transaction;if(s&&s.type!=null&&de(s.type)&&s.maxFeePerGas==null&&s.maxPriorityFeePerGas==null){const i=await this.getFeeData();i.maxFeePerGas==null&&i.maxPriorityFeePerGas==null&&(t=Object.assign({},t,{transaction:Object.assign({},s,{type:void 0})}))}}const n=this.getRpcRequest(t);return n!=null?await this.send(n.method,n.args):super._perform(t)}async _detectNetwork(){const t=this._getOption("staticNetwork");if(t)if(t===!0){if(y(this,Un))return y(this,Un)}else return t;return y(this,Vr)?await y(this,Vr):this.ready?(_(this,Vr,(async()=>{try{const n=Hs.from(de(await this.send("eth_chainId",[])));return _(this,Vr,null),n}catch(n){throw _(this,Vr,null),n}})()),await y(this,Vr)):(_(this,Vr,(async()=>{const n={id:Qu(this,ou)._++,method:"eth_chainId",params:[],jsonrpc:"2.0"};this.emit("debug",{action:"sendRpcPayload",payload:n});let s;try{s=(await this._send(n))[0],_(this,Vr,null)}catch(i){throw _(this,Vr,null),this.emit("debug",{action:"receiveRpcError",error:i}),i}if(this.emit("debug",{action:"receiveRpcResult",result:s}),"result"in s)return Hs.from(de(s.result));throw this.getRpcError(n,s)})()),await y(this,Vr))}_start(){y(this,ss)==null||y(this,ss).resolve==null||(y(this,ss).resolve(),_(this,ss,null),(async()=>{for(;y(this,Un)==null&&!this.destroyed;)try{_(this,Un,await this._detectNetwork())}catch(t){if(this.destroyed)break;console.log("JsonRpcProvider failed to detect network and cannot start up; retry in 1s (perhaps the URL is wrong or the node is not started)"),this.emit("error",Ct("failed to bootstrap network detection","NETWORK_ERROR",{event:"initial-network-discovery",info:{error:t}})),await GG(1e3)}W(this,rf,gb).call(this)})())}async _waitUntilReady(){if(y(this,ss)!=null)return await y(this,ss).promise}_getSubscriber(t){return t.type==="pending"?new VG(this):t.type==="event"?this._getOption("polling")?new v0(this,t.filter):new qG(this,t.filter):t.type==="orphan"&&t.filter.orphan==="drop-log"?new Mx("orphan"):super._getSubscriber(t)}get ready(){return y(this,ss)==null}getRpcTransaction(t){const n={};return["chainId","gasLimit","gasPrice","type","maxFeePerGas","maxPriorityFeePerGas","nonce","value"].forEach(s=>{if(t[s]==null)return;let i=s;s==="gasLimit"&&(i="gas"),n[i]=Pi(de(t[s],`tx.${s}`))}),["from","to","data"].forEach(s=>{t[s]!=null&&(n[s]=re(t[s]))}),t.accessList&&(n.accessList=vc(t.accessList)),t.blobVersionedHashes&&(n.blobVersionedHashes=t.blobVersionedHashes.map(s=>s.toLowerCase())),t.authorizationList&&(n.authorizationList=t.authorizationList.map(s=>{const i=zS(s);return{address:i.address,nonce:Pi(i.nonce),chainId:Pi(i.chainId),yParity:Pi(i.signature.yParity),r:i.signature.r,s:i.signature.s}})),n}getRpcRequest(t){switch(t.method){case"chainId":return{method:"eth_chainId",args:[]};case"getBlockNumber":return{method:"eth_blockNumber",args:[]};case"getGasPrice":return{method:"eth_gasPrice",args:[]};case"getPriorityFee":return{method:"eth_maxPriorityFeePerGas",args:[]};case"getBalance":return{method:"eth_getBalance",args:[Yc(t.address),t.blockTag]};case"getTransactionCount":return{method:"eth_getTransactionCount",args:[Yc(t.address),t.blockTag]};case"getCode":return{method:"eth_getCode",args:[Yc(t.address),t.blockTag]};case"getStorage":return{method:"eth_getStorageAt",args:[Yc(t.address),"0x"+t.position.toString(16),t.blockTag]};case"broadcastTransaction":return{method:"eth_sendRawTransaction",args:[t.signedTransaction]};case"getBlock":if("blockTag"in t)return{method:"eth_getBlockByNumber",args:[t.blockTag,!!t.includeTransactions]};if("blockHash"in t)return{method:"eth_getBlockByHash",args:[t.blockHash,!!t.includeTransactions]};break;case"getTransaction":return{method:"eth_getTransactionByHash",args:[t.hash]};case"getTransactionReceipt":return{method:"eth_getTransactionReceipt",args:[t.hash]};case"call":return{method:"eth_call",args:[this.getRpcTransaction(t.transaction),t.blockTag]};case"estimateGas":return{method:"eth_estimateGas",args:[this.getRpcTransaction(t.transaction)]};case"getLogs":return t.filter&&t.filter.address!=null&&(Array.isArray(t.filter.address)?t.filter.address=t.filter.address.map(Yc):t.filter.address=Yc(t.filter.address)),{method:"eth_getLogs",args:[t.filter]}}return null}getRpcError(t,n){const{method:s}=t,{error:i}=n;if(s==="eth_estimateGas"&&i.message){const c=i.message;if(!c.match(/revert/i)&&c.match(/insufficient funds/i))return Ct("insufficient funds","INSUFFICIENT_FUNDS",{transaction:t.params[0],info:{payload:t,error:i}});if(c.match(/nonce/i)&&c.match(/too low/i))return Ct("nonce has already been used","NONCE_EXPIRED",{transaction:t.params[0],info:{payload:t,error:i}})}if(s==="eth_call"||s==="eth_estimateGas"){const c=mb(i),l=Hd.getBuiltinCallException(s==="eth_call"?"call":"estimateGas",t.params[0],c?c.data:null);return l.info={error:i,payload:t},l}const o=JSON.stringify(YG(i));if(typeof i.message=="string"&&i.message.match(/user denied|ethers-user-denied/i))return Ct("user rejected action","ACTION_REJECTED",{action:{eth_sign:"signMessage",personal_sign:"signMessage",eth_signTypedData_v4:"signTypedData",eth_signTransaction:"signTransaction",eth_sendTransaction:"sendTransaction",eth_requestAccounts:"requestAccess",wallet_requestAccounts:"requestAccess"}[s]||"unknown",reason:"rejected",info:{payload:t,error:i}});if(s==="eth_sendRawTransaction"||s==="eth_sendTransaction"){const c=t.params[0];if(o.match(/insufficient funds|base fee exceeds gas limit/i))return Ct("insufficient funds for intrinsic transaction cost","INSUFFICIENT_FUNDS",{transaction:c,info:{error:i}});if(o.match(/nonce/i)&&o.match(/too low/i))return Ct("nonce has already been used","NONCE_EXPIRED",{transaction:c,info:{error:i}});if(o.match(/replacement transaction/i)&&o.match(/underpriced/i))return Ct("replacement fee too low","REPLACEMENT_UNDERPRICED",{transaction:c,info:{error:i}});if(o.match(/only replay-protected/i))return Ct("legacy pre-eip-155 transactions not supported","UNSUPPORTED_OPERATION",{operation:s,info:{transaction:c,info:{error:i}}})}let a=!!o.match(/the method .* does not exist/i);return a||i&&i.details&&i.details.startsWith("Unauthorized method:")&&(a=!0),a?Ct("unsupported operation","UNSUPPORTED_OPERATION",{operation:t.method,info:{error:i,payload:t}}):Ct("could not coalesce error","UNKNOWN_ERROR",{error:i,payload:t})}send(t,n){if(this.destroyed)return Promise.reject(Ct("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:t}));const s=Qu(this,ou)._++,i=new Promise((o,a)=>{y(this,_i).push({resolve:o,reject:a,payload:{method:t,params:n,id:s,jsonrpc:"2.0"}})});return W(this,rf,gb).call(this),i}async getSigner(t){t==null&&(t=0);const n=this.send("eth_accounts",[]);if(typeof t=="number"){const i=await n;if(t>=i.length)throw new Error("no such account");return new Ya(this,i[t])}const{accounts:s}=await Pr({network:this.getNetwork(),accounts:n});t=nt(t);for(const i of s)if(nt(i)===t)return new Ya(this,t);throw new Error("invalid account")}async listAccounts(){return(await this.send("eth_accounts",[])).map(n=>new Ya(this,n))}destroy(){y(this,Us)&&(clearTimeout(y(this,Us)),_(this,Us,null));for(const{payload:t,reject:n}of y(this,_i))n(Ct("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:t.method}));_(this,_i,[]),super.destroy()}}ja=new WeakMap,ou=new WeakMap,_i=new WeakMap,Us=new WeakMap,ss=new WeakMap,Un=new WeakMap,Vr=new WeakMap,rf=new WeakSet,gb=function(){if(y(this,Us))return;const t=this._getOption("batchMaxCount")===1?0:this._getOption("batchStallTime");_(this,Us,setTimeout(()=>{_(this,Us,null);const n=y(this,_i);for(_(this,_i,[]);n.length;){const s=[n.shift()];for(;n.length&&s.length!==y(this,ja).batchMaxCount;)if(s.push(n.shift()),JSON.stringify(s.map(o=>o.payload)).length>y(this,ja).batchMaxSize){n.unshift(s.pop());break}(async()=>{const i=s.length===1?s[0].payload:s.map(o=>o.payload);this.emit("debug",{action:"sendRpcPayload",payload:i});try{const o=await this._send(i);this.emit("debug",{action:"receiveRpcResult",result:o});for(const{resolve:a,reject:c,payload:l}of s){if(this.destroyed){c(Ct("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:l.method}));continue}const u=o.filter(h=>h.id===l.id)[0];if(u==null){const h=Ct("missing response for request","BAD_DATA",{value:o,info:{payload:l}});this.emit("error",h),c(h);continue}if("error"in u){c(this.getRpcError(l,u));continue}a(u.result)}}catch(o){this.emit("debug",{action:"receiveRpcError",error:o});for(const{reject:a}of s)a(o)}})()}},t))};var No;class Hx extends KG{constructor(t,n){super(t,n);F(this,No);let s=this._getOption("pollingInterval");s==null&&(s=jx.pollingInterval),_(this,No,s)}_getSubscriber(t){const n=super._getSubscriber(t);return CC(n)&&(n.pollingInterval=y(this,No)),n}get pollingInterval(){return y(this,No)}set pollingInterval(t){if(!Number.isInteger(t)||t<0)throw new Error("invalid interval");_(this,No,t),this._forEachSubscriber(n=>{CC(n)&&(n.pollingInterval=y(this,No))})}}No=new WeakMap;var au;class JG extends Hx{constructor(t,n,s){t==null&&(t="http://localhost:8545");super(n,s);F(this,au);typeof t=="string"?_(this,au,new Mi(t)):_(this,au,t.clone())}_getConnection(){return y(this,au).clone()}async send(t,n){return await this._start(),await super.send(t,n)}async _send(t){const n=this._getConnection();n.body=JSON.stringify(t),n.setHeader("content-type","application/json");const s=await n.send();s.assertOk();let i=s.bodyJson;return Array.isArray(i)||(i=[i]),i}}au=new WeakMap;function mb(r){if(r==null)return null;if(typeof r.message=="string"&&r.message.match(/revert/i)&&pt(r.data))return{message:r.message,data:r.data};if(typeof r=="object"){for(const e in r){const t=mb(r[e]);if(t)return t}return null}if(typeof r=="string")try{return mb(JSON.parse(r))}catch{}return null}function yb(r,e){if(r!=null){if(typeof r.message=="string"&&e.push(r.message),typeof r=="object")for(const t in r)yb(r[t],e);if(typeof r=="string")try{return yb(JSON.parse(r),e)}catch{}}}function YG(r){const e=[];return yb(r,e),e}var cu,lu;const fa=class fa extends Hx{constructor(t,n,s){const i=Object.assign({},s??{},{batchMaxCount:1});R(t&&t.request,"invalid EIP-1193 provider","ethereum",t);super(n,i);F(this,cu);F(this,lu);_(this,lu,null),s&&s.providerInfo&&_(this,lu,s.providerInfo),_(this,cu,async(o,a)=>{const c={method:o,params:a};this.emit("debug",{action:"sendEip1193Request",payload:c});try{const l=await t.request(c);return this.emit("debug",{action:"receiveEip1193Result",result:l}),l}catch(l){const u=new Error(l.message);throw u.code=l.code,u.data=l.data,u.payload=c,this.emit("debug",{action:"receiveEip1193Error",error:u}),u}})}get providerInfo(){return y(this,lu)}async send(t,n){return await this._start(),await super.send(t,n)}async _send(t){R(!Array.isArray(t),"EIP-1193 does not support batch request","payload",t);try{const n=await y(this,cu).call(this,t.method,t.params||[]);return[{id:t.id,result:n}]}catch(n){return[{id:t.id,error:{code:n.code,data:n.data,message:n.message}}]}}getRpcError(t,n){switch(n=JSON.parse(JSON.stringify(n)),n.error.code||-1){case 4001:n.error.message=`ethers-user-denied: ${n.error.message}`;break;case 4200:n.error.message=`ethers-unsupported: ${n.error.message}`;break}return super.getRpcError(t,n)}async hasSigner(t){t==null&&(t=0);const n=await this.send("eth_accounts",[]);return typeof t=="number"?n.length>t:(t=t.toLowerCase(),n.filter(s=>s.toLowerCase()===t).length!==0)}async getSigner(t){if(t==null&&(t=0),!await this.hasSigner(t))try{await y(this,cu).call(this,"eth_requestAccounts",[])}catch(n){const s=n.payload;throw this.getRpcError(s,{id:s.id,error:n})}return await super.getSigner(t)}static async discover(t){if(t==null&&(t={}),t.provider)return new fa(t.provider);const n=t.window?t.window:typeof window<"u"?window:null;if(n==null)return null;const s=t.anyProvider;if(s&&n.ethereum)return new fa(n.ethereum);if(!("addEventListener"in n&&"dispatchEvent"in n&&"removeEventListener"in n))return null;const i=t.timeout?t.timeout:300;return i===0?null:await new Promise((o,a)=>{let c=[];const l=d=>{c.push(d.detail),s&&u()},u=()=>{if(clearTimeout(h),c.length)if(t&&t.filter){const d=t.filter(c.map(f=>Object.assign({},f.info)));if(d==null)o(null);else if(d instanceof fa)o(d);else{let f=null;if(d.uuid&&(f=c.filter(p=>d.uuid===p.info.uuid)[0]),f){const{provider:g,info:p}=f;o(new fa(g,void 0,{providerInfo:p}))}else a(Ct("filter returned unknown info","UNSUPPORTED_OPERATION",{value:d}))}}else{const{provider:d,info:f}=c[0];o(new fa(d,void 0,{providerInfo:f}))}else o(null);n.removeEventListener("eip6963:announceProvider",l)},h=setTimeout(()=>{u()},i);n.addEventListener("eip6963:announceProvider",l),n.dispatchEvent(new Event("eip6963:requestProvider"))})}};cu=new WeakMap,lu=new WeakMap;let Qa=fa;const vl={hexStringToNumber(r){const e=r.startsWith("0x")?r.slice(2):r;return parseInt(e,16)},numberToHexString(r){return`0x${r.toString(16)}`},async getUserInfo(r){const[e,t]=await Promise.all([vl.getAddresses(r),vl.getChainId(r)]);return{chainId:t,addresses:e}},async getChainId(r){const e=await r.request({method:"eth_chainId"});return Number(e)},async getAddress(r){const[e]=await r.request({method:"eth_accounts"});return e},async getAddresses(r){return await r.request({method:"eth_accounts"})},async addEthereumChain(r,e){var n,s;const t=((n=e.rpcUrls.chainDefault)==null?void 0:n.http)||[];await r.request({method:"wallet_addEthereumChain",params:[{chainId:vl.numberToHexString(e.id),rpcUrls:[...t],chainName:e.name,nativeCurrency:{name:e.nativeCurrency.name,decimals:e.nativeCurrency.decimals,symbol:e.nativeCurrency.symbol},blockExplorerUrls:[(s=e.blockExplorers)==null?void 0:s.default.url],iconUrls:[Ms.NetworkImageIds[e.id]]}]})}},ea={signMessage:async(r,e,t)=>{if(!e)throw new Error("signMessage - provider is undefined");const n=pt(r)?r:re(Ws(r));return await e.request({method:"personal_sign",params:[n,t]})},estimateGas:async(r,e,t,n)=>{if(!e)throw new Error("estimateGas - provider is undefined");if(!t)throw new Error("estimateGas - address is undefined");if(r.chainNamespace&&r.chainNamespace!=="eip155")throw new Error("estimateGas - chainNamespace is not eip155");const s={from:r.address,to:r.to,data:r.data,type:0},i=new Qa(e,n);return await new Ya(i,t).estimateGas(s)},sendTransaction:async(r,e,t,n)=>{if(!e)throw new Error("sendTransaction - provider is undefined");if(!t)throw new Error("sendTransaction - address is undefined");if(r.chainNamespace&&r.chainNamespace!=="eip155")throw new Error("sendTransaction - chainNamespace is not eip155");const s={to:r.to,value:r.value,gasLimit:r.gas,gasPrice:r.gasPrice,data:r.data,type:0},i=new Qa(e,n),c=await(await new Ya(i,t).sendTransaction(s)).wait();return(c==null?void 0:c.hash)||null},writeContract:async(r,e,t,n)=>{if(!e)throw new Error("writeContract - provider is undefined");if(!t)throw new Error("writeContract - address is undefined");const s=new Qa(e,n),i=new Ya(s,t),o=new Ja(r.tokenAddress,r.abi,i);if(!o||!r.method)throw new Error("Contract method is undefined");const a=o[r.method];if(a)return await a(...r.args);throw new Error("Contract method is undefined")},parseWalletCapabilities:r=>{try{return JSON.parse(r)}catch{throw new Error("Error parsing wallet capabilities")}},parseUnits:aS,formatUnits:oS};class QG extends WI{constructor(){super({adapterType:ee.ADAPTER_TYPES.ETHERS,namespace:ee.CHAIN.EVM}),this.balancePromises={},this.providerHandlers=null}async createEthersConfig(e){if(!e.metadata)return;let t;function n(){if(t)return t;if(!(typeof window>"u")&&window.ethereum)return t=window.ethereum,t}async function s(){var o,a,c;try{const{createCoinbaseWalletSDK:l}=await cn(async()=>{const{createCoinbaseWalletSDK:h}=await import("./index-ByyAH7FS.js");return{createCoinbaseWalletSDK:h}},__vite__mapDeps([48,1,2]));return typeof window>"u"?void 0:l({appName:(o=e==null?void 0:e.metadata)==null?void 0:o.name,appLogoUrl:(a=e==null?void 0:e.metadata)==null?void 0:a.icons[0],appChainIds:((c=e.networks)==null?void 0:c.map(h=>h.id))||[1,84532],preference:{options:e.coinbasePreference??"all"}}).getProvider()}catch(l){console.error("Failed to import Coinbase Wallet SDK:",l);return}}const i={metadata:e.metadata};if(e.enableInjected!==!1&&(i.injected=n()),e.enableCoinbase!==!1){const o=await s();o&&(i.coinbase=o)}return i.EIP6963=e.enableEIP6963!==!1,i}async signMessage(e){const{message:t,address:n,provider:s}=e;if(!s)throw new Error("Provider is undefined");try{return{signature:await ea.signMessage(t,s,n)}}catch{throw new Error("EthersAdapter:signMessage - Sign message failed")}}async sendTransaction(e){var n;if(!e.provider)throw new Error("Provider is undefined");return{hash:await ea.sendTransaction({value:Number.isNaN(Number(e.value))?BigInt(0):BigInt(e.value),to:e.to,data:e.data?e.data:"0x",gas:e.gas?BigInt(e.gas):void 0,gasPrice:e.gasPrice?BigInt(e.gasPrice):void 0,address:he.state.address},e.provider,he.state.address,Number((n=e.caipNetwork)==null?void 0:n.id))}}async writeContract(e){var s;if(!e.provider)throw new Error("Provider is undefined");const{address:t}=ai.parseCaipAddress(e.caipAddress);return{hash:await ea.writeContract(e,e.provider,t,Number((s=e.caipNetwork)==null?void 0:s.id))}}async estimateGas(e){const{provider:t,caipNetwork:n,address:s}=e;if(!t)throw new Error("Provider is undefined");try{return{gas:await ea.estimateGas({data:e.data,to:e.to,address:s},t,s,Number(n==null?void 0:n.id))}}catch{throw new Error("EthersAdapter:estimateGas - Estimate gas failed")}}parseUnits(e){return ea.parseUnits(e.value,e.decimals)}formatUnits(e){return ea.formatUnits(e.value,e.decimals)}async syncConnection(e){const{id:t,chainId:n}=e,s=this.connectors.find(c=>c.id===t),i=s==null?void 0:s.provider;if(!i)throw new Error("Provider not found");const o=await i.request({method:"eth_requestAccounts"}),a=await i.request({method:"eth_chainId"});if(this.listenProviderEvents(i),!o[0])throw new Error("No accounts found");if(!(s!=null&&s.type))throw new Error("Connector type not found");return{address:o[0],chainId:Number(a)||Number(n),provider:i,type:s.type,id:t}}async syncConnectors(e){var n;this.ethersConfig=await this.createEthersConfig(e),(n=this.ethersConfig)!=null&&n.EIP6963&&this.listenInjectedConnector(!0),Object.keys(this.ethersConfig||{}).filter(s=>s!=="metadata"&&s!=="EIP6963").forEach(s=>{var a,c;const i=s==="coinbase"?"coinbaseWalletSDK":s,o=s===ee.CONNECTOR_ID.INJECTED;this.namespace&&this.addConnector({id:i,explorerId:Ms.ConnectorExplorerIds[i],imageUrl:(a=e==null?void 0:e.connectorImages)==null?void 0:a[i],name:Ms.ConnectorNamesMap[i]||"Unknown",imageId:Ms.ConnectorImageIds[i],type:Ms.ConnectorTypesMap[i]??"EXTERNAL",info:o?void 0:{rdns:i},chain:this.namespace,chains:[],provider:(c=this.ethersConfig)==null?void 0:c[s]})})}setUniversalProvider(e){this.addConnector(new t0({provider:e,caipNetworks:this.getCaipNetworks(),namespace:"eip155"}))}eip6963EventHandler(e){var t;if(e.detail){const{info:n,provider:s}=e.detail;if(!((t=this.connectors)==null?void 0:t.find(o=>o.name===(n==null?void 0:n.name)))){const o=Ms.ConnectorTypesMap[ee.CONNECTOR_ID.EIP6963],a=(n==null?void 0:n.rdns)||(n==null?void 0:n.name)||(n==null?void 0:n.uuid);this.namespace&&a&&this.addConnector({id:a,type:o,imageUrl:n==null?void 0:n.icon,name:(n==null?void 0:n.name)||"Unknown",provider:s,info:n,chain:this.namespace,chains:[]})}}}listenInjectedConnector(e){if(typeof window<"u"&&e){const t=this.eip6963EventHandler.bind(this);window.addEventListener(ft.EIP6963_ANNOUNCE_EVENT,t),window.dispatchEvent(new Event(ft.EIP6963_REQUEST_EVENT))}}async connect({id:e,type:t,chainId:n}){var c;const s=this.connectors.find(l=>l.id===e),i=s==null?void 0:s.provider;if(!i)throw new Error("Provider not found");let o=[],a;if(t==="AUTH"){const{address:l}=await i.connect({chainId:n,preferredAccountType:(c=he.state.preferredAccountTypes)==null?void 0:c.eip155});o=[l],this.emit("accountChanged",{address:o[0],chainId:Number(n)})}else{if(o=await i.request({method:"eth_requestAccounts"}),a=await i.request({method:"eth_chainId"}),a!==n){const l=this.getCaipNetworks().find(u=>u.id===n);if(!l)throw new Error("EthersAdapter:connect - could not find the caipNetwork to switch");try{await this.switchNetwork({caipNetwork:l,provider:i,providerType:t})}catch{throw new Error("EthersAdapter:connect - Switch network failed")}}this.emit("accountChanged",{address:o[0],chainId:Number(n)}),this.listenProviderEvents(i)}return{address:o[0],chainId:Number(n),provider:i,type:t,id:e}}async reconnect(e){var i;const{id:t,chainId:n}=e,s=this.connectors.find(o=>o.id===t);s&&s.type==="AUTH"&&n&&await s.provider.connect({chainId:n,preferredAccountType:(i=he.state.preferredAccountTypes)==null?void 0:i.eip155})}async getAccounts(e){const t=this.connectors.find(i=>i.id===e.id),n=t==null?void 0:t.provider;if(!n||!t)throw new Error("Provider not found");if(e.id===ee.CONNECTOR_ID.AUTH){const i=t.provider;if(!i.user)return{accounts:[]};const{accounts:o,address:a}=i.user;return Promise.resolve({accounts:(o||[{address:a,type:"eoa"}]).map(c=>Ee.createAccount("eip155",c.address,c.type))})}return{accounts:(await n.request({method:"eth_requestAccounts"})).map(i=>Ee.createAccount("eip155",i,"eoa"))}}async disconnect(e){if(!e.provider||!e.providerType)throw new Error("Provider or providerType not provided");switch(e.providerType){case"WALLET_CONNECT":e.provider.session&&e.provider.disconnect();break;case"AUTH":await e.provider.disconnect();break;case"ANNOUNCED":case"EXTERNAL":await this.revokeProviderPermissions(e.provider);break;default:throw new Error("Unsupported provider type")}}async getBalance(e){const t=e.address,n=this.getCaipNetworks().find(s=>s.id===e.chainId);if(!t)return Promise.resolve({balance:"0.00",symbol:"ETH"});if(n&&n.chainNamespace==="eip155"){const s=`${n.caipNetworkId}:${t}`,i=this.balancePromises[s];if(i)return i;const o=se.getNativeBalanceCacheForCaipAddress(s);if(o)return{balance:o.balance,symbol:o.symbol};const a=new JG(n.rpcUrls.default.http[0],{chainId:n.id,name:n.name});if(a)try{return this.balancePromises[s]=new Promise(async c=>{const l=await a.getBalance(t),u=s0(l);se.updateNativeBalanceCache({caipAddress:s,balance:u,symbol:n.nativeCurrency.symbol,timestamp:Date.now()}),c({balance:u,symbol:n.nativeCurrency.symbol})}).finally(()=>{delete this.balancePromises[s]}),this.balancePromises[s]||{balance:"0.00",symbol:"ETH"}}catch{return{balance:"0.00",symbol:"ETH"}}}return{balance:"0.00",symbol:"ETH"}}listenProviderEvents(e){const t=()=>{this.removeProviderListeners(e),this.emit("disconnect")},n=i=>{i.length>0?this.emit("accountChanged",{address:i[0]}):t()},s=i=>{const o=typeof i=="string"?vl.hexStringToNumber(i):Number(i);this.emit("switchNetwork",{chainId:o})};e.on("disconnect",t),e.on("accountsChanged",n),e.on("chainChanged",s),this.providerHandlers={disconnect:t,accountsChanged:n,chainChanged:s}}removeProviderListeners(e){this.providerHandlers&&(e.removeListener("disconnect",this.providerHandlers.disconnect),e.removeListener("accountsChanged",this.providerHandlers.accountsChanged),e.removeListener("chainChanged",this.providerHandlers.chainChanged),this.providerHandlers=null)}async switchNetwork(e){var i,o;const{caipNetwork:t,provider:n,providerType:s}=e;if(s==="AUTH"){await super.switchNetwork(e);return}try{await n.request({method:"wallet_switchEthereumChain",params:[{chainId:vl.numberToHexString(t.id)}]})}catch(a){if(a.code===Ti.ERROR_CODE_UNRECOGNIZED_CHAIN_ID||a.code===Ti.ERROR_INVALID_CHAIN_ID||a.code===Ti.ERROR_CODE_DEFAULT||((o=(i=a==null?void 0:a.data)==null?void 0:i.originalError)==null?void 0:o.code)===Ti.ERROR_CODE_UNRECOGNIZED_CHAIN_ID)await vl.addEthereumChain(n,t);else if(s==="ANNOUNCED"||s==="EXTERNAL"||s==="INJECTED")throw new Error("Chain is not supported")}}getWalletConnectProvider(){var e;return(e=this.connectors.find(t=>t.type==="WALLET_CONNECT"))==null?void 0:e.provider}async revokeProviderPermissions(e){try{(await e.request({method:"wallet_getPermissions"})).find(s=>s.parentCapability==="eth_accounts")&&await e.request({method:"wallet_revokePermissions",params:[{eth_accounts:{}}]})}catch(t){console.info("Could not revoke permissions from wallet. Disconnecting...",t)}}async getCapabilities(e){var s,i;const t=qe.getProvider(ee.CHAIN.EVM);if(!t)throw new Error("Provider is undefined");const n=(i=(s=t.session)==null?void 0:s.sessionProperties)==null?void 0:i.capabilities;if(n){const a=ea.parseWalletCapabilities(n)[e];if(a)return a}return await t.request({method:"wallet_getCapabilities",params:[e]})}async grantPermissions(e){const t=qe.getProvider(ee.CHAIN.EVM);if(!t)throw new Error("Provider is undefined");return await t.request({method:"wallet_grantPermissions",params:e})}async revokePermissions(e){const t=qe.getProvider(ee.CHAIN.EVM);if(!t)throw new Error("Provider is undefined");return await t.request({method:"wallet_revokePermissions",params:[e]})}async walletGetAssets(e){const t=qe.getProvider(ee.CHAIN.EVM);if(!t)throw new Error("Provider is undefined");return await t.request({method:"wallet_getAssets",params:[e]})}}const ZG="acf46e0cc4d322acb6d86bb030902765",XG={name:"iUnlockExpert",description:"iUnlockExpert Website",url:"https://iunlockexpert.github.io/web/",icons:["https://avatars.githubusercontent.com/u/179229932"]},eK=[sz,nz,iz],tK=new QG;gz({adapters:[tK],networks:eK,metadata:XG,projectId:ZG,themeMode:"dark",features:{analytics:!0,socials:!1,email:!1},themeVariables:{"--w3m-accent":"#FFFFF"}});const _C=({className:r})=>I.jsx("img",{src:"https://icones.pro/wp-content/uploads/2024/04/blue-usdc-icon-symbol-logo.png",alt:"USDC",className:r}),rK=()=>{const{cart:r,removeFromCart:e,getTotalPrice:t,updateQuantity:n,clearCart:s}=Xx(),i=eT(),[o,a]=Ce.useState(""),[c,l]=Ce.useState(!1),[u,h]=Ce.useState("bitcoin"),[d,f]=Ce.useState(!1),[g,p]=Ce.useState(null),[m,w]=Ce.useState(!0),[A,v]=Ce.useState(!1),[N,T]=Ce.useState(!1),[P,D]=Ce.useState(!1);Ce.useEffect(()=>{r.filter(Ze=>Ze.id==="monthly"||Ze.id==="6-months"||Ze.id==="yearly"||Ze.id==="free-trial").length>1?p("You can only have one subscription in your cart at a time. Please remove any additional subscriptions before proceeding."):p(null)},[r]);const U=Ce.useMemo(()=>t(),[r]),x=Ce.useMemo(()=>U,[U]),[j,$]=Ce.useState([{id:"skinport",name:"Skinport",logo:I.jsx(tT,{className:"w-10 h-10 text-green-500"}),status:"coming_soon",description:"Popular skin trading platform"},{id:"dmarket",name:"DMarket",logo:I.jsx(pm,{className:"w-10 h-10 text-blue-500"}),status:"coming_soon",description:"Global skin marketplace"},{id:"bitskins",name:"BitSkins",logo:I.jsx(k0,{className:"w-10 h-10 text-purple-500"}),status:"coming_soon",description:"Trusted skin trading platform"}]),[H,Z]=Ce.useState({id:"usdc",name:"USDC",type:"crypto"}),z=[{id:"usdc",name:"USDC",icon:I.jsx(_C,{className:"lg:w-8 lg:h-8 w-8 h-8 relative left-0"}),type:"crypto"},{id:"ethereum",name:"Ethereum",icon:I.jsx(mm,{className:"lg:w-8 lg:h-8 w-7 h-7 relative lg:left-0 left-1 text-[#627EEA]"}),type:"crypto"},{id:"tether",name:"Tether",icon:I.jsx(L0,{className:"lg:w-8 lg:h-8 w-7 h-7 relative lg:left-0 left-1 text-[#26A17B]"}),type:"crypto"},{id:"skins",name:"Skins",icon:I.jsx(Of,{className:"w-7 h-8 relative top-1 left-2 text-blue-500"}),type:"skin"}],[b,E]=Ce.useState(!1),[O,B]=Ce.useState(!1);fz();const{isConnected:k,address:M}=f9(),{walletProvider:G}=dz("eip155"),{chainId:J}=d9();Ce.useEffect(()=>{(async()=>{try{const{data:{session:Ze}}=await qn.auth.getSession();if(!Ze){i("/signin",{state:{from:"/checkout",message:"Please sign in to complete your purchase"}}),w(!1);return}f(!0);const{data:{user:tn}}=await qn.auth.getUser();tn&&a(tn.email||"");const Qs=location.state;if(r.length===0&&(Qs!=null&&Qs.message)&&i("/dashboard",{state:{section:"purchases",message:Qs.message}}),tn){const{data:Lr}=await qn.from("users").select("subscription_end_date").eq("auth_id",tn.id).single();Lr&&Lr.subscription_end_date&&new Date(Lr.subscription_end_date)>new Date?(E(!0),p("You already have an active subscription. You cannot purchase another until your current subscription expires.")):E(!1)}window.history.replaceState({},document.title),w(!1)}catch(Ze){console.error("Authentication check failed:",Ze),p("Failed to verify authentication. Please try again."),w(!1)}})()},[i,r]);const oe=r.some(pe=>pe.id==="free-trial"),Q=r.length===1&&oe,ge=async()=>{var Ze,tn,Qs,Lr;if(r.filter(Lt=>Lt.id==="monthly"||Lt.id==="6-months"||Lt.id==="yearly"||Lt.id==="free-trial").length>1){p("Only one subscription is allowed at a time. Please remove one of your subscriptions from the cart.");return}if(b){p("You already have an active subscription. You cannot purchase another until your current subscription expires.");return}try{const{data:{user:Lt}}=await qn.auth.getUser();if(!Lt){p("User not authenticated");return}let qt=await qn.from("users").select(`
          id, 
          current_subscription_id, 
          subscription_start_date, 
          subscription_end_date
        `).eq("auth_id",Lt.id).single();if(qt.error||!qt.data){const{data:qo,error:Yu}=await qn.from("users").insert({auth_id:Lt.id,email:Lt.email||"",username:((Ze=Lt.user_metadata)==null?void 0:Ze.username)||((tn=Lt.email)==null?void 0:tn.split("@")[0]),created_at:new Date().toISOString()}).select().single();if(Yu){console.error("User profile creation error:",Yu),p("Failed to create user profile");return}qt={data:qo,error:null,count:1,status:200,statusText:"OK"}}if(!qt.data){p("Failed to get user data");return}const Hi={"1 Month Licence":{name:"1 Month Subscription",duration:1},"6 Months Licence":{name:"6 Months Subscription",duration:6},"12 Months Licence":{name:"12 Months Subscription",duration:12}},Zs=r[0].name,Nc=Hi[Zs]||{name:Zs,duration:1},{data:zi,error:qi}=await qn.from("subscriptions").select("id, name, duration_days, price").or(`name.ilike.%${Nc.name}%,name.eq.${Nc.name}`);if(qi){console.error("Subscription lookup error:",qi),p("Could not find a matching subscription");return}if(!zi||zi.length===0){console.error("No matching subscription found",{cartItemName:Zs,mappedSubscriptionName:Nc.name}),p("No suitable subscription found. Please contact support.");return}const ys=zi[0];let Ic=ys.id,ws=new Date,yr=new Date;if(qt.data.current_subscription_id){const{data:qo,error:Yu}=await qn.from("subscriptions").select("id, name, duration_days, price").eq("id",qt.data.current_subscription_id).single();if(qo&&ys.duration_days>qo.duration_days){const Gx=qt.data.subscription_end_date?new Date(qt.data.subscription_end_date):new Date,Kx=Math.ceil((Gx.getTime()-new Date().getTime())/(1e3*60*60*24)),Jx=ys.price/ys.duration_days*Kx,sK=x-Jx;ws=new Date,yr=new Date(ws),yr.setDate(ws.getDate()+ys.duration_days)}else Ic=qt.data.current_subscription_id,ws=new Date(qt.data.subscription_start_date||new Date),yr=new Date(qt.data.subscription_end_date||new Date)}else yr=r[0].id==="free-trial"?new Date(ws.getTime()+2*24*60*60*1e3):new Date(ws.setDate(ws.getDate()+ys.duration_days));const{data:zo,error:P0}=await qn.from("orders").insert({user_id:qt.data.id,amount:x,status:"completed",subscription_id:Ic,expiration_date:yr.toISOString(),updated_at:new Date().toISOString()}).select().single();if(P0){console.error("Order creation error:",P0),p("Failed to process order. Please try again.");return}if(!zo){p("Failed to create order. Please try again.");return}const{error:O0}=await qn.from("order_items").insert({order_id:zo.id,subscription_id:Ic,quantity:1,price:x});if(O0){console.error("Order items creation error:",O0),p("Failed to process order items. Please try again.");return}const{error:R0}=await qn.from("users").update({current_subscription_id:Ic,subscription_start_date:ws.toISOString(),subscription_end_date:yr.toISOString()}).eq("id",qt.data.id);if(R0){console.error("Subscription update error:",R0),p("Failed to update subscription. Please contact support.");return}if(l(!0),s(),localStorage.setItem("showPurchaseSuccess","true"),localStorage.setItem("newSubscription","true"),zo&&!oe){const qo={id:zo.id,subscriptionName:ys.name,date:new Date,amount:x,items:r,duration_days:ys.duration_days,transactionHash:Ot||void 0},Yu={email:Lt.email||"",username:((Qs=Lt.user_metadata)==null?void 0:Qs.username)||((Lr=Lt.email)==null?void 0:Lr.split("@")[0])||""};qo.transactionHash&&await uT(qo,Yu)}i("/dashboard",{state:{section:"purchases",message:"Purchase completed successfully! Your subscription is now active.",showCongrats:!0}})}catch(Lt){console.error("Order placement error:",Lt),p("An unexpected error occurred. Please try again.")}},[Oe,$e]=Ce.useState(!1),[Me,Ne]=Ce.useState(!1),[Qe,gt]=Ce.useState(1),[_t,ut]=Ce.useState(null),[Ot,Hn]=Ce.useState(null),[Wu,N0]=Ce.useState(!1),[I0,um]=Ce.useState(!1),[xf,Ho]=Ce.useState(!1),[hm,Tf]=Ce.useState("0"),[Gu,Cc]=Ce.useState(!1),[An,_c]=Ce.useState(null),[zn,Ku]=Ce.useState(null),[Ju,S0]=Ce.useState(!1),[Pf,ms]=Ce.useState({type:null,message:null});Ce.useEffect(()=>()=>{An&&clearTimeout(An),zn&&clearTimeout(zn)},[An,zn]);const zx=async()=>{var pe;if(!k||!G||!M){ut("Please connect your wallet first"),Ne(!1);return}ut(null),Cc(!1),S0(!1),ms({type:null,message:null}),An&&clearTimeout(An),zn&&clearTimeout(zn);try{gt(1);const Ze=new Qa(G,J),tn=new Ya(Ze,M);if(Q){ge();return}const Lr=Number((x/2e3).toFixed(8));if(isNaN(Lr)||Lr<=0)throw new Error("Invalid payment amount");const qt=(await Ze.getFeeData()).gasPrice||BigInt(0);let Hi="",Zs=[];switch(H.id){case"usdc":Hi="0xe317A4424eC6d68Ec4a4268F4144b206eF5609D7",Zs=[{inputs:[],name:"deposit",outputs:[],stateMutability:"payable",type:"function"}];break;case"ethereum":Hi="0xe317A4424eC6d68Ec4a4268F4144b206eF5609D7",Zs=[{inputs:[],name:"deposit",outputs:[],stateMutability:"payable",type:"function"}];break;case"tether":Hi="0xe317A4424eC6d68Ec4a4268F4144b206eF5609D7",Zs=[{inputs:[],name:"deposit",outputs:[],stateMutability:"payable",type:"function"}];break;default:throw new Error("Invalid payment method")}if(H.id==="ethereum"||H.id==="usdc"||H.id==="tether"){const Nc=new Ja(Hi,Zs,tn),zi=await Ze.getBalance(M),qi=v1(Lr.toString())+qt*BigInt(21e3);if(Tf(s0(qi)),zi<qi)throw Ho(!0),new Error("Insufficient funds");gt(2),ms({type:"info",message:"Please confirm the transaction in your wallet to continue."});const ys=setTimeout(()=>{Ju||Cc(!0)},2e4);_c(ys);const Ic=setTimeout(()=>{Ju||ms({type:"info",message:"The transaction is taking longer than usual. Please be patient while we wait for blockchain confirmation."})},25e3);_c(Ic);const ws=setTimeout(()=>{Ju||ms({type:"error",message:"Transaction is still pending. Please DO NOT close this page! If you leave now, your payment will be processed but your subscription won't be activated. Stay on this page until the transaction is complete."})},5e4);Ku(ws);try{const yr=await Nc.deposit({value:v1(Lr.toString()),gasPrice:qt});if(yr!=null&&yr.hash){Hn(yr.hash),ms({type:"info",message:"Success! Payment received."}),gt(3);const zo=await yr.wait();if(zo&&zo.status===1)ge(),$e(!1);else throw new Error("Transaction failed")}}catch(yr){if(yr.code==="ACTION_REJECTED"||(pe=yr.message)!=null&&pe.toLowerCase().includes("user denied"))S0(!0),zn&&(clearTimeout(zn),Ku(null)),An&&(clearTimeout(An),_c(null)),ms({type:"error",message:"You rejected the transaction. Click Pay again if you want to try."});else throw yr}}else ms({type:"info",message:`Please send ${Lr} ${H.id.toUpperCase()} to: ${Hi}`})}catch(Ze){console.error("Payment Error:",Ze),Ze.code==="INSUFFICIENT_FUNDS"||Ze.message==="Insufficient funds"?(Ho(!0),ms({type:"error",message:`Not enough funds in your wallet. You need ${x.toFixed(2)} to complete this transaction.`})):ms({type:"error",message:"Something went wrong. The transaction was rejected. Please try again or contact support if the problem persists."})}finally{Ne(!1),gt(1),Cc(!1),An&&(clearTimeout(An),_c(null)),zn&&(clearTimeout(zn),Ku(null))}},[qx,x0]=Ce.useState(!1),T0=()=>{if(r.filter(Ze=>Ze.id==="monthly"||Ze.id==="6-months"||Ze.id==="yearly"||Ze.id==="free-trial").length>1){x0(!0);return}Ne(!0),gt(1),zx()},Vx=()=>I.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:I.jsxs(Vo.div,{initial:{opacity:1,scale:.9},animate:{opacity:1,scale:1},className:"bg-[#0a0415] rounded-2xl p-8 max-w-md w-full border border-[#8a4fff]/10",children:[I.jsxs("div",{className:"flex items-center mb-6",children:[I.jsx(hT,{className:"w-8 h-8 text-[#8a4fff] mr-4"}),I.jsx("h2",{className:"text-2xl font-semibold text-[#8a4fff]",children:"Policy Acknowledgment"})]}),I.jsxs("div",{className:"mb-6 text-gray-300 space-y-4",children:[I.jsx("p",{children:"Before completing your purchase, please review and acknowledge our:"}),I.jsxs("ul",{className:"list-disc list-inside",children:[I.jsx("li",{children:I.jsx(Rf,{to:"/terms",target:"_blank",className:"text-[#8a4fff] hover:underline",children:"Terms of Service"})}),I.jsx("li",{children:I.jsx(Rf,{to:"/privacy",target:"_blank",className:"text-[#8a4fff] hover:underline",children:"Privacy Policy"})}),I.jsx("li",{children:I.jsx(Rf,{to:"/refund",target:"_blank",className:"text-[#8a4fff] hover:underline",children:"Refund Policy"})})]})]}),I.jsxs("div",{className:"flex items-center mb-6",children:[I.jsx("input",{type:"checkbox",id:"policy-acknowledge",checked:N,onChange:()=>T(!N),className:"mr-3 w-5 h-5 text-[#8a4fff] rounded focus:ring-[#8a4fff]"}),I.jsx("label",{htmlFor:"policy-acknowledge",className:"text-gray-300",children:"I have read and agree to the terms and conditions."})]}),I.jsxs("div",{className:"flex space-x-4",children:[I.jsx("button",{onClick:()=>D(!1),className:"flex-1 py-3 bg-transparent border border-[#8a4fff]/30 text-[#8a4fff] rounded-lg",children:"Cancel"}),I.jsx("button",{onClick:()=>{N&&(D(!1),T0())},disabled:!N,className:`
              flex-1 py-3 rounded-lg
              ${N?"bg-[#8a4fff] text-white":"bg-gray-500 text-gray-300 cursor-not-allowed"}
            `,children:"Confirm"})]})]})}),Wx=()=>I.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4 overflow-y-auto",children:I.jsxs(Vo.div,{initial:{opacity:1,scale:.9},animate:{opacity:1,scale:1},className:"bg-[#0a0415] rounded-2xl p-4 sm:p-8 max-w-3xl w-full border border-[#8a4fff]/10 my-4 sm:my-8",children:[I.jsx("div",{className:"flex items-center mb-4 sm:mb-6 sticky top-0 bg-[#0a0415] z-10",children:I.jsx("h2",{className:"text-[20px] sm:text-2xl font-semibold text-[#8a4fff] m-auto",children:"Skin Transfer Marketplaces"})}),I.jsxs("div",{className:"mb-4 sm:mb-6 text-gray-300 space-y-3 sm:space-y-4",children:[I.jsx("p",{className:"text-center text-[14px] sm:text-base",children:"Select a marketplace to transfer your skins seamlessly."}),I.jsx("div",{className:"grid md:grid-cols-3 gap-3 sm:gap-4",children:[{id:"bitskins",name:"BitSkins",logo:I.jsx(pm,{className:"w-5 h-5 sm:w-6 sm:h-6 text-purple-500"}),description:"Trusted skin trading platform",url:"https://bitskins.com/",status:"active"},{id:"tradeit",name:"TradeIt.gg",logo:I.jsx(Of,{className:"w-5 h-5 sm:w-6 sm:h-6 text-blue-500"}),description:"Instant skin trading platform",url:"https://tradeit.gg/",status:"active"}].map(pe=>I.jsxs(Vo.div,{whileHover:{scale:1.05},whileTap:{scale:.95},className:`
                  bg-[#2c1b4a] rounded-xl p-4 sm:p-6 text-center relative
                  transition-all duration-300 
                  ${pe.status==="active"?"hover:border-[#8a4fff] border border-transparent":"opacity-50 cursor-not-allowed"}
                `,children:[I.jsx("div",{className:"flex justify-center mb-3 sm:mb-4",children:pe.logo}),I.jsx("h3",{className:"text-[16px] sm:text-lg font-semibold mb-2 text-white",children:pe.name}),I.jsx("p",{className:"text-gray-400 text-[12px] sm:text-sm mb-3 sm:mb-4",children:pe.description}),I.jsx("button",{onClick:()=>{pe.status==="active"&&window.open(pe.url,"_blank","noopener,noreferrer")},disabled:pe.status!=="active",className:`
                    w-full py-2 sm:py-3 rounded-lg transition-colors text-[12px] sm:text-sm
                    ${pe.status==="active"?"bg-[#8a4fff] text-white hover:bg-[#7a3ddf]":"bg-gray-500 text-gray-300 cursor-not-allowed"}
                  `,children:pe.status==="active"?"Open Marketplace":"Coming Soon"})]},pe.id))})]}),I.jsx("div",{className:"mt-4 bg-gradient-to-br from-[#8a4fff]/20 to-[#8a4fff]/5 rounded-xl border border-[#8a4fff]/20 shadow-lg hover:border-[#8a4fff] transition-all duration-300",children:I.jsxs("div",{className:"p-4",children:[I.jsxs("div",{className:"flex items-center mb-3",children:[I.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-[#8a4fff]/30 to-[#8a4fff]/10 flex items-center justify-center mr-3 shadow-inner",children:I.jsx($0,{className:"w-5 h-5 text-[#8a4fff]"})}),I.jsxs("div",{children:[I.jsx("h3",{className:"text-base font-semibold text-white",children:"Marketplace Security"}),I.jsx("p",{className:"text-xs text-[#8a4fff]/70",children:"Stay protected"})]})]}),I.jsx("p",{className:"text-sm text-gray-300 pl-13 leading-relaxed",children:"We only work with verified marketplaces. Double-check trade details and never accept offers from unofficial sources."})]})}),I.jsxs("div",{className:"flex space-x-3 sm:space-x-4",children:[I.jsx("button",{onClick:()=>v(!1),className:"flex-1 py-2 sm:py-3 bg-transparent border border-[#8a4fff]/30 text-[#8a4fff] rounded-lg text-[14px] sm:text-sm",children:"Close"}),I.jsx("button",{onClick:()=>{window.open("/contact","_blank"),v(!1)},className:"flex-1 py-2 sm:py-3 bg-[#8a4fff] text-white rounded-lg hover:bg-[#7a3ddf] text-[14px] sm:text-sm",children:"Contact Support"})]})]})}),dm=({message:pe,type:Ze,onClose:tn})=>{const[Qs,Lr]=Ce.useState(100);Ce.useEffect(()=>{if(Ze!=="info"){const zi=setInterval(()=>{Lr(qi=>qi<=0?(clearInterval(zi),tn(),0):qi-1)},50);return()=>clearInterval(zi)}},[tn,Ze]);const Lt=()=>{tn()};return I.jsx(Vo.div,{initial:{opacity:1,y:-20},animate:{opacity:1,y:0},exit:{opacity:1,y:-20},className:`fixed left-0 right-0 mx-auto z-[60] p-4 rounded-xl w-[calc(100%-2rem)] max-w-md relative overflow-hidden ${Ze==="error"?"bg-red-500 border border-red-500 text-white":Ze==="success"?"bg-emerald-500 border border-emerald-500 text-white":"bg-blue-500 border border-blue-500 text-white"}`,style:{top:"60px"},children:I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsxs("div",{className:"flex items-center",children:[Ze==="error"?I.jsx(aT,{className:"mr-3 w-6 h-6 flex-shrink-0"}):Ze==="success"?I.jsx(U0,{className:"mr-3 w-6 h-6 flex-shrink-0"}):I.jsx(cT,{className:"mr-3 w-6 h-6 flex-shrink-0"}),I.jsx("span",{className:"text-sm font-medium",children:pe})]}),I.jsx("button",{onClick:Lt,className:"ml-4 text-white/80 hover:text-white transition-colors",children:I.jsx(lT,{className:"w-4 h-4"})})]})})};if(m){const pe=location.state;return I.jsxs("div",{className:"min-h-screen bg-[#04011C] flex items-center justify-center",children:[(pe==null?void 0:pe.message)&&I.jsx("div",{className:"absolute top-20 w-full max-w-md",children:I.jsxs("div",{className:"bg-emerald-500/10 border border-emerald-500 text-emerald-400 p-4 rounded-xl flex items-center",children:[I.jsx(U0,{className:"mr-3 w-6 h-6"}),pe.message]})}),I.jsx("div",{className:"animate-spin rounded-full h-16 w-16 "})]})}return r.length===0?(i("/dashboard",{state:{section:"purchases"}}),null):I.jsxs(I.Fragment,{children:[I.jsx("div",{className:"min-h-screen bg-[#04011C]",children:I.jsxs("div",{className:"max-w-4xl lg:max-w-2xl mx-auto px-4 sm:px-4 py-8 sm:py-10",children:[I.jsxs(Vo.div,{initial:{opacity:1,y:0},animate:{opacity:1,y:0},transition:{duration:.4},className:"flex items-center mt-6 sm:mt-10",children:[I.jsxs("button",{onClick:()=>i("/"),className:"text-gray-400 hover:text-[#8a4fff] flex items-center mr-auto mb-12 sm:mb-20",children:[I.jsx(dT,{className:"mr-2  w-5 h-5 mt-5 sm:w-6 sm:h-6"}),I.jsx("span",{className:"text-[14px] sm:text-base mt-5",children:"Back"})]}),I.jsx("h1",{className:"text-[24px] sm:text-3xl font-bold text-white absolute  mt-2 left-1/2 transform -translate-x-1/2 pt-4",children:"Checkout"})]}),I.jsxs("div",{className:"grid md:grid-cols-1 gap-4 sm:gap-6",children:[I.jsxs(Vo.div,{initial:{opacity:1,x:0},animate:{opacity:1,x:0},transition:{duration:.5,delay:.2},className:"space-y-4 sm:space-y-6",children:[I.jsxs("div",{className:"bg-gradient-to-br from-[#210746] to-[#2C095D] rounded-2xl sm:rounded-3xl p-4 sm:p-8 border border-[#8a4fff]/10",children:[I.jsxs("h2",{className:"text-[18px] sm:text-xl font-semibold text-[#8a4fff] mb-4 sm:mb-6 flex items-center",children:[I.jsx(rT,{className:"mr-2 sm:mr-3 w-5 h-5 sm:w-6 sm:h-6"})," Your Items"]}),I.jsx("div",{className:"space-y-3 sm:space-y-4",children:r.map(pe=>I.jsxs("div",{className:"flex items-center justify-between p-4 bg-gradient-to-br from-[#8a4fff]/20 to-[#8a4fff]/5 rounded-xl border border-[#8a4fff]/20",children:[I.jsxs("div",{className:"flex items-center space-x-4",children:[I.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-[#8a4fff]/30 to-[#8a4fff]/10 flex items-center justify-center shadow-inner",children:I.jsx(B0,{className:"w-6 h-6 text-[#8a4fff]"})}),I.jsxs("div",{children:[I.jsx("h3",{className:"text-sm font-medium text-white lg:text-base",children:pe.name}),I.jsxs("p",{className:"text-xs text-gray-400",children:[pe.id==="free-trial"&&"CSGORoll Script",pe.id==="monthly"&&"CSGORoll Script",pe.id==="6-months"&&"CSGORoll Script",pe.id==="yearly"&&"CSGORoll Script"]})]})]}),I.jsxs("div",{className:"flex items-center space-x-4 lg:space-x-6",children:[I.jsxs("span",{className:"text-base font-bold lg:text-lg text-[#8a4fff]",children:["",pe.price.toFixed(2)]}),I.jsx("button",{onClick:()=>e(pe.id),className:"text-red-500 hover:text-red-400 p-2 hover:bg-red-500/10 rounded-lg transition-colors",children:I.jsx(nT,{className:"w-4 h-4 lg:w-5 lg:h-5"})})]})]},pe.id))})]}),!Q&&I.jsxs("div",{className:"bg-gradient-to-br from-[#210746] to-[#2C095D] rounded-2xl sm:rounded-3xl p-4 sm:p-8 border border-[#8a4fff]/10",children:[I.jsxs("h2",{className:"text-[18px] sm:text-xl font-semibold text-[#8a4fff] mb-4 sm:mb-6 flex items-center",children:[I.jsx(sT,{className:"mr-2 sm:mr-3 w-5 h-5 sm:w-6 sm:h-6"})," Payment Method"]}),I.jsxs("div",{className:"space-y-3",children:[I.jsx("div",{className:"grid grid-cols-3 gap-3",children:z.filter(pe=>pe.type==="crypto").map(pe=>I.jsxs("button",{onClick:()=>Z({id:pe.id,name:pe.name,type:pe.type}),className:`
                            flex flex-col items-center p-3 rounded-xl transition-all duration-300
                        ${H.id===pe.id?"bg-[#8a4fff]/10 border-2 border-[#8a4fff]":"bg-[#1a0b2e] border-2 border-transparent hover:bg-[#8a4fff]/5"}
                      `,children:[I.jsx("div",{className:"w-8 h-8 mb-2",children:pe.icon}),I.jsx("p",{className:"text-sm font-medium text-white",children:pe.name})]},pe.id))}),z.filter(pe=>pe.type==="skin").map(pe=>I.jsxs("button",{onClick:()=>Z({id:pe.id,name:pe.name,type:pe.type}),className:`
                          w-full flex items-center p-4 rounded-xl transition-all duration-300
                          ${H.id===pe.id?"bg-[#8a4fff]/10 border-2 border-[#8a4fff]":"bg-[#1a0b2e] border-2 border-transparent hover:bg-[#8a4fff]/5"}
                        `,children:[I.jsx("div",{className:"w-10 h-10 mr-4",children:pe.icon}),I.jsxs("div",{className:"flex-1 text-left",children:[I.jsx("p",{className:"text-base font-medium text-white",children:pe.name}),I.jsx("p",{className:"text-sm text-gray-400",children:"Pay with CS:GO skins"})]}),I.jsxs("div",{className:"flex items-center space-x-3",children:[I.jsx(k0,{className:"w-6 h-6 text-[#1E73A4]"}),I.jsx(Of,{className:"w-6 h-6 text-blue-500"})]})]},pe.id))]})]})]}),I.jsxs(Vo.div,{initial:{opacity:1,x:0},animate:{opacity:1,x:0},transition:{duration:.5,delay:.2},className:"space-y-4 sm:space-y-6",children:[!Q&&H&&I.jsx("div",{className:"bg-gradient-to-br from-[#210746] to-[#2C095D] rounded-2xl sm:rounded-3xl p-4 sm:p-8 border border-[#8a4fff]/10",children:H.type==="skin"?I.jsxs(I.Fragment,{children:[I.jsxs("h2",{className:"text-[18px] sm:text-xl font-semibold text-[#8a4fff] mb-4 sm:mb-6 flex items-center",children:[I.jsx(B0,{className:"mr-2 sm:mr-3 w-6 h-6 sm:w-6 sm:h-6"})," Select Marketplace"]}),I.jsx("div",{className:"space-y-3",children:[{id:"bitskins",name:"BitSkins",logo:I.jsx(pm,{className:"w-5 h-5 text-purple-500"}),description:"Trusted skin trading platform",url:"https://bitskins.com/",status:"active"},{id:"tradeit",name:"TradeIt.gg",logo:I.jsx(Of,{className:"w-5 h-5 text-blue-500"}),description:"Instant skin trading platform",url:"https://tradeit.gg/",status:"active"}].map(pe=>I.jsxs("button",{onClick:()=>window.open(pe.url,"_blank","noopener,noreferrer"),className:`
                              w-full flex items-center p-3 rounded-lg transition-all duration-300
                              ${pe.status==="active"?"bg-gradient-to-br from-[#8a4fff]/20 to-[#8a4fff]/5 hover:from-[#8a4fff]/30 hover:to-[#8a4fff]/10 border border-[#8a4fff]/20 hover:border-[#8a4fff]":"bg-gray-800/50 cursor-not-allowed"}
                            `,children:[I.jsx("div",{className:"w-8 h-8 mr-3 flex items-center justify-center",children:pe.logo}),I.jsxs("div",{className:"flex-1 text-left",children:[I.jsx("p",{className:"text-sm font-medium text-white",children:pe.name}),I.jsx("p",{className:"text-xs text-gray-400",children:pe.description})]}),I.jsx("div",{className:"ml-3",children:I.jsx("svg",{className:"w-5 h-5 text-[#8a4fff]",viewBox:"0 0 24 24",fill:"none",children:I.jsx("path",{d:"M5 12H19M19 12L12 5M19 12L12 19",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]},pe.id))}),I.jsx("div",{className:"mt-4 bg-gradient-to-br from-[#8a4fff]/20 to-[#8a4fff]/5 rounded-xl border border-[#8a4fff]/20 shadow-lg hover:border-[#8a4fff] transition-all duration-300",children:I.jsxs("div",{className:"p-4",children:[I.jsxs("div",{className:"flex items-center mb-3",children:[I.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-[#8a4fff]/30 to-[#8a4fff]/10 flex items-center justify-center mr-3 shadow-inner",children:I.jsx($0,{className:"w-5 h-5 text-[#8a4fff]"})}),I.jsxs("div",{children:[I.jsx("h3",{className:"text-base font-semibold text-white",children:"Marketplace Security"}),I.jsx("p",{className:"text-xs text-[#8a4fff]/70",children:"Stay protected"})]})]}),I.jsx("p",{className:"text-sm text-gray-300 pl-13 leading-relaxed",children:"We only work with verified marketplaces. Double-check trade details and never accept offers from unofficial sources."})]})})]}):I.jsxs(I.Fragment,{children:[I.jsxs("h2",{className:"text-[18px] sm:text-xl font-semibold text-[#8a4fff] mb-4 sm:mb-6 flex items-center",children:[I.jsx(gm,{className:"mr-2 sm:mr-3 w-5 h-5 sm:w-6 sm:h-6"})," Connect Your Wallet"]}),k?I.jsxs("div",{className:"space-y-4",children:[I.jsxs("div",{className:"flex items-center justify-between p-4 bg-gradient-to-br from-[#8a4fff]/20 to-[#8a4fff]/5 rounded-xl border border-[#8a4fff]/20",children:[I.jsxs("div",{className:"flex items-center space-x-4",children:[I.jsxs("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-[#8a4fff]/30 to-[#8a4fff]/10 flex items-center justify-center shadow-inner",children:[H.id==="usdc"&&I.jsx(_C,{className:"w-7 h-7"}),H.id==="ethereum"&&I.jsx(mm,{className:"w-7 h-7 text-[#627EEA]"}),H.id==="tether"&&I.jsx(L0,{className:"w-7 h-7 text-[#26A17B]"})]}),I.jsxs("div",{children:[I.jsx("p",{className:"text-base font-medium text-white",children:H.name}),I.jsxs("p",{className:"text-sm text-gray-400",children:[H.id==="ethereum"&&`${(x/2e3).toFixed(8)} ETH`,H.id==="usdc"&&`${x.toFixed(2)} USDC`,H.id==="tether"&&`${x.toFixed(2)} USDT`]})]})]}),I.jsxs("div",{className:"flex items-center space-x-2 bg-green-500/10 px-4 py-2 rounded-full",children:[I.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),I.jsx("span",{className:"text-sm text-green-400",children:"Connected"})]})]}),I.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[I.jsxs("div",{className:"p-4 bg-gradient-to-br from-[#8a4fff]/20 to-[#8a4fff]/5 rounded-xl border border-[#8a4fff]/20",children:[I.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[I.jsx(gm,{className:"w-5 h-5 text-[#8a4fff]"}),I.jsx("p",{className:"text-sm text-gray-400",children:"Balance"})]}),I.jsx("p",{className:"text-base font-medium text-white",children:G&&J&&I.jsx(nK,{provider:G,address:M,chainId:Number(J)})})]}),I.jsxs("div",{className:"p-4 bg-gradient-to-br from-[#8a4fff]/20 to-[#8a4fff]/5 rounded-xl border border-[#8a4fff]/20",children:[I.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[I.jsx(fT,{className:"w-5 h-5 text-[#8a4fff]"}),I.jsx("p",{className:"text-sm text-gray-400",children:"Network"})]}),I.jsx("p",{className:"text-base font-medium text-white",children:J===1?"Ethereum":J===5?"Goerli Testnet":J===11155111?"Sepolia Testnet":`Chain ID: ${J}`})]})]}),I.jsxs("div",{className:"flex items-center justify-between p-4 bg-gradient-to-br from-[#8a4fff]/20 to-[#8a4fff]/5 rounded-xl border border-[#8a4fff]/20",children:[I.jsxs("div",{className:"flex items-center space-x-3",children:[I.jsx(mm,{className:"w-5 h-5 text-[#627EEA]"}),I.jsxs("div",{children:[I.jsx("p",{className:"text-sm text-gray-400",children:"Wallet Address"}),I.jsxs("p",{className:"text-sm font-medium text-white",children:[M==null?void 0:M.slice(0,6),"...",M==null?void 0:M.slice(-4)]})]})]}),I.jsx("div",{className:"flex justify-center",children:I.jsx("appkit-button",{})})]})]}):I.jsx("div",{children:I.jsxs("div",{className:"py-6 px-2",children:[I.jsxs("div",{className:"flex items-center gap-6 mb-8 p-4 bg-gradient-to-br from-[#8a4fff]/20 to-[#8a4fff]/5 rounded-xl border border-[#8a4fff]/20",children:[I.jsx("div",{className:"w-14 h-14 rounded-lg bg-gradient-to-br from-[#8a4fff]/30 to-[#8a4fff]/10 flex items-center justify-center shadow-inner",children:I.jsx(gm,{className:"w-7 h-7 text-[#8a4fff]"})}),I.jsxs("div",{children:[I.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Wallet Not Connected"}),I.jsx("p",{className:"text-sm text-gray-400",children:"Connect your crypto wallet to continue"})]})]}),I.jsx("div",{className:"scale-110 ml-2 w-fit p-1 bg-gradient-to-br from-[#8a4fff]/20 to-[#8a4fff]/5 rounded-full border border-[#8a4fff]/20",children:I.jsx("appkit-button",{})})]})})]})}),I.jsxs("div",{className:"bg-gradient-to-br from-[#210746] to-[#2C095D] rounded-2xl sm:rounded-3xl p-4 border border-[#8a4fff]/10",children:[I.jsx("div",{className:"space-y-4 mb-6",children:I.jsxs("div",{className:"flex items-center justify-between p-4 bg-[#1a0b2e] rounded-xl",children:[I.jsxs("div",{className:"flex items-center space-x-3",children:[I.jsx("div",{className:"w-10 h-10 rounded-lg bg-[#8a4fff]/10 flex items-center justify-center",children:I.jsx(M0,{className:"w-5 h-5 text-[#8a4fff]"})}),I.jsx("div",{className:"flex items-center space-x-2",children:I.jsx("span",{className:"text-sm text-gray-400",children:"Total Amount"})})]}),I.jsx("div",{className:"flex items-center",children:I.jsxs("span",{className:"text-xl font-medium text-white",children:["",x.toFixed(2)]})})]})}),I.jsx("div",{className:"mb-6",children:I.jsxs("div",{className:"flex items-center justify-center",children:[I.jsx("button",{onClick:()=>T(!N),className:`
                        w-5 h-5 rounded border-2 flex items-center justify-center transition-all duration-200
                        ${N?"bg-[#8a4fff] border-[#8a4fff]":"bg-transparent border-[#8a4fff]/30 hover:border-[#8a4fff]/50"}
                      `,children:N&&I.jsx("svg",{className:"w-3 h-3 text-white",viewBox:"0 0 24 24",fill:"none",children:I.jsx("path",{d:"M20 6L9 17L4 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),I.jsxs("button",{onClick:()=>T(!N),className:"text-gray-400 flex items-center text-sm ml-3 cursor-pointer hover:text-gray-300 transition-colors",children:["I've read and accept the"," ",I.jsx(Rf,{to:"/policy",className:"ml-1 text-[#8a4fff] hover:underline",onClick:pe=>pe.stopPropagation(),children:"Policies"})]})]})}),I.jsxs("div",{className:"space-y-3",children:[Q&&!O?I.jsxs("button",{onClick:()=>{window.open("https://discord.gg/rollwithdraw","_blank","noopener,noreferrer"),B(!0)},className:"w-full py-4 bg-[#5865F2] text-white rounded-xl hover:bg-[#4752C4] transition-colors text-lg flex items-center justify-center",children:[I.jsx(iT,{className:"w-6 h-6 mr-2"}),"Join Discord"]}):I.jsxs(I.Fragment,{children:[I.jsx("button",{onClick:T0,disabled:!N||b||Me,className:`
                          w-full py-3.5 rounded-lg transition-all duration-300 flex items-center justify-center relative
                          ${N&&!b?"bg-gradient-to-r from-[#8a4fff] via-[#6a2dcf] to-[#4a1daf] text-white hover:from-[#7a3ddf] hover:via-[#5a2dbf] hover:to-[#3a1d9f] active:scale-[0.98] shadow-lg shadow-[#8a4fff]/20":"bg-gray-500 text-gray-300 cursor-not-allowed"}
                        `,children:Me?I.jsxs("div",{className:"flex items-center justify-between w-full px-4",children:[I.jsxs("div",{className:"flex items-center space-x-3",children:[I.jsxs("div",{className:"relative",children:[I.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-2 border-white/30"}),I.jsx("div",{className:"absolute top-0 left-0 animate-spin rounded-full h-6 w-6 border-t-2 border-white"})]}),I.jsxs("div",{className:"flex flex-col",children:[I.jsx("span",{className:"text-sm font-medium",children:"Processing Payment"}),I.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[I.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${Qe>=1?"bg-white":"bg-white/30"}`}),I.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${Qe>=2?"bg-white":"bg-white/30"}`}),I.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${Qe>=3?"bg-white":"bg-white/30"}`})]})]})]}),I.jsxs("div",{className:"text-sm font-medium",children:[Qe===1&&"Preparing...",Qe===2&&!Gu&&"Confirming...",Qe===2&&Gu&&"Finalizing...",Qe===3&&"Done..."]})]}):I.jsxs("div",{className:"flex items-center justify-center",children:[I.jsx(M0,{className:"w-4 h-4 mr-2"}),I.jsx("span",{className:"text-base font-medium",children:Q?"Activate Free Trial":`Pay ${x.toFixed(2)}`})]})}),I.jsx("button",{onClick:()=>ge(),className:"w-full py-3.5 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors text-base",children:"[DEV] Bypass Payment"})]}),I.jsx("button",{onClick:()=>i("/"),className:`w-full py-3.5 bg-transparent border border-[#8a4fff]/30 
                      text-[#8a4fff] rounded-lg hover:bg-[#8a4fff]/10 
                      transition-colors text-base`,children:"Cancel"})]})]})]})]})]})}),P&&I.jsx(Vx,{}),A&&I.jsx(Wx,{}),I.jsx("div",{className:"fixed top-0 left-0 right-0 z-[60] flex flex-col gap-2 p-4",children:I.jsxs(oT,{children:[Pf.type&&Pf.message&&I.jsx(dm,{message:Pf.message,type:Pf.type,onClose:()=>ms({type:null,message:null})}),xf&&I.jsx(dm,{message:`Not enough funds in your wallet. You need ${x.toFixed(2)} to complete this transaction.`,type:"error",onClose:()=>Ho(!1)}),qx&&I.jsx(dm,{message:"You can only have one subscription in your cart at a time. Please remove any additional subscriptions before proceeding.",type:"error",onClose:()=>x0(!1)})]})})]})},nK=({provider:r,address:e,chainId:t})=>{const[n,s]=Ce.useState("0");return Ce.useEffect(()=>{const i=async()=>{if(r&&e)try{const c=await new Qa(r,t).getBalance(e),l=s0(c),u=(Number(l)*2e3).toFixed(2);s(u)}catch(a){console.error("Error fetching balance:",a)}};i();const o=setInterval(i,1e4);return()=>clearInterval(o)},[r,e,t]),I.jsxs(I.Fragment,{children:["",n]})},bJ=Object.freeze(Object.defineProperty({__proto__:null,default:rK},Symbol.toStringTag,{value:"Module"}));export{_u as $,he as A,Ae as B,_e as C,be as D,SI as E,dK as F,Aj as G,is as H,UT as I,qe as J,yJ as K,Dw as L,Ut as M,OT as N,K as O,ai as P,vp as Q,tt as R,os as S,Ar as T,kh as U,fJ as V,dr as W,Zt as X,pJ as Y,MI as Z,kw as _,Cp as a,zk as a0,KK as a1,LE as a2,B_ as a3,Dk as a4,qk as a5,JK as a6,GK as a7,kg as a8,ZK as a9,YK as aa,bJ as ab,ur as b,ee as c,Ee as d,S as e,At as f,xi as g,mJ as h,gl as i,yn as j,Et as k,ft as l,LH as m,Ni as n,$H as o,se as p,$s as q,gJ as r,HA as s,UC as t,St as u,jA as v,Zr as w,dJ as x,_r as y,hK as z};
